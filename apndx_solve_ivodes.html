<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix K — Solving Initial-Value ODEs – Reaction Engineering Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./apndx_solve_mvodes.html" rel="next">
<link href="./apndx_solve_ates.html" rel="prev">
<link href="./Graphics/BuffaloBadger_16_16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="http://buffalobadger.github.io" class="navbar-brand navbar-brand-logo">
    <img src="./Graphics/Banner.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/RE_Basics"> 
<span class="menu-text">Reaction Engineering Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/SCoRE"> 
<span class="menu-text">SCoRE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/ToTaL_Engineering"> 
<span class="menu-text">ToTaL Engineering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/The_Sett"> 
<span class="menu-text">The Sett</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./apndx_useful_eqns.html">Appendices</a></li><li class="breadcrumb-item"><a href="./apndx_solve_ivodes.html"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Solving Initial-Value ODEs</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_intro_and_defs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reactions, Reactors, and Reaction Engineering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_safety_and_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reaction Engineering Ethics and Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_reaction_progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measures of Reaction Progress</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rate Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_rates_and_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reaction Rates and Rate Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reaction Mechanisms and Mechanistic Rate Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_3_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formulating Reactor Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_design_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reactor Design Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_4_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Isolated Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_reaction_engineering_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Response, Optimization and Design of Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_bstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">BSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_sbstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">SBSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_non_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design of Non-Continuous Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_cstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_pfr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_5_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Ideal Reactor Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_reactor_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reactor Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_thermally_backmixed_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thermally Back-Mixed PFRs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_recycle_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recycle PFRs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_6_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kinetics Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_data_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_bstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_cstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_pfr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_7_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Non-Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_segregated_flow_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Segregated Flow Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_zoned_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Zoned Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_useful_eqns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Frequently Used Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_prereq_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Prerequisite Knowledge</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_nomenclature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Acronyms, Notation, Sign Conventions, and Computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_reaction_thermo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Reaction Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_heat_exchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Reactor Heat Exchange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_collision_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Collision Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_transition_state_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Transition State Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_ideal_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Axial Dispersion Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Solving Algebraic/Transcendental Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ivodes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Solving Initial-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_mvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Solving Missing-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_cvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Solving Coupled-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_estimate_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Parameter Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-mass_matrix" id="toc-sec-mass_matrix" class="nav-link active" data-scroll-target="#sec-mass_matrix"><span class="header-section-number">K.1</span> Identifying IVODEs and Preparing to Solve Them Numerically</a></li>
  <li><a href="#ivode-solvers" id="toc-ivode-solvers" class="nav-link" data-scroll-target="#ivode-solvers"><span class="header-section-number">K.2</span> IVODE Solvers</a>
  <ul class="collapse">
  <li><a href="#cautions-related-to-numerical-solution-of-ivodes" id="toc-cautions-related-to-numerical-solution-of-ivodes" class="nav-link" data-scroll-target="#cautions-related-to-numerical-solution-of-ivodes"><span class="header-section-number">K.2.1</span> Cautions Related to Numerical Solution of IVODEs</a></li>
  <li><a href="#the-derivatives-function" id="toc-the-derivatives-function" class="nav-link" data-scroll-target="#the-derivatives-function"><span class="header-section-number">K.2.2</span> The Derivatives Function</a></li>
  </ul></li>
  <li><a href="#sec-math_form_ivodes" id="toc-sec-math_form_ivodes" class="nav-link" data-scroll-target="#sec-math_form_ivodes"><span class="header-section-number">K.3</span> Mathematical Formulation of the Numerical Solution of a Set of IVODEs</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">K.4</span> Example</a>
  <ul class="collapse">
  <li><a href="#sec-example_J_6_1" id="toc-sec-example_J_6_1" class="nav-link" data-scroll-target="#sec-example_J_6_1"><span class="header-section-number">K.4.1</span> Example: Formulation of the Solution of a Set of BSTR Design Equations</a></li>
  </ul></li>
  <li><a href="#symbols-used-in-sec-apndx_solve_ivodes" id="toc-symbols-used-in-sec-apndx_solve_ivodes" class="nav-link" data-scroll-target="#symbols-used-in-sec-apndx_solve_ivodes"><span class="header-section-number">K.5</span> Symbols Used in <span>Appendix K</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./apndx_useful_eqns.html">Appendices</a></li><li class="breadcrumb-item"><a href="./apndx_solve_ivodes.html"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Solving Initial-Value ODEs</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-apndx_solve_ivodes" class="quarto-section-identifier">Appendix K — Solving Initial-Value ODEs</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This appendix examines the numerical solution of sets of initial value ordinary differential equations (IVODEs). There are many software packages that include an IVODE solver (a function that can be used to solve sets of IVODEs). While the details differ between software packages, almost all IVODE solvers require the same input and they return essentially the same results. This appendix provides sufficient information for readers to follow <em>Reaction Engineering Basics</em> examples and to solve sets of IVODEs using the IVODE solver they prefer. Readers seeking a more complete understanding of how IVODE solvers work should consult a numerical methods reference book or take a course on numerical methods.</p>
<section id="sec-mass_matrix" class="level2" data-number="K.1">
<h2 data-number="K.1" class="anchored" data-anchor-id="sec-mass_matrix"><span class="header-section-number">K.1</span> Identifying IVODEs and Preparing to Solve Them Numerically</h2>
<p>A differential equation contains at least one derivative. A distinguishing feature of a set of <strong>ordinary</strong> differential equations (ODEs) is that every derivative that appears in the equations has the same independent variable. Put differently, there are no partial derivatives in a set of ordinary differential equations. In virtually all cases, the sets of IVODEs that are solved in <em>Reaction Engineering Basics</em> are linear, first-order ODEs. That means that there are no higher order derivatives in the equations and that there are no products, quotients or powers of the first-order derivatives.</p>
<p>Most generally, the sets of IVODEs under consideration here will take the form shown in Equations <a href="#eq-example-ode-1" class="quarto-xref"><span>K.1</span></a> through <a href="#eq-example-ode-4" class="quarto-xref"><span>K.4</span></a>. In those equations <span class="math inline">\(x\)</span> is the independent variable; <span class="math inline">\(y_1\)</span>, <span class="math inline">\(y_2\)</span>, <span class="math inline">\(y_3\)</span>, and <span class="math inline">\(y_4\)</span> are the dependent variables; and <span class="math inline">\(m_{1,1}\)</span> through <span class="math inline">\(m_{4,4}\)</span> and <span class="math inline">\(g_1\)</span> through <span class="math inline">\(g_4\)</span> can be constants (including zero) or functions of the independent and dependent variables.</p>
<p><span id="eq-example-ode-1"><span class="math display">\[
m_{1,1}\frac{dy_1}{dx} + m_{1,2}\frac{dy_2}{dx} + m_{1,3}\frac{dy_3}{dx} + m_{1,4}\frac{dy_4}{dx} = g_1
\tag{K.1}\]</span></span></p>
<p><span id="eq-example-ode-2"><span class="math display">\[
m_{2,1}\frac{dy_1}{dx} + m_{2,2}\frac{dy_2}{dx} + m_{2,3}\frac{dy_3}{dx} + m_{2,4}\frac{dy_4}{dx} = g_2
\tag{K.2}\]</span></span></p>
<p><span id="eq-example-ode-3"><span class="math display">\[
m_{3,1}\frac{dy_1}{dx} + m_{3,2}\frac{dy_2}{dx} + m_{3,3}\frac{dy_3}{dx} + m_{3,4}\frac{dy_4}{dx} = g_3
\tag{K.3}\]</span></span></p>
<p><span id="eq-example-ode-4"><span class="math display">\[
m_{4,1}\frac{dy_1}{dx} + m_{4,2}\frac{dy_2}{dx} + m_{4,3}\frac{dy_3}{dx}  + m_{4,4}\frac{dy_4}{dx} = g_4
\tag{K.4}\]</span></span></p>
<p>While four equations are being used here for illustration purposes, there can be any number of ordinary differential equations in the set as long as the number of ordinary differential equations is equal to the number of dependent variables, and there is only one independent variable. In <em>Reaction Engineering Basics</em>, the independent variable is either the elapsed time, <span class="math inline">\(t\)</span>, or the axial position, <span class="math inline">\(z\)</span>, measured from the inlet of a plug flow reactor.</p>
<p>A set of <span class="math inline">\(N\)</span> initial-value ordinary differential equations will contain 1 independent variable and <span class="math inline">\(N\)</span> dependent variables. The other quantities that may appear within the <span class="math inline">\(m_{i,j}\)</span> coefficients and <span class="math inline">\(g_j\)</span> functions are (a) constants, (b) the independent variable, (c) the dependent variables, (d) known constants, and (e) other unknowns. Before the set of IVODEs can be solved, the other unknowns must be calculated or provided as described subsequently.</p>
<p>What distinguishes the equations as IVODEs is that they value of each dependent variable, <span class="math inline">\(y_j\)</span>, is known at the point where <span class="math inline">\(x\)</span> is equal to zero and the value of either <span class="math inline">\(x\)</span> or one of the <span class="math inline">\(y_j\)</span> is known at some other point. The values of the dependent variables at <span class="math inline">\(x\)</span> = 0 are called the initial values. The variable (<span class="math inline">\(x\)</span> or one of the <span class="math inline">\(y_j\)</span>) that is known at some other point together with that known value is called the stopping criterion for reasons described below.</p>
<p>In preparation for solving a set of <span class="math inline">\(N\)</span> IVODEs, they should be rearranged into a set of derivative functions if they aren’t already in that form. For example, Equations <a href="#eq-example-ode-1" class="quarto-xref"><span>K.1</span></a> through <a href="#eq-example-ode-4" class="quarto-xref"><span>K.4</span></a> need to be converted to derivative expressions of the form shown in Equations <a href="#eq-example-vector-ode-1" class="quarto-xref"><span>K.5</span></a> through <a href="#eq-example-vector-ode-4" class="quarto-xref"><span>K.8</span></a> where <span class="math inline">\(f_1\)</span>, <span class="math inline">\(f_2\)</span>, <span class="math inline">\(f_3\)</span>, and <span class="math inline">\(f_4\)</span> each may be a function of <span class="math inline">\(x\)</span>, <span class="math inline">\(y_1\)</span>, <span class="math inline">\(y_2\)</span>, <span class="math inline">\(y_3\)</span>, and <span class="math inline">\(y_4\)</span> and may also contain known constants and other unknowns that must be calculated or provided before the IVODEs can be solved numerically.</p>
<p><span id="eq-example-vector-ode-1"><span class="math display">\[
\frac{dy_1}{dx}  = f_1
\tag{K.5}\]</span></span></p>
<p><span id="eq-example-vector-ode-2"><span class="math display">\[
\frac{dy_2}{dx} = f_2
\tag{K.6}\]</span></span></p>
<p><span id="eq-example-vector-ode-3"><span class="math display">\[
\frac{dy_3}{dx} = f_3
\tag{K.7}\]</span></span></p>
<p><span id="eq-example-vector-ode-4"><span class="math display">\[
\frac{dy_4}{dx} = f_4
\tag{K.8}\]</span></span></p>
<p>That can be accomplished by algebraic manipulation of Equations <a href="#eq-example-ode-1" class="quarto-xref"><span>K.1</span></a> through <a href="#eq-example-ode-4" class="quarto-xref"><span>K.4</span></a>, but it is particularly straightforward if the original IVODEs are written as a matrix equation. The coefficients in Equations <a href="#eq-example-ode-1" class="quarto-xref"><span>K.1</span></a> through <a href="#eq-example-ode-4" class="quarto-xref"><span>K.4</span></a>, <span class="math inline">\(m_{1,1}\)</span>, <span class="math inline">\(m_{1,2}\)</span>, etc., can be used to construct a so-called mass matrix, <span class="math inline">\(\boldsymbol{M}\)</span>, as shown in <a href="#eq-mass-matrix" class="quarto-xref">Equation&nbsp;<span>K.9</span></a>, the dependent variables can be used to construct a column vector, <span class="math inline">\(\underline{y}\)</span>, as in equation <a href="#eq-dependent-var-vector" class="quarto-xref">Equation&nbsp;<span>K.10</span></a>, and the functions, <span class="math inline">\(g_1\)</span>, <span class="math inline">\(g_2\)</span>, <span class="math inline">\(g_3\)</span>, and <span class="math inline">\(g_4\)</span>, can be used to construct a column vector, <span class="math inline">\(\underline{g}\)</span>, as in equation <a href="#eq-function-vector" class="quarto-xref">Equation&nbsp;<span>K.11</span></a>.</p>
<p><span id="eq-mass-matrix"><span class="math display">\[
\boldsymbol{M} = \begin{bmatrix} m_{1,1} \ m_{1,2} \ m_{1,3} \ m_{1,4} \\m_{2,1} \ m_{2,2} \ m_{2,3} \ m_{2,4} \\m_{3,1} \ m_{3,2} \ m_{3,3} \ m_{3,4} \\ m_{4,1} \ m_{4,2} \ m_{4,3} \ m_{4,4}  \end{bmatrix}
\tag{K.9}\]</span></span></p>
<p><span id="eq-dependent-var-vector"><span class="math display">\[
\underline{y} = \begin{bmatrix} y_1 \\ y_2 \\ y_3 \\ y_4 \end{bmatrix}
\tag{K.10}\]</span></span></p>
<p><span id="eq-function-vector"><span class="math display">\[
\underline{g} = \begin{bmatrix} g_1 \\ g_2 \\ g_3 \\ g_4 \end{bmatrix}
\tag{K.11}\]</span></span></p>
<p>Equations <a href="#eq-example-ode-1" class="quarto-xref"><span>K.1</span></a> through <a href="#eq-example-ode-4" class="quarto-xref"><span>K.4</span></a> then can be written as a matrix equation, <a href="#eq-matrix-form-ivode" class="quarto-xref">Equation&nbsp;<span>K.12</span></a>. Pre-multiplying each side of <a href="#eq-matrix-form-ivode" class="quarto-xref">Equation&nbsp;<span>K.12</span></a> by the inverse of the mass matrix yields the desired derivative expressions, <a href="#eq-matrix-form-of-vector-ivodes" class="quarto-xref">Equation&nbsp;<span>K.13</span></a>. That is, comparing <a href="#eq-matrix-form-of-vector-ivodes" class="quarto-xref">Equation&nbsp;<span>K.13</span></a> to Equations <a href="#eq-example-vector-ode-1" class="quarto-xref"><span>K.5</span></a> through <a href="#eq-example-vector-ode-4" class="quarto-xref"><span>K.8</span></a>, it is apparent that they are equivalent with <span class="math inline">\(f_1\)</span>, <span class="math inline">\(f_2\)</span>, <span class="math inline">\(f_3\)</span>, and <span class="math inline">\(f_4\)</span> given by <a href="#eq-g-in-terms-of-f" class="quarto-xref">Equation&nbsp;<span>K.14</span></a>.</p>
<p><span id="eq-matrix-form-ivode"><span class="math display">\[
\boldsymbol{M}\frac{d}{dx}\underline{y} = \underline{g}
\tag{K.12}\]</span></span></p>
<p><span id="eq-matrix-form-of-vector-ivodes"><span class="math display">\[
\frac{d}{dx}\underline{y} = \boldsymbol{M}^{-1} \underline{g}
\tag{K.13}\]</span></span></p>
<p><span id="eq-g-in-terms-of-f"><span class="math display">\[
\begin{bmatrix} f_1 \\ f_2 \\ f_3 \\ f_4 \end{bmatrix} = \underline{f} = \boldsymbol{M}^{-1} \underline{g}
\tag{K.14}\]</span></span></p>
</section>
<section id="ivode-solvers" class="level2" data-number="K.2">
<h2 data-number="K.2" class="anchored" data-anchor-id="ivode-solvers"><span class="header-section-number">K.2</span> IVODE Solvers</h2>
<p>An IVODE solver is a computer function that solves a set of IVODEs numerically. Typically it must be provided with the following inputs: (a) the initial value of the independent variable, (b) the corresponding initial value of each dependent variable, (c) the identity of the variable (independent or one of the dependents) that is known at another point, (d) the known final value of that variable, and (e) a derivatives function. The IVODE solver returns sets of corresponding values of the independent variable and each of the dependent variables spanning the range from their initial value to the point where the stopping criterion was satisfied.</p>
<p>The inner workings of IVODE solvers are beyond the scope of <em>Reaction Engineering Basics</em>. Nonetheless, a simplified understanding of how IVODEs are solved numerically is useful. When an IVODE solver is called, it must be provided with the following arguments: the initial values, the stopping criterion (i. e. the final value of either the independent variable or one of the dependent variables), and a derivatives function. As described below, the derivatives function uses the IVODEs to calculate and return the values of the derivatives appearing in the IVODEs.</p>
<p>The solver starts from the initial values, as illustrated graphically in part (a) of <a href="#fig-ivode-integration-step" class="quarto-xref">Figure&nbsp;<span>K.1</span></a> for any one of the dependent variables. It isn’t possible to plot <span class="math inline">\(y\)</span> <em>vs.</em> <span class="math inline">\(x\)</span> at that point because <span class="math inline">\(y\left(x\right)\)</span> is not known. (Indeed, <span class="math inline">\(y\left(x\right)\)</span> is the solution to the IVODE.) Instead, the solver uses the IVODEs to calculate the value of each of the derivatives at <span class="math inline">\(\left(x_0,y_0\right)\)</span>. The derivative, <span class="math inline">\(\frac{dy}{dx}\)</span>, at that point is the slope of the unknown function at <span class="math inline">\(\left(x_0,y_0\right)\)</span>. This is shown graphically in part (b) of <a href="#fig-ivode-integration-step" class="quarto-xref">Figure&nbsp;<span>K.1</span></a>.</p>
<div id="fig-ivode-integration-step" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ivode-integration-step-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Graphics/IVODE_Integration_Step.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ivode-integration-step-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;K.1: Graphical Representation of an IVODE Integration Step. (a) The initial value. (b) The slope at that point. (c) Incrementally increasing x and approximating the corresponding y.
</figcaption>
</figure>
</div>
<p>Starting from the known point, <span class="math inline">\(\left(x_0,y_0\right)\)</span>, the solver increases <span class="math inline">\(x\)</span> by a small amount, <span class="math inline">\(\Delta x\)</span>, which is known as the <em>step-size</em>. It then calculates the corresponding change in <span class="math inline">\(y\)</span>, <span class="math inline">\(\Delta y\)</span>, using the slope. The resulting point, <span class="math inline">\(\left(x_1,y_1\right)\)</span>, is shown in part (c) of <a href="#fig-ivode-integration-step" class="quarto-xref">Figure&nbsp;<span>K.1</span></a>. This process is sometimes referred to as taking an integration step. Effectively, the solver uses the small straight line segment between <span class="math inline">\(\left(x_0,y_0\right)\)</span> and <span class="math inline">\(\left(x_1,y_1\right)\)</span> to approximate the true solution, <span class="math inline">\(y\left(x\right)\)</span>, in that interval. The accuracy of this approximation increases as <span class="math inline">\(\Delta x\)</span> decreases, so typically the solver uses small steps. A new integration step is then taken starting fr0m <span class="math inline">\(\left(x_1,y_1\right)\)</span>.</p>
<p>Of course, the solver eventually must stop taking integration steps. After completing each step, the solver checks to determine whether making that step resulted in the stopping criterion being satisfied. If not, the solver takes another integration step. As an example, suppose the stopping criterion is that <span class="math inline">\(y_3\)</span> should equal some value, <span class="math inline">\(y_{3,f}\)</span>, the solver would check to see whether <span class="math inline">\(y_3\)</span> did, in fact, reach or surpass <span class="math inline">\(y_{3,f}\)</span> after making the step. In most cases the stopping criterion will have been surpassed by some small amount, in which case the solver interpolates to find final values that exactly satisfy the stopping criterion. It then returns the values of the dependent variables and the independent variable for all of the steps it took while solving the IVODEs, including those final interpolated values.</p>
<section id="cautions-related-to-numerical-solution-of-ivodes" class="level3" data-number="K.2.1">
<h3 data-number="K.2.1" class="anchored" data-anchor-id="cautions-related-to-numerical-solution-of-ivodes"><span class="header-section-number">K.2.1</span> Cautions Related to Numerical Solution of IVODEs</h3>
<p><em>When the stopping criterion is a value of one of the dependent variables</em>, many solvers require that you provide <em>both</em> a final value of the independent variable <em>and</em> the known final value of that dependent variable. The solver then takes steps as described above, and after each step it checks to see whether either variable has reached its specified final value. The problem is that if you specify a final value of the <em>independent</em> variable that is too small, the solver may reach that value first and stop. The stopping criterion you specified for the dependent variable will not have been reached, and the result that is returned is not the result you are seeking. Therefore it is important to <strong>check that the dependent variable reached the specified final value</strong>.</p>
<p>To avoid having the solver stop because it reached the stopping criterion for the <em>independent</em> variable, it is tempting to specify a very large final value for the independent variable stopping criterion. The problem with doing this is that it may cause the solver to use a step size that is too large, resulting in an inaccurate solution. Therefore, it is important to <strong>check that the step size was not too large</strong>. The solution that is returned will include the final value of the independent variable. The stopping criterion for the independent variable can be set to a value slightly larger than that and the equations can be solved a second time. Assuming the second solution reaches the desired stopping criterion for the dependent variable, the second solution should be accurate.</p>
<p>A second possible problem arises when solving sets of IVODEs where one of the dependent variables changes very abruptly over a very small range of the independent variable. The abrupt changes in that dependent variable may significantly affect the other dependent variables over a much broader range of the independent variable. Equations like this are called <strong>stiff ODEs</strong>, and they require special treatment of the step size. Therefore, when solving sets of ODEs, one should pay attention to whether any of the dependent variables change very abruptly as the independent variable changes. If they do, it is advisable to repeat the solution using a solver that is specifically tailored to stiff ODEs.</p>
</section>
<section id="the-derivatives-function" class="level3" data-number="K.2.2">
<h3 data-number="K.2.2" class="anchored" data-anchor-id="the-derivatives-function"><span class="header-section-number">K.2.2</span> The Derivatives Function</h3>
<p>The IVODE solver is part of a mathematics software package. It must call the derivatives function which is written by the engineer who needs to solve a set of IVODEs. While the arguments to derivatives function are always a value of the independent variable and the corresponding values of each of the dependent variables, and while the return values are always the values of each of the derivatives that appear in the IVODEs, the details of how the arguments are provided and the return values returned is specifice by the mathematics software package. The engineer calling the IVODE solver must write the derivatives function so it conforms to those specifications.</p>
<p>The calculations perfromed within the derivarives function are straightforward. It receives values for the independent and dependent variables, and any known constants that appear in the IVODEs are available. If there are any other unknowns in the IVODEs, their values are first calculated. In most cases these quantities can be calculated using the independent variable, the dependent variables, and known constants. However, if it is not possible to calculate any of the other unknowns appearing in the IVODEs, they must be provided to the derivatives function.</p>
<p>Providing unknown constants to the residuals function forces a computer programming choice like that described in <a href="apndx_solve_ates.html" class="quarto-xref"><span>Appendix J</span></a> for the residuals function. The issue is that the other unknowns cannot be passed to the derivatives function as arguments. The arguments that can be passed to the derivatives function are fixed by the mathematics software package being used and are limited to values of the independent and dependent variables. As a consequence, any other unknowns that cannot be calculated within the derivatives function will need to be provided by other means. The documentation for the mathematics software package may suggest a preferred way to do this such as by using a global variable or by using a pass-through function. Once the other constants are calculated or made available, all that remains to be done within the derivatives function is to evaluate the derivatives using the derivatives functions described above and return them.</p>
</section>
</section>
<section id="sec-math_form_ivodes" class="level2" data-number="K.3">
<h2 data-number="K.3" class="anchored" data-anchor-id="sec-math_form_ivodes"><span class="header-section-number">K.3</span> Mathematical Formulation of the Numerical Solution of a Set of IVODEs</h2>
<p>Once a set of <span class="math inline">\(N\)</span> IVODEs containing <span class="math inline">\(N\)</span> dependent variables has been identified, the initial values have been defined, and a stopping criterion has been specified, the numerical solution of the IVODEs can be formulated. The first step is to formulate the derivatives function. The derivatives function specification should list the arguments to be passed to it (values of the independent and dependent variables), the quantities it will return (values of each of the derivatives appearing in the set of IVODEs), and any other quantities that must be provided to it by means other than as an argument. The formulation of the derivatives function should next present the algorithm, that is, the sequence of calculations need to evaluate and return the values of the derivatives assuming the given and known constants, arguments, and additional required input are available.</p>
<p>The remainder of the formulation focuses on the IVODE solver. It begins by showing how to calculate any unknown initial and final values. Next, any other unknowns that cannot be calculated within the derivatives function should be made available to it as described above. After that, the IVODE solver should be called. The formulation should list the arguments to be passed to it (initial values, stopping criterion, and the derivatives function) and the quantities it will return (corresponding sets of values of the independent and dependent values spanning the range from their initial values to the point where the stopping criterion is satisfied). That completes the mathematical formulation of the numerical solution of a set of IVODEs.</p>
</section>
<section id="example" class="level2" data-number="K.4">
<h2 data-number="K.4" class="anchored" data-anchor-id="example"><span class="header-section-number">K.4</span> Example</h2>
<p>The following example illustrates the formulation of the numerical solution of a set of IVODEs.</p>
<section id="sec-example_J_6_1" class="level3" data-number="K.4.1">
<h3 data-number="K.4.1" class="anchored" data-anchor-id="sec-example_J_6_1"><span class="header-section-number">K.4.1</span> Example: Formulation of the Solution of a Set of BSTR Design Equations</h3>
<p>A reaction engineer needs to solve the BSTR design equations shown in equations (1) and (2). The initial values and stopping criterion are shown in <a href="#tbl-example_J_4_1_initial_values" class="quarto-xref">Table&nbsp;<span>K.1</span></a>. The gas constant, <span class="math inline">\(R\)</span>, reactor volume, <span class="math inline">\(V\)</span>, final time, <span class="math inline">\(t_f\)</span>, and initial concentration of A, <span class="math inline">\(C_{A,0}\)</span> are known constants. The Arrhenius pre-exponential factor, <span class="math inline">\(k_0\)</span>, and activation energy, <span class="math inline">\(E\)</span>, are constants, but they cannot be calculated from the information that will be available to the derivatives function. Formulate the numerical solution of equations (1) and (2).</p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -rV \tag{1}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Z}{dt} = rV \tag{2}
\]</span></p>
<p><span class="math display">\[
r = kC_A \tag{3}
\]</span></p>
<p><span class="math display">\[
k = k_0 \exp{\left( \frac{-E}{RT}\right)} \tag{4}
\]</span></p>
<p><span class="math display">\[
C_A = \frac{n_A}{V} \tag{5}
\]</span></p>
<p><span class="math display">\[
n_{A,0} = C_{A,0}V \tag{6}
\]</span></p>
<div id="tbl-example_J_4_1_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20, 40, 40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_J_4_1_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;K.1: Initial values and stopping criterion for solving the design equations, equations (3) and (4).
</figcaption>
<div aria-describedby="tbl-example_J_4_1_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_f\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n_{A,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(n_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<hr>
<p><u>Derivatives Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, and <span class="math inline">\(n_Z\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Other input: <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return values: <span class="math inline">\(\frac{dn_A}{dt}\)</span> and <span class="math inline">\(\frac{dn_Z}{dt}\)</span></p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<p><span class="math inline">\(\qquad \qquad\)</span> 1. Calculate other unknowns.</p>
<p><span class="math display">\[
k = k_0 \exp{\left( \frac{-E}{RT}\right)} \tag{4}
\]</span></p>
<p><span class="math display">\[
C_A = \frac{n_A}{V} \tag{5}
\]</span></p>
<p><span class="math display">\[
r = kC_A \tag{3}
\]</span></p>
<p><span class="math inline">\(\qquad \qquad\)</span> 2. Evaluate and return the derivatives using equations (1) and (2).</p>
<p><u>Solving the Design Equations</u></p>
<ol type="1">
<li>Calculate the unknown initial and final values</li>
</ol>
<p><span class="math display">\[
n_{A,0} = C_{A,0}V \tag{6}
\]</span></p>
<ol start="2" type="1">
<li><p>Make <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> available to the derivatives function.</p></li>
<li><p>Call an IVODE solver.</p>
<ol type="a">
<li><p>Pass the initial values, stopping criterion and the name of the derivatives function as arguments.</p></li>
<li><p>receive corresponding sets of values of <span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, and <span class="math inline">\(n_Z\)</span> spanning the range from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(T=t_f\)</span>.</p></li>
</ol></li>
</ol>
</section>
</section>
<section id="symbols-used-in-sec-apndx_solve_ivodes" class="level2" data-number="K.5">
<h2 data-number="K.5" class="anchored" data-anchor-id="symbols-used-in-sec-apndx_solve_ivodes"><span class="header-section-number">K.5</span> Symbols Used in <a href="#sec-apndx_solve_ivodes" class="quarto-xref"><span>Appendix K</span></a></h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(f_i\)</span></td>
<td style="text-align: left;">Function of the independent and dependent variables in the <span class="math inline">\(i^{th}\)</span> differential equation when the ODEs are written in vector form without a matrix.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\underline f\)</span></td>
<td style="text-align: left;">Column vector formed from a set of functions.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(g_i\)</span></td>
<td style="text-align: left;">Function of the independent and dependent variables in the <span class="math inline">\(i^{th}\)</span> differential equation when the ODEs are written using a matrix.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\underline g\)</span></td>
<td style="text-align: left;">Column vector formed from a set of functions.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(k\)</span></td>
<td style="text-align: left;">Rate coefficient.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(k_0\)</span></td>
<td style="text-align: left;">Arrhenius pre-exponential factor.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(m_{i,j}\)</span></td>
<td style="text-align: left;">Coefficient that multiplies the derivative of dependent variable <span class="math inline">\(j\)</span> in the <span class="math inline">\(i^{th}\)</span> differential equation.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_i\)</span></td>
<td style="text-align: left;">Molar amount of reagent <span class="math inline">\(i\)</span>, an additional subscripted ‘<span class="math inline">\(0\)</span>’ denotes the initial amount.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r\)</span></td>
<td style="text-align: left;">Reaction rate per unit volume.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: left;">Time; a subscripted <span class="math inline">\(f\)</span> indicates the <em>final</em> time.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(x\)</span></td>
<td style="text-align: left;">Generic independent variable; a subscripted <span class="math inline">\(0\)</span> indicates the initial value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\left(x_i,y_i\right)\)</span></td>
<td style="text-align: left;">Cartesion coordinates of the <span class="math inline">\(i^{th}\)</span> point.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y\)</span></td>
<td style="text-align: left;">Generic dependent variable; a numerical subscript denotes one specific dependent variable out of the vector <span class="math inline">\(\underline y\)</span>; an additional subscripted <span class="math inline">\(f\)</span> indicates the <em>final</em> value; an additional subscripted <span class="math inline">\(0\)</span> indicates the initial value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\underline y\)</span></td>
<td style="text-align: left;">Column vector formed from the dependent variables in a set of ODEs.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(z\)</span></td>
<td style="text-align: left;">axial position measured from the reactor inlet.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(C_i\)</span></td>
<td style="text-align: left;">Concentration of reagent <span class="math inline">\(i\)</span>, an additional subscripted ‘<span class="math inline">\(0\)</span>’ denotes the initial concentration.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(E\)</span></td>
<td style="text-align: left;">Activation energy.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\boldsymbol{M}\)</span></td>
<td style="text-align: left;">Matrix of coefficients that multiplies a column vector of derivatives when the ODEs are written as a matrix equation.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(N\)</span></td>
<td style="text-align: left;">Number of IVODEs in the set.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(R\)</span></td>
<td style="text-align: left;">Ideal gas constant.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T\)</span></td>
<td style="text-align: left;">Temperature; a subscripted <span class="math inline">\(in\)</span> denotes the <em>inlet</em> temperature.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(V\)</span></td>
<td style="text-align: left;">Volume of fluid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\Delta x\)</span></td>
<td style="text-align: left;">Change in the value of the independent variable.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\Delta y\)</span></td>
<td style="text-align: left;">Change in the value of the dependent variable.</td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./apndx_solve_ates.html" class="pagination-link" aria-label="Solving Algebraic/Transcendental Equations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Solving Algebraic/Transcendental Equations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./apndx_solve_mvodes.html" class="pagination-link" aria-label="Solving Missing-Value ODEs">
        <span class="nav-page-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Solving Missing-Value ODEs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>