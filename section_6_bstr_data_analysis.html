<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>19&nbsp; Analysis of Kinetics Data from a BSTR – Reaction Engineering Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./section_6_cstr_data_analysis.html" rel="next">
<link href="./section_6_data_generation.html" rel="prev">
<link href="./Graphics/BuffaloBadger_16_16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="http://buffalobadger.github.io" class="navbar-brand navbar-brand-logo">
    <img src="./Graphics/Banner.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/RE_Basics"> 
<span class="menu-text">Reaction Engineering Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/SCoRE"> 
<span class="menu-text">SCoRE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/ToTaL_Engineering"> 
<span class="menu-text">ToTaL Engineering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/The_Sett"> 
<span class="menu-text">The Sett</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_6_intro.html">Kinetics Data Analysis</a></li><li class="breadcrumb-item"><a href="./section_6_bstr_data_analysis.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_intro_and_defs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reactions, Reactors, and Reaction Engineering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_safety_and_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reaction Engineering Ethics and Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_reaction_progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measures of Reaction Progress</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rate Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_rates_and_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reaction Rates and Rate Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reaction Mechanisms and Mechanistic Rate Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_3_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formulating Reactor Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_design_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reactor Design Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_4_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Isolated Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_reaction_engineering_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Response, Optimization and Design of Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_bstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">BSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_sbstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">SBSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_non_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design of Non-Continuous Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_cstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_pfr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_5_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Ideal Reactor Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_reactor_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reactor Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_thermally_backmixed_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thermally Back-Mixed PFRs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_recycle_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recycle PFRs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_6_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kinetics Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_data_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_bstr_data_analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_cstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_pfr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_7_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Non-Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_age_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Age Distribution Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_segregated_flow_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">A Segregated Flow Reactor Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_zoned_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Zoned Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_prereq_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prerequisite Knowledge</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_nomenclature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Acronyms, Notation, Sign Conventions, and Computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_reaction_thermo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Reaction Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_collision_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Collision Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_transition_state_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Transition State Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_heat_exchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Reactor Heat Exchange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_ideal_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Axial Dispersion Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Solving Algebraic/Transcendental Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ivodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Solving Initial-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_cvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Solving Coupled-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_estimate_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Parameter Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_bvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Solving Boundary-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_useful_eqns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Frequently Used Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#laboratory-bstrs" id="toc-laboratory-bstrs" class="nav-link active" data-scroll-target="#laboratory-bstrs"><span class="header-section-number">19.1</span> Laboratory BSTRs</a>
  <ul class="collapse">
  <li><a href="#testing-the-ideality-of-a-bstr" id="toc-testing-the-ideality-of-a-bstr" class="nav-link" data-scroll-target="#testing-the-ideality-of-a-bstr"><span class="header-section-number">19.1.1</span> Testing the Ideality of a BSTR</a></li>
  </ul></li>
  <li><a href="#bstr-kinetics-experiments-and-data" id="toc-bstr-kinetics-experiments-and-data" class="nav-link" data-scroll-target="#bstr-kinetics-experiments-and-data"><span class="header-section-number">19.2</span> BSTR Kinetics Experiments and Data</a></li>
  <li><a href="#design-of-bstr-experiments" id="toc-design-of-bstr-experiments" class="nav-link" data-scroll-target="#design-of-bstr-experiments"><span class="header-section-number">19.3</span> Design of BSTR Experiments</a>
  <ul class="collapse">
  <li><a href="#adjusted-experimental-inputs" id="toc-adjusted-experimental-inputs" class="nav-link" data-scroll-target="#adjusted-experimental-inputs"><span class="header-section-number">19.3.1</span> Adjusted Experimental Inputs</a></li>
  <li><a href="#experimental-responses" id="toc-experimental-responses" class="nav-link" data-scroll-target="#experimental-responses"><span class="header-section-number">19.3.2</span> Experimental Responses</a></li>
  </ul></li>
  <li><a href="#bstr-data-analysis" id="toc-bstr-data-analysis" class="nav-link" data-scroll-target="#bstr-data-analysis"><span class="header-section-number">19.4</span> BSTR Data Analysis</a>
  <ul class="collapse">
  <li><a href="#bstr-kinetics-data-analysis-using-a-linearized-model" id="toc-bstr-kinetics-data-analysis-using-a-linearized-model" class="nav-link" data-scroll-target="#bstr-kinetics-data-analysis-using-a-linearized-model"><span class="header-section-number">19.4.1</span> BSTR Kinetics Data Analysis Using a Linearized Model</a></li>
  <li><a href="#parameter-estimation-using-an-approximate-reactor-model" id="toc-parameter-estimation-using-an-approximate-reactor-model" class="nav-link" data-scroll-target="#parameter-estimation-using-an-approximate-reactor-model"><span class="header-section-number">19.4.2</span> Parameter Estimation Using an Approximate Reactor Model</a></li>
  <li><a href="#half-life-methods-of-analysis" id="toc-half-life-methods-of-analysis" class="nav-link" data-scroll-target="#half-life-methods-of-analysis"><span class="header-section-number">19.4.3</span> Half-life Methods of Analysis</a></li>
  </ul></li>
  <li><a href="#sec-examples_intro_19" id="toc-sec-examples_intro_19" class="nav-link" data-scroll-target="#sec-examples_intro_19"><span class="header-section-number">19.5</span> Examples</a>
  <ul class="collapse">
  <li><a href="#sec-example_19_5_1" id="toc-sec-example_19_5_1" class="nav-link" data-scroll-target="#sec-example_19_5_1"><span class="header-section-number">19.5.1</span> Assessing a First-Order Rate Expression for a Liquid-Phase Reaction</a></li>
  <li><a href="#sec-example_19_5_2" id="toc-sec-example_19_5_2" class="nav-link" data-scroll-target="#sec-example_19_5_2"><span class="header-section-number">19.5.2</span> Assessing a Second-Order Rate Expression for a Gas-Phase Reaction</a></li>
  <li><a href="#sec-example_19_5_3" id="toc-sec-example_19_5_3" class="nav-link" data-scroll-target="#sec-example_19_5_3"><span class="header-section-number">19.5.3</span> Assessing a Gas-Phase Rate Expression Using Total Pressure as the Response</a></li>
  <li><a href="#sec-example_19_5_4" id="toc-sec-example_19_5_4" class="nav-link" data-scroll-target="#sec-example_19_5_4"><span class="header-section-number">19.5.4</span> Assessing a Michaelis-Menten Rate Expression</a></li>
  <li><a href="#sec-example_19_5_5" id="toc-sec-example_19_5_5" class="nav-link" data-scroll-target="#sec-example_19_5_5"><span class="header-section-number">19.5.5</span> Kinetics Data Analysis using Same-Temperature Data Blocks and Linear Least Squares</a></li>
  <li><a href="#sec-example_19_5_6" id="toc-sec-example_19_5_6" class="nav-link" data-scroll-target="#sec-example_19_5_6"><span class="header-section-number">19.5.6</span> Kinetics Data Analysis using Same-Temperature Data Blocks and an Approximate Reactor Model</a></li>
  </ul></li>
  <li><a href="#symbols-used-in-sec-6_bstr_data_analysis" id="toc-symbols-used-in-sec-6_bstr_data_analysis" class="nav-link" data-scroll-target="#symbols-used-in-sec-6_bstr_data_analysis"><span class="header-section-number">19.6</span> Symbols Used in <span>Chapter 19</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_6_intro.html">Kinetics Data Analysis</a></li><li class="breadcrumb-item"><a href="./section_6_bstr_data_analysis.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-6_bstr_data_analysis" class="quarto-section-identifier"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> presented an overview of the design of kinetics experiments and the generation and analysis of kinetics data. This chapter focuses specifically on data generation and analysis using reactors that conform to the assumptions of the ideal BSTR model described in <a href="section_3_design_equations.html" class="quarto-xref"><span>Chapter 6</span></a> and <a href="apndx_ideal_reactor_models.html" class="quarto-xref">Appendix&nbsp;<span>G</span></a>. Only isothermal, single-response data are considered.</p>
<section id="laboratory-bstrs" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="laboratory-bstrs"><span class="header-section-number">19.1</span> Laboratory BSTRs</h2>
<p>The name Batch <em>Stirred Tank</em> Reactor may conjure up a mental image of a BSTR as a cylindrical vessel fabricated from steel, with some means of stirring the contents vigourously. In fact, it is quite possible to use a simple beaker or Erlenmeyer flask placed on a heated magnetic stir plate and equipped with magnetic stir bar as a BSTR. When a round-bottomed flask like that shown in <a href="#fig-laboratory_bstr" class="quarto-xref">Figure&nbsp;<span>19.1</span></a> is used, the stir bar can be replace by rotating shaft from a motor that extends through a neck and into the flask. The shaft has a paddle on its end that is curved to match the bottom of the flask. As the paddle rotates, it mixes the contents of the reactor. The reactor shown in the figure has two additional necks that can be used, for example, to insert a thermometer and to withdraw samples for analysis. This particular flask has a jacket that surrounds the reactor. A heating or cooling fluid can be circulated through that jacket using the inlet and outlet ports seen on the sides of the vessel. There is also a stopcock at the bottom that can be opened to drain the BSTR when the experiments are complete.</p>
<div id="fig-laboratory_bstr" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-laboratory_bstr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/laboratory_stirred_tank_reactor.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-laboratory_bstr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.1: Round-bottomed flask used as a laboratory BSTR.
</figcaption>
</figure>
</div>
<p>For higher pressure reactions, a metal “autoclave” can be used. The top of this type of autoclave is a flange with a gasket that can be bolted onto the reactor to seal it for use at higher pressures. Typically autoclaves can be heated or cooled, and they use a shaft and paddle for agitation. Special fittings or magnetic couplings are used so that the rotating shaft can pass into the autoclave without allowing the high pressure contents to leak out.</p>
<p>In fact, devices that do not resemble a stirred beaker can also be used as BSTRs for kinetics data generation. The primary requirement is that the contents of the reactor be perfectly mixed. As an example, <a href="#fig-batch_recirc_reactor" class="quarto-xref">Figure&nbsp;<span>19.2</span></a> shows a recirculation loop reactor. Fluid is rapidly recirculated in the reactor by a pump. In-line mixing devices can be placed in the flow path to promote thorough mixing of the fluid. The reactor must be operated at a very high recirculation rate, and for isothermal operation, the pump and other components all must be maintained at the same constant temperature. If heterogeneous catalytic reactions are being studied, a packed catalyst bed can be inserted somewhere within the loop. In this case, the amount of reactant converted during a single pass through the bed should be very small so that the compositions at the beginning and at the end of the bed are essentially equal. In this way the composition in the loop will change with time, but within it, the composition will be essentially uniform everywhere, just as the batch reactor model assumes. An isothermal recirculation reactor such as that shown in <a href="#fig-batch_recirc_reactor" class="quarto-xref">Figure&nbsp;<span>19.2</span></a> is particularly useful for the study of a single gas phase reaction that involves a change in the total number of moles. In such a system, if the initial composition, temperature and pressure are known, the composition at any other time can be found from a measurement of the total pressure. Thus kinetics data can be measured simply by recording the total pressure as a function of time.</p>
<div id="fig-batch_recirc_reactor" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-batch_recirc_reactor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/batch_recirculation_schematic.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-batch_recirc_reactor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.2: Batch recirculation loop reactor schematic.
</figcaption>
</figure>
</div>
<p>The stopped flow reactor, shown schematically in <a href="#fig-stopped_flow_reactor" class="quarto-xref">Figure&nbsp;<span>19.3</span></a>, is a batch reactor that is especially useful for the study of rapid, liquid-phase, bimolecular reactions. Solutions containing the reactants are fed in separate streams to a small mixing chamber. This chamber is designed so that the fluids enter as high velocity jets. The high velocity of these jets causes instantaneous, perfect mixing as the jets enter the reactor. Downstream from the mixing chamber, but still near to it, a detector is located. Typically the detector is a spectrophotometer. This device shines radiation of a given frequency through the fluid and measures how much of the radiation is absorbed. The frequency of the radiation is chosen so that only one of the reactants or products absorbs the radiation. In this way the response from the spectrophotometer is directly proportional to the amount of that one reactant or product. In a typical experiment the fluids begin flowing and a steady state is established. The flow is then stopped instantaneously, and the response of the spectrophotometer is recorded as a function of time. The instant the flow stops, the volume through which the radiation passes becomes a very small batch reactor.</p>
<div id="fig-stopped_flow_reactor" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stopped_flow_reactor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/stopped_flow_schematic.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stopped_flow_reactor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.3: Stopped-flow reactor schematic.
</figcaption>
</figure>
</div>
<section id="testing-the-ideality-of-a-bstr" class="level3" data-number="19.1.1">
<h3 data-number="19.1.1" class="anchored" data-anchor-id="testing-the-ideality-of-a-bstr"><span class="header-section-number">19.1.1</span> Testing the Ideality of a BSTR</h3>
<p>Before a laboratory BSTR is used to generate kinetics data, it should be tested to ensure that it conforms to the assumptions of an ideal BSTR. The most important assumption is that of perfect mixing. If the reactor walls are transparent or if there is a window in the walls, a “smoke test” is a simple way to check the mixing. To perform this kind of test a small amount of colored fluid is added to the reactor. For a gas phase reactor the added fluid is some form of smoke, for a liquid phase system it is often a colored dye. The contents of the reactor are observed at the instant the smoke or dye is added. The smoke or dye should instantaneously mix and fill the entire contents of the reactor. Importantly, there should not be any “corners” or other locations where the color changes slowly. Locations where the color changes slowly are called stagnant zones. They are places where the mixing is not perfect.</p>
<p>A second way of testing the assumption of perfect mixing involves performing the same experiment several times. Each time the experiment is repeated, the only difference from the other experiments is the rate of agitation. That is, a different stirrer speed or recirculation rate is used in each experiment. As the agitation rate is increased in successive experiments, a point should be reached where the experimental results are identical to the previous experiment. At that rate of agitation, the assumption of perfect mixing can be assumed to be satisfied. In subsequent experiments where kinetics data are being generated, an agitation rate somewhat above that critical rate should then be used.</p>
</section>
</section>
<section id="bstr-kinetics-experiments-and-data" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="bstr-kinetics-experiments-and-data"><span class="header-section-number">19.2</span> BSTR Kinetics Experiments and Data</h2>
<p>In a typical BSTR kinetics experiment, the reactants are first loaded into the reactor; this is also called charging the reactor. If the charge to the reactor has not been pre-heated, then once the reagents are in the vessel, it may be necessary to heat the contents to the desired temperature. If the reaction being studied involves two or more reactants, they can be pre-heated separately to the desired temperature before adding them to the reactor. If a catalytic or enzymatic reaction is being studied, the catalyst or enzyme can be added to start the reaction once the desired temperature has been reached.</p>
<p>In any of these situations, <strong>as soon as the reactor is charged and has stabilized at the desired temperature</strong>, the “initial composition” is analyzed. It is important to recognize that for kinetics data analysis purposes, the initial composition is not necessarily the composition that was charged to the reactor, but the composition at the point when the reactor begins to operate isothermally. The kinetics experiment is taken to begin at this instant, and the elapsed time is measured from that instant. Periodically the elapsed time and some quantity that can be related to the composition (the response) are recorded. Each such measurement represents a single data point. The experimental design dictates how long the reaction is allowed to continue, or equivalently, the number of data points generated before the reaction is terminated. As such, each experiment typically yields multiple data points.</p>
</section>
<section id="design-of-bstr-experiments" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="design-of-bstr-experiments"><span class="header-section-number">19.3</span> Design of BSTR Experiments</h2>
<p>The design of kinetics experiments was considered in <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> and won’t be repeated here. It was recommended that reactors being used to generate kinetics data should operate isothermally and that experiments should be performed in blocks where all of the experiments in any one block occur at the same temperature. In <em>Reaction Engineering Basics</em> it is always assumed that kinetics data have been generated using an isothermal reactor wherein only one reaction is occurring.</p>
<p>Briefly, the purpose of kinetics experiments is to generate kinetics data that can be used to develop a rate expression. Generally there will be a critical range of temperatures and critical ranges of the concentration of each reagent within which the rate expression needs to be as accurate as possible. The experiments should be designed so that the temperature and each concentration (or partial pressure) spans its critical range. A factorial design like that described in <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> and illustrated in <a href="section_6_data_generation.html#sec-example_18_6_1" class="quarto-xref">Example&nbsp;<span>18.6.1</span></a> can be used.</p>
<section id="adjusted-experimental-inputs" class="level3" data-number="19.3.1">
<h3 data-number="19.3.1" class="anchored" data-anchor-id="adjusted-experimental-inputs"><span class="header-section-number">19.3.1</span> Adjusted Experimental Inputs</h3>
<p>As already noted, each BSTR experiment will be isothermal, so one of the experimental adjusted reactor inputs will be the reactor temperature. The number of temperature levels to be used will depend upon the critical range of the temperature. If the rate expression needs to be accurate over a range of 150 °C, a greater number of temperature levels should be studied than if it needs to be accurate over a range of 30 °C.</p>
<p>In many cases, the rate of liquid-phase reactions is not affected by total pressure. Nonetheless, the pressure in a liquid-phase system will not change as the reaction proceeds. So if desired, total pressure can be used as a factor for liquid-phase reactions, and different pressure levels can be specified in the experimental design.</p>
<p>For gas-phase reactions, the pressure is closely tied to the composition. If the reaction causes a change in the total number of moles in the system, the total pressure will change as the reaction proceeds. Since reactor volume and temperature are constant in a BSTR kinetics experiment, the initial composition for a gas phase system is determined by the total pressure and the relative amounts of the reagents at the time when isothermal operation commences.</p>
<p>Two experimental inputs affect the composition of the reacting fluid during the experiments. One is the initial composition described above, and the other is the time that has elapsed when the response is measured. In any one experiment, the composition will change continually as the reaction proceeds, so responses measured at different elapsed times during the same experiment will correspond to different compositions. It makes sense to measure the response as many times as possible during each experiment to minimize the time and cost of the experimental study.</p>
<p>The number of times the response can be measured may be determined by the time it takes to make the measurement. For example changes in the absorbance of monochromatic radiation can be measured almost continuously, but analysis using gas chromatography may require several minutes per measurement. The temperature of the experiment may also affect the possible number of response measurements. Consider an irreversible reaction. The reaction rate will be greater in experiments where the temperature is higher. As a consequence, the reaction will go to completion in a shorter period of time in higher temperature experiments than in low temperature experiments. That may mean that fewer responses can be measured in a high temperature experiment than in a low temperature experiment.</p>
</section>
<section id="experimental-responses" class="level3" data-number="19.3.2">
<h3 data-number="19.3.2" class="anchored" data-anchor-id="experimental-responses"><span class="header-section-number">19.3.2</span> Experimental Responses</h3>
<p>Many different quantities can be used as the experimental response. The only requirement is that it must be possible to relate the measured response to the composition of the system. Obvious choices for the measured response are the concentration or partial pressure of any one reactant or product. Recall from <a href="section_1_reaction_progress.html" class="quarto-xref"><span>Chapter 3</span></a> that knowing the initial molar amounts and any one final amount allows calculation of the apparent extent of reaction, which, in turn allows the calculation of all other final amounts. That said, any quantity that can be used to calculate the apparent extent of reaction is an acceptable response.</p>
<p>One other possibility for the measured response from BSTR kinetics experiments is known as the half-life. This response variable is the elapsed time required for the amount of any one reactant to decrease to one-half of its initial value. Measuring the half-life is particularly easy with a stopped-flow reactor like that depicted in <a href="#fig-stopped_flow_reactor" class="quarto-xref">Figure&nbsp;<span>19.3</span></a>. One simply measures the elapsed time between the instant the flow is stopped and the instant the spectrophotometer signal becomes one-half of its original value. (This assumes that the spectrophotometer signal is linearly proportional to the amount of the reagent absorbing the light.) The analysis of kinetics data where the half-life is the measured response is discussed below.</p>
</section>
</section>
<section id="bstr-data-analysis" class="level2" data-number="19.4">
<h2 data-number="19.4" class="anchored" data-anchor-id="bstr-data-analysis"><span class="header-section-number">19.4</span> BSTR Data Analysis</h2>
<p>Kinetics data analysis is discussed in general terms in <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a>. It requires generation of a model for the reactor used in the experiments. The reactor model, <a href="section_3_reactor_models.html" class="quarto-xref"><span>Chapter 7</span></a>, is used within a predicted responses function to predict the response for each experiment. The prdicted responses function is called by a numerical fitting function which fits the predicted reponses model to the experimental data. In this chapter that process is applied to analysis of data from an isothermal BSTR. <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> also describes analysis of same-temperature blocks of kinetics data using linear least squares, and it mentions the use of approximate reactor models. The analysis of BSTR kinetics data using those approaches is also considered in this chapter.</p>
<p>The reactor that needs to be modeled is an isothermal BSTR wherein a single reaction is taking place. <strong>The reactor model</strong> is generated in the same way that BSTR reactor models are generated in <a href="section_4_bstr_analysis.html" class="quarto-xref"><span>Chapter 9</span></a>. Since the reactor operates isothermally and only one reaction takes place, the mole balance design equations can be solved independently of the energy balances. Calculation of the composition at any time after the start of the reaction does not require use of the energy balances. Therefore only mole balances on the reagents are included among the design equations. In addition, since only one reaction is taking place, it isn’t necessary to index the reaction. As a consequence, the BSTR design equations for an isothermal, single-reaction experiment take the form shown in <a href="#eq-bstr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>19.1</span></a>.</p>
<p><span id="eq-bstr_mole_bal_one_reaction"><span class="math display">\[
\frac{dn_i}{dt} = \nu_i r V
\tag{19.1}\]</span></span></p>
<p>The instant the reactor stabilizes at the desired temperature can be defined as <span class="math inline">\(t=0\)</span>. The initial values then equal the molar amounts of each of the reagents at that instant. The response may be measured several times during a BSTR kinetics experiment, yielding several data points from each experiment. The initial values are the same for each of the data points, but the stopping criterion changes, being equal to the elapsed time at which the response was measured.</p>
<p>The derivatives function for a kinetics experiment receives the the elapsedd time and the molar amounts of each of the reagents at the start of an integration step and returns the corresponding values of the derivative of each molar amount with respect to time. To do so, it first needs to calculate unknown quantities appearing in the design equations, and then use the design equations to evaluate the derivatives. During kinetics data analysis, the rate expression parameters will be changing as the predicted responses function is being fit to the experimental. Consequently the current values of the rate expression parameters will need to be made available to the derivatives function.</p>
<p>When a set of kinetics data are being analyzed, the predicted responses function will need to solve the BSTR design equations for each experiment in the data set. For this reason, the adjusted experimental inputs for the experiment being analyzed are usually passed to the reactor model function as an argument during kinetics data analysis. They are needed for the calculation of the initial values and the stopping criterion.</p>
<p>The final component of the BSTR model is a description of the sequence of function calls and calculations used to solve the design equations. An IVODE solver is used to solve the BSTR design equations. It is passed the derivatives function, initial values, and the stopping criterion for the experiment being analyzed. It solves the design equations and returns sets of corresponding values of the time and the molar amounts of each of the reagents spanning the range from the <span class="math inline">\(t=0\)</span> to the time when the response was measured in that experiment. These sets of values are then returned by the BSTR model.</p>
<p><strong>The predicted responses fucntion</strong> that must be written is straightforward. It receives the set of adjusted inputs from all of the experiments and values for each of the parameters that appear in the proposed rate expression. It simply loops through the experiments. For each experiment it uses the BSTR model to solve the design equations and then calculates the predicted response using the results from solving the design quations. After all of the experiments have been evaluated, it returns the set of model-predicted responses for the experiments.</p>
<p>A <strong>numerical fitting function</strong> is used to fit the predicted responses model to the experimental data. The details of using the numerical fiting function will depend upon the specific software being used, but the arguments provided to it and the results it returns are essentially the same for any software package. The arguments that must be provided to a numerical fitting function consist of a guess for the unknown rate expression parameters, the values of each of the experimentally adjusted inputs for all of the experiments in the data set being analyzed, the corresponding values of the measured response for every experiment, and the predicted responses function described above.</p>
<p>Assuming the numerical fitting function is successful, it will return the estimated values of each parameter appearing in the rate expression, the upper and lower bounds of the 95% confidence interval for each parameter, and the coefficient of determination, <span class="math inline">\(R^2\)</span>. Instead of the 95% confidence intervals for the rate expression parameters, the fitting function might return the standard error. It also might return the set of predicted responses corresponging to the estimated parameter values. If the predicted responses are not returned by the fitting function, they can be calculated using the predicted responses function. A parity plot and residuals plots then can be generated, and the accuracy of the proposed rate expression can be assessed as described in <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a>.</p>
<section id="bstr-kinetics-data-analysis-using-a-linearized-model" class="level3" data-number="19.4.1">
<h3 data-number="19.4.1" class="anchored" data-anchor-id="bstr-kinetics-data-analysis-using-a-linearized-model"><span class="header-section-number">19.4.1</span> BSTR Kinetics Data Analysis Using a Linearized Model</h3>
<p>In some situations it is possible to analyze BSTR kinetics data using linear least squares instead of a numerical fitting function. To do so, the data set is split into same-temperature blocks of data, and each block is analyzed separately.</p>
<p>To begin, <a href="#eq-bstr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>19.1</span></a> is written for any <u>one</u> reactant or product, it does not matter which. That mole balance is solved analytically to obtain an integrated form of the reactor model, as indicated in <a href="#eq-integrated_bstr_mole_bal" class="quarto-xref">Equation&nbsp;<span>19.2</span></a> where <span class="math inline">\(f\)</span> represents the function obtained upon solving the mole balance analytically. The mole balance may contain the molar amounts of reagents other than <span class="math inline">\(i\)</span>. If so, those molar amounts must be expressed in terms of <span class="math inline">\(n_i\)</span> using the apparent extent of reaction before the IVODE can be solved. It isn’t always possible to solve the mole balance analytically. If that is the case, this approach cannot be used.</p>
<p><span id="eq-integrated_bstr_mole_bal"><span class="math display">\[
\frac{dn_i}{dt} = \nu_i r V \qquad \Rightarrow \qquad n_i = f\left( n_i, t \right)
\tag{19.2}\]</span></span></p>
<p>Assuming that the mole balance can be solved to find the function, <span class="math inline">\(f\)</span>, the resulting algebraic/transcendental equation (ATE) is re-written so that by defining new variables, <span class="math inline">\(y\)</span> and <span class="math inline">\(x_1\)</span> through <span class="math inline">\(x_n\)</span>, it becomes a linear equation as shown in <a href="#eq-linearized_equation" class="quarto-xref">Equation&nbsp;<span>19.3</span></a>. The number of <span class="math inline">\(x_i\)</span> variables depends upon the number of parameters in the proposed rate epxression. It isn’t always possible to linearize the integrated reactor model, in which case this approach again can’t be used.</p>
<p><span id="eq-linearized_equation"><span class="math display">\[
y = m_1x_1 + m_2x_2 + \cdots + m_nx_n + b
\tag{19.3}\]</span></span></p>
<p>The rate expression parameters cannot appear in the defining equations for the new variables, <span class="math inline">\(y\)</span> and the <span class="math inline">\(x_i\)</span>. Additionally, the definition of each slope, <span class="math inline">\(m_i\)</span>, and the intercept, <span class="math inline">\(b\)</span>, must contain a unique combination of the rate expression parameters; it may not contain any adjusted inputs or the response, and it cannot be a known constant. With those restrictions, the total number of slopes and intercepts will equal the number of rate expression parameters.</p>
<p>The values of <span class="math inline">\(y\)</span> and the <span class="math inline">\(x_i\)</span> are calculated for each experiment. A spreadsheet, calculator, or linear least-squares function is used to fit the <a href="#eq-linearized_equation" class="quarto-xref">Equation&nbsp;<span>19.3</span></a> to the resulting <span class="math inline">\(x-y\)</span> data. Doing so yields the best value of each slope, <span class="math inline">\(m_i\)</span>, and the intercept, <span class="math inline">\(b\)</span>, along with the 95% confidence interval (or standard error) for each and the coefficient of determination, <span class="math inline">\(R^2\)</span>. During linearization of the reactor model, the slopes and intercept were defined in terms of the rate expression parameters. Those definitions are used to calculate the best estimates and the uncertainty for each rate expression parameter.</p>
<p>Very commonly when there is only one <span class="math inline">\(x\)</span> (i. e. when <span class="math inline">\(y=mx\)</span> or <span class="math inline">\(y = mx + b\)</span>) this is all done in a spreadsheet. The adjusted inputs and the responses are entered as columns. New columns are created for <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> which are calculated using the original data. A plot of <span class="math inline">\(y\)</span> <em>vs.</em> <span class="math inline">\(x\)</span> is generated, a trendline is added, and the equation for the trendline is displayed on the graph. The rate expression parameters are then calculated using the slope and intercept in the displayed equation. Most spreadsheets can be configured to show or calculate the coefficient of determination and the uncertainty in the slope and intercept, can also be calculated.</p>
<p>Analyzing all of the same-temperature data blocks results in a secondary data set consisting of the value of each rate expression parameters at each of the data block temperatures. Assuming the unknown parameters are rate coefficients or equilibrium constants for which thermodynamic data are unavailable, the second stage of analysis then involves fitting the Arrhenius expression to this secondary data set. This has already been described in <a href="section_2_rates_and_expressions.html" class="quarto-xref"><span>Chapter 4</span></a> and <a href="apndx_estimate_parameters.html" class="quarto-xref"><span>Appendix L</span></a> and illustrated in <a href="section_2_rates_and_expressions.html#sec-example_4_5_4" class="quarto-xref">Example&nbsp;<span>4.5.4</span></a>, so it won’t be discussed here.</p>
<p>This approach to kinetics data analysis has great historical significance and is still very commonly used and taught. It is not emphasized in <em>Reaction Engineering Basics</em> because it cannot always be used, and when it is used, the pre-exponential factors, activation energies, and unknown heats of reaction appearing in the proposed rate expressions are estimated using other estimates and not using the experimental data directly.</p>
</section>
<section id="parameter-estimation-using-an-approximate-reactor-model" class="level3" data-number="19.4.2">
<h3 data-number="19.4.2" class="anchored" data-anchor-id="parameter-estimation-using-an-approximate-reactor-model"><span class="header-section-number">19.4.2</span> Parameter Estimation Using an Approximate Reactor Model</h3>
<p>This approach is often referred to as differential data analysis. It, too, uses a single mole balance to model the BSTR. Instead of solving the exact mole balance, <a href="#eq-bstr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>19.1</span></a>, the approximate form shown in <a href="#eq-bstr_diff_mol_bal" class="quarto-xref">Equation&nbsp;<span>19.4</span></a> is used. The primary advantage of this approach is that it converts the reactor model from an IVODE to an ATE. The derivative can be approximated using backward, forward or central differences (see <a href="apndx_prereq_knowledge.html" class="quarto-xref">Appendix&nbsp;<span>A</span></a>). In the past, before computers were readily available, the derivative was also estimated graphically. That is <span class="math inline">\(n_i\)</span> was plotted <em>vs</em>. <span class="math inline">\(t\)</span>, a smooth curve was drawn through the data, and the slopes of tangents to that curve were measured and used to approximate the derivative.</p>
<p><span id="eq-bstr_diff_mol_bal"><span class="math display">\[
\frac{dn_i}{dt} = \nu_i r V \approx \frac{\Delta n_i}{\Delta t} = \nu_i r V
\tag{19.4}\]</span></span></p>
<p>To complete the analysis, <a href="#eq-bstr_diff_mol_bal" class="quarto-xref">Equation&nbsp;<span>19.4</span></a> is usually re-written so that by defining new variables it becomes a linear equation at which point the remaining analysis is exactly the same as just described. Of course, if <a href="#eq-bstr_diff_mol_bal" class="quarto-xref">Equation&nbsp;<span>19.4</span></a> cannot be linearized, this approach cannot be used.</p>
<p>As one might expect, this approach is not as accurate as using the exact reactor model. As the data become noisier (i. e. the greater the random error in the data), the accuracy decreases. If the noise in the data is very small and the intervals between response measurements are also small, the accuracy can approach the accuracy of analysis using the exact reactor model. Nonetheless, analysis using the exact reactor model is generally preferred, and differential data analysis more often is used to perform a quick, preliminary analysis.</p>
<p>One variation on this approach uses <strong>initial rates</strong>. The only difference in the initial rate approach is that <a href="#eq-bstr_diff_mol_bal" class="quarto-xref">Equation&nbsp;<span>19.4</span></a> is only applied at the start of the experiment. As a result, each experiment yields only the value of the derivative at the initial conditions. This approach is typically applied graphically by plotting the molar amount of <span class="math inline">\(i\)</span> <em>vs</em>. <span class="math inline">\(t\)</span>. The initial slope then can be measured graphically. It facilitates a quick, preliminary assessment of possible rate expressions. As personal computers have become popular and available, the use of this approach appears to have declined.</p>
</section>
<section id="half-life-methods-of-analysis" class="level3" data-number="19.4.3">
<h3 data-number="19.4.3" class="anchored" data-anchor-id="half-life-methods-of-analysis"><span class="header-section-number">19.4.3</span> Half-life Methods of Analysis</h3>
<p>Another method that appears to have declined in popularity is the half-life method. It involves measuring the “half-life” of the reaction as described earlier. The half-life, <span class="math inline">\(t_{1/2}\)</span>, is the amount of time that it takes for the concentration of a reactant to decrease to one-half of its initial value. The half-life method is most commonly applied when the rate is expected to depend upon the concentration of a single reactant, e. g. reactant A, in a power-law fashion, <a href="#eq-half_life_rate_expr" class="quarto-xref">Equation&nbsp;<span>19.5</span></a>. This rate expression can be substituted into the batch reactor design equation, <a href="#eq-bstr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>19.1</span></a>, as shown in <a href="#eq-half_life_ode" class="quarto-xref">Equation&nbsp;<span>19.6</span></a>.</p>
<p><span id="eq-half_life_rate_expr"><span class="math display">\[
r_A = - kC_A^\alpha
\tag{19.5}\]</span></span></p>
<p><span id="eq-half_life_ode"><span class="math display">\[
\frac{dn_i}{dt} = - kVC_A^\alpha = -kV\left( \frac{n_A}{V} \right)^\alpha = -kV^{1-\alpha}n_A^\alpha
\tag{19.6}\]</span></span></p>
<p><a href="#eq-half_life_ode" class="quarto-xref">Equation&nbsp;<span>19.6</span></a> can be solved by separating the variables and integrating. The lower limit of integration is that the moles of A equal <span class="math inline">\(n_{A,0}\)</span> at <span class="math inline">\(t\)</span> equals zero, and the upper limit of integration is that the moles of A equal <span class="math inline">\(0.5n_{A,0}\)</span> at <span class="math inline">\(t\)</span> equals <span class="math inline">\(t_{1/2}\)</span>. If the reaction order, <span class="math inline">\(\alpha\)</span>, is equal to one, the result is given in <a href="#eq-half_life_first_order" class="quarto-xref">Equation&nbsp;<span>19.7</span></a>; for reaction orders other than one, <a href="#eq-half_life_other_order" class="quarto-xref">Equation&nbsp;<span>19.8</span></a> results.</p>
<p><span id="eq-half_life_first_order"><span class="math display">\[
t_{1/2} = \frac{0.693}{k}
\tag{19.7}\]</span></span></p>
<p><span id="eq-half_life_other_order"><span class="math display">\[
t_{1/2} = \frac{\left(2^{\alpha -1} - 1\right)}{kC_{A,0}^{\alpha - 1}\left( \alpha - 1 \right)}
\tag{19.8}\]</span></span></p>
<p><a href="#eq-half_life_first_order" class="quarto-xref">Equation&nbsp;<span>19.7</span></a> and <a href="#eq-half_life_other_order" class="quarto-xref">Equation&nbsp;<span>19.8</span></a> suggest that the reaction order, <span class="math inline">\(\alpha\)</span>, can be determined by measuring the half-life in a series of experiments using different initial concentrations of A. If the half-life is the same for all initial concentrations, the reaction is first order and the rate coefficient is 0.693 divided by the half-life. Otherwise, a log-log plot of the half-life <em>vs</em>. the initial concentration should yield a straight line, and the slope should equal <span class="math inline">\(1-\alpha\)</span> as can be seen by taking the logs of each side of equation <a href="#eq-half_life_other_order" class="quarto-xref">Equation&nbsp;<span>19.8</span></a>. Note that <span class="math inline">\(k\)</span> and <span class="math inline">\(\alpha\)</span> were treated as constants in this analysis, so each block of experiments at a single temperature must be evaluated separately.</p>
</section>
</section>
<section id="sec-examples_intro_19" class="level2" data-number="19.5">
<h2 data-number="19.5" class="anchored" data-anchor-id="sec-examples_intro_19"><span class="header-section-number">19.5</span> Examples</h2>
<p>This chapter presents examples of kinetics data analysis using data generated in an isothermal BSTR. <a href="section_6_cstr_data_analysis.html" class="quarto-xref">Chapters&nbsp;<span>20</span></a>, and <a href="section_6_pfr_data_analysis.html" class="quarto-xref"><span>21</span></a> illustrate kinetics data analysis using data generated in ideal CSTRs and PFR, respectively. Analysis using the full data set is preferred, and doing so is described in the first four examples that follow. <a href="#sec-example_19_5_5" class="quarto-xref">Example&nbsp;<span>19.5.5</span></a> illustrates using a spreadsheet for kinetics data analysis involving same-temperature data blocks, a linearized reactor model, and linear least squares parameter estimation. <a href="#sec-example_19_5_6" class="quarto-xref">Example&nbsp;<span>19.5.6</span></a> illustrates differential data analysis using same-temperature data blocks, an approximate reactor model, and a spreadsheet.</p>
<section id="sec-example_19_5_1" class="level3" data-number="19.5.1">
<h3 data-number="19.5.1" class="anchored" data-anchor-id="sec-example_19_5_1"><span class="header-section-number">19.5.1</span> Assessing a First-Order Rate Expression for a Liquid-Phase Reaction</h3>
<p>Kinetics data for liquid-phase reaction (1) were generated using an ideal, isothermal, 1 L BSTR. The reaction is irreversible, and preliminary analysis indicated that the rate is not affected by the concentration of the product, Z. The experimental design used the initial concentration of A and the temperature as factors. Twelve experiments were performed wherein the temperature and initial concentration of reagent A were set after which the concentration of reagent A was measured at six reaction times, giving a set of 72 experimental data points. The rate expression shown in equation (2) has been proposed for this reaction. The rate coefficient in equation (2) is expected to display Arrhenius temperature dependence. Determine the best values for the Arrhenius pre-exponential factor and activation energy and assess the accuracy of the proposed first order rate expression.</p>
<p><span class="math display">\[
A \rightarrow Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = k C_A \tag{2}
\]</span></p>
<p>Note that these data were generated using the experimental design from <a href="section_6_data_generation.html#sec-example_18_6_1" class="quarto-xref">Example&nbsp;<span>18.6.1</span></a>. The first few data points are shown in <a href="#tbl-example_19_5_1_data" class="quarto-xref">Table&nbsp;<span>19.1</span></a>. The full data set is available in the .csv file <a href="examples/reb_19_5_1/reb_19_5_1_data.csv">reb_19_5_1_data.csv</a></p>
<div class="cell">
<div id="tbl-example_19_5_1_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_1_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.1: First 8 experimental data points.
</figcaption>
<div aria-describedby="tbl-example_19_5_1_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Experiment</th>
<th style="text-align: center;">T (°C)</th>
<th style="text-align: center;">C<sub>A,0</sub> (M)</th>
<th style="text-align: center;">t<sub>f</sub> (min)</th>
<th style="text-align: center;">C<sub>A,f</sub> (M)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.47</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.45</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">0.41</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">0.38</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">0.36</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.33</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">73</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">73</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.40</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This assignment presents kinetics data, describes the experiments used to generate them, and asks me to assess the accuracy of a proposed rate expression. These are characteristics of is a kinetics data analysis assigment, in this case one involving data from an isothermal BSTR. I’ll begin by summarizing the assignment. I’ll assign an appropriate variable symbol to each quantity provided in the narrative. I’ll use a subscripted “0” to denote quantities at the start of the reaction, a subscripted “f” to denote quantities at the time the response was measured, a subscripted “CI,l” to denote the lower limit of a 95% confidence interval, and a subscripted “CI,u” to denote the upper limit of a 95% confidence interval. I’ll underline symbols that represent a set of values.</p>
<p>The adjusted experimental inputs were the temperature, initial concentration of A and the elapsed time at which the response was measured. The measured response was the concentration of A.</p>
<p>The assignment asks for the best estimates for the Arrhenius pre-exponential factor and activation energy. It also asks for an assessemnt of the accuracy of the rate expression. That makes the coefficient of determination, the uncertainties in the estimated parameters, a parity plot, and residuals plots quantities of interest, as well, since I’ll need them to assess the accuracy of the rate expression.</p>
</div>
</div>
</div>
<section id="assignment-summary" class="level4" data-number="19.5.1.1">
<h4 data-number="19.5.1.1" class="anchored" data-anchor-id="assignment-summary"><span class="header-section-number">19.5.1.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, liquid-phase BSTR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_19_5_1_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_1_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/bstr_isothermal_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_1_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.4: Schematic representation of the experimental BSTR wherein molar amounts vary with time while the temperature is constant.
</figcaption>
</figure>
</div>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{C}_{A,f,expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{A,f,model}\)</span> (as a parity plot), and <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{A,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{t}_{f}\)</span> (as residuals plots).</p>
<p><strong>Given and Known Constants</strong>: <span class="math inline">\(V = 1\text{ L}\)</span>, <span class="math inline">\(R\)</span> = 8.314 x 10<sup>-3</sup> kJ mol<sup>-1</sup> K<sup>-1</sup>.</p>
<p><strong>Adjusted Experimental Inputs</strong>: <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, and <span class="math inline">\(\underline{t}_{f}\)</span></p>
<p><strong>Experimental Response</strong>: <span class="math inline">\(\underline{C}_{A,f}\)</span></p>
</section>
<section id="mathematical-formulation-of-the-calculations" class="level4" data-number="19.5.1.2">
<h4 data-number="19.5.1.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-calculations"><span class="header-section-number">19.5.1.2</span> Mathematical Formulation of the Calculations</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I know I’ll need a reactor model, so I’ll generate that first. In kinetics experiments the reactor operates isothermally, so the mole balance design equations can be solved independently of the energy balances. The composition at the time the response is measured can be calculate by solving the mole balances, so an energy balance on the reacting fuid and an energy balance on a heat exchange fluid do not need to be included among the reactor design equations. Only one reaction is takeing place, so the general form of the mole balance takes the form given in <a href="#eq-bstr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>19.1</span></a>. It can be used to write a mole balances for A and Z.</p>
<p><span class="math display">\[
\frac{dn_i}{dt} = \nu_i r V
\]</span></p>
<p>The BSTR reactor design equations are IVODEs, so the model must include initial values, a stopping criterion and a derivatives function (see <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix J</span></a>). I can define <span class="math inline">\(t=0\)</span> to be the instant the experiment started. The initial values then equal the molar amounts of A and Z at that time. Reagent Z was not present at the start of any of the experiments being analyzed here, so its initial value is zero. For each experiment I know the elapsed time at which the response was measured. I want to calculate the response at that time, so I will use <span class="math inline">\(t_f\)</span> as the stopping criterion.</p>
</div>
</div>
</div>
<center>
<strong>BSTR Model</strong>
</center>
<p><u>Design Equations</u></p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -rV \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Z}{dt} = rV \tag{4}
\]</span></p>
<p><u>Initial Values and Stopping Criterion</u></p>
<div id="tbl-example_19_5_1_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20, 40, 40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_1_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.2: Initial values and stopping criterion for solving the design equations, equations (3) and (4).
</figcaption>
<div aria-describedby="tbl-example_19_5_1_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Final Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_f\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n_{A,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(n_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I’ll need to write the derivatives function, and it must receive the values of the independent and dependent variables at the start of an integrations step as its only arguments. It must return the corresponding values of the derivatives of <span class="math inline">\(n_A\)</span> and <span class="math inline">\(n_Z\)</span> with respect to <span class="math inline">\(t\)</span>.</p>
<p>Within the derivatives function the given and known constants and the arguments are available. Before the derivatives can be evaluated, any other quantities appearing in them must be calculated. The only other quantity in the design equations here is the rate, which can be calculated using equation (2), but to do that, the concentration of A and the rate coefficient need to be calculated.</p>
<p>The concentration of A can be calculated using the defining equation for concentration. The Arrhenius expression, <a href="section_2_rates_and_expressions.html#eq-arrhenius" class="quarto-xref">Equation&nbsp;<span>4.8</span></a>, can be used to calculate the rate coefficient, but to do so the Arrhenius pre-exponential factor, activation energy, and the temperature are needed. As the predicted responses model is fit to the experimental data, the pre-exponential factor and activation energy will be changing. The temperature will be different depending upon which experimental data point is being analyzed. Thus, the pre-exponential factor, activation energy and temperature are not known and cannot be calculated, so they must be made available to the derivatives function.</p>
</div>
</div>
</div>
<p><u>Derivatives Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, and <span class="math inline">\(n_Z\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Must be Available: <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, and <span class="math inline">\(T\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return values: <span class="math inline">\(\frac{dn_A}{dt}\)</span>, and <span class="math inline">\(\frac{dn_Z}{dt}\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<p><span class="math display">\[
k = k_0\exp{\left( \frac{-E}{RT}\right)} \tag{5}
\]</span></p>
<p><span class="math display">\[
C_A = \frac{n_A}{V} \tag{6}
\]</span></p>
<p><span class="math display">\[
r = kC_A \tag{2}
\]</span></p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -rV \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Z}{dt} = rV \tag{4}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The last component of the BSTR model is a function that solves the design equations. I’ll use an IVODE solver to do that, and I’ll need to provide it with the initial values, stopping criterion, and the derivatives function, above. The initial molar amount of A can be calculated from its initial concentration, but that will be varying from one experiment to the next. Also, the time at which the response was measured will vary from one experiment to the next. Therefore, the initial concentration of A and the time at which the response was measured for the experiment being analyzed must be provided to the reactor model as input.</p>
</div>
</div>
</div>
<p><u>BSTR Reactor Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(T\)</span>, <span class="math inline">\(C_{A,0}\)</span> and <span class="math inline">\(t_f\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return Values: <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_A\)</span>, and <span class="math inline">\(\underline{n}_B\)</span></p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<ol type="1">
<li><p>Make <span class="math inline">\(T\)</span> globally available.</p></li>
<li><p>Calculate unknown initial and final values.</p></li>
</ol>
<p><span class="math display">\[
n_{A,0} = C_{A,0}V \tag{7}
\]</span></p>
<ol start="3" type="1">
<li><p>Call an IVODE solver passing the initial values, stopping criterion and derivatives function as arguments.</p></li>
<li><p>Receive corresponding sets of values of <span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, and <span class="math inline">\(n_B\)</span> that span the range from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=t_f\)</span> from the IVODE solver and return them.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The reactor model cannot be fit to the experimental data. Instead it must be used to create a predicted response model that relates the adjusted experimental inputs for an experiment to the predicted response for that experiment.</p>
<p>To do that, the BSTR model above can be solved for any one experiment. Doing so will yield <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_A\)</span>, and <span class="math inline">\(\underline{n}_Z\)</span>. The predicted response, the final concentration of A, can then be calculated using the defining equation for concentration.</p>
<p>I’ll use a numerical fitting function to estimate the parameters in the rate expression. One of the things I’ll need to provide to it is a predicted responses function that calculates the predicted response for each experiment as just described, and then returns the results. I must write the predicted responses function, and doing so is fairly straightforward.</p>
<p>The predicted responses function must receive the adjusted experimental inputs for all of the experiments and values for each of the parameters appearing in the proposed rate expression as its only arguments. It must return the predicted responses for all of the experiments. All it needs to do is go through the experiments one by one and calculate the predicted response as just described. There are two important things to remember when doing this. One is to immediately make the rate expression parameters available to the derivatives function. The second is to make the temperature available to the derivatives function before solving the reactor design equations.</p>
</div>
</div>
</div>
<center>
<strong>Predicted Responses Function</strong>
</center>
<p><u>Arguments:</u> <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, <span class="math inline">\(\underline{t}_{f}\)</span>, <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>.</p>
<p><u>Return values:</u> <span class="math inline">\(\underline{C}_{A,f,model}\)</span></p>
<p><u>Algorithm:</u></p>
<ol type="1">
<li>Make <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> available to the derivatives function.</li>
<li>For each experiment in the data set
<ol type="a">
<li>Call the BSTR model function, passing <span class="math inline">\(C_{A,0}\)</span> and <span class="math inline">\(t_f\)</span> as arguments, to solve the BSTR design equations and receive <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_A\)</span>, and <span class="math inline">\(\underline{n}_Z\)</span>.</li>
<li>Calculate the predicted response.</li>
</ol></li>
</ol>
<p><span class="math display">\[
C_{A,f,model} = \frac{\underline{n}_A\big\vert_{t=t_f}}{V} \tag{8}
\]</span></p>
<ol start="3" type="1">
<li>Return the set of model-predicted responses, <span class="math inline">\(\underline{C}_{A,f,model}\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now that I have a predicted responses function, I can use a numerical fitting function from a software package to fit the predicted response model to the experimental data. I will need to provide four things to it:</p>
<ul>
<li>an initial guess for each of the rate expression parameters</li>
<li>the adjusted experimental inputs for all of the experiments</li>
<li>the experimental responses for all of the experiments</li>
<li>the predicted responses function</li>
</ul>
<p>Assuming the numerical fitting function is successful, it will return the estimated value of <span class="math inline">\(k_0\)</span>, the lower and upper limits of its 95% confidence interval, <span class="math inline">\(k_{0,CI,l}\)</span> and <span class="math inline">\(k_{0,CI,u}\)</span>, the estimated value of <span class="math inline">\(E\)</span>, the lower and upper limits of its 95% confidence interval, <span class="math inline">\(E_{CI,l}\)</span> and <span class="math inline">\(E_{CI,u}\)</span>, and the coefficient of determination, <span class="math inline">\(R^2\)</span>.</p>
<p>I’m asked to assess the accuracy of the resulting model. To help with that, I can generate a parity plot and residuals plots. To do so I will use the estimated values of <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> to calculate the model-predicted responses for all of the experiments. Plotting the predicted responses against the corresponding experimental responses will result in the partiy plot. I can calculate experiment residuals, <span class="math inline">\(\epsilon_{expt}\)</span>, by taking the difference between the experiment responses and the model-predicted responses. Plotting the experimental residuals against the corresponding values of each or the experimental adjusted inputs will yield a set of residuals plots.</p>
</div>
</div>
</div>
<center>
<strong>Parameter Estimation</strong>
</center>
<ol type="1">
<li>Set an initial guess for the parameters (<span class="math inline">\(k_{0,guess}\)</span> and <span class="math inline">\(E_{guess}\)</span>)</li>
<li>Call a numerical fitting function passing the adjusted experimental inputs for all of the experiments (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, and <span class="math inline">\(\underline{t}_{f}\)</span>), the experimental responses (<span class="math inline">\(\underline{C}_{A,f}\)</span>), the initial guess for the parameters from step 1, and the predicted responses function, above, as arguments, and receive the parameter estimates (<span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>), their 95% confidence intervals (<span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, and <span class="math inline">\(E_{CI,u}\)</span>), and the coefficient of determination, <span class="math inline">\(R^2\)</span>.</li>
</ol>
<center>
<strong>Generation of Assessment Graphs</strong>
</center>
<ol type="1">
<li>Call the predicted responses function above, passing the estimated parameters (<span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>) and the adjusted experimental inputs for all of the experiments (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, and <span class="math inline">\(\underline{t}_{f}\)</span>) as arguments and receive the predicted responses for all of the experiments (<span class="math inline">\(\underline{C}_{A,f,model}\)</span>).</li>
<li>Calculate the experiment residuals.</li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{C}_{A,f} - \underline{C}_{A,f,model} \tag{9}
\]</span></p>
<ol start="3" type="1">
<li>Generate a parity plot showing <span class="math inline">\(\underline{C}_{A,f,expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{A,f,model}\)</span>.</li>
<li>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> versus <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{A,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{t}_{f}\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point, I have everything I need to calculate the quantities of interest. I’ll need to read in the data, perform the calculations and present the results.</p>
</div>
</div>
</div>
<center>
<strong>Perform the Calculations</strong>
</center>
<ol type="1">
<li>Read the adjusted experimental inputs and experimental responses data from the file, <a href="'examples/reb_19_5_1/reb_19_5_1_data.csv'">reb_19_5_1_data.csv</a>.</li>
<li>Estimate the parameters and generate the assessment graphs as described above.</li>
<li>Display the results and/or save them to a file.</li>
</ol>
</section>
<section id="results-and-discussion" class="level4" data-number="19.5.1.3">
<h4 data-number="19.5.1.3" class="anchored" data-anchor-id="results-and-discussion"><span class="header-section-number">19.5.1.3</span> Results and Discussion</h4>
<p>The calculations were performed as described above with one significant exception. Because <span class="math inline">\(k_0\)</span> can have a wide range of values, it is difficult to make a good initial guess for its value, and if the guess is not sufficiently close to the actual value, the fitting function can fail. Therefore, the the base-10 log of <span class="math inline">\(k_0\)</span> was estimated, as described in <a href="section_6_data_generation.html#sec-example_18_6_2" class="quarto-xref">Example&nbsp;<span>18.6.2</span></a>. As a consequence the predicted responses function received the value of the base-10 log of <span class="math inline">\(k_0\)</span> as an argument, from which <span class="math inline">\(k_0\)</span> was calculated and made available to all other functions. In addition, the numerical fittng function returned the estimated values of the base-10 log of <span class="math inline">\(k_0\)</span>, the base-10 log of <span class="math inline">\(k_{0,CI,l}\)</span>, and the base-10 log of <span class="math inline">\(k_{0,CI,u}\)</span>. These were then used to calculate <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, and <span class="math inline">\(k_{0,CI,u}\)</span>. The results are as follow:</p>
<p>k<sub>0</sub>: 3.61 x 10<sup>8</sup> min<sup>-1</sup>, 95% CI [3.02 x 10<sup>8</sup>, 4.33 x 10<sup>8</sup>]<br>
E: 67.5 kJ mol<sup>-1</sup>, 95% CI [67, 68.1]<br>
R<sup>2</sup>: 1</p>
<p>The resulting parity plot and residuals plots are presented in <a href="#fig-example_19_5_1_parity" class="quarto-xref">Figure&nbsp;<span>19.5</span></a> and <a href="#fig-example_19_5_1_residual" class="quarto-xref">Figure&nbsp;<span>19.6</span></a>.</p>
<div id="fig-example_19_5_1_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_1_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_1/reb_19_5_1_parity.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_1_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.5: Parity plot showing the measured concentration of A and the concentration predicted using the rate expression.
</figcaption>
</figure>
</div>
<div id="fig-example_19_5_1_residual" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_1_residual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_1/reb_19_5_1_residuals_T.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_1/reb_19_5_1_residuals_CA0.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_1/reb_19_5_1_residuals_tf.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_1_residual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.6: Experiment residuals plotted against each of the adjusted experimental inputs, <span class="math inline">\(T\)</span>, <span class="math inline">\(C_{A,0}\)</span>, and <span class="math inline">\(t_f\)</span>.
</figcaption>
</figure>
</div>
<p>The proposed rate expression offers a very accurate representation of the experimental data and can be accepted for use in the range of temperature and composition studied. The coefficient of determination is essentially equal to 1.0, the upper and lower limits of the confidence intervals for both parameters are close to their estimated values, the data in the parity plot fall very close to the parity line, and the experiment residuals scatter randomly about zero in all three residuals plots.</p>
</section>
</section>
<section id="sec-example_19_5_2" class="level3" data-number="19.5.2">
<h3 data-number="19.5.2" class="anchored" data-anchor-id="sec-example_19_5_2"><span class="header-section-number">19.5.2</span> Assessing a Second-Order Rate Expression for a Gas-Phase Reaction</h3>
<p>The gas-phase reaction between reagents A and B was studied in an ideal, isothermal, 500 cm<sup>3</sup> BSTR. In all experiments the reactor was charged with reagents A and B only, but with varying partial pressures. The fractional conversion of reagent A was measured at seven different elapsed times in each experiment. Experiments were performed at three different temperatures. A total of 189 data points were recorded. Assess the accuracy of the rate expression shown in equation (2).</p>
<p><span class="math display">\[
A + B \rightarrow Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = k P_A P_B \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_19_5_2_data" class="quarto-xref">Table&nbsp;<span>19.3</span></a>. The full data set is available in the file <a href="examples/reb_19_5_2/reb_19_5_2_data.csv">reb_19_5_2_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_19_5_2_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_2_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.3: First 5 of the 189 experimentally generated data.
</figcaption>
<div aria-describedby="tbl-example_19_5_2_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">T (°C)</th>
<th style="text-align: center;">P<sub>A,0</sub> (atm)</th>
<th style="text-align: center;">P<sub>B,0</sub> (atm)</th>
<th style="text-align: center;">t<sub>f</sub> (min)</th>
<th style="text-align: center;">f<sub>A</sub></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.022</td>
</tr>
<tr class="even">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.5</td>
<td style="text-align: center;">0.049</td>
</tr>
<tr class="even">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">2.0</td>
<td style="text-align: center;">0.060</td>
</tr>
<tr class="odd">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">0.078</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I can see that this is a kinetics data analysis problem involving an isothermal BSTR because it provides experimental data, describes the experiments that generated the data, and asks me to assess a proposed rate expression. I’ll begin by summarizing the assignment. I’ll assign appropriate variables symbols to each quantity that is provided. I’ll use a subscripted “0” to denote quantities at the start of the experiment, a subscripted “f” to denote quantities at the time the response was measured, and I’ll underline variables representing a set of values of that quantity.</p>
<p>From the problem narrative I know that the temperature, initial pressures of A and B, and the final time are the adjusted experimental inputs in the experioment. The response is the conversion of A.</p>
<p>The assignment asks for an assessment of the accuracy of the proposed rate expression. To do that I’ll estimate the pre-exponential factor, its 95% confidence interval, the activation energy, and its 95% confidence interval. I’ll also calculate the coefficient of determination, so I’ll list all of these as quantities of interest, using a subscripted “CI,l” and “CI,u” to denote the uppser and lower limits of the confidence intervals. I’ll also make a parity plot and residuals plots, so I will additionally list the quantities needed for those graphs as being of interest.</p>
</div>
</div>
</div>
<section id="assignment-summary-1" class="level4" data-number="19.5.2.1">
<h4 data-number="19.5.2.1" class="anchored" data-anchor-id="assignment-summary-1"><span class="header-section-number">19.5.2.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, gas-phase BSTR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_19_5_2_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/bstr_isothermal_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.7: Schematic representation of the experimental BSTR wherein molar amounts vary with time while the temperature is constant.
</figcaption>
</figure>
</div>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{f}_A\)</span> <em>vs.</em> <span class="math inline">\(\underline{f}_{A,model}\)</span> (as a parity plot), and <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{P}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{P}_{B,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{t}_f\)</span> (as residuals plots).</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(V = 500\text{ cm}^3\)</span>.</p>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span>, <span class="math inline">\(\underline{P}_{B,0}\)</span>, and <span class="math inline">\(\underline{t}_f\)</span>.</p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{f}_A\)</span>.</p>
</section>
<section id="mathematical-formulation-of-the-calculations-1" class="level4" data-number="19.5.2.2">
<h4 data-number="19.5.2.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-calculations-1"><span class="header-section-number">19.5.2.2</span> Mathematical Formulation of the Calculations</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I know that I’m going to need a model for the isothermal BSTR used in the experiments, so I’ll develop that first. I only need the mole balance design equations because they can be solved independently of the energy balances when the reactor is isothermal, and solving them will give me everything I need to calculate the predicted conversion.</p>
<p>I’ll write a mole balance on each of the reagents. The general form of the BSTR mole balance is given in <a href="section_3_design_equations.html#eq-bstr_mole_balance" class="quarto-xref">Equation&nbsp;<span>6.8</span></a>. Since there is only one reaction, the summation reduces to a single term and I don’t need subscripts denoting the reaction.</p>
<p><span class="math display">\[
\frac{dn_i}{dt} = V \sum_j \nu_{i,j}r_j \qquad \Rightarrow \qquad \frac{dn_i}{dt} = \nu_i r V
\]</span></p>
<p>The design equations are IVODEs that I’ll solve numerically, so the reactor model must also include initial values, a stopping criterion, and a derivatives function. I can define the instant that the experiment starts to be <span class="math inline">\(t=0\)</span>. In that case the initial values are simply the molar amounts of each reagent at the start of the experiment. Here, the initial molar amounts of Y and Z were always equal to zero. I know the time when the response was measured, and I want to calculate the conversion at that time, so I’ll use it as the stopping criterion.</p>
</div>
</div>
</div>
<center>
<strong>BSTR Model</strong>
</center>
<p><u>Design Equations</u></p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -Vr \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{dn_B}{dt} = -Vr \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Y}{dt} = Vr \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Z}{dt} = Vr \tag{6}
\]</span></p>
<p><u>Initial Values and Stopping Criterion</u></p>
<div id="tbl-example_19_5_2_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20, 40, 40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.4: Initial values and stopping criterion for solving the design equations, (3) through (6).
</figcaption>
<div aria-describedby="tbl-example_19_5_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Final Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_f\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n_{A,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(n_B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n_{B,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(n_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I will need to write the derivatives function. It must receive the values of the independent and dependent variables (<span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, <span class="math inline">\(n_B\)</span>, <span class="math inline">\(n_Y\)</span>, and <span class="math inline">\(n_Z\)</span>) at the start of an integration step as its only arguments, and it must return the values of the derivatives of the dependent variables with respect to the independent variable (<span class="math inline">\(\frac{dn_A}{dt}\)</span>, <span class="math inline">\(\frac{dn_B}{dt}\)</span>, <span class="math inline">\(\frac{dn_Y}{dt}\)</span>, and <span class="math inline">\(\frac{dn_Z}{dt}\)</span>).</p>
<p>Within the derivatives function the given and known constants and the arguments will be available. Any other quantities appearing in the design equations must be calculated before the derivatives can be evaluated using equations (3) through (6). The only unknown quantity in the design equations is <span class="math inline">\(r\)</span>, and it can be calculated using equation (2).</p>
<p>To calculate the rate using equation (2), the pre-exponential factor, activation energy, temperature, and partial pressures of A and B are needed. The partial pressures can be calculated using the ideal gas law, but that also requires the temperature.</p>
<p>As the predicted responses model is fit to the experimental data, the pre-exponential factor and the activation energy will be changing, and as different experiments are analyzed, the temperature will be changing. Therefore the kinetics parameters and the temperature cannot be calculated, and will need to be made available to the derivatives function.</p>
</div>
</div>
</div>
<p><u>Derivatives Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, <span class="math inline">\(n_B\)</span>, <span class="math inline">\(n_Y\)</span>, and <span class="math inline">\(n_Z\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Must be Available: <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, and <span class="math inline">\(T\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return values: <span class="math inline">\(\frac{dn_A}{dt}\)</span>, <span class="math inline">\(\frac{dn_B}{dt}\)</span>, <span class="math inline">\(\frac{dn_Y}{dt}\)</span>, and <span class="math inline">\(\frac{dn_Z}{dt}\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<p><span class="math display">\[
k = k_0 \exp{ \left( \frac{-E}{RT}  \right)} \tag{7}
\]</span></p>
<p><span class="math display">\[
P_A = \frac{n_A RT}{V} \tag{8}
\]</span></p>
<p><span class="math display">\[
P_B = \frac{n_B RT}{V} \tag{9}
\]</span></p>
<p><span class="math display">\[
r = kP_AP_B \tag{2}
\]</span></p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -Vr \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{dn_B}{dt} = -Vr \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Y}{dt} = Vr \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Z}{dt} = Vr \tag{6}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The last think I need for the reactor model is a function that will solve the design equations. I’ll use an IVODE solver for that. I’ll need to provide the initial values and stopping criterion in <a href="#tbl-example_19_5_2_initial_values" class="quarto-xref">Table&nbsp;<span>19.4</span></a> to it along with the the derivatives function above. I can calculate the initial molar amounts of A and B for any experiment using their initial partial pressures, but since the partial pressures change from one experiment to the next, the initial partial pressures for the experiment being analyzed will need to be provided, and since their calculation requires the temperature, it, too must be provided. Similarly, the stopping criterion, that is the time at which the response was measured, also changes from experiment to experiment and will need to be provided as input to the reactor model.</p>
</div>
</div>
</div>
<p><u>BSTR Model Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(T\)</span>, <span class="math inline">\(P_{A,0}\)</span>, <span class="math inline">\(P_{B,0}\)</span>, and <span class="math inline">\(t_f\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return Values: <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_A\)</span>, <span class="math inline">\(\underline{n}_B\)</span>, <span class="math inline">\(\underline{n}_Y\)</span>, and <span class="math inline">\(\underline{n}_Z\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<ol type="1">
<li>Calculate the unknown initial values.</li>
</ol>
<p><span class="math display">\[
n_{A,0} = \frac{P_{A,0}V}{RT} \tag{10}
\]</span></p>
<p><span class="math display">\[
n_{B,0} = \frac{P_{B,0}V}{RT} \tag{11}
\]</span></p>
<ol start="2" type="1">
<li><p>Call an IVODE solver passing the initial values, stopping criterion and derivatives function as arguments.</p></li>
<li><p>Receive corresponding sets of values of <span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, <span class="math inline">\(n_B\)</span>, <span class="math inline">\(n_Y\)</span>, and <span class="math inline">\(n_Z\)</span> that span the range from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=t_f\)</span> from the IVODE solver and return them.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I need to use the BSTR model above to create a predicted responses model that can be fit to the experimental data. To do that the BSTR model can be solved for any one experiment to get <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_A\)</span>, <span class="math inline">\(\underline{n}_B\)</span>, <span class="math inline">\(\underline{n}_Y\)</span>, and <span class="math inline">\(\underline{n}_Z\)</span>. The final molar amount of A can then be used calculate the conversion.</p>
<p>I will use numerical fitting func to estimate the unknown parameters, <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>. I will need to provide it with a guess for <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>, the set of adjusted experimental inputs being analyzed, the corresponding set of experimental responses and a predicted responses function that I will need to write.</p>
<p>The predicted responses function must receive the rate expression parameters (<span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>) and adjusted experimental inputs for all of the experiments (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span>, <span class="math inline">\(\underline{P}_{B,0}\)</span>, and <span class="math inline">\(\underline{t}_f\)</span>) as its only arguments. It must calculate and return the model-predicted responses for all of the experiments (<span class="math inline">\(\underline{f}_{A,model}\)</span>). The predicted responses function simply needs to go through the experiments one by one and calculate the predicted conversion of A as just described. Before it starts going through the experiments it needs to make the rate expression parameters available to the derivatives function, and each time it starts to analyze an experiment it needs to make the temperature available to the derivatives function.</p>
</div>
</div>
</div>
<center>
<strong>Predicted Responses Function</strong>
</center>
<p><span class="underlline">Arguments:</span> <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span>, <span class="math inline">\(\underline{P}_{B,0}\)</span>, <span class="math inline">\(\underline{t}_f\)</span>, <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>.</p>
<p><span class="underlline">Return values:</span> <span class="math inline">\(\underline{f}_{A,model}\)</span></p>
<p><span class="underlline">Algorithm:</span></p>
<ol type="1">
<li>Make <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> available to the derivatives function.</li>
<li>For each experiment in the data set
<ol type="a">
<li>Make the temperature available to the derivatives function.</li>
<li>Call the BSTR model function passing <span class="math inline">\(T\)</span>, <span class="math inline">\(P_{A,0}\)</span>, <span class="math inline">\(P_{B,0}\)</span>, and <span class="math inline">\(t_f\)</span> as arguments to solve the design equations and receive <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_A\)</span>, <span class="math inline">\(\underline{n}_B\)</span>, <span class="math inline">\(\underline{n}_Y\)</span>, and <span class="math inline">\(\underline{n}_Z\)</span>.</li>
<li>Calculate the predicted response.</li>
</ol></li>
</ol>
<p><span class="math display">\[
n_{A,0} = \frac{P_{A,0}V}{RT} \tag{10}
\]</span></p>
<p><span class="math display">\[
f_{A,model} = \frac{n_{A,0} - n_A\big\vert_{t=t_f}}{n_{A,0}} \tag{12}
\]</span></p>
<ol start="3" type="1">
<li>Return the set of model-predicted responses, <span class="math inline">\(\underline{f}_{A,model}\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I can use a numerical fitting function to fit the predicted response model to the experimental data. I will need to provide it with a guess for the rate expression parameters, the adjusted experimental inputs for all of the experiments, the experimental responses for all of the experiments, and the predicted responses function.</p>
<p>Assuming it is successful, the numerical fitting function will return the estimated values of <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>, the lower and upper limits of their 95% confidence interval, <span class="math inline">\(k_{0,CI,ll}\)</span> <span class="math inline">\(k_{0,CI,ul}\)</span>, <span class="math inline">\(E_{CI,ll}\)</span>, and <span class="math inline">\(E_{CI,ul}\)</span> and the coefficient of determination, <span class="math inline">\(R^2\)</span>.</p>
<p>After estimating <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>, I can calculate the model-predicted responses and use them to generate a parity plot of the experimental conversion <em>vs.</em> the model-predicted conversion. I can also calculate the differences between the experimental and model-predicted conversions, that is the experiment residuals, and use them to generate residuals plots of the residuals versus each of the adjusted experimental inputs.</p>
</div>
</div>
</div>
<center>
<strong>Parameter Estimation</strong>
</center>
<ol type="1">
<li>Set an initial guess for the parameters (<span class="math inline">\(k_{0,guess}\)</span>, and <span class="math inline">\(E_{guess}\)</span>)</li>
<li>Call a numerical fitting function passing the adjusted experimental inputs for all of the experiments (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span>, <span class="math inline">\(\underline{P}_{B,0}\)</span>, and <span class="math inline">\(\underline{t}_f\)</span>), the experimental responses (<span class="math inline">\(\underline{f}_A\)</span>), the initial guess for the parameters from step 1, and the predicted responses function, above, as arguments, and receive the parameter estimates (<span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>), their 95% confidence intervals (<span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, and <span class="math inline">\(E_{CI,u}\)</span>), and the coefficient of determination, <span class="math inline">\(R^2\)</span>.</li>
</ol>
<center>
<strong>Generation of Assessment Graphs</strong>
</center>
<ol type="1">
<li>Call the predicted responses function above, passing the estimated parameters (<span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>) and the adjusted experimental inputs for all of the experiments (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span>, <span class="math inline">\(\underline{P}_{B,0}\)</span>, and <span class="math inline">\(\underline{t}_f\)</span>) as arguments and receive the predicted responses for all of the experiments (<span class="math inline">\(\underline{f}_{A,model}\)</span>).</li>
<li>Calculate the experiment residuals.</li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{f}_A - \underline{f}_{A,model} \tag{13}
\]</span></p>
<ol start="3" type="1">
<li>Generate a parity plot showing <span class="math inline">\(\underline{f}_A\)</span> vs.&nbsp;<span class="math inline">\(\underline{f}_{A,model}\)</span>.</li>
<li>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{P}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{P}_{B,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{t}_f\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point, I have everything I need to calculate the quantities of interest. I’ll need to read in the data, perform the calculations and report the results.</p>
</div>
</div>
</div>
<center>
<strong>Perform the Calculations</strong>
</center>
<ol type="1">
<li>Read the adjusted experimental inputs and experimental responses data from the file, <a href="'examples/reb_19_5_2/reb_19_5_2_data.csv'">reb_19_5_2_data.csv</a>.</li>
<li>Estimate the parameters and generate the assessment graphs as described above.</li>
<li>Display the results and/or save them to a file.</li>
</ol>
</section>
<section id="results-and-discussion-1" class="level4" data-number="19.5.2.3">
<h4 data-number="19.5.2.3" class="anchored" data-anchor-id="results-and-discussion-1"><span class="header-section-number">19.5.2.3</span> Results and Discussion</h4>
<p>The calculations were performed as described above, and the results are as follow.</p>
<p>k<sub>0</sub>: 2.59 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup>, 95% CI [2.08, 3.1]<br>
E: 21.8 kcal mol<sup>-1</sup>, 95% CI [21.5, 22.1]<br>
R<sup>2</sup>: 0.999</p>
<p><a href="#fig-example_19_5_2_parity" class="quarto-xref">Figure&nbsp;<span>19.8</span></a> and <a href="#fig-example_19_5_2_residuals" class="quarto-xref">Figure&nbsp;<span>19.9</span></a> show the partiy and residuals plots, respectively.</p>
<div id="fig-example_19_5_2_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_2_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_2/reb_19_5_2_parity.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_2_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.8: Parity plot
</figcaption>
</figure>
</div>
<div id="fig-example_19_5_2_residuals" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_2_residuals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_2/reb_19_5_2_residuals_PA0.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_2/reb_19_5_2_residuals_PB0.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_2/reb_19_5_2_residuals_T.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_2/reb_19_5_2_residuals_tf.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_2_residuals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.9: Residuals plots for <span class="math inline">\(P_{A,0}\)</span>, <span class="math inline">\(P_{B,0}\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(t_f\)</span>.
</figcaption>
</figure>
</div>
<p><strong>Assessment</strong></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I now need to assess the accuracy of the model and make a decision whether to accept it, recommend additional experiments, or reject it. Here, all of the accuracy criteria are satisfied.</p>
<ul>
<li>The coefficient of determination is close to 1.0.</li>
<li>The upper and lower limits of the 95% confidence intervals for <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> are close to the estimated values.</li>
<li>The data points in the parity plot all lie close to the parity line.</li>
<li>The data points in the residuals plots scatter randomly about zero, and no apparent trend can be seen in the deviations.</li>
</ul>
<p>These results indicate that the model is accurate and should be accepted.</p>
</div>
</div>
</div>
<p>The rate expression in equation (2) is accurate when the Arrhenius expression is used to represent the temperature dependence of <span class="math inline">\(k\)</span>. Equation (2) should be accepted as the rate expression with 2.59 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup> as the pre-exponential factor and 21.8 kcal mol<sup>-1</sup> as the activation energy.</p>
</section>
</section>
<section id="sec-example_19_5_3" class="level3" data-number="19.5.3">
<h3 data-number="19.5.3" class="anchored" data-anchor-id="sec-example_19_5_3"><span class="header-section-number">19.5.3</span> Assessing a Gas-Phase Rate Expression Using Total Pressure as the Response</h3>
<p>An ideal, 100 cm<sup>3</sup>, isothermal BSTR was used to generate kinetics data for reaction (1) at several temperatures. In a typical experiment at any one temperature, reagent A was added to the reactor at that temperature and a pressure of <span class="math inline">\(P_{A,0}\)</span>. Then, to begin the reaction, a sufficient amount of reagent B at the same temperature was added instantaneously to bring the total pressure to 6.0 atm. The reaction progress was followed by recording the total pressure once per minute for 24 min after the addition of reagent B. Use the resulting experimental data to assess the accuracy of the rate expression shown in equation (2).</p>
<p><span class="math display">\[
A + B \rightarrow Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = k P_A \sqrt{P_B} \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_19_5_3_data" class="quarto-xref">Table&nbsp;<span>19.5</span></a>. The full data set is available in the file <a href="examples/reb_19_5_3/reb_19_5_3_data.csv">reb_19_5_3_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_19_5_3_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_3_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.5: First 5 experimental data points.
</figcaption>
<div aria-describedby="tbl-example_19_5_3_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">T (°C)</th>
<th style="text-align: center;">P<sub>A,0</sub> (atm)</th>
<th style="text-align: center;">t<sub>f</sub> (min)</th>
<th style="text-align: center;">P<sub>f</sub> (atm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">225</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5.97</td>
</tr>
<tr class="even">
<td style="text-align: center;">225</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">5.83</td>
</tr>
<tr class="odd">
<td style="text-align: center;">225</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">5.84</td>
</tr>
<tr class="even">
<td style="text-align: center;">225</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">5.76</td>
</tr>
<tr class="odd">
<td style="text-align: center;">225</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5.68</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a kinetics data analysis assignment where an isothermal, gas-phase BSTR was used to generate data and I’m asked to assess the accuracy of a proposed rate expression using those data. The experimentally adjusted inputs were the temperature, the initial partial pressure of reagent A, and the time at which the response, i. e. the total pressure, was measured.</p>
<p>To assess the accuracy of the rate expression I need to estimate the rate expression parameters, their 95% confidence intervals, and the coefficient of determination. Assuming that the rate coefficient displays Arrhenius temperature dependence, the rate expresson parameters are <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>. I’ll also want to make a parity plot and model plots.</p>
<p>I’ll begin by summarizing the assignment using appropriate variable symbols for each quantity with a subscripted “0” denoting a value a the start of the experiment, a subscripted “f” denoting the time when the response was measured, subscripted “CI,l” and “CI,u” to denote the limits of the 95% confidence interval and an underline to denote sets of values.</p>
</div>
</div>
</div>
<section id="assignment-summary-2" class="level4" data-number="19.5.3.1">
<h4 data-number="19.5.3.1" class="anchored" data-anchor-id="assignment-summary-2"><span class="header-section-number">19.5.3.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, gas phase BSTR.</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_19_5_3_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_3_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/bstr_isothermal_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_3_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.10: Schematic representation of the experimental BSTR wherein the temperature was constant. Because the total moles change as the reaction proceeds, the pressure will vary with time.
</figcaption>
</figure>
</div>
<p><strong>Items of Interest:</strong> <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{P}_f\)</span> <em>vs.</em> <span class="math inline">\(\underline{P}_{f,model}\)</span> (as a parity plot), <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(T\)</span>, <em>vs.</em> <span class="math inline">\(P_{A,0}\)</span> and <em>vs.</em> <span class="math inline">\(t_f\)</span> (as residuals plots).</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(V\)</span> = 100 cm<sup>3</sup>, <span class="math inline">\(P_0\)</span> = 6 atm, and <span class="math inline">\(R\)</span> = 82.06 cm<sup>3</sup> atm mol<sup>-1</sup> K<sup>-1</sup> = 1.987 x 10<sup>-3</sup> kcal mol<sup>-1</sup> K<sup>-1</sup>.</p>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span></p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{P}_f\)</span></p>
</section>
<section id="mathematical-formulation-of-the-analysis" class="level4" data-number="19.5.3.2">
<h4 data-number="19.5.3.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-analysis"><span class="header-section-number">19.5.3.2</span> Mathematical Formulation of the Analysis</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I know I will need a model for the experimental BSTR, so I’ll generate that first. The experimental reactor operates isothermally, and when that is true, the mole balance design equations can be solved independently of any other reactor design equations. Since I can calculate everything I need using the mole balances, they are the only equations I’ll include among the design equations. The general form of the BSTR mole balance is given in <a href="section_3_design_equations.html#eq-bstr_mole_balance" class="quarto-xref">Equation&nbsp;<span>6.8</span></a>, but here, since there is only one reaction, the summation becomes a single term and the subscripts denoting the reaction are not needed. I’ll write a mole balance for each reagent in the system.</p>
<p><span class="math display">\[
\frac{dn_i}{dt} = V \nu_ir
\]</span></p>
<p>The mole balances are IVODEs, so I will need initial values, a stopping criterion and a derivatives function in order to solve them numerically. I can define <span class="math inline">\(t=0\)</span> to be the instant the reaction begins, in which case the inital values are the molar amounts of each reagent at that time. In these experiments the initial molar amount of Z was always zero. The elapsed time when the total pressure was measured is known for each experiment, and I’ll use as the stopping criterion because I want to calculate the total pressure at that time.</p>
</div>
</div>
</div>
<center>
<strong>BSTR Model</strong>
</center>
<p><u>Design Equations</u></p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -rV \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{dn_B}{dt} = -rV \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Z}{dt} = rV \tag{5}
\]</span></p>
<p><u>Initial Values and Stopping Criterion</u></p>
<div id="tbl-example_19_5_3_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20, 40, 40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_3_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.6: Initial values and stopping criterion for solving equations (3) through (5).
</figcaption>
<div aria-describedby="tbl-example_19_5_3_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_f\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n_{A,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(n_B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n_{B,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I’ll need to write a derivatives function. It will have access to the given and known constants from the assignment summary, and it will be passed the values of the independent variable, <span class="math inline">\(t\)</span>, and the dependent variables, <span class="math inline">\(n_A\)</span>, <span class="math inline">\(n_B\)</span>, and <span class="math inline">\(n_Z\)</span>, at start of an integration step. It must evaluate and return the derivatives in the design equations. Before that can be done, any other quantities appearing in the design equations must be calculated.</p>
<p>In this assignment the only other quantity in equations (3) through (5) is the rate, and it can be calculated using equation (2). In otder to do that, <span class="math inline">\(k\)</span>, <span class="math inline">\(P_A\)</span>, and <span class="math inline">\(P_B\)</span> must be calculated. <span class="math inline">\(P_A\)</span> and <span class="math inline">\(P_B\)</span> can be calculated using the ideal gas law, but the temperature will also be needed, and it varies from one experiment to the next. Also, as the predicted responses model is being fit to the experimental data, the pre-exponential factor and the activation energy will be varying. For that reason <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, an <span class="math inline">\(T\)</span> will need to be made available to the derivatives function so the rate coefficient can be calculated using the Arrhenius expression.</p>
</div>
</div>
</div>
<p><u>Derivatives Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, <span class="math inline">\(n_B\)</span>, and <span class="math inline">\(n_Z\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Must be Available: <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, and <span class="math inline">\(T\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return values: <span class="math inline">\(\frac{dn_A}{dt}\)</span>, <span class="math inline">\(\frac{dn_B}{dt}\)</span>, and <span class="math inline">\(\frac{dn_Z}{dt}\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<p><span class="math display">\[
P_A = \frac{n_ART}{V} \tag{6}
\]</span></p>
<p><span class="math display">\[
P_B = \frac{n_BRT}{V} \tag{7}
\]</span></p>
<p><span class="math display">\[
k = k_0 \exp{ \left( \frac{-E}{RT} \right)} \tag{8}
\]</span></p>
<p><span class="math display">\[
r = kP_A\sqrt{P_B} \tag{2}
\]</span></p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -rV \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{dn_B}{dt} = -rV \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{dn_Z}{dt} = rV \tag{5}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Finally I’ll write a BSTR model function that solves the design equations. I’ll use an IVODE solver to do so. I will need to provide the initial values, stopping criterion and the derivatives function to it. I can calculate the initial molar amounts of A and B using the ideal gas law, but to do so I’ll need their initial partial pressures and the temperature. The initial partial pressure of A (and consequently the initial partial pressure of B) and the temperature will change from experiment to experiment, so they will need to be passed to the model function as arguments. Similarly, the final time will vary from one experiment to the next and must be passed in as an argument.</p>
</div>
</div>
</div>
<p><u>BSTR Model Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(P_{A,0}\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(t_f\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return Values: <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_A\)</span>, <span class="math inline">\(\underline{n}_B\)</span>, and <span class="math inline">\(\underline{n}_Z\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<ol type="1">
<li>Calculate unknown initial and final values.</li>
</ol>
<p><span class="math display">\[
n_{A,0} = \frac{P_{A,0}V}{RT} \tag{9}
\]</span></p>
<p><span class="math display">\[
P_{B,0} = P_0 - P_{A,0} \tag{10}
\]</span></p>
<p><span class="math display">\[
n_{B,0} = \frac{P_{B,0}V}{RT} \tag{11}
\]</span></p>
<ol start="2" type="1">
<li><p>Call an IVODE solver passing the initial values, stopping criterion and derivatives function as arguments.</p></li>
<li><p>Receive corresponding sets of values of <span class="math inline">\(t\)</span>, <span class="math inline">\(n_A\)</span>, <span class="math inline">\(n_B\)</span>, and <span class="math inline">\(n_Z\)</span> spanning the range from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=t_f\)</span> from the IVODE solver and return them.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now I need to use the model function to create a predicted responses model that can be fit to the experimental data. It will be called by a numerical fitting function, so the predicted responses function must receive the rate expression parameters, <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>, and the adjusted experimental inputs for all of the experiments as its only arguments.</p>
<p>After making the pre-exponential factor and activation energy available to derivatives function, the predicted responses function simply needs to go through the experiments sequentially. For each experiment it should make the temperature available to the derivatives function, call the BSTR reactor model function to get the solution of the design equations for that experiment, and then use the results to calculate the model-predicted final pressure using the ideal gas law. After going through all of the experiments, it should return the full set of predicted final pressures.</p>
</div>
</div>
</div>
<center>
<strong>Predicted Responses Function</strong>
</center>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return Values: <span class="math inline">\(\underline{P}_{f,model}\)</span></p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<ol type="1">
<li>Make <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> available to the derivatives function.</li>
<li>For each experiment in the data set
<ol type="a">
<li>Make <span class="math inline">\(T\)</span> available to the derivatives function.</li>
<li>Call the BSTR model function passing <span class="math inline">\(T\)</span>, <span class="math inline">\(P_{A,0}\)</span>, and <span class="math inline">\(t_f\)</span> as arguments to solve the design equations and receive <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_A\)</span>, <span class="math inline">\(\underline{n}_B\)</span>, and <span class="math inline">\(\underline{n}_Z\)</span>.</li>
<li>Calculate the predicted response.</li>
</ol></li>
</ol>
<p><span class="math display">\[
P_{f,model} = \frac{\left(n_A\big\vert_{t=t_f} + n_B\big\vert_{t=t_f} + n_Z\big\vert_{t=t_f}\right)RT}{V} \tag{12}
\]</span></p>
<ol start="3" type="1">
<li>Return the set of model-predicted responses, <span class="math inline">\(\underline{P}_{f,model}\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I will use a numerical fitting function to fit the predicted responses model to the experimental data. I’ll need to provide (a) a guess for the rate expression parameters, (b) the adjusted experimental inputs for all of the experiments, (c) the experimental response for all of the experiments, and (d) the predicted responses function above.</p>
<p>Assuming the numerical fitting function converges, it will return estimates for <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>, the 95% confidence intervals for <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>, and the coefficient of determination, <span class="math inline">\(R^2\)</span>. The estimated rate expression parameters can then be used to calculate the predicted responses for all of the experiments. They can be used to generate a parity plot and to calculate the experiment residual for each experiment. The latter can bhen be used to generate residuals plots.</p>
</div>
</div>
</div>
<center>
<strong>Parameter Estimation</strong>
</center>
<ol type="1">
<li>Set an initial guess for the parameters <span class="math inline">\(k_{0,guess}\)</span> and <span class="math inline">\(E_{guess}\)</span></li>
<li>Call a numerical fitting function passing the adjusted experimental inputs for all of the experiments <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span>, the experimental responses <span class="math inline">\(\underline{P}_f\)</span>, the initial guess for the parameters from step 1, and the predicted responses function, above, as arguments, and receive the parameter estimates <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>, their 95% confidence intervals <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{CI,u}\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, and the coefficient of determination, <span class="math inline">\(R^2\)</span>.</li>
</ol>
<center>
<strong>Generation of Assessment Graphs</strong>
</center>
<ol type="1">
<li>Call the predicted responses function above, passing the estimated parameters <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> and the adjusted experimental inputs for all of the experiments <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span> as arguments and receive the predicted responses for all of the experiments <span class="math inline">\(\underline{P}_f\)</span>.</li>
<li>Calculate the experiment residuals.</li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{P}_f - \underline{P}_{f,model} \tag{13}
\]</span></p>
<ol start="3" type="1">
<li>Generate a parity plot showing <span class="math inline">\(\underline{P}_f\)</span> <em>vs.</em> <span class="math inline">\(\underline{P}_{f,model}\)</span>.</li>
<li>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{P}_{A,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{t}_f\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point, I can perform all of the calculations needed to complete the assignment.</p>
</div>
</div>
</div>
<center>
<strong>Perform the Calculations</strong>
</center>
<ol type="1">
<li>Read the adjusted experimental inputs and experimental responses from the data file, <a href="examples/reb_19_5_3/reb_19_5_3_data.csv">reb_19_5_3_data.csv</a>.</li>
<li>Estimate the parameters and generate the assessment graphs as described above.</li>
<li>Display the results and/or save them to a file.</li>
</ol>
</section>
<section id="results-and-discussion-2" class="level4" data-number="19.5.3.3">
<h4 data-number="19.5.3.3" class="anchored" data-anchor-id="results-and-discussion-2"><span class="header-section-number">19.5.3.3</span> Results and Discussion</h4>
<p>The calculations were performed as described above, and the results are shown in <a href="#tbl-example_19_5_3_results" class="quarto-xref">Table&nbsp;<span>19.7</span></a>.</p>
<div class="cell">
<div id="tbl-example_19_5_3_results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_3_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.7: Parameter estimation results
</figcaption>
<div aria-describedby="tbl-example_19_5_3_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<td style="text-align: center;">k<sub>0</sub></td>
<td style="text-align: center;">0.636 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-1.5</sup>, 95% CI [0.534, 0.738]</td>
</tr>
<tr class="even">
<td style="text-align: center;">E</td>
<td style="text-align: center;">14 kcal mol<sup>-1</sup>, 95% CI [13.9, 14.2]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.998</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A parity plot of the measured responses <em>vs</em>. the model-predicated responses is presented in <a href="#fig-example_19_5_3_parity" class="quarto-xref">Figure&nbsp;<span>19.11</span></a>, and residuals plots showing the difference between the measured and predicted responses <em>vs.</em> the temperature, <em>vs</em>. the initial partial pressure of A, and <em>vs</em>. the reaction time are shown in <a href="#fig-example_19_5_3_residual" class="quarto-xref">Figure&nbsp;<span>19.12</span></a>.</p>
<div id="fig-example_19_5_3_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_3_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_3/reb_19_5_3_parity.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_3_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.11: Parity plot showing the measured experimental responses and the responses predicted by the proposed rate expression.
</figcaption>
</figure>
</div>
<div id="fig-example_19_5_3_residual" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_3_residual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_3/reb_19_5_3_T_residuals.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_3/reb_19_5_3_PA0_residuals.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_3/reb_19_5_3_tf_residuals.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_3_residual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.12: Residuals plots showing the difference between the measured and predicted responses with respect to each of the adjusted experimental inputs,<span class="math inline">\(T\)</span>, <span class="math inline">\(P_{A,0}\)</span>, and <span class="math inline">\(t_{f\)</span>.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The proposed model is quite accurate. Looking at the parity plot, the deviations of the data from the diagonal line is very small, and in the residuals plots, the deviations are random with no apparent trends. The difference between the upper and lower limits of the 95% confidence intervals are small relative to the estimated values of the rate coefficient parameters, <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>, and the coefficient of determination is nearly equal to 1.0.</p>
</div>
</div>
</div>
<p><strong>Assessment</strong></p>
<p>When the Arrhenius parameters shown in <a href="#tbl-example_19_5_3_results" class="quarto-xref">Table&nbsp;<span>19.7</span></a> are used in the proposed rate expression, equation (2), the rate expression is acceptably accurate.</p>
</section>
</section>
<section id="sec-example_19_5_4" class="level3" data-number="19.5.4">
<h3 data-number="19.5.4" class="anchored" data-anchor-id="sec-example_19_5_4"><span class="header-section-number">19.5.4</span> Assessing a Michaelis-Menten Rate Expression</h3>
<p>The enzymatic dehydration of substrate S to product P, reaction (1), was studied in a 50 ml BSTR. Three experiments were performed. The temperature was the same in all three experiments, but the initial concentration of substrate S (mmol L<sup>-1</sup>) differed. At the start of each experiment product P was not present in the reactor. The reaction takes place in aqueous solution, so the concentration of water may be assumed to be constant. The concentration of product P (mmol L<sup>-1</sup>) was measured at 10 min intervals during 2 h of reaction in each of the experiments. Use the resulting data to assess the accuracy of the Michaelis-Menten rate expression, equation (2), for this reaction.</p>
<p><span class="math display">\[
S \rightarrow P + H_2O \tag{1}
\]</span></p>
<p><span class="math display">\[
r = \frac{V_{max}C_S}{K_m + C_S} \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_19_5_4_data" class="quarto-xref">Table&nbsp;<span>19.8</span></a>. The full data set is available in the file <a href="examples/reb_19_5_4/reb_19_5_4_data.csv">reb_19_5_4_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_19_5_4_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_4_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.8: First five experimental data points.
</figcaption>
<div aria-describedby="tbl-example_19_5_4_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">C<sub>S,0</sub> (mmol L<sup>-1</sup>)</th>
<th style="text-align: center;">t<sub>f</sub> (min)</th>
<th style="text-align: center;">C<sub>P,f</sub> (mmol L<sup>-1</sup>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">15</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.35</td>
</tr>
<tr class="even">
<td style="text-align: center;">15</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.90</td>
</tr>
<tr class="odd">
<td style="text-align: center;">15</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">1.26</td>
</tr>
<tr class="even">
<td style="text-align: center;">15</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">1.69</td>
</tr>
<tr class="odd">
<td style="text-align: center;">15</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">2.72</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This assignment describes kinetics experiments, presents the data from them and asks me to use the data to assess a proposed rate expression. As such, it is a kinetics data analysis assignment where a liquid-phase reaction was studied in an isothermal BSTR. The adjusted experimental inputs were the initial concentration of S and the elapsed time when the response (the concentration of P) was measured. I’ll start by summarizing the assignment using subscripted “0”, “f”, “CI,l”, and “CI,u” to denote values at the start of the experiment, values at the time the response was measured, the lower limit of a 95% confidence interval and the upper limit of that interval. I’ll use underlines to denote sets of values.</p>
<p>I’m asked to assess the accuracy of the rate expression, so I’ll need to estimate the rate expression parameters, <span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span>, calculate their 95% confidence intervals and calculate the coefficient of determination. I’ll also make a parity plot and residuals to help in the assessment.</p>
</div>
</div>
</div>
<section id="assignment-summary-3" class="level4" data-number="19.5.4.1">
<h4 data-number="19.5.4.1" class="anchored" data-anchor-id="assignment-summary-3"><span class="header-section-number">19.5.4.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, steady-state BSTR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_19_5_4_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_4_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/bstr_isothermal_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_4_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.13: Schematic representation of the isothermal experimental BSTR.
</figcaption>
</figure>
</div>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(V_{max}\)</span>, <span class="math inline">\(V_{max,CI,l}\)</span>, <span class="math inline">\(V_{max,CI,u}\)</span>, <span class="math inline">\(K_m\)</span>, <span class="math inline">\(K_{m,CI,l}\)</span>, <span class="math inline">\(K_{m,CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{C}_P\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{P,model}\)</span> (as a parity plot), and <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{S,0}\)</span> and <em>vs.</em> <span class="math inline">\(\underline{t}_f\)</span> (as residuals plots).</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(V\)</span> = 50 ml.</p>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{C}_{S,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span></p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{C}_{P,f}\)</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I know I will need to model the experimental BSTR, so I’ll start by developing the reactor model. Mole balances are always need in a reactor model. For a BSTR the general form of the mole balance is given by <a href="section_3_design_equations.html#eq-bstr_mole_balance" class="quarto-xref">Equation&nbsp;<span>6.8</span></a>. Here there is only one reaction, so the summation becomes a single term and the subscripts denoting the reaction are not needed.</p>
<p><span class="math display">\[
\frac{dn_i}{dt} = \nu_i r V
\]</span></p>
<p>Because the reactor operated isothermally, the mole balances can be solved independently of any other reactor design equations. Here I won’t need any other design equations because I can calculate the response using just the mole balances.</p>
<p>However, since the mole balances are IVODEs, I will need initial values, a stopping criterion, and a derivatives function to solve them. I can define <span class="math inline">\(t=0\)</span> to be the instant the experiment starts in which case the initial values are the molar amounts at that instant. The initial molar amount of P was zero in all experiments. The time when the response was measured is also known, and will be used as the stopping criterion.</p>
</div>
</div>
</div>
<center>
<strong>BSTR Model</strong>
</center>
<p><u>Design Equations</u></p>
<p><span class="math display">\[
\frac{dn_S}{dt} = -rV \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{dn_P}{dt} = rV \tag{4}
\]</span></p>
<p><u>Initial Values and Stopping Criterion</u></p>
<div id="tbl-example_19_5_4_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20, 40, 40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_4_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.9: Initial values and stopping criterion for solving the design equations, equations (3) and (4).
</figcaption>
<div aria-describedby="tbl-example_19_5_4_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_f\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_S\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n_{S,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(n_P\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I’ll need to write a derivatives function. It will be given the values of the independent and dependent variables (<span class="math inline">\(t\)</span>, <span class="math inline">\(n_S\)</span>, and <span class="math inline">\(n_P\)</span>) at the start of an integration step. Using those values and the given and known constants from the assignment summary, the derivatives in the design equations must be calculated and returned. In order to do that any unknown quantities appearing in the design equations must first be calculated. The only unknown in the design equations is <span class="math inline">\(r\)</span>, and that can be calculated using equation (2), but equation (2) contains 3 more unknowns: <span class="math inline">\(V_{max}\)</span>, <span class="math inline">\(K_m\)</span>, and <span class="math inline">\(C_S\)</span>. <span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span> will change as the predicted response model is fit to the data, so they will need to be provided. The concentration of S can be calculated using the defining equation for concentration, <a href="section_1_intro_and_defs.html#eq-concentration_closed" class="quarto-xref">Equation&nbsp;<span>1.7</span></a>.</p>
</div>
</div>
</div>
<p><u>Derivatives Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(t\)</span>, <span class="math inline">\(n_S\)</span>, and <span class="math inline">\(n_P\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Must be Available: <span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Return Values: <span class="math inline">\(\frac{dn_S}{dt}\)</span> and <span class="math inline">\(\frac{dn_P}{dt}\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<p><span class="math display">\[
C_S = \frac{n_S}{V} \tag{5}
\]</span></p>
<p><span class="math display">\[
r = \frac{V_{max}C_S}{K_m + C_S} \tag{2}
\]</span></p>
<p><span class="math display">\[
\frac{dn_S}{dt} = -rV \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{dn_P}{dt} = rV \tag{4}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I’ll use an IVODE solver to solve the design equations. I’ll need to provide the derivatives function, above, to it, along with the initial values and stopping criterion in <a href="#tbl-example_19_5_4_initial_values" class="quarto-xref">Table&nbsp;<span>19.9</span></a>. The initial molar amount of S can be calculated from its initial concentration. Because the initial concentration varies from one experiment to the next, it will need to be provided, as will the final time which also varies with the experiment.</p>
</div>
</div>
</div>
<p><u>BSTR Model Function</u></p>
<p><span class="math inline">\(\qquad\)</span> Arguments: <span class="math inline">\(C_{S,0}\)</span> and <span class="math inline">\(t_f\)</span></p>
<p><span class="math inline">\(\qquad\)</span> Return Values: <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_S\)</span>, and <span class="math inline">\(\underline{n}_P\)</span>.</p>
<p><span class="math inline">\(\qquad\)</span> Algorithm:</p>
<ol type="1">
<li>Calculate unknown initial and final values.</li>
</ol>
<p><span class="math display">\[
n_{S,0} = C_{S,0}V \tag{6}
\]</span></p>
<ol start="2" type="1">
<li><p>Call an IVODE solver passing the initial values, stopping criterion and derivatives function as arguments.</p></li>
<li><p>Receive corresponding sets of values of <span class="math inline">\(t\)</span>, <span class="math inline">\(n_S\)</span>, and <span class="math inline">\(n_P\)</span> that span the range from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=t_f\)</span> from the IVODE solver and return them.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The reactor model function cannot be fit to the experimental data. Instead I need to use it to generate a predicted responses model that can be fit to the data. It will be called by a numerical fitting function, so it must have the rate expression parameters (<span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span> here) and the adjusted experimental inputs (<span class="math inline">\(\underline{C}_{S,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span>) as its only arguments.</p>
<p>It must make the rate expression parameters available to the derivatives function and then process each experimental data point. For each data point it needs to solve the design equations and calculate the predicted response, namely the concentration of P. Solving the design equations will yield the molar amount of P, so the concentration can be calculated using the defining equation for concentration.</p>
</div>
</div>
</div>
<center>
<strong>Predicted Responses Function</strong>
</center>
<p><u>Arguments:</u> <span class="math inline">\(V_{max}\)</span>, <span class="math inline">\(K_m\)</span>, (<span class="math inline">\(\underline{C}_{S,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span></p>
<p><u>Return Values:</u> <span class="math inline">\(\underline{C}_{P,f,model}\)</span></p>
<p><u>Algorithm:</u></p>
<ol type="1">
<li>Make [list rate expression parameters] available to the [derivatives/residuals] function.</li>
<li>For each experiment in the data set
<ol type="a">
<li>Make <span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span> available to the derivatives function.</li>
<li>Call the BSTR model function passing <span class="math inline">\(C_{S,0}\)</span> and <span class="math inline">\(t_f\)</span> as arguments to solve the design equations and receive <span class="math inline">\(\underline{t}\)</span>, <span class="math inline">\(\underline{n}_S\)</span>, and <span class="math inline">\(\underline{n}_P\)</span>..</li>
<li>Calculate the predicted response.</li>
</ol></li>
</ol>
<p><span class="math display">\[
C_{P,f,model} = \frac{n_P\big\vert_{t=t_f}}{V} \tag{7}
\]</span></p>
<ol start="3" type="1">
<li>Return the set of model-predicted responses, <span class="math inline">\(\underline{C}_{P,f,model}\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now I can use a numerical fitting function to fit the predicted responses model to the data. I will need to provide the fitting function with a guess for the rate expression parameters, the set of adjusted experimental inputs, the set of experimental responses, and the predicted responses function.</p>
<p>Assuming the fitting function converges, it will return estimates for the rate expression parameters, their 95% confidence intervals, and the coefficient of determination. I will use the parameter estimates to calculate the model-predicted responses, and then use those to calculate the experiment residuals. That will give me the data I need to make a parity plot and residuals plots.</p>
</div>
</div>
</div>
<center>
<strong>Parameter Estimation</strong>
</center>
<ol type="1">
<li>Set an initial guess for the parameters (<span class="math inline">\(V_{max,guess}\)</span> and <span class="math inline">\(K_{m,guess}\)</span>).</li>
<li>Call a numerical fitting function passing the adjusted experimental inputs for all of the experiments (<span class="math inline">\(\underline{C}_{S,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span>), the experimental responses (<span class="math inline">\(\underline{C}_{P,f}\)</span>), the initial guess for the parameters from step 1, and the predicted responses function, above, as arguments, and receive the parameter estimates (<span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span>), their 95% confidence intervals (<span class="math inline">\(V_{max,CI,l}\)</span>, <span class="math inline">\(V_{max,CI,u}\)</span>, <span class="math inline">\(K_m,CI,l\)</span> and <span class="math inline">\(K_m,CI,u\)</span>), and the coefficient of determination, <span class="math inline">\(R^2\)</span>.</li>
</ol>
<center>
<strong>Generation of Assessment Graphs</strong>
</center>
<ol type="1">
<li>Call the predicted responses function above, passing the estimated parameters (<span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span>) and the adjusted experimental inputs for all of the experiments (<span class="math inline">\(\underline{C}_{S,0}\)</span> and <span class="math inline">\(\underline{t}_f\)</span>) as arguments and receive the predicted responses for all of the experiments (<span class="math inline">\(\underline{C}_{P,f}\)</span>).</li>
<li>Calculate the experiment residuals.</li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{C}_{P,f} - \underline{C}_{P,f,model} \tag{8}
\]</span></p>
<ol start="3" type="1">
<li>Generate a parity plot showing <span class="math inline">\(\underline{C}_{P,f}\)</span> vs.&nbsp;<span class="math inline">\(\underline{C}_{P,f,model}\)</span>.</li>
<li>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{S,0}\)</span> and <em>vs.</em> <span class="math inline">\(\underline{t}_f\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I now have everything I need to perform the calculations that are needed to complete the assignment.</p>
</div>
</div>
</div>
<center>
<strong>Performing the Analysis</strong>
</center>
<ol type="1">
<li>Read the adjusted experimental inputs and the experimental responses from the data file, <a href="examples/reb_19_5_4/reb_19_5_4_data.csv">reb_19_5_4_data.csv</a>.</li>
<li>Estimate the parameters and generate the assessment graphs as described above.</li>
<li>Display the results and/or save them to a file.</li>
</ol>
</section>
<section id="results-and-discussion-3" class="level4" data-number="19.5.4.2">
<h4 data-number="19.5.4.2" class="anchored" data-anchor-id="results-and-discussion-3"><span class="header-section-number">19.5.4.2</span> Results and Discussion</h4>
<p>The calculations were performed as described above, and the results are shown in <a href="#tbl-example_19_5_4_results" class="quarto-xref">Table&nbsp;<span>19.10</span></a>. A parity plot of the measured responses <em>vs</em>. the model-predicated responses is presented in <a href="#fig-example_19_5_4_parity" class="quarto-xref">Figure&nbsp;<span>19.14</span></a>, and residuals plots showing the difference between the measured and predicted responses <em>vs</em>. the initial concentration of S and <em>vs</em>. the reaction time are shown in <a href="#fig-example_19_5_4_residual" class="quarto-xref">Figure&nbsp;<span>19.15</span></a>.</p>
<div class="cell">
<div id="tbl-example_19_5_4_results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_4_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.10: Parameter estimation results
</figcaption>
<div aria-describedby="tbl-example_19_5_4_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<td style="text-align: center;">V<sub>max</sub></td>
<td style="text-align: center;">0.115 mmol L<sup>-1</sup> min<sup>-1</sup>, 95% CI [0.111, 0.12]</td>
</tr>
<tr class="even">
<td style="text-align: center;">K<sub>m</sub></td>
<td style="text-align: center;">2.13 mmol L<sup>-1</sup>, 95% CI [1.81, 2.51]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.993</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="fig-example_19_5_4_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_4_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_4/reb_19_5_4_parity.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_4_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.14: Parity plot showing the measured experimental responses and the responses predicted by the proposed rate expression.
</figcaption>
</figure>
</div>
<div id="fig-example_19_5_4_residual" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_4_residual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_4/reb_19_5_4_CS0_residuals.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_19_5_4/reb_19_5_4_tf_residuals.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_4_residual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.15: Residuals plots showing the difference between the measured and predicted responses with respect to each of the adjusted experimental inputs, <span class="math inline">\(C_{S,0}\)</span> and <span class="math inline">\(t_{rxn}\)</span>.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The proposed model is quite accurate. Looking at the parity plot, the deviations of the data from the parity line is very small, and in the residuals plots, the deviations are random with no apparent trends. The difference between the upper and lower limits of the 95% confidence intervals are small relative to the estimated values of <span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span>, and the coefficient of determination is nearly equal to 1.0.</p>
</div>
</div>
</div>
<p><strong>Assessment</strong></p>
<p>When the <span class="math inline">\(V_{max}\)</span> and <span class="math inline">\(K_m\)</span> shown in <a href="#tbl-example_19_5_4_results" class="quarto-xref">Table&nbsp;<span>19.10</span></a> are used in the proposed rate expression, equation (2), the rate expression is acceptably accurate.</p>
</section>
</section>
<section id="sec-example_19_5_5" class="level3" data-number="19.5.5">
<h3 data-number="19.5.5" class="anchored" data-anchor-id="sec-example_19_5_5"><span class="header-section-number">19.5.5</span> Kinetics Data Analysis using Same-Temperature Data Blocks and Linear Least Squares</h3>
<p>Recall <a href="#sec-example_19_5_2" class="quarto-xref">Example&nbsp;<span>19.5.2</span></a>, below. This example repeats that assignment using linear least squares fitting and a spreadsheet.</p>
<p>The gas-phase reaction between reagents A and B was studied in an ideal, isothermal, 500 cm<sup>3</sup> BSTR. In all experiments the reactor was charged with reagents A and B only, but with varying partial pressures. The fractional conversion of reagent A was measured at seven different elapsed times in each experiment. Experiments were performed at three different temperatures. A total of 189 data points were recorded. Assess the accuracy of the rate expression shown in equation (2).</p>
<p><span class="math display">\[
A + B \rightarrow Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = k P_A P_B \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_19_5_2_data" class="quarto-xref">Table&nbsp;<span>19.3</span></a>. The full data set is available in the file <a href="examples/reb_19_5_2/reb_19_5_2_data.csv">reb_19_5_2_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_19_5_5_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_5_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.11: First 5 of the 189 experimentally generated data.
</figcaption>
<div aria-describedby="tbl-example_19_5_5_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">T (°C)</th>
<th style="text-align: center;">P<sub>A,0</sub> (atm)</th>
<th style="text-align: center;">P<sub>B,0</sub> (atm)</th>
<th style="text-align: center;">t<sub>f</sub> (min)</th>
<th style="text-align: center;">f<sub>A</sub></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.022</td>
</tr>
<tr class="even">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.5</td>
<td style="text-align: center;">0.049</td>
</tr>
<tr class="even">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">2.0</td>
<td style="text-align: center;">0.060</td>
</tr>
<tr class="odd">
<td style="text-align: center;">475</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">0.078</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The assignment is the same as it was in <a href="#sec-example_19_5_2" class="quarto-xref">Example&nbsp;<span>19.5.2</span></a>, except for the quantities of interest. When a linearized model is used, the data are analyzed in same temperature blocks. Instead of a single parity plot and one residuals plot for each adjusted input, the graphs used for assessment will be a model plot for each temperature and an Arrhenius plot. So I’ll copy the assignment summary from <a href="#sec-example_19_5_2" class="quarto-xref">Example&nbsp;<span>19.5.2</span></a> and change the quantities of interest.</p>
</div>
</div>
</div>
<section id="assignment-summary-4" class="level4" data-number="19.5.5.1">
<h4 data-number="19.5.5.1" class="anchored" data-anchor-id="assignment-summary-4"><span class="header-section-number">19.5.5.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, gas-phase BSTR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_19_5_2_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/bstr_isothermal_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.16: Schematic representation of the experimental BSTR wherein molar amounts vary with time while the temperature is constant.
</figcaption>
</figure>
</div>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, model plots for each same-temperature data block, and an Arrhenuis plot.</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(V = 500\text{ cm}^3\)</span>.</p>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{P}_{A,0}\)</span>, <span class="math inline">\(\underline{P}_{B,0}\)</span>, and <span class="math inline">\(\underline{t}_f\)</span>.</p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{f}_A\)</span>.</p>
</section>
<section id="mathematical-formulation-of-the-calculations-2" class="level4" data-number="19.5.5.2">
<h4 data-number="19.5.5.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-calculations-2"><span class="header-section-number">19.5.5.2</span> Mathematical Formulation of the Calculations</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If I’m going to use linear least squares to do the fitting, I must use a <em>single</em> mole balance on one of the products or reactants to model the reactor. Because the reactor is isothermal, I can solve that mole balance independently of the energy balances. The response in this problem is the fractional conversion of reagent A, so I’ll write the mole balance on reagent A.</p>
<p>The mole balance will be a differential equation. I know that I will need to solve that IVODE <em>analytically</em> before I’ll be able to linearize the model.</p>
</div>
</div>
</div>
<center>
<strong>Linearized Reactor Model</strong>
</center>
<p>A mole balance on reagent A is shown in equation (3), where the rate expression, equation (2), has been substituted into the mole balance.</p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -kVP_AP_B \tag{3}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I need to solve equation (3) <em>analytically</em> before I can linearize it. To do that, I need to express every variable quantity appearing in it in terms of the dependent variable, <span class="math inline">\(n_A\)</span>, and the independent variable <span class="math inline">\(t\)</span>. In any one experiment, <span class="math inline">\(k\)</span> and <span class="math inline">\(V\)</span> will be constant, but <span class="math inline">\(P_A\)</span> and <span class="math inline">\(P_B\)</span> will change as the reaction proceeds. Consequently, I need to express <span class="math inline">\(P_A\)</span> and <span class="math inline">\(P_B\)</span> in terms of <span class="math inline">\(n_A\)</span> and <span class="math inline">\(t\)</span>.</p>
</div>
</div>
</div>
<p>Using the ideal gas law, the partial pressures can be eliminated, equation (4).</p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -kV\left( \frac{n_ART}{V} \right)\left( \frac{n_BRT}{V} \right) = \frac{-k\left(RT\right)^2}{V}n_An_B \tag{4}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Expressing <span class="math inline">\(P_B\)</span> using the ideal gas law introduced the molar amount of B, <span class="math inline">\(n_B\)</span>. It is not a constant, so it must be expressed in terms of <span class="math inline">\(n_A\)</span> and <span class="math inline">\(t\)</span>. I can accomplish that using the apparent extent of reaction (see <a href="section_1_reaction_progress.html" class="quarto-xref"><span>Chapter 3</span></a>).</p>
<p>First I’ll express the molar amount of reagent B in terms of its initial amount and the apparent extent of the reaction.</p>
<p><span class="math display">\[
n_B = n_{B,0} - \xi
\]</span></p>
<p>Then I can express <span class="math inline">\(\xi\)</span> in terms of the molar amount of reagent A.</p>
<p><span class="math display">\[
n_A = n_{A,0} - \xi \qquad \Rightarrow \qquad \xi = n_{A,0} - n_A
\]</span></p>
<p>Substuting the second expression into the first gives me an expression for the molar amount of reagent B.</p>
<p><span class="math display">\[
n_B = n_{B,0} - n_{A,0} + n_A
\]</span></p>
</div>
</div>
</div>
<p>After expressing the molar amount of B in terms of the molar amount of A, equation (5) results.</p>
<p><span class="math display">\[
\frac{dn_A}{dt} = \frac{-k\left(RT\right)^2}{V}n_A\left( n_{B,0} - n_{A,0} + n_A \right) \tag{5}
\]</span></p>
<p>Separation of variables and integration then leads to equation (6).</p>
<p><span class="math display">\[
\frac{1}{n_{A,0}-n_{B,0}} \ln{\frac{n_{A,0}\left( n_{B,0} - n_{A,0} + n_A  \right)}{n_{B,0}n_A}} = \frac{-k\left(RT\right)^2}{V} t\tag{6}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See Where That Came From
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Rearrange equation (6) so only <span class="math inline">\(n_A\)</span> appears on the left side and only <span class="math inline">\(t\)</span> appears on the right.</p>
<p><span class="math display">\[
\frac{dn_A}{n_A\left( n_{B,0} - n_{A,0} + n_A \right)} = \frac{-k\left(RT\right)^2}{V}dt
\]</span></p>
<p>Then integrate noting that at <span class="math inline">\(t=0\)</span>, <span class="math inline">\(n_A = n_{A,0}\)</span>, at any later time, <span class="math inline">\(t\)</span>, the molar amount of reagent A is <span class="math inline">\(n_A\)</span>, and <span class="math inline">\(k\)</span>, <span class="math inline">\(R\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(V\)</span> are constants that can be taken outside of the integral.</p>
<p><span class="math display">\[
\int_{n_{A,0}}^{n_A}\frac{dn_A}{n_A\left( n_{B,0} - n_{A,0} + n_A \right)} = \frac{-k\left(RT\right)^2}{V}\int_{t_0}^tdt
\]</span></p>
<p><span class="math display">\[
\frac{1}{n_{B,0}-n_{A,0}} \left(\ln{\frac{ n_{B,0} - n_{A,0} + n_A  }{n_A}}\right)\Bigg\vert_{n_{A,0}}^{n_A} = \frac{-k\left(RT\right)^2}{V} t\Big\vert_{t_0}^t
\]</span></p>
<p>Evaluating at the upper and lower limits and taking the difference on each side then yields equation (6).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Looking at equation (6), I can see that the first fraction will become infinite if <span class="math inline">\(n_{A,0} = n_{B,0}\)</span>, and some of the experiments have equal initial partial pressures of reagents A and B. If <span class="math inline">\(n_{A,0} = n_{B,0}\)</span> then <span class="math inline">\(n_A\)</span> will equal <span class="math inline">\(n_B\)</span> at all times because one A is consumed every time one B is consumed in the reaction. In this case, the rate expression becomes <span class="math inline">\(r=kP_A^2\)</span>, so the reactor model is as follows.</p>
<p><span class="math display">\[
\frac{dn_A}{dt} = -kVP_A^2
\]</span></p>
<p>Rearrange so only <span class="math inline">\(n_A\)</span> appears on the left side and only <span class="math inline">\(t\)</span> appears on the right.</p>
<p><span class="math display">\[
\frac{dn_A}{n_A^2} = \frac{-k\left(RT\right)^2}{V}dt
\]</span></p>
<p>Then integrate noting that at <span class="math inline">\(t=0\)</span>, <span class="math inline">\(n_A = n_{A,0}\)</span>, at any later time, <span class="math inline">\(t\)</span>, the molar amount of reagent A is <span class="math inline">\(n_A\)</span>, and <span class="math inline">\(k\)</span>, <span class="math inline">\(R\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(V\)</span> are constants that can be taken outside of the integral.</p>
<p><span class="math display">\[
\int_{n_{A,0}}^{n_A}\frac{dn_A}{n_A^2} = \frac{-k\left(RT\right)^2}{V}\int_{t_0}^tdt
\]</span></p>
<p><span class="math display">\[
\frac{-1}{n_A}\Bigg\vert_{n_{A,0}}^{n_A} = \frac{-k\left(RT\right)^2}{V} t\Big\vert_{t_0}^t
\]</span></p>
<p>Evaluating at the upper and lower limits and taking the difference on each side then yields equation (7), below.</p>
</div>
</div>
</div>
<p>If <span class="math inline">\(n_{A,0} = n_{B,0}\)</span>, separation of variables and integration leads to equation (7).</p>
<p><span class="math display">\[
\frac{1}{n_{A,0}} - \frac{1}{n_A} = \frac{-k\left(RT\right)^2}{V} t\tag{7}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Someone just starting to learn about kinetic data analysis might not have noticed that the initial fraction in equation (6) will become infinite if <span class="math inline">\(n_{A,0} = n_{B,0}\)</span>. In that case, the analysis would have failed a little later, indicating that something was wrong. Eventually the new learner might figure out the problem, but this is one of those times when a little prior experience (or the ability to ask a teacher who has such experience) really helps.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Having solved the mole balance ODE, the next step is to linearize it. In this problem nothing needs to be done. It is already linear. That means that I next need to calculate the values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> for each experimental data point.</p>
</div>
</div>
</div>
<p>If <span class="math inline">\(y\)</span> is defined as shown in equation (8) for experiments where <span class="math inline">\(n_{A,0} = n_{B,0}\)</span>, or as shown in equation (9) when <span class="math inline">\(n_{A,0} \ne n_{B,0}\)</span>, and <span class="math inline">\(x\)</span> is defined as shown in equation (10), it can be seen that the model for both cases is a linear equation with a slope equal to <span class="math inline">\(k\)</span>, equation (11).</p>
<p><span class="math display">\[
y = \frac{1}{n_{A,0}} - \frac{1}{n_A} \tag{8}
\]</span></p>
<p><span class="math display">\[
y = \frac{1}{n_{A,0}-n_{B,0}} \ln{\frac{n_{A,0}\left( n_{B,0} - n_{A,0} + n_A  \right)}{n_{B,0}n_A}} \tag{9}
\]</span></p>
<p><span class="math display">\[
x = \frac{-t_f\left(RT\right)^2}{V} \tag{10}
\]</span></p>
<p><span class="math display">\[
y=kx \tag{11}
\]</span></p>
<center>
<strong>Linear Least Squares Parameter Estimation</strong>
</center>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point, I can use linear least squares to estimate <span class="math inline">\(k\)</span> for each same-temperature data block. To do that, I simply need to calculate <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> for each data point in the data block being analyzed. Then I can fit equation (11) to those data, and the resulting slope will equal <span class="math inline">\(k\)</span>.</p>
<p>Once I have estimated <span class="math inline">\(k\)</span> at each of the same-temperature data block temperatures I will have a set of <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data. I can estimate the Arrhenius parameters by linearizing the Arrhenius expression and fitting the result to the <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data as was done in <a href="section_2_rates_and_expressions.html#sec-example_4_5_4" class="quarto-xref">Example&nbsp;<span>4.5.4</span></a>.</p>
<p>All of this can be accomplished using a spreadsheet.</p>
</div>
</div>
</div>
<p>The values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> can be calculated for every experimental data point using equation (10) and either equation (8) (if <span class="math inline">\(n_{A,0} = n_{B,0}\)</span>) or equation (9). Before doing so, the initial molar amounts of A and B and the final molar amount of A must be calculated using the experimental data for each experiment, equations (12) through (14).</p>
<p><span class="math display">\[
n_{A,0} = \frac{P_{A,0}V}{RT} \tag{12}
\]</span></p>
<p><span class="math display">\[
n_{B,0} = \frac{P_{B,0}V}{RT} \tag{13}
\]</span></p>
<p><span class="math display">\[
n_A = n_{A,0} \left( 1 - f_A \right) \tag{14}
\]</span></p>
<p><u>Estimation of <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span></u></p>
<ol type="1">
<li>Split the data into same-temperature blocks.</li>
<li>For each block
<ol type="a">
<li>calculate <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span></li>
<li>fit equation (11) to the resulting data to estimate <span class="math inline">\(k\)</span></li>
</ol></li>
</ol>
<p>The Arrhenius expression can then be fit to the resulting <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data. Recall from <a href="apndx_estimate_parameters.html" class="quarto-xref"><span>Appendix L</span></a> that the Arrhenius expression can be linearized by taking the logarithm of each side, <a href="apndx_estimate_parameters.html#eq-x_and_y_in_linear_arrhenius" class="quarto-xref">Equation&nbsp;<span>L.5</span></a>, reproduced here as equation (13).</p>
<p><span class="math display">\[
\begin{matrix} y = \ln{k_j} \\ x = \displaystyle \frac{-1}{RT} \end{matrix} \quad \Rightarrow \quad y = m x + b \quad \Rightarrow \quad \begin{matrix} m = E_j \\ b = \ln{k_{0,j}} \end{matrix} \tag{13}
\]</span></p>
<p>The <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data can be used to calculate <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in equation (13), and <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> can be estimated by fitting <span class="math inline">\(y=mx+b\)</span> to the resulting <span class="math inline">\(x\)</span> - <span class="math inline">\(y\)</span> data. The estimated values of <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> then can be calculated as shown in equation (13).</p>
<p><u>Estimation of <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span></u></p>
<ol type="1">
<li>Using the <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data above, calculate a corresponding set of <span class="math inline">\(y\)</span> <em>vs.</em> <span class="math inline">\(x\)</span> data using equation (13).</li>
<li>Fit <span class="math inline">\(y=mx + b\)</span> to those data to find <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>.</li>
<li>Calculate <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> using equation (13).</li>
</ol>
</section>
<section id="implementation-of-the-calculations-using-a-spreadsheet" class="level4" data-number="19.5.5.3">
<h4 data-number="19.5.5.3" class="anchored" data-anchor-id="implementation-of-the-calculations-using-a-spreadsheet"><span class="header-section-number">19.5.5.3</span> Implementation of the Calculations Using a Spreadsheet</h4>
<p>To perform the calculations, the file provided with assignment, <a href="examples/reb_19_5_2/reb_19_5_2_data.csv">reb_19_5_2_data.csv</a>, was opened in a spreadsheet program. The spreadsheet consisted of five columns (A through E) with headings of T, PA0, PB0, tf, and fA, corresponding to the the headings shown in <a href="#tbl-example_19_5_5_data" class="quarto-xref">Table&nbsp;<span>19.11</span></a>. Each column contained 189 rows below the heading, one for each experiment.</p>
<p>Five columns were added to the right of the fA column, as shown in <a href="#fig-example_19_5_5_screenshot" class="quarto-xref">Figure&nbsp;<span>19.17</span></a>. In column F the temperature in K was calculated from the Celsius temperature in column A. In columns G, H, and I, the initial molar amounts of A and B and the final molar amount of A were calculated using equations (12) through (14). Finally, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> were calculated using equation (10) and either equation (8) for experiments where <span class="math inline">\(n_{A,0} = n_{B,0}\)</span>, or equation (9) when <span class="math inline">\(n_{A,0} \ne n_{B,0}\)</span>.</p>
<div id="fig-example_19_5_5_screenshot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_5_screenshot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_5/spreadsheet_screenshot.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_5_screenshot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.17: First five rows of the spreadsheed used to perform the analysis.
</figcaption>
</figure>
</div>
<p>Next the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> columns for experiments with <span class="math inline">\(T\)</span> = 475 °C were selected and used to generate a scatter plot. A linear trendline with an intercept of zero was added to the graph, and it was set to display the equation for the trendline and the <span class="math inline">\(R^2\)</span> value. The resulting plot is shown in <a href="#fig-example_19_5_5_model_plot" class="quarto-xref">Figure&nbsp;<span>19.18</span></a>. The displayed equation is <span class="math inline">\(y=1.097\text{E}-06x\)</span>, indicating that the slope is 1.097 x 10<sup>-6</sup> mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup>. This is also the value of <span class="math inline">\(k\)</span> as shown in equation (11).</p>
<div id="fig-example_19_5_5_model_plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_5_model_plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_5/475C_model_plot.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_5_model_plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.18: Model plot for the 475 °C data from the spreadsheed used to perform the analysis.
</figcaption>
</figure>
</div>
<p>Model plots, not shown, for the 500 °C and 525 °C data were generated the same manner. The temperatures, estimated rate coefficients and coefficients of determination are shown in <a href="#tbl-example_19_5_5_rate_coefficients" class="quarto-xref">Table&nbsp;<span>19.12</span></a>. A new spreadsheet was created with columns for the temperatures and rate coefficients. Columns were then added for the temperature in K, <span class="math inline">\(x\)</span> (<span class="math inline">\(\frac{-1}{RT}\)</span>), and <span class="math inline">\(y\)</span> (<span class="math inline">\(\ln{ k}\)</span>) from equation (13). A plot of <span class="math inline">\(y\)</span> <em>vs.</em> <span class="math inline">\(x\)</span> was generated, a linear trendline (<span class="math inline">\(y=mx+b\)</span>) was added and the graph was set to display the trendline equation and the coefficient of determination. A screenshot from the spreadsheet is shown as <a href="#fig-example_19_5_5_arrhenius" class="quarto-xref">Figure&nbsp;<span>19.19</span></a>.</p>
<div id="tbl-example_19_5_5_rate_coefficients" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[33,33,33]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_5_rate_coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.12: Estimated rate coefficients for each of the same-temperature data blocks.
</figcaption>
<div aria-describedby="tbl-example_19_5_5_rate_coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Temperature</th>
<th style="text-align: center;"><span class="math inline">\(k\)</span></th>
<th style="text-align: center;"><span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">475 °C</td>
<td style="text-align: center;">1.097 x 10<sup>-6</sup></td>
<td style="text-align: center;">0.9985</td>
</tr>
<tr class="even">
<td style="text-align: center;">500 °C</td>
<td style="text-align: center;">1.740 x 10<sup>-6</sup></td>
<td style="text-align: center;">0.9989</td>
</tr>
<tr class="odd">
<td style="text-align: center;">525 °C</td>
<td style="text-align: center;">2.772 x 10<sup>-6</sup></td>
<td style="text-align: center;">0.9989</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="fig-example_19_5_5_arrhenius" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_5_arrhenius-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_5/Arrhenius_screenshot.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_5_arrhenius-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.19: Screenshot of spreadsheet used to perform the Arrhenius analysis.
</figcaption>
</figure>
</div>
<p>It can be seen in <a href="#fig-example_19_5_5_arrhenius" class="quarto-xref">Figure&nbsp;<span>19.19</span></a> that the slope of the Arrhenius plot is 21989 cal mol<sup>-1</sup> and the intercept is 1.0632. As shown in equation (13), the slope is equal to the activation energy, <span class="math inline">\(E\)</span>, and the intercept is equal to the natural logarithm of <span class="math inline">\(k_0\)</span>. The pre-exponential factor can be calcuated using equation (14), and it is found to equal 2.896 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup>.</p>
</section>
<section id="discussion" class="level4" data-number="19.5.5.4">
<h4 data-number="19.5.5.4" class="anchored" data-anchor-id="discussion"><span class="header-section-number">19.5.5.4</span> Discussion</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I now need to assess the accuracy of the model and make a decision whether to accept it, recommend additional experiments, or reject it. All of the accuracy criteria are satisfied, and the rate expression should be accepted.</p>
<ul>
<li>The coefficient of determination is close to 1.0 for each of the three temperature levels and for the Arrhenius plot.</li>
<li>The data points in the model plots and the Arrhenius plot all lie close to the line representing the model.</li>
<li>The data points in the model and Arrhenius plots scatter randomly from the line representing the model, and there is no apparent trend in the deviations.</li>
</ul>
</div>
</div>
</div>
<p>The rate expression in equation (2) is accurate when the Arrhenius expression is used to represent the temperature dependence of <span class="math inline">\(k\)</span>. Equation (2) should be accepted as the rate expression with <span class="math inline">\(k_0\)</span> = 2.90 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup> and <span class="math inline">\(E\)</span> equal to 22.0 kcal mol<sup>-1</sup>.</p>
</section>
<section id="comparision-of-the-two-analyses" class="level4" data-number="19.5.5.5">
<h4 data-number="19.5.5.5" class="anchored" data-anchor-id="comparision-of-the-two-analyses"><span class="header-section-number">19.5.5.5</span> Comparision of the Two Analyses</h4>
<p>The same rate expression was assessed using the same data set in <a href="#sec-example_19_5_2" class="quarto-xref">Example&nbsp;<span>19.5.2</span></a> and in this example. In <a href="#sec-example_19_5_2" class="quarto-xref">Example&nbsp;<span>19.5.2</span></a> a response function was fit to all of the data to estimate the best values of <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>. In this example a linearized reactor model was fit to the three same-temperature data sets, and the Arrhenius expression was fit to the resulting rate coefficient estimates. In both cases it was concluded that the rate expression was accurate. <a href="#tbl-example_19_5_5_results_comparison" class="quarto-xref">Table&nbsp;<span>19.13</span></a> compares the resulting parameter estimates.</p>
<div id="tbl-example_19_5_5_results_comparison" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[33,33,33]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_5_results_comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.13: Comparison of estimated rate epxression parameters.
</figcaption>
<div aria-describedby="tbl-example_19_5_5_results_comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;"><span class="math inline">\(k_0\)</span></th>
<th style="text-align: center;"><span class="math inline">\(E\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Response Function</td>
<td style="text-align: center;">2.59 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup></td>
<td style="text-align: center;">21.8 kcal mol<sup>-1</sup></td>
</tr>
<tr class="even">
<td style="text-align: center;">Linearized Model</td>
<td style="text-align: center;">2.90 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup></td>
<td style="text-align: center;">22.0 kcal mol<sup>-1</sup></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>It is possible to estimate the uncertainty in the parameter estimates when using a spreadsheet, but that was not done here. The pre-exponential factor and activation energy for the response function method shown in <a href="#tbl-example_19_5_5_results_comparison" class="quarto-xref">Table&nbsp;<span>19.13</span></a> are based directly upon the experimental data. In contrast, the pre-exponential factor and activation energy for the linearized model are estimates that are based on estimates of the rate coefficients, each of which is based upon a fraction of the data.</p>
<p>Apart from this example and the one that follows, kinetics data analysis in <em>Reaction Engineering Basics</em> uses a response function so that each parameter is estimated from the full data set. While it is arguably easier to use a linearized model and use a spreadsheet, that approach cannot always be used, and the estimated parameters are based upon other estimates that are each based upon only a fraction of the data.</p>
</section>
</section>
<section id="sec-example_19_5_6" class="level3" data-number="19.5.6">
<h3 data-number="19.5.6" class="anchored" data-anchor-id="sec-example_19_5_6"><span class="header-section-number">19.5.6</span> Kinetics Data Analysis using Same-Temperature Data Blocks and an Approximate Reactor Model</h3>
<p>Recall <a href="#sec-example_19_5_1" class="quarto-xref">Example&nbsp;<span>19.5.1</span></a>, below. This example repeats that assignment using a linearized, approximate reactor model and a spreadsheet.</p>
<p>Kinetics data for liquid-phase reaction (1) were generated using an ideal, isothermal, 1 L BSTR. The reaction is irreversible, and preliminary analysis indicated that the rate is not affected by the concentration of the product, Z. The experimental design used the initial concentration of A and the temperature as factors. Twelve experiments were performed wherein the temperature and initial concentration of reagent A were set after which the concentration of reagent A was measured at six reaction times, giving a set of 72 experimental data points. The rate expression shown in equation (2) has been proposed for this reaction. The rate coefficient in equation (2) is expected to display Arrhenius temperature dependence. Determine the best values for the Arrhenius pre-exponential factor and activation energy and assess the accuracy of the proposed first order rate expression.</p>
<p><span class="math display">\[
A \rightarrow Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = k C_A \tag{2}
\]</span></p>
<p>Note that these data were generated using the experimental design from <a href="section_6_data_generation.html#sec-example_18_6_1" class="quarto-xref">Example&nbsp;<span>18.6.1</span></a>. The first few data points are shown in <a href="#tbl-example_19_5_6_data" class="quarto-xref">Table&nbsp;<span>19.14</span></a>. The full data set is available in the .csv file <a href="examples/reb_19_5_1/reb_19_5_1_data.csv">reb_19_5_1_data.csv</a></p>
<div class="cell">
<div id="tbl-example_19_5_6_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_6_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.14: First 8 experimental data points.
</figcaption>
<div aria-describedby="tbl-example_19_5_6_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Experiment</th>
<th style="text-align: center;">T (°C)</th>
<th style="text-align: center;">C<sub>A,0</sub> (M)</th>
<th style="text-align: center;">t<sub>f</sub> (min)</th>
<th style="text-align: center;">C<sub>A,f</sub> (M)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.47</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.45</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">0.41</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">0.38</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">0.36</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.33</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">73</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">73</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.40</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This assignment is the same as <a href="#sec-example_19_5_1" class="quarto-xref">Example&nbsp;<span>19.5.1</span></a>, and so the same summary can be used except that the quantities of interest are different. The data can be broken into four same-temperature blocks (65, 73, 82 and 90 °C). Each of those blocks will be analyzed separately to estimate the rate coefficient at those temperatures. Then the resulting <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data will be analyzed to find the Arrhenius parameters and the coefficient of determination. Instead of a parity plot and residuals plots, a model plot for each block temperature and an Arrhenius plot will be used to assess the accuracy of the proposed rate expression.</p>
</div>
</div>
</div>
<section id="assignment-summary-5" class="level4" data-number="19.5.6.1">
<h4 data-number="19.5.6.1" class="anchored" data-anchor-id="assignment-summary-5"><span class="header-section-number">19.5.6.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, liquid-phase BSTR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_19_5_1_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_1_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/bstr_isothermal_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_1_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.20: Schematic representation of the experimental BSTR wherein molar amounts vary with time while the temperature is constant.
</figcaption>
</figure>
</div>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k\big\vert_{T=65\text{°C}}\)</span>, <span class="math inline">\(k\big\vert_{T=73\text{°C}}\)</span>, <span class="math inline">\(k\big\vert_{T=82\text{°C}}\)</span>, <span class="math inline">\(k\big\vert_{T=90\text{°C}}\)</span>, <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, model plots, and an Arrhenius plot.</p>
<p><strong>Given and Known Constants</strong>: <span class="math inline">\(V = 1\text{ L}\)</span>, <span class="math inline">\(R\)</span> = 8.314 x 10<sup>-3</sup> kJ mol<sup>-1</sup> K<sup>-1</sup>.</p>
<p><strong>Adjusted Experimental Inputs</strong>: <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, and <span class="math inline">\(\underline{t}_{f}\)</span></p>
<p><strong>Experimental Response</strong>: <span class="math inline">\(\underline{C}_{A,f}\)</span></p>
</section>
<section id="mathematical-formulation-of-the-calculations-3" class="level4" data-number="19.5.6.2">
<h4 data-number="19.5.6.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-calculations-3"><span class="header-section-number">19.5.6.2</span> Mathematical Formulation of the Calculations</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In any kinetics data analysis, a model for the experimental reactor is needed, so I’ll by generating that. Because the kinetics experiments are isothermal, the mole balance design equations can be solved independently of the energy balances. In addition, everything that is needed for kinetics data analysis can be found by solving the mole balance design equations, so they are the only equations that need to be included in the design equations.</p>
<p>In these experiments there is only one reaction taking place and there aren’t any non-reactive reagents, so the minimum number of mole balance is one. Here I will use a mole balance on reagent A to model the system. Here I’m going to approximate it and then linearize it. That is, I’m going to approximate the derivative in the design equation using backwards differences.</p>
<p><span class="math display">\[
\frac{dn_A}{dt} = \nu_A r V = -rV
\]</span></p>
<p>Since I am using backward differences (see <a href="apndx_prereq_knowledge.html" class="quarto-xref"><span>Appendix A</span></a>) to approximate the derivative, each data point will use the response from the previous data point as well as for the data point itself. I will substitute the rate expression into the approximate design equation.</p>
</div>
</div>
</div>
<center>
<strong>Approximate BSTR Model</strong>
</center>
<p><u>Design Equation</u></p>
<p><span class="math display">\[
\frac{dn_A}{dt} \approxeq \frac{\Delta n_A}{\Delta t} \approxeq \frac{n_A\big \vert_{t=t_i} - n_A \big \vert_{t=t_{i-1}}}{t_i - t_{i-1}} = -kC_AV \tag{3}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Looking at the design equation, I can see it is already linear. I can also see that if I divide both sides by <span class="math inline">\(V\)</span>, I can define new variables, <span class="math inline">\(y\)</span>, <span class="math inline">\(x\)</span>, and <span class="math inline">\(m\)</span>, so the design equation becomes <span class="math inline">\(y=mx\)</span>. Having divided by <span class="math inline">\(V\)</span>, it will be easier to calculate <span class="math inline">\(y\)</span> because the concentration was measured in the experiments, not the molar amounts.</p>
</div>
</div>
</div>
<p><span class="math display">\[
\frac{C_A\big \vert_{t=t_i} - C_A \big \vert_{t=t_{i-1}}}{t_i - t_{i-1}} = -kC_A \tag{4}
\]</span></p>
<p><span class="math display">\[
\begin{matrix} y = \displaystyle \frac{ C_A\big \vert_{t=t_i} - C_A \big \vert_{t=t_{i-1}}}{t_i - t_{i-1}} \\ x = -C_A \end{matrix} \quad \Rightarrow \quad y = m C_A \quad \Rightarrow \quad m = -k \tag{5}
\]</span></p>
<center>
<strong>Linear Least Squares Parameter Estimation</strong>
</center>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point I can use linear least squares to estimate <span class="math inline">\(k\)</span> for each same-temperature data block. All I need to do is calculate <span class="math inline">\(y\)</span> for each data point in the block being analyzed. Then I can fit equation (5) to the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> data and the slope will equal <span class="math inline">\(k\)</span>.</p>
<p>Once I have estimated <span class="math inline">\(k\)</span> at each of the same-temperature data block temperatures, I will have a set of <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data. I can fit the Arrhenius experssion to those data to estimate the pre-exponential factor and activation energy. All of this can be done in a spreadsheet.</p>
</div>
</div>
</div>
<p><u>Estimation of <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span></u></p>
<ol type="1">
<li>Split the data into same-temperature blocks.</li>
<li>For each block
<ol type="a">
<li>Calculate <span class="math inline">\(y\)</span> using equation (5).</li>
<li>fit <span class="math inline">\(y=mC_A\)</span> to the resulting data to estimate <span class="math inline">\(m\)</span>.</li>
<li>Calculate <span class="math inline">\(k = -m\)</span>.</li>
</ol></li>
</ol>
<p>The Arrhenius expression can then be fit to the resulting <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data. Recall from <a href="apndx_estimate_parameters.html" class="quarto-xref"><span>Appendix L</span></a> that the Arrhenius expression can be linearized by taking the logarithm of each side, <a href="apndx_estimate_parameters.html#eq-x_and_y_in_linear_arrhenius" class="quarto-xref">Equation&nbsp;<span>L.5</span></a>, reproduced here as equation (6).</p>
<p><span class="math display">\[
\begin{matrix} y = \ln{k_j} \\ x = \displaystyle \frac{-1}{RT} \end{matrix} \quad \Rightarrow \quad y = m x + b \quad \Rightarrow \quad \begin{matrix} m = E_j \\ b = \ln{k_{0,j}} \end{matrix} \tag{6}
\]</span></p>
<p>The <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data can be used to calculate <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in equation (6), and <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> can be estimated by fitting <span class="math inline">\(y=mx+b\)</span> to the resulting <span class="math inline">\(x\)</span> - <span class="math inline">\(y\)</span> data. The estimated values of <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> then can be calculated as shown in equation (6).</p>
<p><u>Estimation of <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span></u></p>
<ol type="1">
<li>Using the <span class="math inline">\(k\)</span> <em>vs.</em> <span class="math inline">\(T\)</span> data above, calculate a corresponding set of <span class="math inline">\(y\)</span> <em>vs.</em> <span class="math inline">\(x\)</span> data using equation (6).</li>
<li>Fit <span class="math inline">\(y=mx + b\)</span> to those data to find <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>.</li>
<li>Calculate <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> using equation (6).</li>
</ol>
</section>
<section id="implementation-of-the-calculations-using-a-spreadsheet-1" class="level4" data-number="19.5.6.3">
<h4 data-number="19.5.6.3" class="anchored" data-anchor-id="implementation-of-the-calculations-using-a-spreadsheet-1"><span class="header-section-number">19.5.6.3</span> Implementation of the Calculations Using a Spreadsheet</h4>
<p>To perform the calculations, the file provided with assignment, <a href="examples/reb_19_5_1/reb_19_5_1_data.csv">reb_19_5_1_data.csv</a>, was opened in a spreadsheet program. The spreadsheet consisted of five columns (A through E) with headings of Experiment, T, CA0, tf, and CAf, corresponding the the headings shown in <a href="#tbl-example_19_5_6_data" class="quarto-xref">Table&nbsp;<span>19.14</span></a>. Each column contained 72 rows below the heading, one for each data point. Before begining the analysis, the data were sorted by the temperature, then experiment and then tf.</p>
<p>Two columns were added to the right of the CAf column, as shown in <a href="#fig-example_19_5_6_screenshot" class="quarto-xref">Figure&nbsp;<span>19.21</span></a>. In column F the temperature in Kelvin was calculated from the Celsius temperature in column B. In column G, <span class="math inline">\(y\)</span> was calculated using equation (5). If <span class="math inline">\(y\)</span> was being calculated for the first data point in an experiment, the initial concentration, <span class="math inline">\(C_{A,0}\)</span> was used as <span class="math inline">\(C_A \big \vert_{t=t_{1-1}}\)</span> and 0 was used as <span class="math inline">\(t\big \vert_{t=t_{1-1}}\)</span>, otherwise <span class="math inline">\(C_{A,f}\)</span> and <span class="math inline">\(t_f\)</span> from the previous data point were used.</p>
<div id="fig-example_19_5_6_screenshot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_6_screenshot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_6/spreadsheet_model_plot.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_6_screenshot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.21: Portion of the spreadsheet used to perform the analysis showing the model plot for the block of 65 °C data.
</figcaption>
</figure>
</div>
<p>Next the <span class="math inline">\(C_{A,f}\)</span> and <span class="math inline">\(y\)</span> columns for experiments with <span class="math inline">\(T\)</span> = 65 °C were selected and used to generate a scatter plot. A linear trendline with an intercept of zero was added to the graph, and it was set to display the equation for the trendline and the <span class="math inline">\(R^2\)</span> value. <a href="#fig-example_19_5_6_screenshot" class="quarto-xref">Figure&nbsp;<span>19.21</span></a> includes the resulting plot. The displayed equation is <span class="math inline">\(y=-0.0140x\)</span>, indicating that the slope is -0.0140 min<sup>-1</sup>, so according to equation (5), <span class="math inline">\(k = 0.0140\)</span> min<sup>-1</sup>.</p>
<p>Model plots, not shown, for the 73, 82, and 90 °C data blocks were generated the same manner. The temperatures, estimated rate coefficients and coefficients of determination are shown in <a href="#tbl-example_19_5_6_rate_coefficients" class="quarto-xref">Table&nbsp;<span>19.15</span></a>.</p>
<div id="tbl-example_19_5_6_rate_coefficients" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[33,33,33]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_6_rate_coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.15: Estimated rate coefficients for each of the same-temperature data blocks.
</figcaption>
<div aria-describedby="tbl-example_19_5_6_rate_coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Temperature (°C)</th>
<th style="text-align: center;"><span class="math inline">\(k\)</span> (min<sup>-1</sup>)</th>
<th style="text-align: center;"><span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">65</td>
<td style="text-align: center;">0.0140</td>
<td style="text-align: center;">0.9801</td>
</tr>
<tr class="even">
<td style="text-align: center;">73</td>
<td style="text-align: center;">0.0247</td>
<td style="text-align: center;">0.9937</td>
</tr>
<tr class="odd">
<td style="text-align: center;">82</td>
<td style="text-align: center;">0.0468</td>
<td style="text-align: center;">0.9943</td>
</tr>
<tr class="even">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.0837</td>
<td style="text-align: center;">0.9979</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>A new spreadsheet was created with columns for the temperatures and rate coefficients. Columns were then added for the temperature in K, <span class="math inline">\(x\)</span> (<span class="math inline">\(\frac{-1}{RT}\)</span>), and <span class="math inline">\(y\)</span> (<span class="math inline">\(\ln{ k}\)</span>) from equation (6). A plot of <span class="math inline">\(y\)</span> <em>vs.</em> <span class="math inline">\(x\)</span> was generated, a linear trendline (<span class="math inline">\(y=mx+b\)</span>) was added and the graph was set to display the trendline equation and the coefficient of determination. A screenshot from the spreadsheet is shown as <a href="#fig-example_19_5_6_arrhenius" class="quarto-xref">Figure&nbsp;<span>19.22</span></a>.</p>
<div id="fig-example_19_5_6_arrhenius" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_6_arrhenius-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_6/Arrhenius_spreadsheet.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_6_arrhenius-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.22: Screenshot of spreadsheet used to perform the Arrhenius analysis.
</figcaption>
</figure>
</div>
<p>It can be seen in <a href="#fig-example_19_5_6_arrhenius" class="quarto-xref">Figure&nbsp;<span>19.22</span></a> that the slope of the Arrhenius plot is 72.936 kJ mol<sup>-1</sup> and the intercept is 21.658. As shown in equation (6), the slope is equal to the activation energy, <span class="math inline">\(E\)</span>, and the intercept is equal to the natural logarithm of <span class="math inline">\(k_0\)</span>. The pre-exponential factor can be calculated, and it is found to equal 2.90 x 10<sup>9</sup> min<sup>-1</sup>.</p>
</section>
<section id="discussion-1" class="level4" data-number="19.5.6.4">
<h4 data-number="19.5.6.4" class="anchored" data-anchor-id="discussion-1"><span class="header-section-number">19.5.6.4</span> Discussion</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I now need to assess the accuracy of the model and make a decision whether to accept it, recommend additional experiments, or reject it. All of the accuracy criteria are satisfied, and the rate expression should be accepted.</p>
<ul>
<li>The coefficient of determination is close to 1.0 for each of the three temperature levels and for the Arrhenius plot.</li>
<li>The data points in the Arrhenius plot all lie close to the line representing the model.</li>
<li>The data points in the model plot shown in <a href="#fig-example_19_5_6_screenshot" class="quarto-xref">Figure&nbsp;<span>19.21</span></a> scatter by a moderate amount from the line, but the scatter in the other model plots (not shown) got smaller as the temperature increased. Overall, the scatter can be deemed acceptable knowing that an approximate model was being used.</li>
<li>The data points in the model and Arrhenius plots scatter randomly from the line representing the model, and there is no apparent trend in the deviations.</li>
</ul>
</div>
</div>
</div>
<p>The rate expression in equation (2) is acceptably accurate when the Arrhenius expression is used to represent the temperature dependence of <span class="math inline">\(k\)</span>. Equation (2) should be accepted as the rate expression with <span class="math inline">\(k_0\)</span> = 2.90 x 10<sup>9</sup> min<sup>-1</sup> and <span class="math inline">\(E\)</span> equal to 72.94 kJ mol<sup>-1</sup>.</p>
</section>
<section id="comparision-of-the-two-analyses-1" class="level4" data-number="19.5.6.5">
<h4 data-number="19.5.6.5" class="anchored" data-anchor-id="comparision-of-the-two-analyses-1"><span class="header-section-number">19.5.6.5</span> Comparision of the Two Analyses</h4>
<p>The same rate expression was assessed using the same data set in <a href="#sec-example_19_5_1" class="quarto-xref">Example&nbsp;<span>19.5.1</span></a> and in this example. In <a href="#sec-example_19_5_1" class="quarto-xref">Example&nbsp;<span>19.5.1</span></a> a response function was fit to all of the data to estimate the best values of <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>. In this example a linearized, approximate reactor model was fit to the four same-temperature data sets, and the Arrhenius expression was fit to the resulting rate coefficient estimates. In both cases it was concluded that the rate expression was accurate. #tbl-example_19_5_6_results_comparison compares the resulting parameter estimates.</p>
<div id="tbl-example_19_5_6_results_comparison" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[33,33,33]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_19_5_6_results_comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19.16: Comparison of estimated rate epxression parameters.
</figcaption>
<div aria-describedby="tbl-example_19_5_6_results_comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;"><span class="math inline">\(k_0\)</span></th>
<th style="text-align: center;"><span class="math inline">\(E\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Response Function</td>
<td style="text-align: center;">3.61 x 10<sup>8</sup> min<sup>-1</sup></td>
<td style="text-align: center;">67.5 kJ mol<sup>-1</sup></td>
</tr>
<tr class="even">
<td style="text-align: center;">Linearized Model</td>
<td style="text-align: center;">2.90 x 10<sup>9</sup> min<sup>-1</sup></td>
<td style="text-align: center;">72.94 kJ mol<sup>-1</sup></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>It is possible to estimate the uncertainty in the parameter estimates when using a spreadsheet, but that was not done here. The pre-exponential factor and activation energy for the response function method shown in <a href="#tbl-example_19_5_6_results_comparison" class="quarto-xref">Table&nbsp;<span>19.16</span></a> are based directly upon the experimental data. In contrast, the pre-exponential factor and activation energy for the linearized model are estimates that are based on estimates of the rate coefficients, each of which is based upon a fraction of the data.</p>
<p><a href="#fig-example_19_5_6_parity" class="quarto-xref">Figure&nbsp;<span>19.23</span></a> shows parity plots for parameters estimated using the full data set and a predicted responses model and for parameters in the present example using an approximate model. While both show good agreement between the measured and predicted responses, it is clear that the deviations for the predictions based upon the approximate model are greater. The parameters from the approximate model appear to consistently under-predict the experimental responses. This can be attributed to both the approximate model and the procedure wherein initial estimates (of each rate coefficient at one block temperature) are made using only part of the data and then final estimates (of the pre-exponential factor and activation energy) are generated from the first set of estimates.</p>
<div id="fig-example_19_5_6_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_19_5_6_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_19_5_6/reb_19_5_6_parity.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_19_5_6_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19.23: Parity plots based upon the parameter estimates from a full model (blue, <a href="#sec-example_19_5_1" class="quarto-xref">Example&nbsp;<span>19.5.1</span></a>) and parameter estimates from the approximate model (red, this Example).
</figcaption>
</figure>
</div>
<hr>
</section>
</section>
</section>
<section id="symbols-used-in-sec-6_bstr_data_analysis" class="level2" data-number="19.6">
<h2 data-number="19.6" class="anchored" data-anchor-id="symbols-used-in-sec-6_bstr_data_analysis"><span class="header-section-number">19.6</span> Symbols Used in <a href="#sec-6_bstr_data_analysis" class="quarto-xref"><span>Chapter 19</span></a></h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(b\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y\)</span>-intercept of a linearized response model.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(f\left(\right)\)</span></td>
<td style="text-align: left;">Mathematical function of the variables enclosed by the parentheses.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(k\)</span></td>
<td style="text-align: left;">Rate coefficient.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(k_0\)</span></td>
<td style="text-align: left;">Pre-exponential factor; additional subscripted <span class="math inline">\(CI_l\)</span> and <span class="math inline">\(CI_u\)</span> denote the lower and upper limits of the 95% confidence interval.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(f\)</span></td>
<td style="text-align: left;">Analytic function obtained upon solution of an ODE.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(f_i\)</span></td>
<td style="text-align: left;">Fractional conversion of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(m_i\)</span></td>
<td style="text-align: left;">Slope in the <span class="math inline">\(i\)</span> direction of a linear response model.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_i\)</span></td>
<td style="text-align: left;">Molar amount of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r\)</span></td>
<td style="text-align: left;">Rate of reaction per unit volume.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(r_i\)</span></td>
<td style="text-align: left;">Rate of generation of reagent <span class="math inline">\(i\)</span> per unit volume.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: left;">Time; an additional subscripted <span class="math inline">\(f\)</span> denotes the time at which the response was measured.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(t_{1/2}\)</span></td>
<td style="text-align: left;">Reaction half-life.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(x_i\)</span></td>
<td style="text-align: left;">Independent variable in a linear response function.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y\)</span></td>
<td style="text-align: left;">Reactor response, an additional subscripted “expt” denotes the experimentally measured response, an additional subscripted “model” denotes the response predicted by the model.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(C_i\)</span></td>
<td style="text-align: left;">Molar concentration of reagent <span class="math inline">\(i\)</span>; additional subscripts denote the elapsed time and a model-predicted value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(E\)</span></td>
<td style="text-align: left;">Activation energy; additional subscripted <span class="math inline">\(CI_l\)</span> and <span class="math inline">\(CI_u\)</span> denote the lower and upper limits of the 95% confidence interval.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(K_m\)</span></td>
<td style="text-align: left;">Parameter in the Michaelis-Menten rate expression.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Pressure; an additional subscript denotes the elapsed time.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P_i\)</span></td>
<td style="text-align: left;">Partial Pressure of reagent <span class="math inline">\(i\)</span>; an additional subscript denotes the elapsed time.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(R^2\)</span></td>
<td style="text-align: left;">Coefficient of determination.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T\)</span></td>
<td style="text-align: left;">Tempertature.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(V\)</span></td>
<td style="text-align: left;">Volume.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(V_{max}\)</span></td>
<td style="text-align: left;">Parameter in the Michaelis-Menten rate expression.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\alpha\)</span></td>
<td style="text-align: left;">Power-law reaction order.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\epsilon_{expt}\)</span></td>
<td style="text-align: left;">Experiment residual.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\nu_i\)</span></td>
<td style="text-align: left;">Stoichiometric coefficient of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\Delta n_i\)</span></td>
<td style="text-align: left;">Change in <span class="math inline">\(n_i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\Delta t\)</span></td>
<td style="text-align: left;">Change in <span class="math inline">\(t\)</span>.</td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./section_6_data_generation.html" class="pagination-link" aria-label="Generation and Analysis of Kinetics Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./section_6_cstr_data_analysis.html" class="pagination-link" aria-label="Analysis of Kinetics Data from a CSTR">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>