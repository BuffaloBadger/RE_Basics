<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>21&nbsp; Analysis of Kinetics Data from a PFR – Reaction Engineering Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./section_7_intro.html" rel="next">
<link href="./section_6_cstr_data_analysis.html" rel="prev">
<link href="./Graphics/BuffaloBadger_16_16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="http://buffalobadger.github.io" class="navbar-brand navbar-brand-logo">
    <img src="./Graphics/Banner.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/RE_Basics"> 
<span class="menu-text">Reaction Engineering Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/SCoRE"> 
<span class="menu-text">SCoRE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/ToTaL_Engineering"> 
<span class="menu-text">ToTaL Engineering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/The_Sett"> 
<span class="menu-text">The Sett</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_6_intro.html">Kinetics Data Analysis</a></li><li class="breadcrumb-item"><a href="./section_6_pfr_data_analysis.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_intro_and_defs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reactions, Reactors, and Reaction Engineering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_safety_and_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reaction Engineering Ethics and Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_reaction_progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measures of Reaction Progress</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rate Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_rates_and_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reaction Rates and Rate Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reaction Mechanisms and Mechanistic Rate Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_3_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formulating Reactor Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_design_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reactor Design Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_4_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Isolated Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_reaction_engineering_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Response, Optimization and Design of Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_bstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">BSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_sbstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">SBSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_non_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design of Non-Continuous Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_cstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_pfr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_5_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Ideal Reactor Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_reactor_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reactor Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_thermally_backmixed_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thermally Back-Mixed PFRs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_recycle_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recycle PFRs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_6_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kinetics Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_data_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_bstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_cstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_pfr_data_analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_7_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Non-Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_age_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Age Distribution Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_segregated_flow_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">A Segregated Flow Reactor Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_zoned_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Zoned Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_prereq_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prerequisite Knowledge</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_nomenclature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Acronyms, Notation, Sign Conventions, and Computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_reaction_thermo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Reaction Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_collision_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Collision Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_transition_state_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Transition State Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_heat_exchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Reactor Heat Exchange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_ideal_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Axial Dispersion Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Solving Algebraic/Transcendental Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ivodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Solving Initial-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_cvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Solving Coupled-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_estimate_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Parameter Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_bvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Solving Boundary-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_useful_eqns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Frequently Used Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#laboratory-pfrs" id="toc-laboratory-pfrs" class="nav-link active" data-scroll-target="#laboratory-pfrs"><span class="header-section-number">21.1</span> Laboratory PFRs</a>
  <ul class="collapse">
  <li><a href="#testing-the-ideality-of-a-pfr" id="toc-testing-the-ideality-of-a-pfr" class="nav-link" data-scroll-target="#testing-the-ideality-of-a-pfr"><span class="header-section-number">21.1.1</span> Testing the Ideality of a PFR</a></li>
  </ul></li>
  <li><a href="#pfr-kinetics-experiments-and-data" id="toc-pfr-kinetics-experiments-and-data" class="nav-link" data-scroll-target="#pfr-kinetics-experiments-and-data"><span class="header-section-number">21.2</span> PFR Kinetics Experiments and Data</a>
  <ul class="collapse">
  <li><a href="#differential-operation" id="toc-differential-operation" class="nav-link" data-scroll-target="#differential-operation"><span class="header-section-number">21.2.1</span> Differential Operation</a></li>
  </ul></li>
  <li><a href="#design-of-pfr-experiments" id="toc-design-of-pfr-experiments" class="nav-link" data-scroll-target="#design-of-pfr-experiments"><span class="header-section-number">21.3</span> Design of PFR Experiments</a></li>
  <li><a href="#pfr-data-analysis" id="toc-pfr-data-analysis" class="nav-link" data-scroll-target="#pfr-data-analysis"><span class="header-section-number">21.4</span> PFR Data Analysis</a>
  <ul class="collapse">
  <li><a href="#the-steady-state-pfr-model" id="toc-the-steady-state-pfr-model" class="nav-link" data-scroll-target="#the-steady-state-pfr-model"><span class="header-section-number">21.4.1</span> The Steady-State PFR Model</a></li>
  <li><a href="#the-predicted-response-model" id="toc-the-predicted-response-model" class="nav-link" data-scroll-target="#the-predicted-response-model"><span class="header-section-number">21.4.2</span> The Predicted Response Model</a></li>
  <li><a href="#parameter-estimates-statistics-and-assessment-graphs" id="toc-parameter-estimates-statistics-and-assessment-graphs" class="nav-link" data-scroll-target="#parameter-estimates-statistics-and-assessment-graphs"><span class="header-section-number">21.4.3</span> Parameter Estimates, Statistics and Assessment Graphs</a></li>
  <li><a href="#accuracy-assessment" id="toc-accuracy-assessment" class="nav-link" data-scroll-target="#accuracy-assessment"><span class="header-section-number">21.4.4</span> Accuracy Assessment</a></li>
  <li><a href="#analysis-using-a-linearized-model" id="toc-analysis-using-a-linearized-model" class="nav-link" data-scroll-target="#analysis-using-a-linearized-model"><span class="header-section-number">21.4.5</span> Analysis Using a Linearized Model</a></li>
  <li><a href="#analysis-using-an-approximate-reactor-model" id="toc-analysis-using-an-approximate-reactor-model" class="nav-link" data-scroll-target="#analysis-using-an-approximate-reactor-model"><span class="header-section-number">21.4.6</span> Analysis Using an Approximate Reactor Model</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">21.5</span> Examples</a>
  <ul class="collapse">
  <li><a href="#sec-example_21_5_1" id="toc-sec-example_21_5_1" class="nav-link" data-scroll-target="#sec-example_21_5_1"><span class="header-section-number">21.5.1</span> Kinetics of Gas-Phase Decomposition</a></li>
  <li><a href="#sec-example_21_5_2" id="toc-sec-example_21_5_2" class="nav-link" data-scroll-target="#sec-example_21_5_2"><span class="header-section-number">21.5.2</span> Power-Law Kinetics of a Heterogeneous Catalytic Reaction</a></li>
  <li><a href="#sec-example_21_5_3" id="toc-sec-example_21_5_3" class="nav-link" data-scroll-target="#sec-example_21_5_3"><span class="header-section-number">21.5.3</span> Mechanistic Kinetics of a Heterogeneous Catalytic Reaction</a></li>
  </ul></li>
  <li><a href="#symbols-used-in-sec-6_pfr_data_analysis" id="toc-symbols-used-in-sec-6_pfr_data_analysis" class="nav-link" data-scroll-target="#symbols-used-in-sec-6_pfr_data_analysis"><span class="header-section-number">21.6</span> Symbols Used in <span>Chapter 21</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_6_intro.html">Kinetics Data Analysis</a></li><li class="breadcrumb-item"><a href="./section_6_pfr_data_analysis.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-6_pfr_data_analysis" class="quarto-section-identifier"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This chapter completes the Kinetics Data Analysis section of <em>Reaction Engineering Basics</em>. It focuses on the generation and analysis of kinetics data from a PFR. <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> presented an overview of kinetics data generation and analysis, and Chapters <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>19</span></a> and <a href="section_6_cstr_data_analysis.html" class="quarto-xref"><span>20</span></a> examined analysis of data from BSTRs and CSTRs, respectively. Much of the information presented in those chapters also applies to PFRs and won’t be duplicated here.</p>
<section id="laboratory-pfrs" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="laboratory-pfrs"><span class="header-section-number">21.1</span> Laboratory PFRs</h2>
<p>In its most basic form, a PFR is simply a length of rigid tubing or pipe. Reagents flow in at one end and out at the other. The key assumption of the PFR model is that of plug flow. As explained in <a href="section_3_design_equations.html" class="quarto-xref"><span>Chapter 6</span></a> and <a href="apndx_ideal_reactor_models.html" class="quarto-xref">Appendix&nbsp;<span>G</span></a>, the fluid flow velocity is constant across the tube diameter in plug flow. There is no mixing in the axial direction, and perfect mixing in the radial direction. Thus, in contrast to stirred tank reactors, the composition varies spatially in a PFR. That is, as one moves from the reactor inlet to the reactor outlet, the concentrations of reactants decrease and those of products increase. (The temperature and pressure can also vary along the length of a PFR, but when generating kinetics data the reactor usually operated isothermally and with negligible pressure drop).</p>
<p>A second difference between PFRs and stirred tank reactors is that there is no agitation in PFRs. For this reason, PFRs are very often used to generate kinetics data for heterogeneous catalytic reactions. Recall, a heterogeneous catalyst is a material that exists as a separate phase from the reacting fluid and that causes the rate of one or more reactions to increase. Most commonly heterogeneous catalysts are porous solids that are immersed in the reacting fluid. It is difficult to agitate the solid particles if a stirred tank reactor is used. When a heterogeneous catalytic reaction is studied in a PFR, the catalyst is typically contained within the reactor tube as a stationary packed bed through which the reacting fluid flows. A section of pipe filled with small pellets or beads that are held in place by screens or other means offers a good mental picture of a packed bed.</p>
<p>The ideal PFR design equations can be used to model a packed bed reactor. To do so, the combined packed bed and reaction fluid are treated as if they are a single, homogeneous fluid. The most important assumption that this introduces to the analysis is that there are no concentration or temperature gradients at the interface between the solid and fluid phases or within the pores of the solid. In reality, there will be concentration and temperature gradients between the bulk of the fluid and the surface of the heterogeneous catalyst particles, and there will be gradients within the pores of the catalyst particles as discussed in <a href="section_4_pfr_analysis.html#sec-packed_bed_gradients" class="quarto-xref">Chapter&nbsp;<span>13.6.3</span></a>. For present purposes, the important point is that these gradients must be negligibly small if the PFR design equations from <a href="section_3_design_equations.html" class="quarto-xref"><span>Chapter 6</span></a> are used to model the reactor.</p>
<section id="testing-the-ideality-of-a-pfr" class="level3" data-number="21.1.1">
<h3 data-number="21.1.1" class="anchored" data-anchor-id="testing-the-ideality-of-a-pfr"><span class="header-section-number">21.1.1</span> Testing the Ideality of a PFR</h3>
<p>Before a PFR is used to generate kinetics data, it should be tested to ensure it conforms to the asumptions of an ideal PFR. Importantly, it should be tested for plug flow, and if it is a packed bed, it should be tested for negligible concentration and temperature gradients.</p>
<p><strong>Testing for plug flow</strong> is not easy. As noted in <a href="apndx_prereq_knowledge.html" class="quarto-xref">Appendix&nbsp;<span>A</span></a>, in laminar flow the radial velocity profile is parabolic, and it flattens as the flow becomes turbulent. The Reynolds number, <span class="math inline">\(N_{Re}\)</span>, offers a measure of how turbulent the flow is. It can be computed using <a href="#eq-Reynolds_number" class="quarto-xref">Equation&nbsp;<span>21.1</span></a>. In cylindrical pipes, a Reynolds number greater than ca. 3500 indicates turbulent flow; a much greater Reynolds number is needed in order to approach plug flow.</p>
<p><span id="eq-Reynolds_number"><span class="math display">\[
N_{Re} = \frac{\rho vD}{\mu}
\tag{21.1}\]</span></span></p>
<p>Smoke- or dye-based flow visualizations are useful for gauging the mixing in an agitated vessel, but they are difficult to apply for gauging plug flow. Alternatively, a small amount of a dye or otherwise detectable species can be injected at the reactor inlet. If the injection is effectively instantaneous, the dye should emerge from the reactor all at once. The greater the time span over which the dye emerges, the greater the deviation from plug flow. Essentially this involves measuring the residence time distribution or age function for the reactor. Doing so is described in <a href="section_7_segregated_flow_model.html" class="quarto-xref"><span>Chapter 23</span></a>. The measured age distribution function can then be compared to that expected for plug flow to determine whether plug flow prevails in the reactor.</p>
<p>As noted above, when a tubular reactor contains a packed bed of solid particles, gradients in concentration and temperature can exist within the fluid that is close to the surface of the solid particles. When present, these are referred to as external gradients because they are external to the solid material. A common experimental test for <strong>external mass transfer limitations</strong> (i. e. for non-negligible external concentration gradients) in a packed bed reactor relies on the fact that for an ideal PFR, the conversion depends only upon the residence time within the reactor and not the linear velocity of the flowing fluid. The external mass transfer coefficient, in contrast, <em>does</em> depend upon the linear velocity of the flowing fluid. Thus, if the conversion changes when the linear velocity is changed while holding the residence time constant, this indicates that the apparent rate is being affected by the rate of external mass transfer.</p>
<p>One approach to this test is to measure the conversion at varying fluid velocities with a fixed amount of catalyst and plot the conversion versus the residence time. The experiment is then repeated using a different amount of catalyst. In the absence of mass transfer limitations, the plots should superimpose. An alternative approach is to measure the conversion with a given amount of catalyst and at a given fluid flow rate. The conversion is then measured again using a different amount of catalyst, but with a flow rate that gives the same residence time as in the first experiment. In the absence of external mass transfer limitations, the conversions should be equal. Care should be taken in applying this test, however, because at the very low Reynolds numbers that are often used in laboratory reactors, the mass transfer coefficient depends very weakly upon the fluid velocity <span class="citation" data-cites="chambers_lack_1966">(<a href="references.html#ref-chambers_lack_1966" role="doc-biblioref">Chambers and Boudart 1966</a>)</span>.</p>
<p>When external mass transfer limitations are very severe, a first-order rate expression, <a href="#eq-apparent_first_order" class="quarto-xref">Equation&nbsp;<span>21.2</span></a>, will be found to fit the experimental data very well. In this case it is more appropriate to refer to <a href="#eq-apparent_first_order" class="quarto-xref">Equation&nbsp;<span>21.2</span></a> as the <em>apparent</em> rate expression because the rate it refers to is the rate of external mass transfer and not the rate of reaction. The true rate expression can be first-order, but when external mass transfer limitations are severe, the apparent activation energy, <span class="math inline">\(E\)</span>, will be very low (≲ 10 to 15 kJ mol<sup>-1</sup>). True reaction rates typically have activation energies that are greater than this. This can serve as a warning indicator when kinetics data are being analyzed. If the reaction kinetics are observed to change to first order and the activation energy is simultaneously observed to become small, the kinetics data may contain experiments where external transport limitations existed. There are also <strong>computational tests for external transport limitations</strong> that can be applied to test for external gradients <span class="citation" data-cites="mears_tests_1971 satterfield_heterogeneous_1980 wheeler_reaction_1951">(<a href="references.html#ref-mears_tests_1971" role="doc-biblioref">Mears 1971</a>; <a href="references.html#ref-satterfield_heterogeneous_1980" role="doc-biblioref">Satterfield 1980</a>; <a href="references.html#ref-wheeler_reaction_1951" role="doc-biblioref">Wheeler 1951</a>)</span>.</p>
<p><span id="eq-apparent_first_order"><span class="math display">\[
r=k_0\exp{\left( \frac{-E}{RT} \right)}C_i
\tag{21.2}\]</span></span></p>
<p>Most heterogeneous catalysts are porous solids with very high specific surface areas. Most of this surface area is internal and corresponds to the walls of pores (picture the catalyst interior as looking like a microscopic sponge). The only way for reactants to reach the majority of the catalytic sites is to diffuse into the pore structure. If the rate of the reaction at the active sites is large, this can lead to the formation of significant <strong>internal concentration gradients</strong> within the pores. For present purposes, the goal is to be able to identify experimental conditions where these gradients are insignificantly small. As a general rule of thumb, internal concentration gradients are more likely than external concentration gradients.</p>
<p>One <strong>experimental test for the presence of internal heat or mass transfer limitations</strong> is to repeatedly measure the conversion using finer and finer catalyst particle sizes. In the absence of internal gradients, the conversion should not depend upon the particle size, but if gradients are present, their effects should diminish as the particle size is decreased. This happens because the diffusional path length becomes smaller as the particle size is decreased. Koros and Nowak <span class="citation" data-cites="koros_diagnostic_1967">(<a href="references.html#ref-koros_diagnostic_1967" role="doc-biblioref">1967</a>)</span> suggest a test where the catalyst is prepared from two powders that are mixed and formed into catalyst pellets. One powder is inert while the other is catalytic. Two or more sets of pellets are prepared using different ratios of the powders. In the absence of internal gradients, the ratio of the observed rates should equal the ratio of amounts of the active powders used to prepare the catalysts. Madon and Boudart <span class="citation" data-cites="madon_experimental_1982">(<a href="references.html#ref-madon_experimental_1982" role="doc-biblioref">1982</a>)</span> describe a similar test where the catalyst comprises very small active catalyst nanoparticles supported on a porous oxide carrier.</p>
<p>There are also a few <strong>computational tests for the presence of intraparticle temperature or concentration gradients</strong>. For an isothermal reaction, <a href="#eq-internal_conc_gradients" class="quarto-xref">Equation&nbsp;<span>21.3</span></a> can be used to calculate <span class="math inline">\(\phi_s\)</span>. For a zero-order reaction, the effects of concentration gradients in the pores will be negligible if <span class="math inline">\(\phi_s\)</span> is less than 6. For first order reactions it should be less than 1, and for second order reactions it should be less than 0.3.</p>
<p><span id="eq-internal_conc_gradients"><span class="math display">\[
\phi_s = \frac{r_p^2\left( -r \right)}{D_{\text{eff}}C_i}
\tag{21.3}\]</span></span></p>
</section>
</section>
<section id="pfr-kinetics-experiments-and-data" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="pfr-kinetics-experiments-and-data"><span class="header-section-number">21.2</span> PFR Kinetics Experiments and Data</h2>
<p>From an operational viewpoint, the procedure for performing kinetics experiments using a PFR is exactly the same as the procedure used with a CSTR. Each experiment will yield a single data point. As with the stirred tank reactors, experiments should be performed in blocks where all of the experiments in a block are performed at the same temperature to prevent the generally strong temperature dependence of reaction rates from masking weaker composition and pressure effects. Similarly, the PFR should operate at steady state so that the temperature of the reacting fluid is constant. Doing so allows kinetics data analysis using only the PFR mole balance design equations (as long as the pressure drop along the length of the reactor also is negligible).</p>
<section id="differential-operation" class="level3" data-number="21.2.1">
<h3 data-number="21.2.1" class="anchored" data-anchor-id="differential-operation"><span class="header-section-number">21.2.1</span> Differential Operation</h3>
<p>The mole balances for a steady-state PFR are initial-value ordinary differential equations (IVODEs). As was the case with BSTRs in <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a>, it is possible to analyze PFR kinetics data using an approximate mole balance. This is known as the differential method of analysis of PFR data. Unlike differential analysis of BSTR data, if one plans to use the differential method of analysis for PFR data, then an additional restriction is imposed during the experiments. This requirement is that the molar flow rate <em>of each reagent</em> present in the feed should not change by more than ca. 5% between the inlet and the outlet of the reactor.</p>
</section>
</section>
<section id="design-of-pfr-experiments" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="design-of-pfr-experiments"><span class="header-section-number">21.3</span> Design of PFR Experiments</h2>
<p>It was noted in the preceding section that the operational procedure for generating kinetics data using a PFR is essentially the same as that for a CSTR. Both of these reactors are flow reactors, and consequently the adjusted inputs and experimental responses are the same. The space time determines the amount of time during which reaction can occur, and the space time is adjusted by varying individual reagent or total flow rates. In principle the reactor volume could also be varied to change space time, but doing so is impractical. The use of a temperature controller makes it easy to generate blocks of same-temperature kinetics data. In a PFR the composition changes continually as the reagents flow through the reactor. The composition and flow rate of the feed to the reactor can be varied so that the concentrations or partial pressures of the reagents each span their range of interest. As with BSTRs and CSTRs, the experimental response can be any quantity that is directly related to the composition of the fluid leaving the reactor or to the extent of reaction relative to the reactor feed.</p>
</section>
<section id="pfr-data-analysis" class="level2" data-number="21.4">
<h2 data-number="21.4" class="anchored" data-anchor-id="pfr-data-analysis"><span class="header-section-number">21.4</span> PFR Data Analysis</h2>
<p>This book considers analysis of PFR kinetics experiments wherein a single reaction occurs isothermally, isobarically, and at steady-state, and a single response is measured. The analysis procedure is identical to that used when analyzing data from a BSTR or from a CSTR. A model for the reactor, consisting of mole balances on each of the reagents, is generated. The PFR model is then used to generate a predicted response model. The predicted response model is fit to the experimental data, yielding estimates for each of the rate expression parameters, uncertainties for those estimates, and a coefficient of determination. The resulting model is used to generate a set of model-predicted responses for the experiments from which a parity plot ane residuals plots can be generated.</p>
<p>As was the case for analysis of BSTR and CSTR kinetics data, a concise summary of the assignment can be helpful. In this book the summary identifies the reactor and how it was operated (here as an isothermal, steady-state PFR) and presents a simple schematic of it. It lists the adjusted experimental inputs and the experimental response. The rate expression parameters, their uncertainties, the coefficient of determination, the model-predicted responses and the experiment residuals are listed as the quantities of interest. The summary concludes with a listing of the given and known constants that did not change in any of the experiments.</p>
<section id="the-steady-state-pfr-model" class="level3" data-number="21.4.1">
<h3 data-number="21.4.1" class="anchored" data-anchor-id="the-steady-state-pfr-model"><span class="header-section-number">21.4.1</span> The Steady-State PFR Model</h3>
<p>The PFR model is essentiall the same as in any assignment that involves modeling a PFR. Since the design equations are IVODEs, it is formulated by generating the design equations needed to model the experimental PFR, specifying the initial values and stopping criterion for solving the design equations numerically, defining a derivatives function that is also used when solving the design equations, and defining the PFR model function that solves the design equations numerically. The description that follows assumes that the axial distance from the PFR inlet is the independent variable in the design equations. If the cumulative reactor volume is being used instead, <span class="math inline">\(z\)</span> should be replaced with <span class="math inline">\(V\)</span> in the following discussion as described in <a href="section_4_pfr_analysis.html" class="quarto-xref"><span>Chapter 13</span></a>.</p>
<p><strong>Design Equations</strong> The PFR can be modeled using only mole balances because when the reactor operates isobarically and isothermally at a known temperature, the mole balances can be solved for the outlet molar flow rates of the reagents independently of the energy and momentum balances for the reactor. The PFR mole balance was derived in <a href="section_3_design_equations.html" class="quarto-xref"><span>Chapter 6</span></a>, and the steady-state version is given in <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>. Since this book only considers experiments where a single reaction occurs, the summation over the reactions reduces to a single term and it is not necessary to index the reaction, <a href="#eq-pfr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>21.4</span></a>.</p>
<p><span id="eq-pfr_mole_bal_one_reaction"><span class="math display">\[
\frac{d \dot{n}_i}{dz}  = \frac{\pi D^2}{4}\nu_{i}r
\tag{21.4}\]</span></span></p>
<p><strong>Initial Values and Stopping Criterion</strong> The independent variable in the PFR design equations is the axial distancce from the reactor inlet, so its initial values is zero. The dependent variables in the design equations are the molar flow rates of the reagents, so their initial values are the molar flow rates at the reactor inlet (where <span class="math inline">\(z\)</span> equals zero). In PFR kinetics experiments, the length of the reactor, <span class="math inline">\(L\)</span>, is known, so the stopping criterion is that <span class="math inline">\(z=L\)</span>.</p>
<p><strong>Derivatives Function</strong> In addition to the initial values and stopping criterion, a derivatives function is needed when solving the (IVODE) design equations. The derivatives function receives the axial position and molar flow rates of the reagents at the start of an integration step as its only arguments. Using them and any given and known constants, it must evaluate the derivatives in the design equations and return them.</p>
<p>As the predicted responses model is being fit to the experimental data, the fitting function will be varying the rate expression parameters. They appear in the design equations, so they need to be provided to the derivatives function. They cannot be passed to it as arguments, so they must be made available to it by some other means, and this should be indicated in the definitin of the PFR model function.</p>
<p>The last component of the derivatives function is its algorithm. That is, assuming the given and know constants, rate expression parameters, axial position and molar flow rates of the reagents are all available, it should list the sequence of calculations that are needed to evaluate the design equation derivatives.</p>
<p><strong>PFR Model Function</strong> The PFR model function solves the design equations numerically and returns the results. To accomplish this, it must calculate the initial and final values, make the current rate expression parameters available to the derivatives function, call an IVODE solver (passing to it the initial values, stopping criterion and derivatives function), and return the results. Some of the inputs to the PFR, i. e. the adjusted experimental inputs, will change from experiment to experiment. They are needed to calculate the initial values, so the adjusted experimental inputs for the experiment being analyzed should be indicated as arguments to the PFR model.</p>
<p>Before the PFR model calls the IVODE solver, it should make the rate expression parameters available to the derivatives function. To facilitate doing so, the rate expression parameters must also be arguments to the PFR model function. The return values for the PFR model should be listed as corresponding sets of values of <span class="math inline">\(z\)</span> and the molar flow rates of the reagents spanning the range from the inlet to the outlet of the reactor (which is what tht IVODE solver will return).</p>
</section>
<section id="the-predicted-response-model" class="level3" data-number="21.4.2">
<h3 data-number="21.4.2" class="anchored" data-anchor-id="the-predicted-response-model"><span class="header-section-number">21.4.2</span> The Predicted Response Model</h3>
<p>The purpose of the predicted response model is to use the PFR model to calculate the response for each of the experiments in the data set. In essence, the predicted responses model relates the predicted response for an experiment to the adjusted inputs and the rate expression parameters. The model includes a predicted responses function that is used by a numerical fitting function from a mathematics or statistics software package to fit the response model to the experimental data.</p>
<p><strong>Predicted Response</strong> The PFR model solves the design equations yielding the values of the molar flow rates of the reagents from the inlet to the outlet of the reactor. Recalling that the measured response is a quantity that is related to the reactor’s outlet composition, the results from solving the PFR design equations can be used to calculate a predicted value of the response.</p>
<p><strong>Predicted Responses Function</strong> As noted above, the predicted responses function will be used by a numerical fitting function from a mathematics or statistics software package. The numerical fitting function requires that the arguments to the predicted responses function are the rate expression parameters and the full set of adjusted experimental inputs, and nothing else. It aslo requires that the predicted responses function returns the model-predicated responses for all of the experiments, and nothing else.</p>
<p>The definition of the predicted responses function should indicate the arguments passed to it and the quantities it returns. When analyzing PFR data, no other variables need to be made available to the predicted repsonsed function, so its definition should conclude with its algorithm. The algorithm should simply solve the PFR design equations and calculate the predicted response for each experiment, and return the results.</p>
</section>
<section id="parameter-estimates-statistics-and-assessment-graphs" class="level3" data-number="21.4.3">
<h3 data-number="21.4.3" class="anchored" data-anchor-id="parameter-estimates-statistics-and-assessment-graphs"><span class="header-section-number">21.4.3</span> Parameter Estimates, Statistics and Assessment Graphs</h3>
<p>As was the case during analysis of BSTR kinetics data and CSTR kinetics data, the quantities of interest include the rate expression parameters, the uncertainty in the parameter estimates and the coefficient of determination. These quantities are found using a numerical fitting function from a mathematics or statistics software package. Its use is the same as when analyzing BSTR or CSTR data. The arguments to the fitting function are a guess for the rate expression parameters, the full set of adjusted experimental inputs, the full set of experimental responses, and the predicted responses function.</p>
<p>The other quantities of interest are the model-predicted responses for the final model and the experiment residuals. The model-predicted responses are calculated by passing the parameter estimates and the full set of adjusted experimental inputs to the predicted responses function. The experiment residuals are then calculated as the difference between the experimental responses and the model-predicted responses.</p>
<p>A parity plot and residuals plots are then generated for use in assessing the accuracy of the final rate expression. In the parity plot the measured responses are plotted <em>vs.</em> the predicted responses as points along with a parity line (predicted response equal to measured response). In residuals plots the experiment residuals are plotted separately <em>vs.</em> each of the adjusted experimental inputs.</p>
</section>
<section id="accuracy-assessment" class="level3" data-number="21.4.4">
<h3 data-number="21.4.4" class="anchored" data-anchor-id="accuracy-assessment"><span class="header-section-number">21.4.4</span> Accuracy Assessment</h3>
<p>Accuracy is assessed as for the other data types. If the rate expression is accurate, the following criteria will be satisfied.</p>
<ul>
<li>The coefficient of determination, <span class="math inline">\(R^2\)</span>, will be close to 1.</li>
<li>The points in the parity plot will all be close to the parity line.</li>
<li>In each residuals plot, the points will scatter randomly about zero (the horizontal axis), and no systematic deviations will be apparent.</li>
<li>The uncertainty in most, if not all, parameter estimates will be small compared to their estimated value. (See <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> for a discussion of why a few estimates may have a large uncertaintly.)</li>
</ul>
</section>
<section id="analysis-using-a-linearized-model" class="level3" data-number="21.4.5">
<h3 data-number="21.4.5" class="anchored" data-anchor-id="analysis-using-a-linearized-model"><span class="header-section-number">21.4.5</span> Analysis Using a Linearized Model</h3>
<p>When only one reaction is taking place, as is always the case in <em>Reaction Engineering Basics</em> kinetics data analysis problems, the reactor can be modeled using only one mole balance on a reactant or product in the reaction. When this is done, the extent of reaction is used to relate the amounts of all other reagents to the reagent for which the mole balance is written. Sometimes the single mole balance can be solved analytically, for example by separation of variables. Doing so yields an integrated mole balance that is an ATE. If the integrated mole balance can be rearranged into a linear form, the model can be fit to the experimental data using linear least squares. This was described and discussed in <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> and illustrated in <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a> and won’t be repeated or illustrated in this chapter.</p>
</section>
<section id="analysis-using-an-approximate-reactor-model" class="level3" data-number="21.4.6">
<h3 data-number="21.4.6" class="anchored" data-anchor-id="analysis-using-an-approximate-reactor-model"><span class="header-section-number">21.4.6</span> Analysis Using an Approximate Reactor Model</h3>
<p>This approach, commonly referred to as <strong>differential data analysis</strong>, is completely analogous to differential analysis of BSTR data. The one significant difference is that to use differential data analysis with PFR data, the reactor must have been operated differentially when the data were generated as described above. The approximated mole balance given in <a href="#eq-differential_pfr_mole_bal" class="quarto-xref">Equation&nbsp;<span>21.5</span></a> is typically linearized and the analysis is performed using linear least squares often in a spreadsheet. In most cases, differential analysis is less accurate than the other methods of analysis. Since differential data analysis was illustrated in <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a>, it is not repeated in the examples of this chapter.</p>
<p><span id="eq-differential_pfr_mole_bal"><span class="math display">\[
\frac{d \dot{n}_i}{dz}  = \frac{\pi D^2}{4}\nu_{i}r \qquad \Rightarrow \qquad \frac{\dot{n}_{i,1} - \dot{n}_{i,0}}{L} = \frac{\pi D^2}{4}\nu_{i}r
\tag{21.5}\]</span></span></p>
</section>
</section>
<section id="examples" class="level2" data-number="21.5">
<h2 data-number="21.5" class="anchored" data-anchor-id="examples"><span class="header-section-number">21.5</span> Examples</h2>
<p>The analysis of kinetics data from a PFR is nearly identical to the analysis of BSTR kinetics data as described and illustrated in <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a>. For both data types the reactor design equations are IVODEs, so the mathematics are the same. One difference is associated with gas phase reactions where the total number of moles changes. In a BSTR this causes the pressure to change as the reaction proceeds (see <a href="section_6_bstr_data_analysis.html#sec-example_19_5_3" class="quarto-xref">Example&nbsp;<span>19.5.3</span></a>). Assuming no pressure drop, in a PFR the volumetric flow rate will change as the reaction proceeds. This is illustrated in <a href="#sec-example_21_5_1" class="quarto-xref">Example&nbsp;<span>21.5.1</span></a>. When analyzing PFR kinetics data the cumulative volume of the reactor or the mass of catalyst in the reactor is sometimes used as the independent variable in the design equations. Doing so is illustrated in Examples -<a href="#sec-example_21_5_2" class="quarto-xref"><span>Section 21.5.2</span></a> and -<a href="#sec-example_21_5_3" class="quarto-xref"><span>Section 21.5.3</span></a>.</p>
<section id="sec-example_21_5_1" class="level3" data-number="21.5.1">
<h3 data-number="21.5.1" class="anchored" data-anchor-id="sec-example_21_5_1"><span class="header-section-number">21.5.1</span> Kinetics of Gas-Phase Decomposition</h3>
<p>The gas-phase decomposition of reagent A, reaction (1), was studied at 1500 K and 1 atm using a PFR with a diameter of 1.0 cm and a length of 10 cm. The inlet volumetric flow rates of reagents A, Y, and Z, in standard cm<sup>3</sup> min<sup>-1</sup>, were varied from experiment to experiment. In all experiments the outlet conversion of reagent A was measured. The data are presented below. Using those data, estimate the best value for the rate coefficient, <span class="math inline">\(k\)</span>, in equation (2) and assess the accuracy of the resulting rate expression.</p>
<p><span class="math display">\[
A \rightarrow Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = kP_A \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_21_5_1_data" class="quarto-xref">Table&nbsp;<span>21.1</span></a>; the full data set are available in the file, <a href="examples/reb_21_5_1/reb_21_5_1_data.csv">reb_21_5_1_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_21_5_1_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_1_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.1: First 8 of the 160 experimentally generated data.
</figcaption>
<div aria-describedby="tbl-example_21_5_1_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(\dot{V}_{A,0}\)</span> (sccm)</th>
<th style="text-align: center;"><span class="math inline">\(\dot{V}_{Y,0}\)</span> (sccm)</th>
<th style="text-align: center;"><span class="math inline">\(\dot{V}_{Z,0}\)</span> (sccm)</th>
<th style="text-align: center;">f<sub>A</sub> (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">30</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">98.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">30</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">90.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">30</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">85.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">30</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">73.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">30</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">93.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">30</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">82.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">30</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">76.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">30</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">65.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The assignment narrative describes reactor experiments, provides the data generated in those experiments, and asks me to use them to assess the accuracy of a proposed rate expression. Those are distinguishing characteristics of a kinetics data analysis assignment.</p>
<p>I’ll begin by summarizing the assignment. I’ll assign an appropriate variable symbol to represent each of the quantities provided in the assignment. While doing so I will use a subscripted “0” to denote a quantity value at the inlet to the reactor and a subscripted “1” to denote one at the outlet. I’ll use subscripted “CI,l” and “CI,u” to denote values that are the lower or upper limit of a 95% confidence interval. I’ll underline a variable symbol if it represents a set of values (i. e. a vector).</p>
<p>In the experiments for this assignment, a PFR that operated isothermally and at steady-state was used. The adjusted experimental inputs were the inlet volumetric flow rates of the reagents and the measured response was the conversion. Fitting the responses model to the experimental data will yield the rate coefficient, the 95% confidence interval for the rate coefficient and the coefficient of determination, so I’ll list them as quantities of interest. A parity plot and residuals plots will help me assess the accuracy of the proposed rate expression. To make those plots, I’ll need the model-predicted responses and the experiment residuals for the experiments, so I’ll list them as quantities of interest, as well.</p>
</div>
</div>
</div>
<section id="assignment-summary" class="level4" data-number="21.5.1.1">
<h4 data-number="21.5.1.1" class="anchored" data-anchor-id="assignment-summary"><span class="header-section-number">21.5.1.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, steady-state PFR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_21_5_1_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_1_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/pfr_kinetics_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_1_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.1: Schematic representation of the PFR used in the experiments.
</figcaption>
</figure>
</div>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{\dot{V}}_{A,0}\)</span>, <span class="math inline">\(\underline{\dot{V}}_{Y,0}\)</span>, and <span class="math inline">\(\underline{\dot{V}}_{Z,0}\)</span></p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{f}_A\)</span></p>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k\)</span>, <span class="math inline">\(k_{CI,l}\)</span>, <span class="math inline">\(k_{CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{f}_A\)</span> <em>vs.</em> <span class="math inline">\(\underline{f}_{A,model}\)</span> as a parity plot, <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}_{Y,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}_{Z,0}\)</span> as residuals plots.</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(T\)</span> = 1500 K, <span class="math inline">\(P\)</span> = 1 atm., <span class="math inline">\(D\)</span> = 1 cm, and <span class="math inline">\(L\)</span> = 10 cm.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a kinetics data analysis assignment, and I know that to complete it I will need a predicted response model that relates the rate expression parameters and the adjusted experimental inputs for any one experiment to the measured response from that experiment. I can begin to generate the predicted response model by generating a model for the PFR used in the experiments. The PFR model relates the rate expression parameters and the adjusted experimental inputs to the molar flow rates of the reagents between the reactor inlet and outlet. To generate the predicted responses model I can solve the PFR design equations, and use the resulting outlet molar flow rates to calculate the response.</p>
<p>Once I have a predicted response model, I can fit it to the experimental data to get estimates and uncertainties for the parameters and the coefficient of determination. Using the estimated parameters in the predicted responses model will generate the model-predicated responses for the experiments, and those can be used to calculate the experiment residuals. That will allow me to generate a parity plot and residuals plot.</p>
<p>To complete the assignment I can assess the accuracy of the rate expression by noting that for an accurate model the following criteria are satisfied:</p>
<p>The coefficient of determination is close to 1.0. The points in the parity plot are close to the parity line. The points in the residuals plots scatter randomly about zero with no apparent trends or systematic deviations. The lower and upper limits of the 95% confidence interval for most, if not all, of the rate expression parameters close to their estimated values.</p>
</div>
</div>
</div>
<center>
<strong>Task List</strong>
</center>
<ol type="1">
<li>Develop the PFR model.</li>
<li>Using the PFR model, develop a predicted responses model.</li>
<li>Fit the predicted responses model to the experimental data.</li>
<li>Generate a parity plot and residuals plots.</li>
<li>Assess the accuracy of the rate expression.</li>
</ol>
</section>
<section id="mathematical-formulation-of-the-analysis" class="level4" data-number="21.5.1.2">
<h4 data-number="21.5.1.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-analysis"><span class="header-section-number">21.5.1.2</span> Mathematical Formulation of the Analysis</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I’ll start to formulate a model for the PFR used in the experiments by selecting the design equations I need and simplifying them appropriately for this reactor. The general PFR mole balance is given by <a href="section_3_design_equations.html#eq-pfr_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.33</span></a>, but when the reactor operates at steady-state the time derivatives are equal to zero an the spatial derivatives become ordinary derivatives as in <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>. Here there is only one reaction taking place, so the summation over the reactions reduces to a single term and it isn’t necessary to index the reaction, as shown below.</p>
<p><span class="math display">\[
\frac{d \dot n_i}{d z} =\frac{\pi D^2}{4}\nu_{i}r
\]</span></p>
<p>When a PFR operates isothermally at a known temperature and with negligible pressure drop, the mole balance design equations can be solved independently of the energy and momentum balances. Doing so yields the molar flow rates within and at the outlet of the reactor which is all that is needed for kinetics data analysis. So the mole balances for each of the reagents are the only design equations needed.</p>
<p>The mole balances are IVODEs, and to solve them numerically using an IVODE solver I will need initial values for all variables and a stopping criterion. I can define <span class="math inline">\(z\)</span> to equal zero at the reactor inlet in which case the other initial values are the molar flow rate of each of the ragents at the reactor inlet. I know the length of the reactor, so <span class="math inline">\(z = L\)</span> can be used as the stopping criterion.</p>
</div>
</div>
</div>
<center>
<strong>Steady-State, Isothermal PFR Model</strong>
</center>
<p><strong>Design Equations</strong></p>
<p><span class="math display">\[
\frac{d\dot{n}_A}{dz} = -\frac{\pi D^2}{4}r \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_Y}{dz} = \frac{\pi D^2}{4}r \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_Z}{dz} = \frac{\pi D^2}{4}r \tag{5}
\]</span></p>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_21_5_1_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20, 40, 40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_1_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.2: Initial values and stopping criterion for solving the design equations, (3), (4), (5).
</figcaption>
<div aria-describedby="tbl-example_21_5_1_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(L\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{Y,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{Z,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In addition to the initial values and stopping criterion, I will need to write a derivatives function and provide it to the IVODE solver (see <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix J</span></a>). The derivatives function will be called by an IVODE solver from a mathematics software package. For that reason, the the independent and dependent variables must be the only arguments passed to the derivatives function, and it must return the corresponding values of the design equation derivatives and nothing else.</p>
<p>So, the deerivatives function will be given values for <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span>, and using them, it must evaluate the right-hand sides of equations (3) - (5) and return the results. Of course, I can use the known constants given in the assignment narrative, but if any other input is needed, it must be provided by some means other than as an argument.</p>
<p>Looking at the right-hand sides of equations (3) - (5) I see that I will need <span class="math inline">\(D\)</span> and <span class="math inline">\(r\)</span>. The tube diameter, <span class="math inline">\(D\)</span>, is a given and known constant, but <span class="math inline">\(r\)</span> will need to be calculated. The rate expression, equation (2) can be used to calculate <span class="math inline">\(r\)</span>, but that, in turn, requires <span class="math inline">\(k\)</span> and <span class="math inline">\(P_A\)</span>. As the responses model is being fit to the experimental data, the fitting function will be varying the value of <span class="math inline">\(k\)</span>. As such, it cannot be calculated and must be made available to the derivatives function. The partial pressure of reagent A can be calculated within the derivatives function. It is simply the mole fraction of A times the pressure.</p>
</div>
</div>
</div>
<p><strong>Derivatives Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\frac{d\dot{n}_A}{dz}\)</span>, <span class="math inline">\(\frac{d\dot{n}_Y}{dz}\)</span>, and <span class="math inline">\(\frac{d\dot{n}_Z}{dz}\)</span>.</p>
<p><u>Must be Available</u>: <span class="math inline">\(k\)</span>.</p>
<p><u>Algorithm</u>:</p>
<p><span class="math display">\[
P_A = \frac{\dot{n}_A}{\dot{n}_A+\dot{n}_Y + \dot{n}_Z}P \tag{6}
\]</span></p>
<p><span class="math display">\[
r = kP_A \tag{2}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_A}{dz} = -\frac{\pi D^2}{4}r \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_Y}{dz} = \frac{\pi D^2}{4}r \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_Z}{dz} = \frac{\pi D^2}{4}r \tag{5}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To complete the PFR model I need to write a model function that solves the design equations for any one experiment. It will need to receive the adjusted experimental inputs for that experiment and the current value of <span class="math inline">\(k\)</span> as arguments. It should return the solution of the design equations, that is, corresponding sets of values of the independent variable (<span class="math inline">\(z\)</span>) and the dependent variables (<span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span>) spanning the range from the reactor inlet to the reactor outlet.</p>
<p>To do so, it must first make <span class="math inline">\(k\)</span> available to the derivatives function since <span class="math inline">\(k\)</span> cannot be passed to the derivatives function as an argument. Next it should evaluate any of the initial and final values in <a href="#tbl-example_21_5_1_initial_values" class="quarto-xref">Table&nbsp;<span>21.2</span></a> that aren’t known constants. Here the reactor length is a known constant, but the inlet molar flow rates need to be calculated. Doing so simply involves dividing the inlet volumetric flow rates for the current experiment by the molar volume at standard conditions, <span class="math inline">\(\hat{V}_{STP}\)</span>.</p>
<p>It can then get the solution of the design equations by calling an IVODE solver, passing the initial values, stopping criterion and derivatives function as arguments.</p>
</div>
</div>
</div>
<p><strong>PFR Model Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(\dot{V}_{A,0}\)</span>, <span class="math inline">\(\dot{V}_{Y,0}\)</span>, <span class="math inline">\(\dot{V}_{Z,0}\)</span>, and <span class="math inline">\(k\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\underline{z}\)</span>, <span class="math inline">\(\underline{\dot{n}}_A\)</span>, <span class="math inline">\(\underline{\dot{n}}_Y\)</span> and <span class="math inline">\(\underline{\dot{n}}_Z\)</span> spanning the range from the reactor inlet to the reactor outlet.</p>
<p><u>Algorithm</u>:</p>
<ol type="1">
<li>Make <span class="math inline">\(k\)</span> available to the derivatives function.</li>
<li>Calculate the unknown initial and final values in <a href="section_4_cstr_analysis.html#tbl-example_12_7_5_initial_values" class="quarto-xref">Table&nbsp;<span>12.2</span></a>.</li>
</ol>
<p><span class="math display">\[
\dot{n}_{A,0} = \frac{\dot{V}_{A,0}}{\hat{V}_{\text{ STP}}} \tag{7}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Y,0} = \frac{\dot{V}_{Y,0}}{\hat{V}_{\text{ STP}}} \tag{8}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,in} = \frac{\dot{V}_{Z,0}}{\hat{V}_{\text{ STP}}} \tag{9}
\]</span></p>
<ol start="3" type="1">
<li>Get corresponding sets of values <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span> spanning the range from the reactor inlet to the reactor outlet by calling an IVODE solver, passing the intial values, stopping criterion and derivatives function as arguments.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Having developed a model for the PFR used in the experiments, my next task is to use it to develop a predicted response model that can be fit to the experimental data. The predicted response model must relate the measured response to the rate expression parameters and the adjusted experimental inputs. The PFR model relates the outlet molar flow rates to the rate expression parameters and the adjusted experimental inputs, so all I need is equations that relate the outlet molar flow rates to the measured response. The measured response is the conversion of A. By definition, it is equal to the inlet molar flow rate of A minus the outlet molar flow rate of A divided by the inlet molar flow rate.</p>
<p>I will use a numerical fitting function from a mathematics or statistics software package to fit the predicted response model to the experimental data (see <a href="apndx_estimate_parameters.html" class="quarto-xref"><span>Appendix L</span></a>). One of the things I will need to provide to it is a predicted responses function, that I must write. The predicted responses function will be called by the numerical fitting function, and it assumes that the only arguments to the predicted responses function are the adjusted experimental inputs and the rate expression parameters and that the predicted responses function returns the model predicted responses for all of the experiments and nothing else. I can use the known constants given the assignment narrative within the predicted function, but if it requires any other input, I will need to provide that by some means other than as an argument.</p>
<p>Writing the predicted responses function is straightforward. It simply needs to go through the experiments one by one calling the PFR model function and using the the results it returns to calculate the model-predicted response, <span class="math inline">\(f_A\)</span>. After doing this for each experiment, the full set of model-predicated responses can be returned.</p>
</div>
</div>
</div>
<center>
<strong>Predicted Response Model</strong>
</center>
<p><strong>Predicted Response</strong></p>
<p><span class="math display">\[
\dot{n}_{A,0} = \frac{\dot{V}_{A,0}}{\hat{V}_{\text{ STP}}} \tag{7}
\]</span></p>
<p><span class="math display">\[
f_A = \frac{\dot{n}_{A,0} - \dot{n}_A \big \vert_{z=L}}{\dot{n}_{A,0}} \tag{10}
\]</span></p>
<p><strong>Predicted Responses Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(k\)</span>, <span class="math inline">\(\underline{\dot{V}}_{A,0}\)</span>, <span class="math inline">\(\underline{\dot{V}}_{Y,0}\)</span>, and <span class="math inline">\(\underline{\dot{V}}_{Z,0}\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\underline{f}_{A,model}\)</span>.</p>
<p><u>Algorithm</u>:</p>
<ol type="1">
<li><p>For each experiment in the data set:</p>
<ol type="a">
<li><p>Get <span class="math inline">\(\underline{z}\)</span>, <span class="math inline">\(\underline{\dot{n}}_A\)</span>, <span class="math inline">\(\underline{\dot{n}}_Y\)</span> and <span class="math inline">\(\underline{\dot{n}}_Z\)</span> by calling the PFR model function passing <span class="math inline">\(\dot{V}_{A,0}\)</span>, <span class="math inline">\(\dot{V}_{Y,0}\)</span>, <span class="math inline">\(\dot{V}_{Z,0}\)</span>, and <span class="math inline">\(k\)</span> as arguments</p></li>
<li><p>Calculate the predicted response using equations (7) and (10).</p></li>
</ol></li>
<li><p>Return <span class="math inline">\(\underline{f}_{A,model}\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now that I have generated the PFR model function and the predicted responses function, most of the remaining tasks can be accomplished simply by making function calls. To estimate the rate expression parameters, parameter uncertainties and get the coefficient of determination, I simply need to make guesses for the rate expression parameters and call the numerical fitting function. Once I’ve done that, all I need to do to generate the data for the parity and residuals plots is to call the predicted responses function using the final parameter estimates and then calculate the experiment residuals.</p>
</div>
</div>
</div>
<center>
<strong>Parameter Estimates and Statistics</strong>
</center>
<ol type="1">
<li><p>Define a guess for <span class="math inline">\(k_{guess}\)</span>.</p></li>
<li><p>Get <span class="math inline">\(k\)</span>, <span class="math inline">\(k_{CI,l}\)</span>, <span class="math inline">\(k_{CI,u}\)</span>, and <span class="math inline">\(R^2\)</span> by calling a numerical fitting function, passing the guess, <span class="math inline">\(k_{guess}\)</span>, the adjusted experimental inputs (<span class="math inline">\(\underline{\dot{V}}_{A,0}\)</span>, <span class="math inline">\(\underline{\dot{V}}_{Y,0}\)</span>, and <span class="math inline">\(\underline{\dot{V}}_{Z,0}\)</span>), the experimental responses (<span class="math inline">\(\underline{f}_A\)</span>) and the predicted responses function as arguments.</p></li>
</ol>
<center>
<strong>Assessment Graphs</strong>
</center>
<ol type="1">
<li><p>Get <span class="math inline">\(\underline{f}_{A,model}\)</span> by calling the predicted repsonses function passing the estimated parameter, <span class="math inline">\(k\)</span>, and the adjusted experimental inputs, <span class="math inline">\(\underline{\dot{V}}_{A,0}\)</span>, <span class="math inline">\(\underline{\dot{V}}_{Y,0}\)</span>, and <span class="math inline">\(\underline{\dot{V}}_{Z,0}\)</span>, as arguments.</p></li>
<li><p>Calculate the experiment residuals.</p></li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{f}_{A,model} - \underline{f}_A \tag{11}
\]</span></p>
<ol start="3" type="1">
<li><p>Generate a parity plot showing <span class="math inline">\(\underline{f}_A\)</span> <em>vs.</em> <span class="math inline">\(\underline{f}_{A,model}\)</span> as points and <span class="math inline">\(\underline{f}_A\)</span> = <span class="math inline">\(\underline{f}_{A,model}\)</span> as the parity line.</p></li>
<li><p>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}_{Y,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}_{Z,0}\)</span>.</p></li>
</ol>
<center>
<strong>Calculations Summary</strong>
</center>
<ol type="1">
<li><p>Read the adjusted experimental inputs and the experimental responses from the file, <a href="examples/reb_21_5_1/reb_21_5_1_data.csv">reb_21_5_1_data.csv</a>.</p></li>
<li><p>Calculate the parameter estimates and statistics and generate the assessment graphs as described above.</p></li>
<li><p>Display the results and/or save them to a file.</p></li>
</ol>
</section>
<section id="results-analysis-and-discussion" class="level4" data-number="21.5.1.3">
<h4 data-number="21.5.1.3" class="anchored" data-anchor-id="results-analysis-and-discussion"><span class="header-section-number">21.5.1.3</span> Results, Analysis, and Discussion</h4>
<p>The calculations were performed as described above except that the base-10 log of <span class="math inline">\(k\)</span> was estimated instead of estimating <span class="math inline">\(k\)</span> directly (see <a href="section_6_data_generation.html#sec-example_18_6_2" class="quarto-xref">Example&nbsp;<span>18.6.2</span></a>). The fitting results are shown in <a href="#tbl-example_21_5_1_results" class="quarto-xref">Table&nbsp;<span>21.3</span></a>, and the parity plot and residuals plots are shown in <a href="#fig-example_21_5_1_plots" class="quarto-xref">Figure&nbsp;<span>21.2</span></a>.</p>
<div class="cell">
<div id="tbl-example_21_5_1_results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_1_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.3: Parameter estimation results
</figcaption>
<div aria-describedby="tbl-example_21_5_1_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">k</td>
<td style="text-align: center;">1.49 x 10<sup>-3</sup> mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-1</sup>, 95% CI [1.49 x 10<sup>-3</sup>, 1.5 x 10<sup>-3</sup>]</td>
</tr>
<tr class="even">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.993</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="fig-example_21_5_1_plots" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_1_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_1/reb_21_5_1_parity.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_1/reb_21_5_1_A_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_1/reb_21_5_1_Y_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_1/reb_21_5_1_Z_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_1_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.2: Parity and Residuals Plots.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By all criteria, the rate expression appears to be very accurate. The coefficient of determination is close to 1.0, the upper and lower limits of the 95% confidence interval for <span class="math inline">\(k\)</span> are very close to the value of <span class="math inline">\(k\)</span>, the points in the parity plot are all very close to the diagonal line, and in each of the residuals plots the scatter is random with no apparent trends.</p>
</div>
</div>
</div>
<center>
<strong>Assessment</strong>
</center>
<p>When the rate coefficient in <a href="#tbl-example_21_5_1_results" class="quarto-xref">Table&nbsp;<span>21.3</span></a> is used in the proposed rate expression, it is acceptably accurate.</p>
<hr>
</section>
</section>
<section id="sec-example_21_5_2" class="level3" data-number="21.5.2">
<h3 data-number="21.5.2" class="anchored" data-anchor-id="sec-example_21_5_2"><span class="header-section-number">21.5.2</span> Power-Law Kinetics of a Heterogeneous Catalytic Reaction</h3>
<p>Reversible, gas-phase reaction (1) was studied in a PFR at 1 atm and 400 °C. In all experiments the same amount of catalyst, 3.0 g, was present in the reactor, forming a small packed bed. The apparent density of the catalyst bed was constant, and pressure drop across the catalyst bed was negligible. The inlet volumetric flow rate was also the same in all experiments and equal to 0.85 L min<sup>-1</sup> at standard temperature and pressure. The inlet mole fractions of A, B, Y, and Z were varied in the experiments and the partial pressure of A at the reactor outlet was recorded. Use the resulting data presented below to assess the accuracy of the power-law rate expression shown in equation (2). The equilibrium constant, <span class="math inline">\(K\)</span>, in equation (2) can be calculated from available thermodynamic data, and at 400 °C it has a value of 12.2.</p>
<p><span class="math display">\[
A + B \rightarrow Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = kP_{A}^{\alpha_A}P_{B}^{\alpha_B}P_{Y}^{\alpha_Y}P_{Z}^{\alpha_Z}\left( 1 - \frac{P_YP_Z}{KP_AP_B} \right) \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_21_5_2_data" class="quarto-xref">Table&nbsp;<span>21.4</span></a>; the full data set are available in the file, <a href="examples/reb_21_5_2/reb_21_5_2_data.csv">reb_21_5_2_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_21_5_2_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_2_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.4: First 8 of the 64 experimentally generated data.
</figcaption>
<div aria-describedby="tbl-example_21_5_2_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">y<sub>A,0</sub></th>
<th style="text-align: center;">y<sub>B,0</sub></th>
<th style="text-align: center;">y<sub>Y,0</sub></th>
<th style="text-align: center;">y<sub>Z,0</sub></th>
<th style="text-align: center;">P<sub>A,1</sub> (atm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.155</td>
<td style="text-align: center;">0.314</td>
<td style="text-align: center;">0.256</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.234</td>
<td style="text-align: center;">0.234</td>
<td style="text-align: center;">0.267</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.310</td>
<td style="text-align: center;">0.159</td>
<td style="text-align: center;">0.265</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.350</td>
<td style="text-align: center;">0.115</td>
<td style="text-align: center;">0.234</td>
<td style="text-align: center;">0.242</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.350</td>
<td style="text-align: center;">0.175</td>
<td style="text-align: center;">0.175</td>
<td style="text-align: center;">0.245</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.350</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.119</td>
<td style="text-align: center;">0.249</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.462</td>
<td style="text-align: center;">0.079</td>
<td style="text-align: center;">0.159</td>
<td style="text-align: center;">0.236</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.462</td>
<td style="text-align: center;">0.119</td>
<td style="text-align: center;">0.119</td>
<td style="text-align: center;">0.237</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The assignment narrative describes reactor experiments, provides the data generated in those experiments, and asks me to use them to assess the accuracy of a proposed rate expression. Those are distinguishing characteristics of a kinetics data analysis assignment.</p>
<p>I’ll begin by summarizing the assignment. I’ll assign an appropriate variable symbol to represent each of the quantities provided in the assignment. While doing so I will use a subscripted “0” to denote a quantity value at the inlet to the reactor, and a subscripted “1” to denote one at the outlet. I’ll use subscripted “CI,l” and “CI,u” to denote values that are the lower or upper limit of a 95% confidence interval. I’ll underline a variable symbol if it represents a set of values (i. e. a vector).</p>
<p>In the experiments for this assignment, a PFR that operated isothermally and at steady-state was used. The adjusted experimental inputs were the inlet mole fractions of the four reagents and the measured response was the outlet partial pressure of A.</p>
<p>All of the data in this assignment are at the same temperature. That means I can estimate the rate coefficient, <span class="math inline">\(k\)</span>, but not the Arrhenius parameters. I can also estimate the power-law exponents, so fitting the responses model to the experimental data will yield <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_Y\)</span>, and <span class="math inline">\(\alpha_Z\)</span>, so I’ll list them as quantities of interest. The coefficient of determination, <span class="math inline">\(R^2\)</span>, a parity plot, and residuals plots will help me assess the accuracy of the proposed rate expression. To make those plots, I’ll need the model-predicted responses and the experiment residuals for the experiments, so I’ll list them as quantities of interest, as well.</p>
</div>
</div>
</div>
<section id="assignment-summary-1" class="level4" data-number="21.5.2.1">
<h4 data-number="21.5.2.1" class="anchored" data-anchor-id="assignment-summary-1"><span class="header-section-number">21.5.2.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, steady-state PFR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_21_5_2_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/pfr_kinetics_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.3: Schematic representation of the PFR used in the experiments.
</figcaption>
</figure>
</div>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{y}_{A,0}\)</span>, <span class="math inline">\(\underline{y}_{B,0}\)</span>, <span class="math inline">\(\underline{y}_{Y,0}\)</span>, and <span class="math inline">\(\underline{y}_{Z,0}\)</span>.</p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{P}_{A,1}\)</span></p>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k\)</span>, <span class="math inline">\(k_{CI,l}\)</span>, <span class="math inline">\(k_{CI,u}\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_{A,CI,l}\)</span>, <span class="math inline">\(\alpha_{A,CI,u}\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_{B,CI,l}\)</span>, <span class="math inline">\(\alpha_{B,CI,u}\)</span>, <span class="math inline">\(\alpha_Y\)</span>, <span class="math inline">\(\alpha_{Y,CI,l}\)</span>, <span class="math inline">\(\alpha_{Y,CI,u}\)</span>, <span class="math inline">\(\alpha_Z\)</span>, <span class="math inline">\(\alpha_{Z,CI,l}\)</span>, <span class="math inline">\(\alpha_{Z,CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{P}_{A,1}\)</span> <em>vs.</em> <span class="math inline">\(\underline{P}_{A,1,model}\)</span> as a parity plot, <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{y}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{y}_{B,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{y}_{Y,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{y}_{Z,0}\)</span> as residuals plots.</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(T\)</span> = 400 °C, <span class="math inline">\(P\)</span> = 1 atm, <span class="math inline">\(m_{catalyst}\)</span> = 3.0 g, <span class="math inline">\(\dot{V}_{in}\)</span> = 0.85 L<sub>stp</sub> min<sup>-1</sup>, and <span class="math inline">\(K\)</span> = 12.2.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a kinetics data analysis assignment, and I know that to complete it I will need a predicted response model that relates the rate expression parameters and the adjusted experimental inputs for any one experiment to the measured response from that experiment. I can begin to generate the predicted response model by generating a model for the PFR used in the experiments. The PFR model relates the rate expression parameters and the adjusted experimental inputs to the molar flow rates of the reagents. To generate the predicted responses model I can solve the PFR design equations, and use the outlet molar flow rates to calculate the response.</p>
<p>Once I have a predicted response model, I can fit it to the experimental data to get estimates and uncertainties for the parameters and the coefficient of determination. Using the estimated parameters in the predicted responses model will generate the model-predicated responses for the experiments, and those can be used to calculate the experiment residuals. That will allow me to generate a parity plot and residuals plot.</p>
<p>To complete the assignment I can assess the accuracy of the rate expression by noting that for an accurate model the following criteria are satisfied:</p>
<p>The coefficient of determination is close to 1.0. The points in the parity plot are close to the parity line. The points in the residuals plots scatter randomly about zero with no apparent trends or systematic deviations. The lower and upper limits of the 95% confidence interval for most, if not all, of the rate expression parameters close to their estimated values.</p>
</div>
</div>
</div>
<center>
<strong>Task List</strong>
</center>
<ol type="1">
<li>Develop the PFR model.</li>
<li>Using the PFR model, develop a predicted responses model.</li>
<li>Fit the predicted responses model to the experimental data.</li>
<li>Generate a parity plot and residuals plots.</li>
<li>Assess the accuracy of the rate expression.</li>
</ol>
</section>
<section id="mathematical-formulation-of-the-analysis-1" class="level4" data-number="21.5.2.2">
<h4 data-number="21.5.2.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-analysis-1"><span class="header-section-number">21.5.2.2</span> Mathematical Formulation of the Analysis</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I’ll start to formulate a model for the PFR used in the experiments by selecting the design equations I need and simplifying them appropriately for this reactor. The general PFR mole balance is given by <a href="section_3_design_equations.html#eq-pfr_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.33</span></a>, but when the reactor operates at steady-state the time derivatives are equal to zero an the spatial derivatives become ordinary derivatives as in <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>. Here there is only one reaction taking place, so the summation over the reactions reduces to a single term and it isn’t necessary to index the reaction, as shown below.</p>
<p><span class="math display">\[
\frac{d \dot n_i}{d z} =\frac{\pi D^2}{4}\nu_{i}r
\]</span></p>
<p>In this assignment, however, the dimensions of the reactor are not provided, but instead, the catalyst mass. Therefore, I’ll need to change the independent variable to the cumulative catalyst mass. I can also normalize the rate per catalyst mass, in which case the design equations is given below.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{dm} = \nu_{i}r
\]</span></p>
<p>When a PFR operates isothermally at a known temperature and with negligible pressure drop, the mole balance design equations can be solved independently of the energy and momentum balances. Doing so yields the molar flow rates within and at the outlet of the reactor which is all that is needed for kinetics data analysis. So the mole balances for each of the reagents are the only design equations needed.</p>
<p>The mole balances are IVODEs, and to solve them numerically using an IVODE solver I will need initial values for all variables and a stopping criterion. At the inlet to the reactor, the cumulative mass will equal zero, giving the initial value for the independent variable. The other initial values are then the molar flow rate of each of the ragents at the reactor inlet. I know the final mass of catalyst, so <span class="math inline">\(m = m_{catalyst}\)</span> can be used as the stopping criterion.</p>
</div>
</div>
</div>
<center>
<strong>Isothermal, Steady-State PFR Model</strong>
</center>
<p><strong>Design Equations</strong></p>
<p><span class="math display">\[
\frac{d\dot{n}_A}{dm} = -r \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_B}{dm} = -r \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_Y}{dm} = r \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_Z}{dm} = r \tag{6}
\]</span></p>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_21_5_2_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20, 40, 40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.5: Initial values and stopping criterion for solving the design equations, equations (3) through (6).
</figcaption>
<div aria-describedby="tbl-example_21_5_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(m\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(m_{\text{catalyst}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{B,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{Y,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{Z,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In addition to the initial values and stopping criterion, I will need to write a derivatives function (see <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix J</span></a>). The derivatives function will be called by an IVODE solver from a mathematics software package. For that reason, the the independent and dependent variables must be the only arguments passed to the derivatives function, and it must return the corresponding values of the design equation derivatives and nothing else.</p>
<p>So, the derivatives function will be given values for <span class="math inline">\(m\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span>, and using them, it must evaluate the right-hand sides of equations (3) - (6) and return the results. Of course, I can use the known constants given in the assignment narrative, but if any other input is needed, it must be provided by some means other than as an argument.</p>
<p>The only variables on the right-hand sides of equations (3) - (6) is the rate, <span class="math inline">\(r\)</span>. It’s not a known constant, so it will need to be calculated. The rate expression, equation (2), can be used, but that requires <span class="math inline">\(k\)</span>, the power-law exponents, the partial pressures of the reagents and <span class="math inline">\(K\)</span>. As the responses model is being fit to the experimental data, the fitting function will be varying the value of <span class="math inline">\(k\)</span> and the power-law exponents, so they cannot be calculated and must be made available to the derivatives function. The equilibrium constant, <span class="math inline">\(K\)</span>, is a known constant. The partial pressures of the reagents can be calculated within the derivatives function. They are simply equal to the mole fraction of each reagent times the pressure.</p>
<p><span class="math display">\[
P_i = y_iP = \frac{\dot{n}_i}{sum_i\left(\dot{n}_i\right)}P
\]</span></p>
</div>
</div>
</div>
<p><strong>Derivatives Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(m\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\frac{\dot{n}_A}{dm}\)</span>, <span class="math inline">\(\frac{\dot{n}_B}{dm}\)</span>, <span class="math inline">\(\frac{\dot{n}_Y}{dm}\)</span>, and <span class="math inline">\(\frac{\dot{n}_Z}{dm}\)</span>.</p>
<p><u>Must be Available</u>: <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_Y\)</span>, and <span class="math inline">\(\alpha_Z\)</span>.</p>
<p><u>Algorithm</u>:</p>
<p><span class="math display">\[
P_A = \frac{\dot{n}_A}{\dot{n}_A++\dot{n}_B+\dot{n}_Y+\dot{n}_Z}P \tag{7}
\]</span></p>
<p><span class="math display">\[
P_B = \frac{\dot{n}_B}{\dot{n}_A++\dot{n}_B+\dot{n}_Y+\dot{n}_Z}P \tag{8}
\]</span></p>
<p><span class="math display">\[
P_Y = \frac{\dot{n}_Y}{\dot{n}_A++\dot{n}_B+\dot{n}_Y+\dot{n}_Z}P \tag{9}
\]</span></p>
<p><span class="math display">\[
P_Z = \frac{\dot{n}_Z}{\dot{n}_A++\dot{n}_B+\dot{n}_Y+\dot{n}_Z}P \tag{10}
\]</span></p>
<p><span class="math display">\[
r = kP_{A}^{\alpha_A}P_{B}^{\alpha_B}P_{Y}^{\alpha_Y}P_{Z}^{\alpha_Z}\left( 1 - \frac{P_YP_Z}{KP_AP_B} \right) \tag{2}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To complete the PFR model I need to write a model function that solves the design equations for any one experiment. It will need to receive the adjusted experimental inputs for that experiment and the current value of <span class="math inline">\(k\)</span> as arguments. It should return the solution of the design equations, that is, corresponding sets of values of the independent variable (<span class="math inline">\(m\)</span>) and the dependent variables (<span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span>) spanning the range from the reactor inlet to the reactor outlet.</p>
<p>To do so, it must first make <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_Y\)</span>, and <span class="math inline">\(\alpha_Z\)</span> available to the derivatives function since they cannot be passed to the derivatives function as arguments. Next it should evaluate any of the initial and final values in <a href="#tbl-example_21_5_1_initial_values" class="quarto-xref">Table&nbsp;<span>21.2</span></a> that aren’t known constants. Here the catalyst mass is a known constant, but the inlet molar flow rates need to be calculated. Doing so simply involves dividing the inlet volumetric flow rates for the current experiment by the molar volume at standard conditions, <span class="math inline">\(\hat{V}_{STP}\)</span> to get the total molar flow rate, and then multiplying that by the inlet mole fraction of each reagent.</p>
<p>It can then get the solution of the design equations by calling an IVODE solver, passing the initial values, stopping criterion and derivatives function as arguments.</p>
</div>
</div>
</div>
<p><strong>PFR Model Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_Y\)</span>, and <span class="math inline">\(\alpha_Z\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(y_{B,0}\)</span>, <span class="math inline">\(y_{Y,0}\)</span>, and <span class="math inline">\(y_{Z,0}\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\underline{m}\)</span>, <span class="math inline">\(\underline{\dot{n}}_A\)</span>, <span class="math inline">\(\underline{\dot{n}}_B\)</span>, <span class="math inline">\(\underline{\dot{n}}_Y\)</span>, and <span class="math inline">\(\underline{\dot{n}}_Z\)</span> spanning the range from the reactor inlet to the reactor outlet (where <span class="math inline">\(m=m_{catalyst}\)</span>).</p>
<p><u>Algorithm</u>:</p>
<ol type="1">
<li>Make <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_Y\)</span>, and <span class="math inline">\(\alpha_Z\)</span> available to the derivatives function.</li>
<li>Calculate the unknown initial anf final values in <a href="#tbl-example_21_5_2_initial_values" class="quarto-xref">Table&nbsp;<span>21.8</span></a>.</li>
</ol>
<p><span class="math display">\[
\dot{n}_{A,0} = y_{A,0}\frac{\dot{V}_{0}}{\hat{V}_{STP}} \tag{11}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,0} = y_{B,0}\frac{\dot{V}_{0}}{\hat{V}_{STP}} \tag{12}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Y,0} = y_{Y,0}\frac{\dot{V}_{0}}{\hat{V}_{STP}} \tag{13}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,0} = y_{Z,0}\frac{\dot{V}_{0}}{\hat{V}_{STP}} \tag{14}
\]</span></p>
<ol start="3" type="1">
<li>Get corresponding sets of <span class="math inline">\(m\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span> spanning the range from <span class="math inline">\(m=0\)</span> to <span class="math inline">\(m=m_{catalyst}\)</span> by callling an IVODE solver, passing the initial values, stopping criterion and derivatives function as arguments.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Having developed a model for the PFR used in the experiments, my next task is to use it to develop a predicted response model that can be fit to the experimental data. The predicted response model must relate the measured response to the rate expression parameters and the adjusted experimental inputs. The PFR model relates the outlet molar flow rates to the rate expression parameters and the adjusted experimental inputs, so all I need is equations that relate the outlet molar flow rates to the measured response. The measured response is the outlet partial pressure of A. By definition, it is equal to the outlet mole fraction of A times the total pressure.</p>
<p>I will use a numerical fitting function from a mathematics or statistics software package to fit the predicted response model to the experimental data (see <a href="apndx_estimate_parameters.html" class="quarto-xref"><span>Appendix L</span></a>). One of the things I will need to provide to it is a predicted responses function, that I must write. The predicted responses function will be called by the numerical fitting function, and it assumes that the only arguments to the predicted responses function are the adjusted experimental inputs and the rate expression parameters, and that the predicted responses function returns the model predicted responses for all of the experiments and nothing else. I can use the known constants given the assignment narrative within the predicted function, but if it requires any other input, I will need to provide that by some means other than as an argument.</p>
<p>Writing the predicted responses function is straightforward. It simply needs to go through the experiments one by one calling the PFR model function and using the the results it returns to calculate the model-predicted response, <span class="math inline">\(P_{A,1,model}\)</span>. After doing this for each experiment, the full set of model-predicated responses can be returned.</p>
</div>
</div>
</div>
<center>
<strong>Predicted Response Model</strong>
</center>
<p><strong>Predicted Response</strong></p>
<p><span class="math display">\[
P_{A,1,model} = \frac{\dot{n}_{A}\Big\vert_{m=m_{catalyst}}}{\left( \dot{n}_{A}\Big\vert_{m=m_{catalyst}} + \dot{n}_{B}\Big\vert_{m=m_{catalyst}} + \dot{n}_{Y}\Big\vert_{m=m_{catalyst}} + \dot{n}_{Z}\right)}P\Big\vert_{m=m_{catalyst}} \tag{15}
\]</span></p>
<p><strong>Predicted Responses Function</strong></p>
<p><u>Arguments</u>: , <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_Y\)</span>, and <span class="math inline">\(\alpha_Z\)</span>, <span class="math inline">\(\underline{y}_{A,0}\)</span>, <span class="math inline">\(\underline{y}_{B,0}\)</span>, <span class="math inline">\(\underline{y}_{Y,0}\)</span>, and <span class="math inline">\(\underline{y}_{Z,0}\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\underline{P}_{A,1,model}\)</span>.</p>
<p><u>Algorithm</u>:</p>
<ol type="1">
<li><p>For each experiment in the data set:</p>
<ol type="a">
<li><p>Get <span class="math inline">\(\underline{m}\)</span>, <span class="math inline">\(\underline{\dot{n}}_A\)</span>, <span class="math inline">\(\underline{\dot{n}}_B\)</span>, <span class="math inline">\(\underline{\dot{n}}_Y\)</span>, and <span class="math inline">\(\underline{\dot{n}}_Z\)</span> by calling the PFR model function passing <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_Y\)</span>, and <span class="math inline">\(\alpha_Z\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(y_{B,0}\)</span>, <span class="math inline">\(y_{Y,0}\)</span>, and <span class="math inline">\(y_{Z,0}\)</span> as arguments.</p></li>
<li><p>Calculate the predicted response using equation (15).</p></li>
</ol></li>
<li><p>Return <span class="math inline">\(\underline{P}_{A,1,model}\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now that I have generated the PFR model function and the predicted responses function, most of the remaining tasks can be accomplished simply by making function calls. To estimate the rate expression parameters, parameter uncertainties and get the coefficient of determination, I simply need to make guesses for the rate expression parameters and call the numerical fitting function. Once I’ve done that, all I need to do to generate the data for the parity and residuals plots is to call the predicted responses function using the final parameter estimates and then calculate the experiment residuals.</p>
</div>
</div>
</div>
<center>
<strong>Parameter Estimates and Statistics</strong>
</center>
<ol type="1">
<li><p>Define parameter guesses, <span class="math inline">\(k_{guess}\)</span>, <span class="math inline">\(\alpha_{A,guess}\)</span>, <span class="math inline">\(\alpha_{B,guess}\)</span>, <span class="math inline">\(\alpha_{Y,guess}\)</span>, and <span class="math inline">\(\alpha_{Z,guess}\)</span>.</p></li>
<li><p>Get <span class="math inline">\(k\)</span>, <span class="math inline">\(k_{CI,l}\)</span>, <span class="math inline">\(k_{CI,u}\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_{A,CI,l}\)</span>, <span class="math inline">\(\alpha_{A,CI,u}\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_{B,CI,l}\)</span>, <span class="math inline">\(\alpha_{B,CI,u}\)</span>, <span class="math inline">\(\alpha_Y\)</span>, <span class="math inline">\(\alpha_{Y,CI,l}\)</span>, <span class="math inline">\(\alpha_{Y,CI,u}\)</span>, <span class="math inline">\(\alpha_Z\)</span>, <span class="math inline">\(\alpha_{Z,CI,l}\)</span>, <span class="math inline">\(\alpha_{Z,CI,u}\)</span>, and <span class="math inline">\(R^2\)</span> by calling a numerical fitting function, passing the parameter guesses, the adjusted experimental inputs, the experimental responses, and the predicted responses function as arguments.</p></li>
</ol>
<center>
<strong>Assessment Graphs</strong>
</center>
<ol type="1">
<li><p>Get <span class="math inline">\(\underline{P}_{A,1,model}\)</span> by calling the predicted repsonses function passing the estimated parameters, <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_Y\)</span>, and <span class="math inline">\(\alpha_Z\)</span>, and the adjusted experimental inputs as arguments.</p></li>
<li><p>Calculate the experiment residuals.</p></li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{P}_{A,1,model} - \underline{P}_{A,1} \tag{16}
\]</span></p>
<ol start="3" type="1">
<li><p>Generate a parity plot showing <span class="math inline">\(\underline{P}_{A,1}\)</span> <em>vs.</em> <span class="math inline">\(\underline{P}_{A,1,model}\)</span> as points and <span class="math inline">\(\underline{P}_{A,1}\)</span> = <span class="math inline">\(\underline{P}_{A,1,model}\)</span> as the parity line.</p></li>
<li><p>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{y}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{y}_{B,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{y}_{Y,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{y}_{Z,0}\)</span>.</p></li>
</ol>
<center>
<strong>Calculations Summary</strong>
</center>
<ol type="1">
<li><p>Read the adjusted experimental inputs and the experimental responses from the file, <a href="examples/reb_21_5_2/reb_21_5_2_data.csv">reb_21_5_2_data.csv</a>.</p></li>
<li><p>Calculate the parameter estimates and statistics and generate the assessment graphs as described above.</p></li>
<li><p>Display the results and/or save them to a file.</p></li>
</ol>
</section>
<section id="results-analysis-and-discussion-1" class="level4" data-number="21.5.2.3">
<h4 data-number="21.5.2.3" class="anchored" data-anchor-id="results-analysis-and-discussion-1"><span class="header-section-number">21.5.2.3</span> Results, Analysis, and Discussion</h4>
<p>The calculations were performed as described above. The resulting values of the rate expression parameters, their 95% confidence intervals, and the coefficient of determination, <span class="math inline">\(R^2\)</span>, are shown in <a href="#tbl-example_21_5_2_results" class="quarto-xref">Table&nbsp;<span>21.6</span></a>. The parity plot is shown in <a href="#fig-example_21_5_2_parity" class="quarto-xref">Figure&nbsp;<span>21.4</span></a>, and the residuals plots are shown in <a href="#fig-example_21_5_2_residuals_plots" class="quarto-xref">Figure&nbsp;<span>21.5</span></a>.</p>
<div class="cell">
<div id="tbl-example_21_5_2_results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_2_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.6: Parameter estimation results
</figcaption>
<div aria-describedby="tbl-example_21_5_2_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">k</td>
<td style="text-align: center;">1.26 x 10<sup>-3</sup> mol g<sup>-1</sup> min<sup>-1</sup> atm<sup>-0.73</sup>, 95% CI [3.91 x 10<sup>-4</sup>, 4.04 x 10<sup>-3</sup>]</td>
</tr>
<tr class="even">
<td style="text-align: center;">α<sub>A</sub></td>
<td style="text-align: center;">0.98 , 95% CI [0.58, 1.4]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">α<sub>B</sub></td>
<td style="text-align: center;">0.32 , 95% CI [0.15, 0.5]</td>
</tr>
<tr class="even">
<td style="text-align: center;">α<sub>Y</sub></td>
<td style="text-align: center;">-0.57 , 95% CI [-0.77, -0.37]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">α<sub>Z</sub></td>
<td style="text-align: center;">-9.4 x 10<sup>-3</sup> , 95% CI [-0.2, 0.18]</td>
</tr>
<tr class="even">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.998</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="fig-example_21_5_2_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_2_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./examples/reb_21_5_2/reb_21_5_2_parity.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_2_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.4: Parity Plot.
</figcaption>
</figure>
</div>
<div id="fig-example_21_5_2_residuals_plots" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_2_residuals_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_2/reb_21_5_2_A_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_2/reb_21_5_2_B_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_2/reb_21_5_2_Y_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_2/reb_21_5_2_Z_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_2_residuals_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.5: Residuals Plots.
</figcaption>
</figure>
</div>
<p><strong>Assessment</strong></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The coefficient of determination is close to 1.0, the points on the parity plot lie close to the diagonal line, and the points in the residuals plots scatter randomly about zero. This suggests an accurate rate expression. However, the upper and lower limits of the 95% confidence intervals for the parameters are significant compated to the parameter values. This suggests some inaccuracy in the model.</p>
</div>
</div>
</div>
<p>Based upon the parity plot, residuals plots and coefficient of determination, the rate expression in equation (2) accurately predicts the experimental results when the parameters have the values shown in <a href="#tbl-example_21_5_2_results" class="quarto-xref">Table&nbsp;<span>21.6</span></a>. The confidence intervals are not narrow relative to the parameters’ values, but they are acceptable. It is possible that additional experiments at different conditions would tighten the confidence intervals for the parameters.</p>
<hr>
</section>
</section>
<section id="sec-example_21_5_3" class="level3" data-number="21.5.3">
<h3 data-number="21.5.3" class="anchored" data-anchor-id="sec-example_21_5_3"><span class="header-section-number">21.5.3</span> Mechanistic Kinetics of a Heterogeneous Catalytic Reaction</h3>
<p>In <a href="#sec-example_21_5_2" class="quarto-xref">Example&nbsp;<span>21.5.2</span></a>, kinetics data for reaction (1) that had been generated in a steady-state, isothermal PFR were used to assess the accuracy of a power-law rate expression. In those experiments the same amount of catalyst, 3.0 g, was present in the reactor, forming a small packed bed. The apparent density of the catalyst bed was constant, and pressure drop across the catalyst bed was negligible. The inlet volumetric flow rate was also the same in all experiments and equal to 0.85 L min<sup>-1</sup> at standard temperature and pressure. The inlet mole fractions of A, B, Y, and Z were varied in the experiments and the partial pressure of A at the reactor outlet was recorded. Use the data from that example to assess the accuracy of the mechanistic rate expression shown in equation (2). The equilibrium constant, <span class="math inline">\(K_1\)</span>, in equation (2) can be calculated from available thermodynamic data. At 400 °C the value of <span class="math inline">\(K_1\)</span> is 12.2.</p>
<p><span class="math display">\[
A + B \rightarrow Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = \frac{kP_{A}P_{B}}{1 + K_AP_A + K_BP_B + K_YP_Y + K_ZP_Z }\left( 1 - \frac{P_YP_Z}{K_1P_AP_B} \right) \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_21_5_3_data" class="quarto-xref">Table&nbsp;<span>21.7</span></a>; the full data set are available in the file, <a href="examples/reb_21_5_2/reb_21_5_2_data.csv">reb_21_5_2_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_21_5_3_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_3_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.7: First 8 of the 64 experimentally generated data.
</figcaption>
<div aria-describedby="tbl-example_21_5_3_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">y<sub>A,in</sub></th>
<th style="text-align: center;">y<sub>B,in</sub></th>
<th style="text-align: center;">y<sub>Y,in</sub></th>
<th style="text-align: center;">y<sub>Z,in</sub></th>
<th style="text-align: center;">P<sub>A,out</sub> (atm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.155</td>
<td style="text-align: center;">0.314</td>
<td style="text-align: center;">0.256</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.234</td>
<td style="text-align: center;">0.234</td>
<td style="text-align: center;">0.267</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.310</td>
<td style="text-align: center;">0.159</td>
<td style="text-align: center;">0.265</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.350</td>
<td style="text-align: center;">0.115</td>
<td style="text-align: center;">0.234</td>
<td style="text-align: center;">0.242</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.350</td>
<td style="text-align: center;">0.175</td>
<td style="text-align: center;">0.175</td>
<td style="text-align: center;">0.245</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.350</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.119</td>
<td style="text-align: center;">0.249</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.462</td>
<td style="text-align: center;">0.079</td>
<td style="text-align: center;">0.159</td>
<td style="text-align: center;">0.236</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">0.462</td>
<td style="text-align: center;">0.119</td>
<td style="text-align: center;">0.119</td>
<td style="text-align: center;">0.237</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The only difference between this assignment and the one from <a href="#sec-example_21_5_2" class="quarto-xref">Example&nbsp;<span>21.5.2</span></a> is the rate expression to be assessed. As a consequence, the rate expression parameters to be estimated in this assignment are different, as is the rate expression used in the derivatives function. So, apart from those two changes, I can use the same assignment summary and mathematical formulations as I used in the preceding example.</p>
</div>
</div>
</div>
<section id="assignment-summary-2" class="level4" data-number="21.5.3.1">
<h4 data-number="21.5.3.1" class="anchored" data-anchor-id="assignment-summary-2"><span class="header-section-number">21.5.3.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Isothermal, steady-state PFR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_21_5_2_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/pfr_kinetics_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.6: Schematic representation of the PFR used in the experiments.
</figcaption>
</figure>
</div>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{y}_{A,0}\)</span>, <span class="math inline">\(\underline{y}_{B,0}\)</span>, <span class="math inline">\(\underline{y}_{Y,0}\)</span>, and <span class="math inline">\(\underline{y}_{Z,0}\)</span>.</p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{P}_{A,1}\)</span></p>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k\)</span>, <span class="math inline">\(k_{CI,l}\)</span>, <span class="math inline">\(k_{CI,u}\)</span>, <span class="math inline">\(K_A\)</span>, <span class="math inline">\(K_{A,CI,l}\)</span>, <span class="math inline">\(K_{A,CI,u}\)</span>, <span class="math inline">\(K_B\)</span>, <span class="math inline">\(K_{B,CI,l}\)</span>, <span class="math inline">\(K_{B,CI,u}\)</span>, <span class="math inline">\(K_Y\)</span>, <span class="math inline">\(K_{Y,CI,l}\)</span>, <span class="math inline">\(K_{Y,CI,u}\)</span>, <span class="math inline">\(K_Z\)</span>, <span class="math inline">\(K_{Z,CI,l}\)</span>, <span class="math inline">\(K_{Z,CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{P}_{A,1}\)</span> <em>vs.</em> <span class="math inline">\(\underline{P}_{A,1,model}\)</span> as a parity plot, <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{y}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{y}_{B,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{y}_{Y,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{y}_{Z,0}\)</span> as residuals plots.</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(T\)</span> = 400 °C, <span class="math inline">\(P\)</span> = 1 atm, <span class="math inline">\(m_{catalyst}\)</span> = 3.0 g, <span class="math inline">\(\dot{V}_{in}\)</span> = 0.85 L<sub>stp</sub> min<sup>-1</sup>, and <span class="math inline">\(K\)</span> = 12.2.</p>
<center>
<strong>Task List</strong>
</center>
<ol type="1">
<li>Develop the PFR model.</li>
<li>Using the PFR model, develop a predicted responses model.</li>
<li>Fit the predicted responses model to the experimental data.</li>
<li>Generate a parity plot and residuals plots.</li>
<li>Assess the accuracy of the rate expression.</li>
</ol>
</section>
<section id="mathematical-formulation-of-the-analysis-2" class="level4" data-number="21.5.3.2">
<h4 data-number="21.5.3.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-analysis-2"><span class="header-section-number">21.5.3.2</span> Mathematical Formulation of the Analysis</h4>
<center>
<strong>Isothermal, Steady-State PFR Model</strong>
</center>
<p><strong>Design Equations</strong></p>
<p><span class="math display">\[
\frac{d\dot{n}_A}{dm} = -r \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_B}{dm} = -r \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_Y}{dm} = r \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_Z}{dm} = r \tag{6}
\]</span></p>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_21_5_2_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="[20, 40, 40]">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.8: Initial values and stopping criterion for solving the design equations, equations (3) through (6).
</figcaption>
<div aria-describedby="tbl-example_21_5_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(m\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(m_{\text{catalyst}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{B,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{Y,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{Z,0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><strong>Derivatives Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(m\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\frac{\dot{n}_A}{dm}\)</span>, <span class="math inline">\(\frac{\dot{n}_B}{dm}\)</span>, <span class="math inline">\(\frac{\dot{n}_Y}{dm}\)</span>, and <span class="math inline">\(\frac{\dot{n}_Z}{dm}\)</span>.</p>
<p><u>Must be Available</u>: <span class="math inline">\(k\)</span>, <span class="math inline">\(K_A\)</span>, <span class="math inline">\(K_B\)</span>, <span class="math inline">\(Y_Y\)</span>, and <span class="math inline">\(K_Z\)</span>.</p>
<p><u>Algorithm</u>:</p>
<p><span class="math display">\[
P_A = \frac{\dot{n}_A}{\dot{n}_A++\dot{n}_B+\dot{n}_Y+\dot{n}_Z}P \tag{7}
\]</span></p>
<p><span class="math display">\[
P_B = \frac{\dot{n}_B}{\dot{n}_A++\dot{n}_B+\dot{n}_Y+\dot{n}_Z}P \tag{8}
\]</span></p>
<p><span class="math display">\[
P_Y = \frac{\dot{n}_Y}{\dot{n}_A++\dot{n}_B+\dot{n}_Y+\dot{n}_Z}P \tag{9}
\]</span></p>
<p><span class="math display">\[
P_Z = \frac{\dot{n}_Z}{\dot{n}_A++\dot{n}_B+\dot{n}_Y+\dot{n}_Z}P \tag{10}
\]</span></p>
<p><span class="math display">\[
r = \frac{kP_{A}P_{B}}{1 + K_AP_A + K_BP_B + K_YP_Y + K_ZP_Z }\left( 1 - \frac{P_YP_Z}{K_1P_AP_B} \right) \tag{2}
\]</span></p>
<p><strong>PFR Model Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(k\)</span>, <span class="math inline">\(K_A\)</span>, <span class="math inline">\(K_B\)</span>, <span class="math inline">\(K_Y\)</span>, and <span class="math inline">\(K_Z\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(y_{B,0}\)</span>, <span class="math inline">\(y_{Y,0}\)</span>, and <span class="math inline">\(y_{Z,0}\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\underline{m}\)</span>, <span class="math inline">\(\underline{\dot{n}}_A\)</span>, <span class="math inline">\(\underline{\dot{n}}_B\)</span>, <span class="math inline">\(\underline{\dot{n}}_Y\)</span>, and <span class="math inline">\(\underline{\dot{n}}_Z\)</span> spanning the range from the reactor inlet to the reactor outlet (where <span class="math inline">\(m=m_{catalyst}\)</span>).</p>
<p><u>Algorithm</u>:</p>
<ol type="1">
<li>Make <span class="math inline">\(k\)</span>, <span class="math inline">\(K_A\)</span>, <span class="math inline">\(K_B\)</span>, <span class="math inline">\(K_Y\)</span>, and <span class="math inline">\(K_Z\)</span> available to the derivatives function.</li>
<li>Calculate the unknown initial anf final values in <a href="#tbl-example_21_5_2_initial_values" class="quarto-xref">Table&nbsp;<span>21.8</span></a>.</li>
</ol>
<p><span class="math display">\[
\dot{n}_{A,0} = y_{A,0}\frac{\dot{V}_{0}}{\hat{V}_{STP}} \tag{11}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,0} = y_{B,0}\frac{\dot{V}_{0}}{\hat{V}_{STP}} \tag{12}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Y,0} = y_{Y,0}\frac{\dot{V}_{0}}{\hat{V}_{STP}} \tag{13}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,0} = y_{Z,0}\frac{\dot{V}_{0}}{\hat{V}_{STP}} \tag{14}
\]</span></p>
<ol start="3" type="1">
<li>Get corresponding sets of <span class="math inline">\(m\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, and <span class="math inline">\(\dot{n}_Z\)</span> spanning the range from <span class="math inline">\(m=0\)</span> to <span class="math inline">\(m=m_{catalyst}\)</span> by callling an IVODE solver, passing the initial values, stopping criterion and derivatives function as arguments.</li>
</ol>
<center>
<strong>Predicted Response Model</strong>
</center>
<p><strong>Predicted Response</strong></p>
<p><span class="math display">\[
P_{A,1,model} = \frac{\dot{n}_{A}\Big\vert_{m=m_{catalyst}}}{\left( \dot{n}_{A}\Big\vert_{m=m_{catalyst}} + \dot{n}_{B}\Big\vert_{m=m_{catalyst}} + \dot{n}_{Y}\Big\vert_{m=m_{catalyst}} + \dot{n}_{Z}\right)}P\Big\vert_{m=m_{catalyst}} \tag{15}
\]</span></p>
<p><strong>Predicted Responses Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(k\)</span>, <span class="math inline">\(K_A\)</span>, <span class="math inline">\(K_B\)</span>, <span class="math inline">\(K_Y\)</span>, and <span class="math inline">\(K_Z\)</span>, <span class="math inline">\(\underline{y}_{A,0}\)</span>, <span class="math inline">\(\underline{y}_{B,0}\)</span>, <span class="math inline">\(\underline{y}_{Y,0}\)</span>, and <span class="math inline">\(\underline{y}_{Z,0}\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\underline{P}_{A,1,model}\)</span>.</p>
<p><u>Algorithm</u>:</p>
<ol type="1">
<li><p>For each experiment in the data set:</p>
<ol type="a">
<li><p>Get <span class="math inline">\(\underline{m}\)</span>, <span class="math inline">\(\underline{\dot{n}}_A\)</span>, <span class="math inline">\(\underline{\dot{n}}_B\)</span>, <span class="math inline">\(\underline{\dot{n}}_Y\)</span>, and <span class="math inline">\(\underline{\dot{n}}_Z\)</span> by calling the PFR model function passing <span class="math inline">\(k\)</span>, <span class="math inline">\(K_A\)</span>, <span class="math inline">\(K_B\)</span>, <span class="math inline">\(K_Y\)</span>, and <span class="math inline">\(K_Z\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(y_{B,0}\)</span>, <span class="math inline">\(y_{Y,0}\)</span>, and <span class="math inline">\(y_{Z,0}\)</span> as arguments.</p></li>
<li><p>Calculate the predicted response using equation (15).</p></li>
</ol></li>
<li><p>Return <span class="math inline">\(\underline{P}_{A,1,model}\)</span>.</p></li>
</ol>
<center>
<strong>Parameter Estimates and Statistics</strong>
</center>
<ol type="1">
<li><p>Define parameter guesses, <span class="math inline">\(k_{guess}\)</span>, <span class="math inline">\(K_{A,guess}\)</span>, <span class="math inline">\(K_{B,guess}\)</span>, <span class="math inline">\(K_{Y,guess}\)</span>, and <span class="math inline">\(K_{Z,guess}\)</span>.</p></li>
<li><p>Get <span class="math inline">\(k\)</span>, <span class="math inline">\(k_{CI,l}\)</span>, <span class="math inline">\(k_{CI,u}\)</span>, <span class="math inline">\(K_A\)</span>, <span class="math inline">\(K_{A,CI,l}\)</span>, <span class="math inline">\(K_{A,CI,u}\)</span>, <span class="math inline">\(K_B\)</span>, <span class="math inline">\(K_{B,CI,l}\)</span>, <span class="math inline">\(K_{B,CI,u}\)</span>, <span class="math inline">\(K_Y\)</span>, <span class="math inline">\(K_{Y,CI,l}\)</span>, <span class="math inline">\(K_{Y,CI,u}\)</span>, <span class="math inline">\(K_Z\)</span>, <span class="math inline">\(K_{Z,CI,l}\)</span>, <span class="math inline">\(K_{Z,CI,u}\)</span>, and <span class="math inline">\(R^2\)</span> by calling a numerical fitting function, passing the parameter guesses, the adjusted experimental inputs, the experimental responses, and the predicted responses function as arguments.</p></li>
</ol>
<center>
<strong>Assessment Graphs</strong>
</center>
<ol type="1">
<li><p>Get <span class="math inline">\(\underline{P}_{A,1,model}\)</span> by calling the predicted repsonses function passing the estimated parameters, <span class="math inline">\(k\)</span>, <span class="math inline">\(K_A\)</span>, <span class="math inline">\(K_B\)</span>, <span class="math inline">\(K_Y\)</span>, and <span class="math inline">\(K_Z\)</span>, and the adjusted experimental inputs as arguments.</p></li>
<li><p>Calculate the experiment residuals.</p></li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{P}_{A,1,model} - \underline{P}_{A,1} \tag{16}
\]</span></p>
<ol start="3" type="1">
<li><p>Generate a parity plot showing <span class="math inline">\(\underline{P}_{A,1}\)</span> <em>vs.</em> <span class="math inline">\(\underline{P}_{A,1,model}\)</span> as points and <span class="math inline">\(\underline{P}_{A,1}\)</span> = <span class="math inline">\(\underline{P}_{A,1,model}\)</span> as the parity line.</p></li>
<li><p>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{y}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{y}_{B,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{y}_{Y,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{y}_{Z,0}\)</span>.</p></li>
</ol>
<center>
<strong>Calculations Summary</strong>
</center>
<ol type="1">
<li><p>Read the adjusted experimental inputs and the experimental responses from the file, <a href="examples/reb_21_5_2/reb_21_5_2_data.csv">reb_21_5_2_data.csv</a>.</p></li>
<li><p>Calculate the parameter estimates and statistics and generate the assessment graphs as described above.</p></li>
<li><p>Display the results and/or save them to a file.</p></li>
</ol>
</section>
<section id="results-analysis-and-discussion-2" class="level4" data-number="21.5.3.3">
<h4 data-number="21.5.3.3" class="anchored" data-anchor-id="results-analysis-and-discussion-2"><span class="header-section-number">21.5.3.3</span> Results, Analysis, and Discussion</h4>
<p>The calculations were performed as described above. A few different sets of rate expression parameters were found to give comparably accurate fits. One such set of the rate expression parameters, their 95% confidence intervals, and the coefficient of determination, <span class="math inline">\(R^2\)</span>, are shown in <a href="#tbl-example_21_5_3_results" class="quarto-xref">Table&nbsp;<span>21.9</span></a> where “Inf” indicates infinity. The parity plot is shown in <a href="#fig-example_21_5_3_parity" class="quarto-xref">Figure&nbsp;<span>21.7</span></a>, and the residuals plots are shown in <a href="#fig-example_21_5_3_residuals_plots" class="quarto-xref">Figure&nbsp;<span>21.8</span></a>.</p>
<div class="cell">
<div id="tbl-example_21_5_3_results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_3_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.9: Parameter estimation results
</figcaption>
<div aria-describedby="tbl-example_21_5_3_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">k</td>
<td style="text-align: center;">7.34 x 10<sup>5</sup> mol g<sup>-1</sup> min<sup>-1</sup> atm<sup>-2</sup>, 95% CI [0 x 10<sup>0</sup>, Inf]</td>
</tr>
<tr class="even">
<td style="text-align: center;">K<sub>A</sub></td>
<td style="text-align: center;">8 x 10<sup>-4</sup> atm<sup>-1</sup>, 95% CI [8 x 10<sup>-4</sup>, 8 x 10<sup>-4</sup>]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">K<sub>B</sub></td>
<td style="text-align: center;">2 x 10<sup>8</sup> atm<sup>-1</sup>, 95% CI [0 x 10<sup>0</sup>, Inf]</td>
</tr>
<tr class="even">
<td style="text-align: center;">K<sub>Y</sub></td>
<td style="text-align: center;">1.4 x 10<sup>8</sup> atm<sup>-1</sup>, 95% CI [0 x 10<sup>0</sup>, Inf]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">K<sub>Z</sub></td>
<td style="text-align: center;">1 x 10<sup>-5</sup> atm<sup>-1</sup>, 95% CI [1 x 10<sup>-5</sup>, 1 x 10<sup>-5</sup>]</td>
</tr>
<tr class="even">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.997</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="fig-example_21_5_3_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_3_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_21_5_3/reb_21_5_3_parity.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_3_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.7: Parity Plot.
</figcaption>
</figure>
</div>
<div id="fig-example_21_5_3_residuals_plots" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_3_residuals_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_3/reb_21_5_3_A_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_3/reb_21_5_3_B_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_3/reb_21_5_3_Y_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_3/reb_21_5_3_Z_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_3_residuals_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.8: Residuals Plots.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Looking at the parity plot and <span class="math inline">\(R^2\)</span>, the model appears to be accurate, but there is a problem. For several of the parameters the confidence interval ranges from 0 to infinity. Based on my experience (a novice would not be expected to know this) I know that this can mean that some of the kinetics parameters are kinetically insignificant or coupled. Here, <span class="math inline">\(K_B\)</span> and <span class="math inline">\(K_Y\)</span> are of the order of 10<sup>8</sup>. The total pressure is 1 atm, so the partial pressures will be of the order of 0.1 atm. With this information, looking at the denominator in equation (2) it is apparent that the terms containg <span class="math inline">\(K_B\)</span> and <span class="math inline">\(K_Y\)</span> will be much greater than the other terms (<span class="math inline">\(K_A\)</span> ~ 10<sup>-4</sup> and <span class="math inline">\(K_Z\)</span> ~ 10<sup>-2</sup>), so the other terms can be eliminated.</p>
<p><span class="math display">\[
r = \frac{kP_{A}P_{B}}{\cancelto{0}{1} + \cancelto{0}{K_AP_A} + K_BP_B + K_YP_Y + \cancelto{0}{K_ZP_Z} }\left( 1 - \frac{P_YP_Z}{K_1P_AP_B} \right)
\]</span></p>
<p>There is still a problem with the remaining rate expression. Specifically there cannot be a unique set of values of <span class="math inline">\(k\)</span>, <span class="math inline">\(K_B\)</span>, and <span class="math inline">\(K_Y\)</span> that will minimize the sum of the squares of the residuals. Multiplying the numerator and denominator by any constant, <span class="math inline">\(\alpha\)</span>, does not change the rate. Therefore the rate will be the same if the parameters equal <span class="math inline">\(k\)</span>, <span class="math inline">\(K_B\)</span>, and <span class="math inline">\(K_Y\)</span> or if they equal <span class="math inline">\(\alpha k\)</span>, <span class="math inline">\(\alpha K_B\)</span>, and <span class="math inline">\(\alpha K_Y\)</span>. In other words, the remaining parameters are coupled. This problem can be eliminated by dividing the numerator and denominator by <span class="math inline">\(K_Y\)</span> and defining two new kinetics parameters.</p>
<p><span class="math display">\[
k^\prime = \frac{k}{K_Y}
\]</span></p>
<p><span class="math display">\[
K_B^\prime = \frac{K_B}{K_Y}
\]</span></p>
<p><span class="math display">\[
r = \frac{k^\prime P_{A}P_{B}}{K_B^\prime P _B + P_Y}\left( 1 - \frac{P_YP_Z}{K_1P_AP_B} \right)
\]</span></p>
</div>
</div>
</div>
<p><strong>Assessment</strong></p>
<p>The uncertainty in the kinetics parameters is unacceptable. Some of the parameters in equation (2) may be kinetically insignificant or coupled. Examining the parameter estimates, it appears that in the denominator only the terms containing <span class="math inline">\(P_B\)</span> and <span class="math inline">\(P_Y\)</span> are significant. It is recommended to repeat the analysis using the rate expression shown in equation (15).</p>
<p><span class="math display">\[
r = \frac{k^\prime P_{A}P_{B}}{K_B^\prime P _B + P_Y}\left( 1 - \frac{P_YP_Z}{K_1P_AP_B} \right) \tag{15}
\]</span></p>
<p><strong>Follow-up</strong></p>
<p>The analysis was repeated a third time using equation (15) as the rate expression. The parameter estimation results are shown in <a href="#tbl-example_21_5_3_results_2_par" class="quarto-xref">Table&nbsp;<span>21.10</span></a>. The parity plot is shown in <a href="#fig-example_21_5_3_parity_two_par" class="quarto-xref">Figure&nbsp;<span>21.9</span></a> and the residuals plots are shown in <a href="#fig-example_21_5_3_residuals_plots_two_par" class="quarto-xref">Figure&nbsp;<span>21.10</span></a>.</p>
<div class="cell">
<div id="tbl-example_21_5_3_results_2_par" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_21_5_3_results_2_par-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;21.10: Parameter estimation results for equation (15)
</figcaption>
<div aria-describedby="tbl-example_21_5_3_results_2_par-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">k’</td>
<td style="text-align: center;">5.4 x 10<sup>-3</sup> mol g<sup>-1</sup> min<sup>-1</sup> atm<sup>-2</sup>, 95% CI [4.26 x 10<sup>-3</sup>, 6.83 x 10<sup>-3</sup>]</td>
</tr>
<tr class="even">
<td style="text-align: center;">K<sub>B</sub>’</td>
<td style="text-align: center;">1.5 atm<sup>-1</sup>, 95% CI [1.1, 2.1]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.997</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="fig-example_21_5_3_parity_two_par" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_3_parity_two_par-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_21_5_3/reb_21_5_3_parity_follow_up.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_3_parity_two_par-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.9: Parity Plot for Rate Expression (3).
</figcaption>
</figure>
</div>
<div id="fig-example_21_5_3_residuals_plots_two_par" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_21_5_3_residuals_plots_two_par-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_3/reb_21_5_3_A_residual_follow_up.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_3/reb_21_5_3_B_residual_follow_up.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_3/reb_21_5_3_Y_residual_follow_up.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_21_5_3/reb_21_5_3_Z_residual_follow_up.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_21_5_3_residuals_plots_two_par-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21.10: Residuals for Rate Expression (15).
</figcaption>
</figure>
</div>
<p><strong>Final Assessment</strong></p>
<p>Based upon the parity plot, residuals plots, and coefficient of determination, the rate expression in equation (15) is just as accurate as that in equation (2). In addition, for rate expression (15), there are fewer parameters and their confidence intervals are narrow relative to their values. The rate expression in equation (15) is preferred over the rate expression in equation (2).</p>
<hr>
</section>
</section>
</section>
<section id="symbols-used-in-sec-6_pfr_data_analysis" class="level2" data-number="21.6">
<h2 data-number="21.6" class="anchored" data-anchor-id="symbols-used-in-sec-6_pfr_data_analysis"><span class="header-section-number">21.6</span> Symbols Used in <a href="#sec-6_pfr_data_analysis" class="quarto-xref"><span>Chapter 21</span></a></h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(f_i\)</span></td>
<td style="text-align: left;">Fractional conversion of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(i\)</span></td>
<td style="text-align: left;">index denoting a reagent.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(m\)</span></td>
<td style="text-align: left;">Mass of catalyst.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(k\)</span></td>
<td style="text-align: left;">Rate coefficient.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(k_0\)</span></td>
<td style="text-align: left;">Pre-exponential factor in the Arrhenius expression.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_i\)</span></td>
<td style="text-align: left;">Molar flow rate of reagent <span class="math inline">\(i\)</span>, an additional subscript indexes the flow stream.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r\)</span></td>
<td style="text-align: left;">Net rate of reaction (per unit fluid volume or per catalyst mass, depending on context).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(r_p\)</span></td>
<td style="text-align: left;">Catalyst particle radius.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(v\)</span></td>
<td style="text-align: left;">Fluid velocity.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y_i\)</span></td>
<td style="text-align: left;">Mole fraction of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(z\)</span></td>
<td style="text-align: left;">Axial distance from the reactor inlet.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(C_i\)</span></td>
<td style="text-align: left;">Concentration of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(CI\)</span></td>
<td style="text-align: left;">Subscript indicating a 95% confidence interval, and additional “l” or “u” denotes the lower or upper limit of the interval.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(D\)</span></td>
<td style="text-align: left;">Reactor diameter.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(D_{\text{eff}}\)</span></td>
<td style="text-align: left;">Effective diffusion coefficient.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(E\)</span></td>
<td style="text-align: left;">Activation energy in the Arrhenius expression.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(K\)</span></td>
<td style="text-align: left;">Equilibrium constant, additional subscripts differential between multiple equilibrium constants appearing in the same rate expression.</td>
</tr>
<tr class="even">
<td style="text-align: left;">$L</td>
<td style="text-align: left;">Reactor length</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(N_{Re}\)</span></td>
<td style="text-align: left;">Reynolds number.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Pressure.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P_i\)</span></td>
<td style="text-align: left;">Partial pressure of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(R\)</span></td>
<td style="text-align: left;">Ideal gas constant.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R^2\)</span></td>
<td style="text-align: left;">Coefficient of determination.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T\)</span></td>
<td style="text-align: left;">Absolute temperature.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(V\)</span></td>
<td style="text-align: left;">Volume.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{V}\)</span></td>
<td style="text-align: left;">Volumetric flow rate, additional subscripts index the reagent and the flow stream.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\hat{V}_{STP}\)</span></td>
<td style="text-align: left;">Molar volume of an ideal gas at standard temperature and pressure.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\alpha_i\)</span></td>
<td style="text-align: left;">Exponent on the partial pressure of reagent <span class="math inline">\(i\)</span> in a power-law rate expression.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\epsilon_{expt}\)</span></td>
<td style="text-align: left;">Experiment residual.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\mu\)</span></td>
<td style="text-align: left;">Fluid viscosity.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\nu_i\)</span></td>
<td style="text-align: left;">Stoichiometric coefficient of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\rho\)</span></td>
<td style="text-align: left;">Fluid density.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\rho_{\text{bed}}\)</span></td>
<td style="text-align: left;">Apparent catalyst bed density.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\phi_s\)</span></td>
<td style="text-align: left;">Internal concentration gradient metric.</td>
</tr>
</tbody>
</table>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-chambers_lack_1966" class="csl-entry" role="listitem">
Chambers, Robert P., and Michel Boudart. 1966. <span>“Lack of Dependence of Conversion on Flow Rate in Catalytic Studies.”</span> <em>Journal of Catalysis</em> 6 (1): 141–45. <a href="https://doi.org/10.1016/0021-9517(66)90118-7">https://doi.org/10.1016/0021-9517(66)90118-7</a>.
</div>
<div id="ref-koros_diagnostic_1967" class="csl-entry" role="listitem">
Koros, R. M., and E. J. Nowak. 1967. <span>“A Diagnostic Test of the Kinetic Regime in a Packed Bed Reactor.”</span> <em>Chemical Engineering Science</em> 22 (3): 470. <a href="https://doi.org/10.1016/0009-2509(67)80134-9">https://doi.org/10.1016/0009-2509(67)80134-9</a>.
</div>
<div id="ref-madon_experimental_1982" class="csl-entry" role="listitem">
Madon, Rostam J., and Michel Boudart. 1982. <span>“Experimental Criterion for the Absence of Artifacts in the Measurement of Rates of Heterogeneous Catalytic Reactions.”</span> <em>Industrial &amp; Engineering Chemistry Fundamentals</em> 21 (4): 438–47. <a href="https://doi.org/10.1021/i100008a022">https://doi.org/10.1021/i100008a022</a>.
</div>
<div id="ref-mears_tests_1971" class="csl-entry" role="listitem">
Mears, D. E. 1971. <span>“Tests for <span>Transport</span> <span>Limitations</span> in <span>Experimental</span> <span>Catalytic</span> <span>Reactors</span>.”</span> <em>Industrial &amp; Engineering Chemistry Process Design and Development</em> 10 (4): 541–47. <a href="https://doi.org/10.1021/i260040a020">https://doi.org/10.1021/i260040a020</a>.
</div>
<div id="ref-satterfield_heterogeneous_1980" class="csl-entry" role="listitem">
Satterfield, Charles N. 1980. <em>Heterogeneous Catalysis in Practice</em>. New York: McGraw-Hill.
</div>
<div id="ref-wheeler_reaction_1951" class="csl-entry" role="listitem">
Wheeler, Ahlborn. 1951. <span>“Reaction <span>Rates</span> and <span>Selectivity</span> in <span>Catalyst</span> <span>Pores</span>.”</span> In <em>Advances in <span>Catalysis</span></em>, edited by W. G. Frankenburg, V. I. Komarewsky, E. K. Rideal, P. H. Emmett, and H. S. Taylor, 3:249–327. Academic Press. <a href="https://doi.org/10.1016/S0360-0564(08)60109-1">https://doi.org/10.1016/S0360-0564(08)60109-1</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./section_6_cstr_data_analysis.html" class="pagination-link" aria-label="Analysis of Kinetics Data from a CSTR">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./section_7_intro.html" class="pagination-link" aria-label="Modeling Non-Ideal Reactors">
        <span class="nav-page-text">Modeling Non-Ideal Reactors</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>