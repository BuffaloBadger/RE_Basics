<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>13&nbsp; PFR Analysis – Reaction Engineering Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./section_4_continuous_design.html" rel="next">
<link href="./section_4_cstr_analysis.html" rel="prev">
<link href="./Graphics/BuffaloBadger_16_16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="http://buffalobadger.github.io" class="navbar-brand navbar-brand-logo">
    <img src="./Graphics/Banner.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/RE_Basics"> 
<span class="menu-text">Reaction Engineering Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/SCoRE"> 
<span class="menu-text">SCoRE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/ToTaL_Engineering"> 
<span class="menu-text">ToTaL Engineering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/The_Sett"> 
<span class="menu-text">The Sett</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_4_intro.html">Modeling Isolated Ideal Reactors</a></li><li class="breadcrumb-item"><a href="./section_4_pfr_analysis.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_intro_and_defs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reactions, Reactors, and Reaction Engineering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_safety_and_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reaction Engineering Ethics and Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_reaction_progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measures of Reaction Progress</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rate Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_rates_and_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reaction Rates and Rate Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reaction Mechanisms and Mechanistic Rate Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_3_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formulating Reactor Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_design_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reactor Design Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_4_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Isolated Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_reaction_engineering_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Response, Optimization and Design of Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_bstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">BSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_sbstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">SBSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_non_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design of Non-Continuous Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_cstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_pfr_analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_5_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Ideal Reactor Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_reactor_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reactor Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_thermally_backmixed_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thermally Back-Mixed PFRs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_recycle_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recycle PFRs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_6_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kinetics Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_data_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_bstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_cstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_pfr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_7_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Non-Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_age_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Age Distribution Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_segregated_flow_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">A Segregated Flow Reactor Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_zoned_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Zoned Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_prereq_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prerequisite Knowledge</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_nomenclature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Acronyms, Notation, Sign Conventions, and Computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_reaction_thermo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Reaction Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_collision_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Collision Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_transition_state_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Transition State Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_heat_exchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Reactor Heat Exchange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_ideal_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Axial Dispersion Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Solving Algebraic/Transcendental Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ivodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Solving Initial-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_cvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Solving Coupled-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_estimate_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Parameter Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_bvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Solving Boundary-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_useful_eqns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Frequently Used Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#pfr-characteristics" id="toc-pfr-characteristics" class="nav-link active" data-scroll-target="#pfr-characteristics"><span class="header-section-number">13.1</span> PFR Characteristics</a></li>
  <li><a href="#pfr-operation" id="toc-pfr-operation" class="nav-link" data-scroll-target="#pfr-operation"><span class="header-section-number">13.2</span> PFR Operation</a></li>
  <li><a href="#qualitative-analysis-of-steady-state-reaction-in-a-pfr" id="toc-qualitative-analysis-of-steady-state-reaction-in-a-pfr" class="nav-link" data-scroll-target="#qualitative-analysis-of-steady-state-reaction-in-a-pfr"><span class="header-section-number">13.3</span> Qualitative Analysis of Steady-State Reaction in a PFR</a></li>
  <li><a href="#pfr-design-equations" id="toc-pfr-design-equations" class="nav-link" data-scroll-target="#pfr-design-equations"><span class="header-section-number">13.4</span> PFR Design Equations</a></li>
  <li><a href="#pfr-reaction-fronts" id="toc-pfr-reaction-fronts" class="nav-link" data-scroll-target="#pfr-reaction-fronts"><span class="header-section-number">13.5</span> PFR Reaction Fronts</a></li>
  <li><a href="#packed-bed-pfrs" id="toc-packed-bed-pfrs" class="nav-link" data-scroll-target="#packed-bed-pfrs"><span class="header-section-number">13.6</span> Packed Bed PFRs</a>
  <ul class="collapse">
  <li><a href="#the-pseudo-homogeneous-pfr-model" id="toc-the-pseudo-homogeneous-pfr-model" class="nav-link" data-scroll-target="#the-pseudo-homogeneous-pfr-model"><span class="header-section-number">13.6.1</span> The Pseudo-Homogeneous PFR Model</a></li>
  <li><a href="#normalization-of-heterogeneous-catalytic-reaction-rates" id="toc-normalization-of-heterogeneous-catalytic-reaction-rates" class="nav-link" data-scroll-target="#normalization-of-heterogeneous-catalytic-reaction-rates"><span class="header-section-number">13.6.2</span> Normalization of Heterogeneous Catalytic Reaction Rates</a></li>
  <li><a href="#sec-packed_bed_gradients" id="toc-sec-packed_bed_gradients" class="nav-link" data-scroll-target="#sec-packed_bed_gradients"><span class="header-section-number">13.6.3</span> Concentration and Temperature Gradients in Packed Bed PFRs</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">13.7</span> Examples</a>
  <ul class="collapse">
  <li><a href="#sec-example_13_7_1" id="toc-sec-example_13_7_1" class="nav-link" data-scroll-target="#sec-example_13_7_1"><span class="header-section-number">13.7.1</span> Steady-State Conversion in a Gas-Phase PFR</a></li>
  <li><a href="#sec-example_13_7_2" id="toc-sec-example_13_7_2" class="nav-link" data-scroll-target="#sec-example_13_7_2"><span class="header-section-number">13.7.2</span> Required Steady-State PFR Feed Temperature</a></li>
  <li><a href="#sec-example_13_7_3" id="toc-sec-example_13_7_3" class="nav-link" data-scroll-target="#sec-example_13_7_3"><span class="header-section-number">13.7.3</span> Pressure Drop in a Steady-State, Gas-Phase PFR</a></li>
  <li><a href="#sec-example_13_7_4" id="toc-sec-example_13_7_4" class="nav-link" data-scroll-target="#sec-example_13_7_4"><span class="header-section-number">13.7.4</span> Minimum Water-Gas Shift Reactor Volume</a></li>
  <li><a href="#sec-example_13_7_5" id="toc-sec-example_13_7_5" class="nav-link" data-scroll-target="#sec-example_13_7_5"><span class="header-section-number">13.7.5</span> Start-up of the PFR from Example&nbsp;<span>13.7.2</span></a></li>
  <li><a href="#sec-example_13_7_6" id="toc-sec-example_13_7_6" class="nav-link" data-scroll-target="#sec-example_13_7_6"><span class="header-section-number">13.7.6</span> Gas-Phase Reaction in a Packed-Bed PFR with Internal Concentration Gradients</a></li>
  </ul></li>
  <li><a href="#symbols-used-in-chapter--sec-4_pfr_analysis" id="toc-symbols-used-in-chapter--sec-4_pfr_analysis" class="nav-link" data-scroll-target="#symbols-used-in-chapter--sec-4_pfr_analysis"><span class="header-section-number">13.8</span> Symbols Used in Chapter&nbsp;<span>13</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_4_intro.html">Modeling Isolated Ideal Reactors</a></li><li class="breadcrumb-item"><a href="./section_4_pfr_analysis.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-4_pfr_analysis" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The reactors examined in preceding chapters were all variants of a stirred tank, that is, they were perfectly mixed. This chapter considers a very different kind of continuous reactor, namely the plug flow reactor (PFR). PFRs are basically tubes through which reacting fluid flows and within which chemical reactions take place.</p>
<div id="fig-pfr_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pfr_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/pfr_schematic.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pfr_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.1: Simple schematic representation of a PFR.
</figcaption>
</figure>
</div>
<section id="pfr-characteristics" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="pfr-characteristics"><span class="header-section-number">13.1</span> PFR Characteristics</h2>
<p>The distincitve characteristics of PFRs were summarized in <a href="section_3_design_equations.html" class="quarto-xref"><span>Chapter 6</span></a>, and they are presented in more detail in <a href="apndx_ideal_reactor_models.html" class="quarto-xref"><span>Appendix G</span></a>. The biggest difference between PFRs and stirred tanks lies in the mixing. Stirred tanks are perfectly mixed at all times, so there are never any spatial variations of composition or temperature within the reactor. In contrast, the composition and temperature vary continuously along the length of a PFR as the reacting fluid flows through it. More specifically, as illustrated in <a href="apndx_ideal_reactor_models.html#fig-pfr-vol-element" class="quarto-xref">Figure&nbsp;<span>G.1</span></a>, it is assumed that the fluid velocity in the axial distance does not vary in the radial direction. As a consequence, the fluid can be thought of as differentially thick disks that move from the reactor inlet to the outlet. There is perfect mixing in the radial direction (i. e. within each differentially thick disk) an no mixing at all in the axial direction (i. e. between disks).</p>
<p>Another difference between PFRs and CSTRs is that the pressure of the reacting fluid in a PFR can decrease as the fluid flows from the inlet to the outlet. When analyzing CSTRs it is assumed that pressure changes are negligible both between inlet and outlet and between the top and bottom of the fluid within the reactor.</p>
<p>In PFRs, heat is exchanged through the reactor walls. Commonly there is a concentric tube surrounding the reactor tube with heat exchange fluid flowing through the annular space. Alternatively, there may be many reactor tubes that all pass through a larger shell while heat exchange fluid flows through the shell. In some applications PFR tubes pass though a firebox within which some fuel is burned. In this situation the flue gases are the heat exchange fluid, and any PFR tubes that are within line of sight of the combustion flame are additionally heated radiantly. <em>Reaction Engineering Basics</em> only considers heat exchange with a fliud in a shell surrounding the PFR tube (see <a href="section_3_design_equations.html" class="quarto-xref"><span>Chapter 6</span></a>).</p>
<p>Being continuous flow reactors, PFRs can operate at steady-state or in a transient mode. At the minimum, transient operation occurs when the PFR is started up and shut down. Transient behavior will occur whenever a reactor input changes. Those changes can involve the flow rate, the feed composition, the feed temperature, the feed pressure, the heat exchange fluid flow rate, and the heat exchange fluid inlet temperature. Due to the nature of plug flow, PFR transients typically only last as long as it takes the reacting fluid to flow from the reactor inlet to its outlet.</p>
<p>PFRs are well-suited to high throughput production. They can also be used for reactions that require solid catalyst particles. The absence of axial mixing can be an advantage because, unlike a CSTR, the reactants are not immediately diluted due to mixing with the fluid already present in the reactor. As a consequence, the concentration of reactant is high at the inlet. High reactant concentration typically results in a high reaction rate and a smaller reactor volume.</p>
<p>The absence of axial mixing can also be a disadvantage if the reaction is exothermic with limited or no heat removal. Unlike a CSTR, where the feed is instantly heated to the outlet temperature upon entering the reactor, fluid enters a PFR at the feed temperature, and its temperature rises continuously as it flows through the reactor. The lower temperatures near the inlet typically result in a lower rate, and therefore a larger reactor is needed to accomplish a given extent of conversion.</p>
<p>Another disadvangage of PFRs is the fixed heat transfer area. As noted, heat exchange with a PFR is typically limited to occur through the reactor wall. Unlike CSTRs, it isn’ feasible to add coiled tubes containing flowing heat exchange fluid within the PFR tube. Similarly, circulating the reacting fluid through an external heat exchanger is not practical. In some situations it is possible to break one long PFR into several shorter PFRs with additional cooling between the shorter lengths of reactor.</p>
</section>
<section id="pfr-operation" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="pfr-operation"><span class="header-section-number">13.2</span> PFR Operation</h2>
<p>Like CSTRs, PFRs are normally designed to operate at steady state. When a PFR operates at steady state, the composition, temperature and pressure are all constant over time at any one axial position in the reactor. The temperature pressure and composition will be different at a different location, but at that location they again will be constant over time. Put differently, the steady-state composition, pressure and temperature in a PFR will vary spatitially, but not temporally.</p>
<p>PFRs must operate in transient modes when they are started up and shut down, and they will also undergo transient operation if any reactor input changes. The absence of axial mixing can result in “odd” transients that intuitively seem to be incorrect. This aspect of transient PFR operation is discussed later in the chapter.</p>
</section>
<section id="qualitative-analysis-of-steady-state-reaction-in-a-pfr" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="qualitative-analysis-of-steady-state-reaction-in-a-pfr"><span class="header-section-number">13.3</span> Qualitative Analysis of Steady-State Reaction in a PFR</h2>
<p><a href="section_4_cstr_analysis.html" class="quarto-xref"><span>Chapter 12</span></a> pointed out that in a continuous reactor, the amount of time during which reaction occurs is equal to the amount of time that the fluid spends in the reactor. As a consequence, when qualitatively analyzing the performance of a continuous reactor, the effects of small changes in space time are considered. When that is done, the qualitative analysis of a PFR is essentially the same as a BSTR except that the space time is used instead of elapsed clock time.</p>
<p>Indeed, there is a relationship between BSTR reaction time and PFR space time. As already noted, each differential, disk-shaped element of fluid that enters a PFR flows through the reactor without mixing with the fluid that entered before it or the fluid that enters after it. Furthermore, being differentially thin and with perfect radial mixing in a PFR, that thin disk is essentially a small batch reactor that moves from the reactor inlet to the reactor outlet, as illustrated in <a href="#fig-pfr_bstr_analogy" class="quarto-xref">Figure&nbsp;<span>13.2</span></a>. From the perspective of that thin disk, the reaction time is equal to the time it takes to flow from the reactor inlet to the reactor outlet.</p>
<div id="fig-pfr_bstr_analogy" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pfr_bstr_analogy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/pfr_bstr_analogy.png" class="img-fluid figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pfr_bstr_analogy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.2: Analogy between reaction time in a BSTR and space time in a PFR.
</figcaption>
</figure>
</div>
<p>For incompressible liquid phase systems, the analogy of <a href="#fig-pfr_bstr_analogy" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> is exact. For gases, the volume of the thin disk may change as it moves through the reactor due to changes in temperature, pressure or total moles. The space time is defined in terms of the inlet volumetric flow rate, so it does not account for expansion or contraction of the thin disk. Nonetheless, for the purposes of a qualitative analysis the expansion effect is not important.</p>
<p><a href="section_4_bstr_analysis.html#sec-bstr_qualitative_analysis" class="quarto-xref"><span>Section 9.3</span></a> presented an approach to qualitative analysis of a BSTR wherein the effects of small increments in reaction time were assessed. The same procedure can be used for PFR, substituting the space time for the reaction time. Basically the changes experienced as a function of reaction time in a BSTR are the same as the changes experienced upon progressing from a PFR’s inlet to its outlet.</p>
</section>
<section id="pfr-design-equations" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="pfr-design-equations"><span class="header-section-number">13.4</span> PFR Design Equations</h2>
<p>The reactor design equations for PFRs and their simplification were presented in <a href="section_3_design_equations.html" class="quarto-xref"><span>Chapter 6</span></a>. The PFR reactor design equations are derived in <a href="apndx_ideal_reactor_models.html" class="quarto-xref"><span>Appendix G</span></a>. The general PFR mole balance, <a href="section_3_design_equations.html#eq-pfr_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.33</span></a>, energy balance, <a href="section_3_design_equations.html#eq-pfr_energy_balance" class="quarto-xref">Equation&nbsp;<span>6.34</span></a>, and momentum balance, <a href="section_3_design_equations.html#eq-pfr_transient_momentum_balance" class="quarto-xref">Equation&nbsp;<span>6.37</span></a>, are reproduced below, along with energy balances on a perfectly mixed heat exchange fluid that exchanges sensible heat, <a href="section_3_design_equations.html#eq-exchange_energy_bal_sensible" class="quarto-xref">Equation&nbsp;<span>6.2</span></a>, or latent heat, <a href="section_3_design_equations.html#eq-exchange_energy_bal_latent" class="quarto-xref">Equation&nbsp;<span>6.6</span></a>, with the reacting fluid.</p>
<p><span class="math display">\[
\frac{\partial \dot{n}_i}{\partial z} + \frac{\pi D^2}{4\dot{V}} \frac{\partial\dot{n}_i}{\partial t} - \frac{\pi D^2\dot{n}_i}{4\dot{V}^2} \frac{\partial \dot{V}}{\partial t}  =\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j
\]</span></p>
<p><span class="math display">\[
\begin{split}
\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right) \frac{\partial T}{\partial z} +&amp; \frac{\pi D^2}{4\dot{V}} \sum_i \left(\dot{n}_i \hat{C}_{p,i} \right) \frac{\partial T}{\partial t} - \frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\ &amp;= \pi D U\left( T_{ex} - T  \right) - \frac{\pi D^2}{4}\sum_j r_j \Delta H_j
\end{split}
\]</span></p>
<p><span class="math display">\[
\frac{\partial \dot{V}}{\partial t} + \frac{4 \dot{V}}{\pi D^2} \frac{\partial \dot{V}}{\partial z} + \frac{\pi D^2}{4 \rho} \frac{\partial P}{\partial z} = - \frac{2 f \dot{V}^2}{\pi D^3}
\]</span></p>
<p><span class="math display">\[
\rho_{ex} V_{ex} \tilde{C}_{p,ex}\frac{dT_{ex}}{dt} = -\dot{Q} - \dot{m}_{ex} \int_{T_{ex,in}}^{T_{ex}} \tilde{C}_{p,ex}dT
\]</span></p>
<p><span class="math display">\[
\frac{\rho_{ex} V_{ex} \Delta H_{\text{latent},ex}^0}{M_{ex}} \frac{d \gamma}{dt} = - \dot{Q} - \gamma \dot{m}_{ex} \frac{\Delta H_{\text{latent},ex}^0}{M_{ex}}
\]</span></p>
<p>The transient PFR design equations above are parital differential equations. They are presented here for completeness. Transient analysis of PFRs is not presented in <em>Reaction Engineering Basics</em> except for the special case, discussed later in the chapter, where a front propagates through the reactor.</p>
<p>When a PRF is operating at steady state, the time derivatives are equal to zero and the partial derivatives become ordinary derivatives. The general form of the <em>steady-state</em> PFR mole balance, <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>, energy balance, <a href="section_3_design_equations.html#eq-pfr_ss_energy_balance" class="quarto-xref">Equation&nbsp;<span>6.40</span></a>, momentum balance, <a href="section_3_design_equations.html#eq-pfr_momentum_balance" class="quarto-xref">Equation&nbsp;<span>6.41</span></a>, and packed bed momentum balance, <a href="section_3_design_equations.html#eq-pfr_ergun_eqn" class="quarto-xref">Equation&nbsp;<span>6.42</span></a>, are reproduced here.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z}  =\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j
\]</span></p>
<p><span class="math display">\[
\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right) \frac{d T}{d z} = \pi D U\left( T_{ex} - T  \right) - \frac{\pi D^2}{4}\sum_j r_j \Delta H_j
\]</span></p>
<p><span class="math display">\[
\frac{dP}{dz} = - \frac{4G}{\pi D^2} \frac{d \dot{V}}{dz} - \frac{fG^2}{2D \rho}
\]</span></p>
<p><span class="math display">\[
\frac{{dP}}{{dz}} =  - \frac{{1 - \varepsilon }}{{{\varepsilon ^3}}}\frac{{{G^2}}}{{\rho {\Phi _s}{D_p}}}\left[ {\frac{{150\left( {1 - \varepsilon } \right)\mu }}{{{\Phi _s}{D_p}G}} + 1.75} \right]
\]</span></p>
<p>Some of the PFR reactor design equations contain more than one dependent variable. As a consequence it is sometimes necessary to add a differential equation or eliminate a dependent variable in order to solve the design equations. Differential forms of the ideal gas law, <a href="#eq-partial_dif_gas_law" class="quarto-xref">Equation&nbsp;<span>13.1</span></a> and <a href="#eq-dif_gas_law_wrt_z" class="quarto-xref">Equation&nbsp;<span>13.2</span></a>, can be used to do this.</p>
<p><span id="eq-partial_dif_gas_law"><span class="math display">\[
P \frac{\partial \dot{V}}{\partial t} + \dot{V} \frac{\partial P}{\partial t} - R \left( T \sum_i \frac{\partial \dot{n}_i}{\partial t} + \left( \sum_i \dot{n}_i \right) \frac{\partial T}{ \partial t} \right) = 0
\tag{13.1}\]</span></span></p>
<p><span id="eq-dif_gas_law_wrt_z"><span class="math display">\[
P \frac{d \dot{V}}{dz} + \dot{V} \frac{dP}{dz} - R \left( T \sum_i \frac{d\dot{n}_i}{dz} + \left( \sum_i \dot{n}_i \right) \frac{dT}{dz} \right) = 0
\tag{13.2}\]</span></span></p>
<p>The sensible heat terms in the PFR energy balances above are written in terms of the molar heat capacities of the reagents. Those terms can also be expressed in terms of the overall volumetric or gravimetric heat capacity of the reacting fluid.</p>
<p><span id="eq-equiv_sens_terms_pfr"><span class="math display">\[
\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right) \frac{\partial T}{\partial z} \Leftrightarrow \rho \dot{V} \tilde{C}_p \frac{\partial T}{\partial z} \Leftrightarrow \dot{V} \breve{C}_p \frac{\partial T}{\partial z}
\tag{13.3}\]</span></span></p>
<p><span id="eq-equiv_sens_terms_pfr_time"><span class="math display">\[
\frac{\pi D^2}{4\dot{V}} \sum_i \left(\dot{n}_i \hat{C}_{p,i} \right) \frac{\partial T}{\partial t} \Leftrightarrow \frac{\pi D^2}{4}\rho  \tilde{C}_p \frac{\partial T}{\partial t} \Leftrightarrow \frac{\pi D^2}{4} \breve{C}_p \frac{\partial T}{\partial t}
\tag{13.4}\]</span></span></p>
<p>If the reacting fluid is an incompressible, ideal liquid mixture, the volumetric flow rate will be constant. Consequently its derivative with respect to either time or axial position will equal zero. The total heat transferred from the exchange fluid to the reacting fluid is given by <a href="#eq-total_heat_exchanged_pfr" class="quarto-xref">Equation&nbsp;<span>13.5</span></a>.</p>
<p><span id="eq-total_heat_exchanged_pfr"><span class="math display">\[
\dot{Q} = \int_0^L \pi D U \left(T_{ex} - T \right)dz
\tag{13.5}\]</span></span></p>
<p>When rate expressions are substituted into the PFR design equations, they will introduce concentrations or, for gases, partial pressures. For liquid phase reactions, the concentration can be expressed in terms of the dependent variables in the design equations using its defining equation. For gases the concentration or partial pressure can be expressed in terms of the molar amounts using the ideal gas law.</p>
<p><span class="math display">\[
C_i = \frac{\dot{n}_i}{\dot{V}}
\]</span></p>
<p><span class="math display">\[
C_i = \frac{\dot{n}_i}{\sum_i \left(\dot{n}_i\right)}\frac{P}{RT} \qquad i = \text{ ideal gas}
\]</span></p>
<p><span class="math display">\[
P_i = \frac{\dot{n}_i}{\sum_i \left(\dot{n}_i\right)}P \qquad i = \text{ ideal gas}
\]</span></p>
</section>
<section id="pfr-reaction-fronts" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="pfr-reaction-fronts"><span class="header-section-number">13.5</span> PFR Reaction Fronts</h2>
<p>According to the ideal PFR model fluid is perfectly mixed in the radial direction, but it does not mix at all in the axial direction. Furthermore, the velocity in the axial direction does not vary across the reactor tube. Figures <a href="apndx_ideal_reactor_models.html#fig-pfr-vol-element" class="quarto-xref"><span>G.1</span></a> and <a href="#fig-pfr_bstr_analogy" class="quarto-xref"><span>13.2</span></a> show that with these assumptions the fluid flow through the reactor can be envisioned as differentially thick disks that move through the reactor one after the other. These disks never mix with the disk ahead of them or with the disk behind them.</p>
<p>Under certain conditions, these assumptions can result in transient behavior where a “front” moves through the reactor. Specifically if the feed temperature or the feed composition (but <strong>not</strong> the feed flow rate) changes abruptly, none of the fluid already in the reactor is affected. This is illustrated in <a href="#fig-transient_front" class="quarto-xref">Figure&nbsp;<span>13.3</span></a> for the situation where there isn’t any reaction taking place within the reactor.</p>
<div id="fig-transient_front" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transient_front-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/stages_of_a_transient_front.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transient_front-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.3: Development of a front in a PFR following an abrupt change in the feed temperature or composition. Gray shading indicates fluid with the temperature and composition prior to the feed change and turquoise indicates fluid with the temperature and composition after the feed change.
</figcaption>
</figure>
</div>
<p>The figure indicates that there is an abrupt change, i. e. a step-change, in the feed temperature and/or composition that starts the transient response. Notice the sharp interface between the fluid that entered just before the change and the fluid entering to start the transient. That interface is called a “front”. As a result of the plug flow within the reactor, a short while later that front has moved part way through the reactor. It remains as sharp as it was at the instant the change occurred because the fluid just ahead of the front never mixes with the fluid at the beginning of the front.</p>
<p>The transient response of the reactor only lasts as long as it takes for the fluid to flow from the reactor inlet to the reactor outlet. If the fluid is incompressible, the linear velocity of the front is equal to the volumetric flow rate divided by the cross-sectional area of the tube, <a href="#eq-pfr_front_velocity" class="quarto-xref">Equation&nbsp;<span>13.6</span></a>. The position of the front is then equal to the elapsed time since the front began times the velocity, <a href="#eq-pfr_front_position" class="quarto-xref">Equation&nbsp;<span>13.7</span></a>. The duration of the front is then equal to the time at which the front reaches the reactor outlet at <span class="math inline">\(z=L\)</span>, which is equal to the PFR space time, <a href="#eq-pfr_transient_duration" class="quarto-xref">Equation&nbsp;<span>13.8</span></a>. Equations <a href="#eq-pfr_front_velocity" class="quarto-xref"><span>13.6</span></a>, <a href="#eq-pfr_front_position" class="quarto-xref"><span>13.7</span></a>, and <a href="#eq-pfr_transient_duration" class="quarto-xref"><span>13.8</span></a> only apply for an incompressible fluid.</p>
<p><span id="eq-pfr_front_velocity"><span class="math display">\[
v_{front} = \frac{\dot{V}}{\frac{\pi D^2}{4}} = \frac{4\dot{V}}{\pi D^2}
\tag{13.6}\]</span></span></p>
<p><span id="eq-pfr_front_position"><span class="math display">\[
z_{front} = v_{front} t = \frac{4\dot{V}t}{\pi D^2}
\tag{13.7}\]</span></span></p>
<p><span id="eq-pfr_transient_duration"><span class="math display">\[
L = \frac{4\dot{V}t_{transient}}{\pi D^2} \quad \Rightarrow \quad t_{transient} = \frac{\pi D^2}{4}\frac{L}{\dot{V}} = \frac{V_{PFR}}{\dot{V}} = \tau_{PFR}
\tag{13.8}\]</span></span></p>
<p>The preceding discussion and <a href="#fig-transient_front" class="quarto-xref">Figure&nbsp;<span>13.3</span></a> assumed that no reaction was taking place when the step-change was applied to the feed composition and/or temperature. However, the same reasoning applies if reaction is taking place. The fluid ahead of the front is unaffected by the change in the feed, and similarly, the fluid behind the front is unaffected by the downstream presence of the front. In other words, <strong>the composition profile during this type of transient can be calculated using the steady-state PFR design equations</strong>.</p>
<p>When a step change in the composition and/or temperature occurs at the inlet to a steady-state PFR, a front will propagate along the length of the reactor. The concentration and temperature profile between the reactor inlet and the front is the steady-state profile for the new feed. The concentration and temperature profile between the front and the reactor outlet is the steady-state profile that existed before the feed change. Example <a href="#sec-example_13_7_5" class="quarto-xref"><span>13.7.5</span></a> illustrates the propagation of this type of front.</p>
<p>It is important to understand that this approach only applies when the step change in the feed does not affect the fluid already in the reactor. If the feed flow rate changed, or if the exchange fluid flow rate or inlet temperature changed, a front like that described above would not result, and this type of analysis would not be valid.</p>
</section>
<section id="packed-bed-pfrs" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="packed-bed-pfrs"><span class="header-section-number">13.6</span> Packed Bed PFRs</h2>
<p>One of the advantages of PFRs is their suitability for heterogeneous catalystic reactions with solid catalysts. The catalyst takes the form of small particles, often cylindrical or spherical in shape with dimensions of the order of 0.25 in. The catalyst particles are highly porous. When they are examined using a microscope, they look similar to a common sponge, with interconnected void spaces throughout their volume.</p>
<section id="the-pseudo-homogeneous-pfr-model" class="level3" data-number="13.6.1">
<h3 data-number="13.6.1" class="anchored" data-anchor-id="the-pseudo-homogeneous-pfr-model"><span class="header-section-number">13.6.1</span> The Pseudo-Homogeneous PFR Model</h3>
<p>Stirred tank reactors are not will suited to reactions that require such catalysts due to the necessity of agitating the fluid to keep it perfectly mixed. Stirring a tank full of solid pellets is not practical. PFRs do not require agitation, so the interior of the reactor can be filled with the catalyst pellets. Screens or other similar means are used to keep the pellets in place, and the reacting fluid flows in the space between the pellets. That space is called the void space. Reactors packed with catalyst pellets as described here are known as packed bed PFRs (assuming they still obey the assumptions of the PFR model).</p>
<p>The presence of the packed bed does introduce a few complications. One is that the fluid no longer flows in the axial direction only. Its path must twist and turn so it can flow around the catalyst particles. In many cases, he relatively small amount of non-axial flow does not significantly affect the assumption of a constant velocity in the axial direction in any reactor cross-section, and it does not introduce significant radial mixing. This allows the reactor to be treated as a pseudo-homogeneous PFR, <a href="#fig-pseudo_homogeneous_pfr_model" class="quarto-xref">Figure&nbsp;<span>13.4</span></a>.</p>
<div id="fig-pseudo_homogeneous_pfr_model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pseudo_homogeneous_pfr_model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Graphics/pseudo_homogeneous_pbr_model.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pseudo_homogeneous_pfr_model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.4: In the pseudo-homogeneous PFR model (left), the entire reactor cross section is treated as if it is available for fluid flow (red), while in reality only the space between the (gray) catalyst particles is available.
</figcaption>
</figure>
</div>
</section>
<section id="normalization-of-heterogeneous-catalytic-reaction-rates" class="level3" data-number="13.6.2">
<h3 data-number="13.6.2" class="anchored" data-anchor-id="normalization-of-heterogeneous-catalytic-reaction-rates"><span class="header-section-number">13.6.2</span> Normalization of Heterogeneous Catalytic Reaction Rates</h3>
<p>A second complication that arises due to the presence of a packed bed is related to the way the reaction rate is normalized. With homogeneous single-phase reactions, reaction rates are almost always normalized per unit volume of reacting fluid. Indeed, the reactor design equations used throughout <em>Reaction Engineering Basics</em> assume that the rate is normalized per reacting fluid volume, and the reacting fluid volume is essentially equal to the reactor volume.</p>
<p>Rate expressions for heterogeneous catalytic reactions are measured under conditions where concentration gradients (see below) are not significant. The reaction actually occurs on the surface of the catalyst particles. As such, the best way to normalize the rate is per unit catalyst surface area. Nonetheless, the catalyst surface area is not often used to normalize heterogeneous catalytic reaction rates. Most commonly the rates are normalized per unit mass of catalyst.</p>
<p>A few other normalization factors are sometimes used instead of the catalyst mass or surface area. Sometimes the rate is normalized per unit catalyst bed volume. When the pseudo-homogeneous PFR model is used, the catalyst bed volume is equal to the reactor volume. In other words, a rate normalized per unit catalyst bed volume can be used directly in the reactor design equations. However, the catalyst bed volume is not a very good normalization factor. It depends how tightly the catalyst particles are packed into the bed. That is, one could load the same mass of catalyst pellets into a tubular reactor three times and find three different bed volumes depending on how well the particles had settled into the tube.</p>
<p>Another potential normalization factor for heterogeneous catalytic reactions is the volume of pellets only. The pellet volume includes the pores within the individual particles, but not the space between particles. Assuming that the catalyst particles are manufactured with a consistent pore volume, this is an acceptable heterogeneous catalytic reaction rate normalziation factor.</p>
<p>The rate expression used to calculate the rate that is substituted into the reactor design equations must be normalized per bed volume. As just noted, this is not a common rate normalization factor due to variations in packing the bed. As such, it is more likely that the rate expression will be normalized per catalyst surface area, per catalyst mass, or per catalyst particle volume, in which case it must be renormalized for use in the design equations.</p>
<p><strong>When the rate is normalized per unit catalyst mass</strong>, then the bed density must be measured when the catalyst is loaded into the reactor. Doing so is relatively straightforward. Before the catalyst is loaded into the reactor, the volume into which the catalyst will be loaded can be measured. The total mass of catalyst particles loaded into the reactor can then be measured. The <strong>bed density</strong> is simply the total mass of catalyst loaded divided by the volume into which it was loaded, <a href="#eq-bed_density" class="quarto-xref">Equation&nbsp;<span>13.9</span></a>. The rate per catalyst mass can then be renormalized by multiplying it by the bed density, <a href="#eq-renormalize_rate_per_mass" class="quarto-xref">Equation&nbsp;<span>13.10</span></a>.</p>
<p><span id="eq-bed_density"><span class="math display">\[
\rho_{bed} = \frac{m_{cat}}{V_{bed}}
\tag{13.9}\]</span></span></p>
<p><span id="eq-renormalize_rate_per_mass"><span class="math display">\[
r_{\text{(per reactor volume)}} = \rho_{bed} r_{\text{(per catalyst mass)}}
\tag{13.10}\]</span></span></p>
<p>There are experimental techniques and instruments for measuring the catalyst’s <strong>specific surface area</strong>, <span class="math inline">\(S_{cat}\)</span>, that is, the surface area per mass of catalyst. <strong>When the rate is normalized per catalyst surface area</strong>, it can be renormalized simply by multiplying it by the specific surface area to get the rate per catalyst mass, and then applying <a href="#eq-renormalize_rate_per_mass" class="quarto-xref">Equation&nbsp;<span>13.10</span></a>, as shown in <a href="#eq-renormalize_rate_per_area" class="quarto-xref">Equation&nbsp;<span>13.11</span></a>.</p>
<p><span id="eq-renormalize_rate_per_area"><span class="math display">\[
r_{\text{(per reactor volume)}} =  \rho_{bed} S_{cat} r_{\text{(per catalyst area)}}
\tag{13.11}\]</span></span></p>
<p><strong>When the rate is normalized per catalyst particle volume</strong> it is convenient to define <span class="math inline">\(\epsilon\)</span> as the catalyst bed <strong>void fraction</strong>, <a href="#eq-void_fraction" class="quarto-xref">Equation&nbsp;<span>13.12</span></a>. It is simply the fraction of the bed volume that is not occupied by catalyst particles. Using that definition, an expression for ratio of the particle volume to the bed volume can be generated, <a href="#eq-particle_volume_per_bed_volume" class="quarto-xref">Equation&nbsp;<span>13.13</span></a>. The rate per particle volume then can be renormalized by multiplying it by this ratio, <a href="#eq-renormalize_rate_per_particle_volume" class="quarto-xref">Equation&nbsp;<span>13.14</span></a>.</p>
<p><span id="eq-void_fraction"><span class="math display">\[
\epsilon = \frac{V_{void}}{V_{bed}} = \frac{V_{void}}{V_{void} + V_{part}}
\tag{13.12}\]</span></span></p>
<p><span id="eq-particle_volume_per_bed_volume"><span class="math display">\[
\frac{V_{part}}{V_{bed}} = \frac{V_{bed} - V_{void}}{V_{bed}} = \frac{1 - \frac{V_{void}}{V_{bed}}}{1} = 1 - \epsilon
\tag{13.13}\]</span></span></p>
<p><span id="eq-renormalize_rate_per_particle_volume"><span class="math display">\[
r_{\text{(per reactor volume)}} = \left( 1 - \epsilon \right) r_{\text{(per particle volume)}}
\tag{13.14}\]</span></span></p>
</section>
<section id="sec-packed_bed_gradients" class="level3" data-number="13.6.3">
<h3 data-number="13.6.3" class="anchored" data-anchor-id="sec-packed_bed_gradients"><span class="header-section-number">13.6.3</span> Concentration and Temperature Gradients in Packed Bed PFRs</h3>
<p>The renormalizations described above all make the implicit assumption that the fluid composition and temperature is uniform in any reactor cross-section. As illustrated <a href="#fig-catalyst_gradients" class="quarto-xref">Figure&nbsp;<span>13.5</span></a>, gradients can form at the interface between two phases, and if one of the phases is porous, gradients can also form within the pores. The middle of the figure shows a cross-section of a packed bed PFR and then zooms in at the bottom of the figure to just show portions of two porous catalyst particles in gray and the fluid in blue. The zoomed in view on the left side shows a uniform blue in the space between the catalyst particles and within the pores of the portions of the two particles that are visible. The uniformity of the blue means that the concentration and temperature are uniformly the same everywhere. This is what the renormalizations assume.</p>
<div id="fig-catalyst_gradients" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-catalyst_gradients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/external_gradients.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-catalyst_gradients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.5: Concentration and temperature gradients between the bulk of the fluid in the void space and the surface of the catalyst particles and within the catalyst particles.
</figcaption>
</figure>
</div>
<p>The zoomed in view shown in the lower right of the figure shows that in fact, there can be temperature and concentration gradient between the bulk of the fluid and the external surface of the catalyst particles <em>and</em> there can be concentration and temperature gradients within the pores of the solid catalyst particles. The blue color in the bulk of the fluid (center of the zoomed view) is uniform, but a gradient in color (representative of concentration and temperture gradients) is seen as the external surface of the two particles are approached. Concentration and temperature gradients between the bulk of the fluid and the surface of the particles are referred to as <strong>external gradients</strong>. Looking more closely at the figure it can be seen that there is also a gradient within the catalyst particles. These gradients are called <strong>internal gradients</strong>.</p>
<p>The problem this presents is as follows. The concentrations and temperatures that are used in the rate expression and the reactor design equations are the bulk fluid concentrations and temperatures. If there are no gradients, as in the lower left of the figure, this does not cause a problem. However, if there are gradients, then the concentrations and temperature within the catalst particle are different from those in the bulk fluid. In other words, the rate should be calculated using the concentrations and temperatured within the catalyst pores because that is where the reaction is taking place, but instead, the rate is being calculated using the bulk fluid concentrations and temperature.</p>
<p>The consequences of using the bulk fluid reactant concentrations in the rate expression when there are gradients present is indicated in <a href="#fig-effect_of_gradients" class="quarto-xref">Figure&nbsp;<span>13.6</span></a>. The upper panel, a in the figure, represents a situation where the catalyst (gray) is not porous, but there are gradients (pink) between the bulk fluid (blue) and the catalyst surface. The region within which the gradients exist (pink) is called the <strong>boundary layer</strong>. The graph on the right of the top panel plots the concentration of a reactant as a function of the distance into the boundary layer. The concentration of a reactant decreases across the boundary layer. As a consequence, the concentration at the surface of the catalyst, <span class="math inline">\(C_{surf}\)</span>, is smaller than the bulk fluid concentration <span class="math inline">\(C_{bulk}\)</span>. It is important to realize that no reaction occurs within the boundary layer because the reaction is catalyzed and only occurs on the catalyst surface. The net effect of the external gradient is that the concentration that <em>should</em> be used in the rate expression, <span class="math inline">\(C_{surf}\)</span>, is smaller than the bulk fluid concentration <span class="math inline">\(C_{bulk}\)</span>. <span class="math inline">\(C_{surf}\)</span> is colored red in the graph to indicate that reaction takes place at that concentration. If the gradient is ignored and the rate is calculated using the bulk concentration, the rate will be larger than it should be, and the predictions made by the reactor design equaions will be incorrect.</p>
<div id="fig-effect_of_gradients" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-effect_of_gradients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/effect_of_gradients.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-effect_of_gradients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.6: The effect of external gradients, internal gradients and both external and internal gradients in concentration upon the rate of reaction. The concentrations at the location were reaction occurs are indicated in red in the graphs.
</figcaption>
</figure>
</div>
<p>The middle panel, b in <a href="#fig-effect_of_gradients" class="quarto-xref">Figure&nbsp;<span>13.6</span></a>, depicts a situation where there are no external gradients, but the catalyst is porous and the reactant diffuses into a catalyst pore (yellow). Since there isn’t a boundary layer, the concentraton at the external surface of the catalyst is equal to <span class="math inline">\(C_{bulk}\)</span>. Being within the pore (and therefore in contact with the catalyst surface), some of the reactant can react as it diffuses into the catalyst pore. The graph to the right of that schematic plots the reactant concentration as a function of the distance into the catalyst particle. The line in the graph is colored red because reaction takes place all along the pore. In other words, the rate should not be evaluated only at <span class="math inline">\(C_{bilk}\)</span>, but at a range of concentrations that exist within the catalyst pore. Once again, if the rate is evaluated only at <span class="math inline">\(C_{bulk}\)</span> it will be too large and the results from the reactor design equations will be incorrect.</p>
<p>Without going into as much detail, the bottom panel, c in <a href="#fig-effect_of_gradients" class="quarto-xref">Figure&nbsp;<span>13.6</span></a>, depicts a situation where there are both external and internal gradients. The graph to the right of the schematic shows that in this situation the rate again occurs over a range of reactant concentrations, but all of them are less than the bulk fluid concentration. Yet again, if the rate is evaluated only at <span class="math inline">\(C_{bulk}\)</span> it will be too large and the results from the reactor design equations will be incorrect.</p>
<p>Several approaches are possible to account for concentration and temperature gradients associated with heterogeneous catalysts. This chapter does not attempt to present a comprehensive discussion of the topic, but instead considers one of the simplest of situations, illustrating one approach to accounting for concentration gradients. In particular, this chapter only considers concentration gradients (an analogous approach can be used to account for temperature gradients), it only considers a system where Fick’s law describes diffusion and where there is equal and opposite counter-diffusion. Additional limitations will be introduced during the analyses. In short, this chapter is intended to provide an introductory basis for those who wish to learn more through independent study or a second course on reaction engineering.</p>
<p><strong>Accounting for External Concentration Gradients</strong> The flux of a reactant, A, through the boundary layer is usually described in terms of a mass transfer coefficient, <span class="math inline">\(k_c\)</span>, where the subscript “c” denotes that the mass transfer coefficient is for use with concentrations as expressed in <a href="#eq-external_flux" class="quarto-xref">Equation&nbsp;<span>13.15</span></a>. The mass transfer coefficient will depend upon the geometry of the system under consideration, the fluid flow rate and fluid properties. As a consequence, values for mass transfer coefficients are often found from dimensionless correlations. <a href="#eq-jD_correlation_with_Reynolds" class="quarto-xref">Equation&nbsp;<span>13.16</span></a> is an example of such a correlation for the dimensionless quantity, <span class="math inline">\(j_D\)</span>, in terms of the Reynolds number, <span class="math inline">\(N_{Re}\)</span>. Equations <a href="#eq-jD_definition" class="quarto-xref"><span>13.17</span></a> and <a href="#eq-Reynolds_definition" class="quarto-xref"><span>13.18</span></a> are the defining equations for <span class="math inline">\(j_D\)</span> and <span class="math inline">\(N_{Re}\)</span>. Equations <a href="#eq-external_flux" class="quarto-xref"><span>13.15</span></a> through <a href="#eq-Reynolds_definition" class="quarto-xref"><span>13.18</span></a> apply specifically to flow through a packed bed of spherical particles with Reynolds numbers greater than 50. A number of correlations of this type are available; a good mass transfer textbook or chemical engineering handbook should be consulted to find an appropriate correlation for other conditions. Both <span class="math inline">\(j_D\)</span> and <span class="math inline">\(N_{Re}\)</span> may be defined differently, depending on the specific correlation being used.</p>
<p><span id="eq-external_flux"><span class="math display">\[
N_A = k_c\left( C_{A,bulk} - C_{A,surf} \right)
\tag{13.15}\]</span></span></p>
<p><span id="eq-jD_correlation_with_Reynolds"><span class="math display">\[
j_D = 0.61N_{Re}^{-0.41}
\tag{13.16}\]</span></span></p>
<p><span id="eq-jD_definition"><span class="math display">\[
j_D = \frac{\pi D_{tube}^2k_c}{4\dot{V}}\left(\frac{\mu}{\rho D_A} \right)^{2/3}
\tag{13.17}\]</span></span></p>
<p><span id="eq-Reynolds_definition"><span class="math display">\[
N_{Re} = \frac{2\dot{V}\rho}{3\pi D_{tube}^2 \mu \left(1-\epsilon \right)D_{part}}
\tag{13.18}\]</span></span></p>
<p>In general, the concentration of the reactant at the external surface of the catalyst particle is not known. Suppose, however, that the catalyst was not porous as in panel a of <a href="#fig-effect_of_gradients" class="quarto-xref">Figure&nbsp;<span>13.6</span></a>, and that the system had reached steady state. At steady state, the flux given by <a href="#eq-external_flux" class="quarto-xref">Equation&nbsp;<span>13.15</span></a> must just equal the rate of reaction on the surface of the catalyst particle. If this weren’t true, reactant would accumulate at the surface, and accumulation does not occur at steady state. Note that the rate expression should be evaluated at <span class="math inline">\(C_{A,surf}\)</span>, not <span class="math inline">\(C_{A,bulk}\)</span>. Then, for a steady state system, the flux according to <a href="#eq-external_flux" class="quarto-xref">Equation&nbsp;<span>13.15</span></a> can be set equal to the rate predicted by the rate expression at <span class="math inline">\(C_{A,surf}\)</span> (assuming the rate expression has been normalized per unit catalyst surface area).</p>
<p>The resulting expression can be solved to find the concentration of A at the surface. For example, if the reaction rate is first order in A, this leads to <a href="#eq-surface_conc_from_mass_transfer_coeff" class="quarto-xref">Equation&nbsp;<span>13.19</span></a> for the surface concentration of A. Substitution of <a href="#eq-surface_conc_from_mass_transfer_coeff" class="quarto-xref">Equation&nbsp;<span>13.19</span></a> back into the first order rate expression leads to a rate expression in terms of the bulk fluid concentration of A, <a href="#eq-rate_from_mass_transfer_coeff" class="quarto-xref">Equation&nbsp;<span>13.20</span></a>. The rate expression in terms of the bulk fluid concentration still has the appearance of a first order rate expression, <a href="#eq-apparent_first_order_from_mass_transfer_coeff" class="quarto-xref">Equation&nbsp;<span>13.21</span></a>, but the apparent rate coefficient, <span class="math inline">\(k^{\prime}\)</span>, is no longer a simple rate coefficient, <a href="#eq-apparent_rate_coeff_from_mass_trandfer_coeff" class="quarto-xref">Equation&nbsp;<span>13.22</span></a>. Thus, if only external concentration gradients were present and the catalyst was non-porous, the rate expression in <a href="#eq-rate_from_mass_transfer_coeff" class="quarto-xref">Equation&nbsp;<span>13.20</span></a> could be used in an ideal reactor model, and the model would correctly account for the external concentration gradient. This analysis only applies if the reaction is first order and the catalyst is non-porous.</p>
<p><span id="eq-surface_conc_from_mass_transfer_coeff"><span class="math display">\[
C_{A,surf} = \frac{k_c}{k + k_c}C_{A,bulk}
\tag{13.19}\]</span></span></p>
<p><span id="eq-rate_from_mass_transfer_coeff"><span class="math display">\[
-r_A = \frac{k k_c}{k + k_c}C_{A,bulk} = \left( \frac{1}{k} + \frac{1}{k_c} \right)^{-1}C_{A,bulk}
\tag{13.20}\]</span></span></p>
<p><span id="eq-apparent_first_order_from_mass_transfer_coeff"><span class="math display">\[
-r_A = k^{\prime}C_{A,bulk}
\tag{13.21}\]</span></span></p>
<p><span id="eq-apparent_rate_coeff_from_mass_trandfer_coeff"><span class="math display">\[
\frac{1}{k^{\prime}} = \frac{1}{k} + \frac{1}{k_c}
\tag{13.22}\]</span></span></p>
<p><strong>Accounting for Internal Concentration Gradients</strong> Accounting for internal concentration gradients associated with heterogeneous catalysts requires some sort of model for the pore structure of the catalyst. Each catalyst particle is likely to have its own unique pore structure. As a result, it is not practical to attempt to construct an exact physical model for the pore structure. Instead, common approaches are to construct a network of pores that are interconnected at nodes where a specified number of pores meet or to assume straight pores with circular cross sections and a distribution of pore diameters. An even simpler approach, that will be used here, is to adopt a pseudo-continuum pore model.</p>
<div id="fig-pseudo_continuum_pore_model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pseudo_continuum_pore_model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/pseudo_continuum_model.png" class="img-fluid figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pseudo_continuum_pore_model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.7: In the pseudo-continuum pore model, the reagents are assumed to diffuse in the radial direction as indicated by the arrows.
</figcaption>
</figure>
</div>
<p>The pseudo-continuum pore model completely ignores the pore structure of the solid. Instead, it treats the catalyst particle as if it is a single homogeneous phase. It further assumes that the reactants diffuse in a straight line in the radial direction, as shown in <a href="#fig-pseudo_continuum_pore_model" class="quarto-xref">Figure&nbsp;<span>13.7</span></a>. Here, the diffusion process is assumed to obey Fick’s law, but an effective diffusivity is used in place of the true diffusion coefficient. With that, a steady state mole balance on reactant A within a spherical catalyst particle takes the form given in <a href="#eq-radial_diffusion_reaction" class="quarto-xref">Equation&nbsp;<span>13.23</span></a>. It should be noted, in particular, that the appropriate diffusion coefficient to use when modeling a porous solid depends upon the chemical species present, the nominal diameter of the catalyst pores and the mode of diffusion. Possible modes of diffusion include ordinary molecular diffusion, Knudsen diffusion, configurational diffusion and surface diffusion.</p>
<p><span id="eq-radial_diffusion_reaction"><span class="math display">\[
-D_{eff,A}\left( \frac{\partial^2 C_A}{\partial r^2} + \frac{2}{r} \frac{\partial C_A}{\partial r}\right) = r_A
\tag{13.23}\]</span></span></p>
<p>In reality, of course, if you looked at any spherical shell within the catalyst particle, only a fraction of the surface of that shell would be available for diffusion because the reactant could not really diffuse through the solid, only the pores. It is commonly assumed that the fraction of the surface of any spherical shell that is available for diffusion is equal to the void fraction, <span class="math inline">\(\varepsilon\)</span>, of the catalyst particle (not the void fraction of the packed bed of particles, <span class="math inline">\(\epsilon\)</span>). Similarly, the actual path followed by a diffusing reactant in reality will twist and turn so that the distance the reactant travels to reach the center of the particle is greater than the radius of the particle. A quantity known as the tortuosity, <span class="math inline">\(\tau\)</span>, is used to account for the difference between the straight line distance to the center and the actual path length. With these two correction factors, the effective diffusivity can be related to the appropriate true diffusion coefficient for species A according to <a href="#eq-effective_diffusivity" class="quarto-xref">Equation&nbsp;<span>13.24</span></a>.</p>
<p><span id="eq-effective_diffusivity"><span class="math display">\[
D_{eff,A} = \frac{\varepsilon D_A}{\tau}
\tag{13.24}\]</span></span></p>
<p>Assuming the total number of moles is not changed by reaction, a mole balance can be written for reactant A on a differentially thin spherical shell within the spherical catalyst particle. Assuming that the rate is again first order, but it is normalized per unit mass of catalyst, and letting <span class="math inline">\(\rho_{part}\)</span> represent the apparent density of a catalyst particle, <a href="#eq-spherical_rxn_dffn" class="quarto-xref">Equation&nbsp;<span>13.25</span></a> results by taking the limit as the shell thickness goes to zero. <a href="#eq-spherical_rxn_dffn" class="quarto-xref">Equation&nbsp;<span>13.25</span></a> is equivalent to <a href="#eq-radial_diffusion_reaction" class="quarto-xref">Equation&nbsp;<span>13.23</span></a>; it is a second order differential equation that can be integrated analytically to obtain an expression for the concentration of A as a function of radial position within the catalyst particle. Doing so leads to two constants of integration. The values of these constants of integration are found by applying the boundary conditions specified in Equations <a href="#eq-spherical_rxn_dffn_bc1" class="quarto-xref"><span>13.26</span></a> and <a href="#eq-spherical_rxn_dffn_bc2" class="quarto-xref"><span>13.27</span></a>. The first boundary condition simply requires that the concentration of A at the entrance to the porous solid is equal to the external surface concentration of A. The second boundary condition is a symmetry condition that requires that the concentration gradient go to zero at the center of the particle.</p>
<p><span id="eq-spherical_rxn_dffn"><span class="math display">\[
D_{eff,A} \frac{1}{r^2} \frac{d}{dr}\left( r^2 \frac{dC_A}{dr} \right) = \rho_{part}k C_A
\tag{13.25}\]</span></span></p>
<p><span id="eq-spherical_rxn_dffn_bc1"><span class="math display">\[
C_A \big\vert_{r=R_{part}} = C_{A,surf}
\tag{13.26}\]</span></span></p>
<p><span id="eq-spherical_rxn_dffn_bc2"><span class="math display">\[
\frac{dC_A}{dr} \Big \vert_{r=0} = 0
\tag{13.27}\]</span></span></p>
<p>Integrating <a href="#eq-spherical_rxn_dffn" class="quarto-xref">Equation&nbsp;<span>13.25</span></a>, finding the constants of integration and substituting them back into the result leads to <a href="#eq-spherical_rxn_dffn_conc" class="quarto-xref">Equation&nbsp;<span>13.28</span></a> for the concentration of A as a function of radial position within the catalyst particle. <a href="#eq-spherical_rxn_dffn_conc" class="quarto-xref">Equation&nbsp;<span>13.28</span></a> only applies for a spherical catalyst particle with a first order reaction taking place. E. W. Thiele was among the first to derive models of this kind, and consequently the name Thiele modulus is given to the dimensionless quantity <span class="math inline">\(\phi\)</span>, <a href="#eq-Thiele_modulus" class="quarto-xref">Equation&nbsp;<span>13.29</span></a>, which represents the ratio of reaction rate to diffusion rate. It should be noted that in general, the definition of the Thiele modulus depends upon the geometry of the catalyst particle and the form of the rate expression.</p>
<p><span id="eq-spherical_rxn_dffn_conc"><span class="math display">\[
C_A\left(r\right) = C_{A,surf} \frac{\sinh{\left(\phi \frac{r}{R_{part}}\right)}}{\frac{r}{R_{part}}\sinh{\phi}}
\tag{13.28}\]</span></span></p>
<p><span id="eq-Thiele_modulus"><span class="math display">\[
\phi = R_{part}\sqrt{\frac{k\rho_{part}}{D_{eff,A}}}
\tag{13.29}\]</span></span></p>
<p>The flux of reactant A into the catalyst through its surface (i. e. in the negative <span class="math inline">\(r\)</span> direction) is related to the gradient in the concentration of A at the surface according to <a href="#eq-Thiele_flux_with_deriv" class="quarto-xref">Equation&nbsp;<span>13.30</span></a>. Substitution of the derivative of <a href="#eq-spherical_rxn_dffn_conc" class="quarto-xref">Equation&nbsp;<span>13.28</span></a> into equation <a href="#eq-Thiele_flux_with_deriv" class="quarto-xref">Equation&nbsp;<span>13.30</span></a> gives an expression for the flux of A into the catalyst particle, <a href="#eq-spherical_rxn_diffn_flux" class="quarto-xref">Equation&nbsp;<span>13.31</span></a>. Multiplication of this flux by the external surface area of the catalyst particle gives the rate at which reactant A enters the particle.</p>
<p><span id="eq-Thiele_flux_with_deriv"><span class="math display">\[
-N_A = D_{eff,A} \left( \frac{dC_A}{dr}\Big\vert_{r = R_{part}} \right)
\tag{13.30}\]</span></span></p>
<p><span id="eq-spherical_rxn_diffn_flux"><span class="math display">\[
-N_A = \frac{\phi D_{eff,A} C_{A,surf}}{R_{part}} \left( \frac{1}{\tanh{\phi}} - \frac{1}{\phi} \right)
\tag{13.31}\]</span></span></p>
<p>As before, at steady state, the rate at which A enters the catalyst particle must just equal the rate of reaction of A within the particle, because otherwise A would accumulate within the particle. It is interesting to compare the rate of reaction given above to the what the rate would equal if there were no concentration gradients. Letting <span class="math inline">\(\eta\)</span> represent the ratio of the actual rate of reaction (where concentration gradients exist) to the rate that would be observed if there were no concentration gradients (and <span class="math inline">\(C_A = C_{A,surf}\)</span> everywhere within the catalyst particle) leads to <a href="#eq-effectiveness_factor" class="quarto-xref">Equation&nbsp;<span>13.32</span></a>. This quantity is known as the effectiveness factor; its value is given by <a href="#eq-effectiveness_factor" class="quarto-xref">Equation&nbsp;<span>13.32</span></a> only when the reaction is first order and the catalyst particles are spherical.</p>
<p><span id="eq-effectiveness_factor"><span class="math display">\[
\eta = \frac{3}{\phi} \left( \frac{1}{\tanh{\phi}} - \frac{1}{\phi} \right)
\tag{13.32}\]</span></span></p>
<p>The utility of the effectiveness factor can be understood by first considering a situation where the external concentration gradients are negligible, such as that depicted in panel b of <a href="#fig-effect_of_gradients" class="quarto-xref">Figure&nbsp;<span>13.6</span></a>. That is, consider the case where the concentration gradient across the boundary layer is negligible. In this case, <span class="math inline">\(C_{A,surf} = C_{A,bulk}\)</span> and the actual rate of reaction, including the effect of the concentration gradients within the pores, is simply equal to the rate of reaction given by the rate expression for the bulk fluid concentration multiplied by the effectiveness factor. Put differently, in the absence of concentration gradients in the boundary layer, all that is needed in order to correct one of the ideal reactor models so that it accounts for the concentration gradients within the spherical catalyst particles is to multiply the rate expression by the effectiveness factor, as in <a href="#eq-effectiveness_rate" class="quarto-xref">Equation&nbsp;<span>13.33</span></a>, where the rate would be normalized per unit catalyst volume.</p>
<p><span id="eq-effectiveness_rate"><span class="math display">\[
-r_A = \eta \rho_{part}kC_{A,bulk}
\tag{13.33}\]</span></span></p>
<p><a href="#fig-effectiveness_vs_Thiele" class="quarto-xref">Figure&nbsp;<span>13.8</span></a> plots the effectiveness factor for a first order reaction taking place in a spherical catalyst particle as a function of the Thiele modulus. The figure shows that as the Thiele modulus goes to zero, the effectiveness factor approaches one. The effectiveness factor remains close to one for values of the Thiele modulus up to ca. 1, so generally one would prefer to operate a reactor at a Thiele modulus around 1 or less. At values of the Thiele modulus greater than 1, the effectiveness factor decreases rapidly, eventually approaching an asymptotic slope equal to <span class="math inline">\(\frac{3}{\phi}\)</span> (for a first-order reaction in a spherical particle).</p>
<div id="fig-effectiveness_vs_Thiele" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-effectiveness_vs_Thiele-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/effectiveness_vs_Thiele.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-effectiveness_vs_Thiele-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.8: Effectiveness factor for a first order reaction in a spherical catalyst particle.
</figcaption>
</figure>
</div>
<p>A word of caution is in order. When the reaction is first order, as in the analysis presented above, the Thiele modulus does not depend upon the concentration of A at the catalyst surface. This is rarely the case; for other reaction orders, the corresponding Thiele modulus, and consequently the effectiveness factor, depends upon the concentration of A at the catalyst surface. This means that as the reaction proceeds, the effectiveness factor will change. In addition, for a spherical catalyst particle and most reaction orders other than one, it has not proven possible to obtain an analytical expression for the effectiveness factor like <a href="#eq-effectiveness_factor" class="quarto-xref">Equation&nbsp;<span>13.32</span></a>, which is for a first order reaction. Instead, the effectiveness factor must be calculated numerically. Thus, it is possible to construct a plot of the effectiveness factor as a function of the Thiele modulus, similar to Figure 38.3. The problem, however, is that when that effectiveness factor is substituted into the PFR design equation, as in <a href="#eq-effectiveness_rate" class="quarto-xref">Equation&nbsp;<span>13.33</span></a>, it is no longer a constant. A rigorous solution of <a href="#eq-effectiveness_rate" class="quarto-xref">Equation&nbsp;<span>13.33</span></a> requires that the variation in the effectiveness factor be accounted for.</p>
<p><strong>Accounting for Simulaneuous External and Internal Gradients</strong> Returning to the first order case, if the concentration gradient across the boundary layer is significant, as in panel c of <a href="#fig-effect_of_gradients" class="quarto-xref">Figure&nbsp;<span>13.6</span></a>, <a href="#eq-spherical_rxn_diffn_flux" class="quarto-xref">Equation&nbsp;<span>13.31</span></a> is still valid. The only problem is that <span class="math inline">\(C_{A,surf}\)</span> is no longer equal to <span class="math inline">\(C_{A,bulk}\)</span>. However, for a steady state process, the flux into the catalyst must just equal the flux through the boundary layer. This is expressed in <a href="#eq-fluxes_equal" class="quarto-xref">Equation&nbsp;<span>13.34</span></a> which can be solved for <span class="math inline">\(C_{A,surf}\)</span> giving <a href="#eq-surf_conc" class="quarto-xref">Equation&nbsp;<span>13.35</span></a>, and the result can be substituted back into <a href="#eq-spherical_rxn_diffn_flux" class="quarto-xref">Equation&nbsp;<span>13.31</span></a> to get an expression for the flux of reactant A into the catalyst in terms of the bulk fluid concentration of A, <a href="#eq-flux_with_external" class="quarto-xref">Equation&nbsp;<span>13.36</span></a>. From that, an expression for the global effectiveness factor, <span class="math inline">\(\eta_G\)</span>, can be derived, <a href="#eq-global_effectiveness" class="quarto-xref">Equation&nbsp;<span>13.37</span></a>. The global effectiveness factor in <a href="#eq-global_effectiveness" class="quarto-xref">Equation&nbsp;<span>13.37</span></a> is the actual rate of reaction (i. e. in the presence of concentration gradients in both the boundary layer and the pores) divided by the rate of reaction in the absence of concentration gradients (i. e. if <span class="math inline">\(C_A = C_{A,bulk}\)</span> everywhere). <a href="#eq-global_effectiveness" class="quarto-xref">Equation&nbsp;<span>13.37</span></a> only applies for a first order reaction taking place isothermally in a spherical catalyst particle.</p>
<p><span id="eq-fluxes_equal"><span class="math display">\[
\frac{\phi D_{eff,A} C_{A,surf}}{R_{part}} \left( \frac{1}{\tanh{\phi}} - \frac{1}{\phi} \right) = k_c \left( C_{A,bulk} - C_{A,surf} \right)
\tag{13.34}\]</span></span></p>
<p><span id="eq-surf_conc"><span class="math display">\[
C_{A,surf} = \frac{\gamma C_{A,bulk} \tanh{\phi}}{\phi + \left( \gamma - 1 \right)\tanh{\phi}}\, \qquad \gamma = \frac{k_c R_{part}}{D_{eff,A}}
\tag{13.35}\]</span></span></p>
<p><span id="eq-flux_with_external"><span class="math display">\[
-N_A = \frac{\gamma C_{A,bulk} D_{eff,A}}{R_{part}} \frac{\phi - \tanh{\phi}}{\phi + \left( \gamma - 1 \right) \tanh{\phi}}
\tag{13.36}\]</span></span></p>
<p><span id="eq-global_effectiveness"><span class="math display">\[
\eta_G = \frac{3}{\phi} \left( \frac{1}{\tanh{\phi}} - \frac{1}{\phi} \right) \frac{\gamma \tanh{\phi}}{\phi + \left( \gamma - 1 \right) \tanh{\phi}}
\tag{13.37}\]</span></span></p>
<p>Once again, the approach presented in this unit is but one of many means of accounting for concentration gradients during heterogeneous catalysis. A similar approach can be applied to additionally account for temperature gradients. The approach used here uses the pseudo-continuum model for the porous solid; models can also be developed using other pore models. This approach can be adapted to catalyst geometries other than spherical and to situations where the total number of moles changes upon reaction. These topics are typically treated in much greater detail in advanced courses on kinetics and reaction engineering.</p>
</section>
</section>
<section id="examples" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="examples"><span class="header-section-number">13.7</span> Examples</h2>
<p>This chapter includes six examples of the analysis of an isolated PFR. The first three examples illustrate response tasks involving steady-state PFRs. A gas-phase reaction with negligible pressure drop is considered in <a href="#sec-example_13_7_1" class="quarto-xref">Example&nbsp;<span>13.7.1</span></a>, and a liquid-phase system in <a href="#sec-example_13_7_2" class="quarto-xref">Example&nbsp;<span>13.7.2</span></a>. In the former example, the reactor design equations are solved to find the PFR output, while in the latter they are solved to find the feed temperature in addition to the reactor output. <a href="#sec-example_13_7_3" class="quarto-xref">Example&nbsp;<span>13.7.3</span></a> examines a gas-phase, packed-bed PFR where a momentum balance is used to account for pressure drop. <a href="#sec-example_13_7_4" class="quarto-xref">Example&nbsp;<span>13.7.4</span></a> illustrates an optimization task for a gas-phase reaction with negligible pressure drop. <a href="#sec-example_13_7_5" class="quarto-xref">Example&nbsp;<span>13.7.5</span></a> analyzes the start-up of the PFR from <a href="#sec-example_13_7_2" class="quarto-xref">Example&nbsp;<span>13.7.2</span></a> where the transient takes the form of a front that propgates along the length of the reactor. Finally, a packed-bed PFR with concentration gradients within the catalyst pores is considered in <a href="#sec-example_13_7_6" class="quarto-xref">Example&nbsp;<span>13.7.6</span></a>.</p>
<section id="sec-example_13_7_1" class="level3" data-number="13.7.1">
<h3 data-number="13.7.1" class="anchored" data-anchor-id="sec-example_13_7_1"><span class="header-section-number">13.7.1</span> Steady-State Conversion in a Gas-Phase PFR</h3>
<p>The heat of reaction (1) is 44.8 kJ mol<sup>-1</sup>, and the reaction is irreversible. The rate expression is equation (2) where the pre-exponential factor is 7.22 x 10<sup>6</sup> mol atm<sup>-2</sup> cm<sup>-3</sup> s<sup>-1</sup> and the activation energy is 84.1 kJ mol<sup>-1</sup>. A 10 foot long tubular reactor with a diameter of 1 inch is heated by a vapor condensing at 200 °C on the outside of the tube wall. The overall heat transfer coefficient is 7.48 x 10<sup>4</sup> J h<sup>-1</sup> ft<sup>-2</sup> K<sup>-1</sup>. Pressure drop through the reactor is negligible. If a gas phase mixture of 60% A and 40% B enters the reactor at 282 L min<sup>-1</sup>, 2.5 atm and 175 °C and if the heat capacities of A, B and Z are equal to 18.0, 12.25 and 21.2 cal mol<sup>-1</sup> K<sup>-1</sup>, what steady state outlet temperature and conversion of B will result?</p>
<p><span class="math display">\[
A + B \rightarrow Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r_1 = k_1 P_A P_B \tag{2}
\]</span></p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This assignment describes an isolated PFR and the manner in which it operates and asks questions about the reactor outputs. I will need to create a model for the reactor and use it to answer the questions. I’ll first summarize the assignment by assigning an appropriate variable symbol to each quantity provided in the narrative. I’ll use a subscripted “in” to denote values at the inlet to the reactor, a subscripted “out” to denote values at the reactor outlet, and I’ll add values for the ideal gas constant since I know I’ll need them. The assignment explicitly asks for the <em>steady-state</em> values of the quantities of interest, and from reading the assignment, I see that the PFR is neither isothermal nor adiabatic, but instead it is heated.</p>
</div>
</div>
</div>
<section id="assignment-summary" class="level4" data-number="13.7.1.1">
<h4 data-number="13.7.1.1" class="anchored" data-anchor-id="assignment-summary"><span class="header-section-number">13.7.1.1</span> Assignment Summary</h4>
<p><strong>Given and Known Constants</strong>: <span class="math inline">\(\Delta H_1\)</span> = 44.8 kJ mol<sup>-1</sup>, <span class="math inline">\(k_{0,1}\)</span> = 7.22 x 10<sup>6</sup> mol atm<sup>-2</sup> cm<sup>-3</sup> s<sup>-1</sup>, <span class="math inline">\(E_1\)</span> = 84.1 kJ mol<sup>-1</sup>, <span class="math inline">\(L\)</span> = 10 ft, <span class="math inline">\(D\)</span> = 1 in, <span class="math inline">\(T_{ex}\)</span> = 200 °C, <span class="math inline">\(U\)</span> = 7.48 x 10<sup>4</sup> J h<sup>-1</sup> ft<sup>-2</sup> K<sup>-1</sup>, <span class="math inline">\(y_{A,in}\)</span> = 0.60, <span class="math inline">\(y_{B,in}\)</span> = 0.40, <span class="math inline">\(\dot{V}_{in}\)</span> = 282 L min<sup>-1</sup>, <span class="math inline">\(P\)</span> = 2.5 atm, <span class="math inline">\(T_{in}\)</span> = 175 °C, <span class="math inline">\(\hat{C}_{p,A}\)</span> = 18.0 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,B}\)</span> = 12.25 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Z}\)</span> = 21.2 cal mol<sup>-1</sup> K<sup>-1</sup>, and <span class="math inline">\(R\)</span> = 8.314 J mol<sup>-1</sup> K<sup>-1</sup> = 0.08206 L atm mol<sup>-1</sup> K<sup>-1</sup>.</p>
<p><strong>Reactor System</strong>: Heated, steady-state PFR with negligible pressure drop</p>
<p><strong>Quantities of Interest</strong>: <span class="math inline">\(T_{out}\)</span> and <span class="math inline">\(f_B\)</span></p>
</section>
<section id="mathematical-formulation-of-the-solution" class="level4" data-number="13.7.1.2">
<h4 data-number="13.7.1.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-solution"><span class="header-section-number">13.7.1.2</span> Mathematical Formulation of the Solution</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I need to generate the reactor design equations for modeling this particular PFR as discussed in <a href="section_3_design_equations.html" class="quarto-xref"><span>Chapter 6</span></a>. The minimum number of mole balances is equal to the number of mathematically independent reactions plus one mole balance per inert species. Since I’m going to solve them numerically, it’s just as easy to write a mole balance on every reagent in the system (A, B, and Z in this assignment). The PFR operates at steady-state, so I’ll start with the general form of the steady-state PFR mole balance given in <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>. There is only one reaction taking place, so the summation reduces to a single term.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z}  =\frac{\pi D^2}{4}\cancelto{\nu_{i,1}r_1}{\sum_j \nu_{i,j}r_j}
\]</span></p>
<p>This reactor is not isothermal, so the mole balances cannot be solved separately from an energy balance on the reacting gas. To generate that equation, I’ll start from the general form of the steady-state PFR energy balance, <a href="section_3_design_equations.html#eq-pfr_ss_energy_balance" class="quarto-xref">Equation&nbsp;<span>6.40</span></a>. There are three reagents present in the reactor, so the first summation expands to three terms. Again, there is only one reaction taking place, so the final summation reduces to a single term. Knowing that I will be solving the design equations numerically, and that I’ll have to evaluate each of the derivatives, I’ll rearrange the equation into the form of a derivative expression (<a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix J</span></a>).</p>
<p><span class="math display">\[
\cancelto{\left( \dot{n}_A \hat{C}_{p,A} + \dot{n}_B \hat{C}_{p,B} + \dot{n}_Z \hat{C}_{p,Z}  \right)}{\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right)} \frac{d T}{d z} = \pi D U\left( T_{ex} - T  \right) - \frac{\pi D^2}{4}\cancelto{r_1 \Delta H_1}{\sum_j r_j \Delta H_j}
\]</span></p>
<p><span class="math display">\[
\frac{d T}{d z} = \frac{\pi D U\left( T_{ex} - T  \right) - \frac{\pi D^2}{4}r_1 \Delta H_1}{\dot{n}_A \hat{C}_{p,A} + \dot{n}_B \hat{C}_{p,B} + \dot{n}_Z \hat{C}_{p,Z}}
\]</span></p>
<p>The PFR is being heated using the latent heat of a heat exchange fluid. Because only the latent heat is involved, the temperature of the exchange fluid is constant. That means that I can solve the combined mole and reacting fluid energy balances independently of an energy balance on the heat exchange fluid. (In this assignment I’m not provide with sufficient information to solve the exchange fluid energy balance, but neither does the assignment ask for anything that would need to be calculated using it.)</p>
<p>Finally, for PFRs a momentum balance is needed to account for pressure drop along the length of the reactor. In this assignment, however, it is noted that pressure drop is negligible, so I won’t add a momentum balance to the reactor design equations.</p>
</div>
</div>
</div>
<p><strong>Reactor Design Equations</strong></p>
<p>Mole balance design equations for A, B, and Z are presented in equations (3) - (5). The energy balance on the reacting gas is given in equation (6).</p>
<p><span class="math display">\[
\frac{d \dot{n}_A}{dz} = -\frac{\pi D^2}{4}r_1 \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_B}{dz} = -\frac{\pi D^2}{4}r_1 \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_Z}{dz} = \frac{\pi D^2}{4}r_1 \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{d T}{d z} = \frac{\pi D U\left( T_{ex} - T  \right) - \frac{\pi D^2}{4}r_1 \Delta H_1}{\left( \dot{n}_A \hat{C}_{p,A} + \dot{n}_B \hat{C}_{p,B} + \dot{n}_Z \hat{C}_{p,Z} \right)} \tag{6}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The reactor design equations consist of four IVODEs and they contain four dependent variables, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, so there isn’t a need to either eliminate a dependent variable or add an IVODE. However, in order to solve the design equations numerically, initial values and a stopping criterion are needed.</p>
<p>I can define <span class="math inline">\(z=0\)</span> to be the inlet to the reactor. The other initial values are then simply the values of the depedent variables at the reactor inlet. The length of the reactor is provided, so that can serve as the stopping criterion.</p>
</div>
</div>
</div>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_13_7_1_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_13_7_1_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.1: Initial values and stopping criterion for solving equations, (numbers).
</figcaption>
<div aria-describedby="tbl-example_13_7_1_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(L\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{B,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(T_{in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to solve the IVODEs numerically I’ll need to do two things: calculate the values of the derivatives at the start of each integration step and calculate all of the initial and final values in <a href="#tbl-example_13_7_1_initial_values" class="quarto-xref">Table&nbsp;<span>13.1</span></a>.</p>
<p>At the start of each integration step, the independent variable (<span class="math inline">\(z\)</span>) and the dependent variables (<span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>) will be known, as will the given and known constants listed above. I will need to calculate any other quantities that appear in the derivatives expressions, equations (3) through (6).</p>
<p>Looking at those equations I see that I’ll need to calculate the rate, <span class="math inline">\(r_1\)</span>. I can use the rate expression, equation (2), to do that, but that wiill require me to calculate the rate coefficient, <span class="math inline">\(k_1\)</span>, and the partial pressures of A and B. The Arrhenius expression, <a href="section_2_rates_and_expressions.html#eq-arrhenius" class="quarto-xref">Equation&nbsp;<span>4.8</span></a>, can be used for the former and a defining equation for partial pressure for the latter.</p>
<p><span class="math display">\[
P_i = y_iP = \frac{\dot{n}_i}{\sum_i\dot{n}_i}
\]</span></p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Evaluating the Derivatives</strong></p>
<p><span class="math display">\[
k_1 = k_{0,1} \exp{\left( \frac{-E_1}{RT} \right)} \tag{7}
\]</span></p>
<p><span class="math display">\[
P_A = \frac{\dot{n}_A}{\dot{n}_A + \dot{n}_B + \dot{n}_Z}P \tag{8}
\]</span></p>
<p><span class="math display">\[
P_B = \frac{\dot{n}_B}{\dot{n}_A + \dot{n}_B + \dot{n}_Z}P \tag{9}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When I solve the IVODEs numerically, I’ll also need to calculate the initial and final values in <a href="#tbl-example_13_7_1_initial_values" class="quarto-xref">Table&nbsp;<span>13.1</span></a>. The reactor length and feed temperature are given in the assignment narrative. The narrative also provides the inlet mole fractions of A and B and the inlet volumetric flow rate. The ideal gas law can be used to calculate the total inlet molar flow rate which can be multiplied by each reagent mole fraction to calculate the inlet molar flow of that reagent.</p>
<p><span class="math display">\[
\dot{n}_{i,in} = y_{i,in} \dot{n}_{total,in} =  y_{i,in} \frac{P\dot{V}_{in}}{RT_{in}}
\]</span></p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Initial and Final Values</strong></p>
<p><span class="math display">\[
\dot{n}_{A,in} = y_{A,in}\frac{P\dot{V}_{in}}{RT_{in}}\tag{10}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,in} = y_{B,in}\frac{P\dot{V}_{in}}{RT_{in}}\tag{11}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point the reactor design equations can be solved numerically to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> spanning the range from their initial (inlet) values to their final (outlet) values. The outlet temperature is one of the quantities of interest. The other, namely the fractional conversion of B can be calculated using its defining equation for an open system, <a href="section_1_reaction_progress.html#eq-conversion_def_open" class="quarto-xref">Equation&nbsp;<span>3.5</span></a>.</p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Quantities of Interest</strong></p>
<p>Solving the reactor design equations yields <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> as functions of <span class="math inline">\(z\)</span> between 0 and <span class="math inline">\(L\)</span>. The outlet temperature and the conversion of B can be calculated using equations (12) and (13).</p>
<p><span class="math display">\[
T_{out} = T \big \vert_{z=L} \tag{12}
\]</span></p>
<p><span class="math display">\[
f_B = \frac{\dot{n}_{B,in} - \dot{n}_B}{\dot{n}_{B,in}}\tag{13}
\]</span></p>
<p><strong>Calculations Summary</strong></p>
<ol type="1">
<li>Substitute given and known constants into all equations.</li>
<li>When it is necessary to evaluate the derivatives
<ol type="a">
<li><span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> will be available</li>
<li>calculate <span class="math inline">\(k_1\)</span>, <span class="math inline">\(P_A\)</span>, and <span class="math inline">\(P_B\)</span> using equtions (7) - (9).</li>
<li>calculate <span class="math inline">\(r_1\)</span> using equation (2).</li>
<li>evaluate the derivatives using equations (3) - (6).</li>
</ol></li>
<li>When it is necessary to calculate the initial and final values in <a href="#tbl-example_13_7_1_initial_values" class="quarto-xref">Table&nbsp;<span>13.1</span></a>
<ol type="a">
<li><span class="math inline">\(T_{in}\)</span> and <span class="math inline">\(L\)</span> are known constants.</li>
<li>calculate <span class="math inline">\(\dot{n}_{A,in}\)</span> and <span class="math inline">\(\dot{n}_{B,in}\)</span> using equations (10) and (11).</li>
</ol></li>
<li>When it is necessary to calculate the quantities of interest, <span class="math inline">\(T \big\vert_{z=L}\)</span> and <span class="math inline">\(f_B\)</span>
<ol type="a">
<li>corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial values to their final values will be available.</li>
<li>calculate %T_{out}$ and <span class="math inline">\(f_B\)</span> using equations (12) and (13).</li>
</ol></li>
</ol>
</section>
<section id="numerical-implementation-of-the-solution" class="level4" data-number="13.7.1.3">
<h4 data-number="13.7.1.3" class="anchored" data-anchor-id="numerical-implementation-of-the-solution"><span class="header-section-number">13.7.1.3</span> Numerical implementation of the Solution</h4>
<ol type="1">
<li>Make the given and known constants available for use in all functions.</li>
<li>Write a derivatives function that
<ol type="a">
<li>receives the independent and dependent variables, <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, as arguments,</li>
<li>evaluates the derivatives as described in step 2 of the calculations summary, and returns them.</li>
</ol></li>
<li>Write a reactor model function that
<ol type="a">
<li>calculates the initial and final values in <a href="#tbl-example_13_7_1_initial_values" class="quarto-xref">Table&nbsp;<span>13.1</span></a> as described in step 3 of the calculations summary,</li>
<li>gets corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial values to their final values by calling an IVODE solver and passing the following information to it
<ol type="i">
<li>the initial values and stopping criterion in <a href="#tbl-example_13_7_1_initial_values" class="quarto-xref">Table&nbsp;<span>13.1</span></a> and</li>
<li>the name of the derivatives function from step 2 above, c, checks that the solver successfully solved the IVODEs, and</li>
</ol></li>
<li>returns the values returned by the IVODE solver.</li>
</ol></li>
<li>Perform the analysis by
<ol type="a">
<li>calling the reactor model function from step 3 above to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial values to their final values, and</li>
<li>calculating the quantities of interest as described in step 4 of the calculations summary,</li>
</ol></li>
</ol>
</section>
<section id="results-and-discussion" class="level4" data-number="13.7.1.4">
<h4 data-number="13.7.1.4" class="anchored" data-anchor-id="results-and-discussion"><span class="header-section-number">13.7.1.4</span> Results and Discussion</h4>
<p>The calculations were performed as described above. The outlet temperature is 138 °C and the conversion of B is 81.6 %. Apparently the rate of heat transfer to the reactor from the vapor condensing on the outside of the reactor wall is less than the heat absorbed by the endothermic reaction. The feed enters at 175 °C, and despite the heat being supplied by the 200 °C heat exchange fluid, the reacting fluid temperature drops to 138 °C by the time it reaches the reactor outlet.</p>
<p>As the temperature drops, the reaction rate decreases. If heat was not being supplied, the temperature would have dropped even lower resulting in a lower conversion at the reactor outlet.</p>
</section>
</section>
<section id="sec-example_13_7_2" class="level3" data-number="13.7.2">
<h3 data-number="13.7.2" class="anchored" data-anchor-id="sec-example_13_7_2"><span class="header-section-number">13.7.2</span> Required Steady-State PFR Feed Temperature</h3>
<p>A perfectly insulated tubular reactor with a diameter of 10 cm and a length of 5 m is fed an aqueous solution containing A and B at concentrations of 1.0 and 1.2 M, respectively. This feed stream flows at 75 L min<sup>-1</sup>. Reagents A and B react according to reaction (1) with a rate of reaction that is accurately described by equation (2). The rate coefficient displays Arrhenius temperature dependence with a pre-exponential factor equal to 8.72 x 10<sup>5</sup> L mol<sup>-1</sup> min<sup>-1</sup> and an activation energy of 7200 cal mol<sup>-1</sup>. The heat of reaction (1) is –10,700 cal mol<sup>-1</sup> and may be assumed to be constant. The heat capacity of the solution and the density of the solution may be taken to be constant and equal to those of water (1.0 cal g<sup>-1</sup> K<sup>-1</sup> and 1.0 g cm<sup>-3</sup>). The pressure drop in the reactor is negligible. What feed temperature is needed in order to convert 95% of the A, and what will the outlet temperature be?</p>
<p><span class="math display">\[
A + B \rightarrow Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r_1 = k_1 C_A C_B \tag{2}
\]</span></p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This assignment describes an isolated steady-state PFR and its operation, and it asks about reactor inputs and outputs. To begin, I’ll summarize the assignment by assigning appropriate variable symbols to all of the quantities it mentions. I’ll use a subscripted “in” to denote values that apply to the feed and a subscripted “out” to denote values that apply to the reactor outlet. I’ll add the ideal gas constant to the list since I know I’ll need it.</p>
<p>The assignment states that the reactor is perfectly insulated. That means that it does not exchange heat through its walls, i. e. it is adiabatic. The assignment does not explicitly state that it operates at steady-state, but there is no mention of a change in any of the reactor inputs anywhere in the narrative. If the reactor was operating in a transient mode, something would have had to change to initiate the transient. Since no such change is mentioned, I can safely assume steady-state operation.</p>
</div>
</div>
</div>
<section id="assignment-summary-1" class="level4" data-number="13.7.2.1">
<h4 data-number="13.7.2.1" class="anchored" data-anchor-id="assignment-summary-1"><span class="header-section-number">13.7.2.1</span> Assignment Summary</h4>
<p><strong>Given and Known Constants</strong>: <span class="math inline">\(D\)</span> = 10 cm, <span class="math inline">\(L\)</span> = 5 m, <span class="math inline">\(C_{A,in}\)</span> = 1.0 M, <span class="math inline">\(C_{B,in}\)</span> = 1.2 M, <span class="math inline">\(\dot{V}_{in}\)</span> = 75 L min<sup>-1</sup>, <span class="math inline">\(k_{0.1}\)</span> = 8.72 x 10<sup>5</sup> L mol<sup>-1</sup> min<sup>-1</sup>, <span class="math inline">\(E_1\)</span> = 7200 cal mol<sup>-1</sup>, <span class="math inline">\(\Delta H_1\)</span> = –10,700 cal mol<sup>-1</sup>, <span class="math inline">\(\tilde{C}_p\)</span> = 1.0 cal g<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\rho\)</span> = 1.0 g cm<sup>-3</sup>, <span class="math inline">\(f_A\)</span> = 0.95, and <span class="math inline">\(R\)</span> = 1.987 cal mol<sup>-1</sup> K<sup>-1</sup>.</p>
<p><strong>Reactor System</strong>: Adiabatic, steady-state PFR with negligible pressure drop</p>
<p><strong>Quantities of Interest</strong>: <span class="math inline">\(T_{in}\)</span> and <span class="math inline">\(T_{out}\)</span></p>
</section>
<section id="mathematical-formulation-of-the-solution-1" class="level4" data-number="13.7.2.2">
<h4 data-number="13.7.2.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-solution-1"><span class="header-section-number">13.7.2.2</span> Mathematical Formulation of the Solution</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to complete this assignment I will need to create a model of this PFR and use it to answer the questions posed. I need to generate the reactor design equations for this PFR in order to model it. The design equations always include mole balances. Knowing I’ll be solving the design equations numerically, I’ll just write a mole balance on every reagent present in the system. This reactor operates at steady-state, so the general form of the mole balance is given by <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>. There is only one reaction taking place, so the summation reduces to a single term.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z} = \frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j = \frac{\pi D^2}{4}\nu_{i,1}r_1
\]</span></p>
<p>The reactor is not isothermal, so I cannot solve the mole balances independently. I need to add an energy balance on the reacting fluid. The general form of the steady-state PFR reacting fluid energy balance is given by <a href="section_3_design_equations.html#eq-pfr_ss_energy_balance" class="quarto-xref">Equation&nbsp;<span>6.40</span></a>. The narrative provides the gravimetric heat capacity and the density of the liquid phase reacting fluid, to the first term can be modified to use that information. This PFR is adiabatic, so the heat exchange term is equal to zero, and again, there is only one reaction taking place.</p>
<p><span class="math display">\[
\cancelto{\rho \dot{V} \breve{C}_p}{\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right)} \frac{d T}{d z} = \cancelto{0}{\pi D U\left( T_{ex} - T  \right)} - \frac{\pi D^2}{4}\cancelto{r_1 \Delta H_1}{\sum_j r_j \Delta H_j}
\]</span></p>
<p>When I solve the design equations numerically, I’m going to need to evaluate the derivatives, so I will re-write the equation in the form of a derivative expression (see <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix J</span></a>).</p>
<p><span class="math display">\[
\frac{d T}{d z} = -\frac{\pi D^2}{4} \frac{r_1 \Delta H_1}{\rho \dot{V} \tilde{C}_p}
\]</span></p>
<p>The reactor is adiabatic, so there isn’t a heat exchange fluid to write an energy balance on. The pressure drop is negligible, so a momentum balance is not needed.</p>
</div>
</div>
</div>
<p><strong>Reactor Design Equations</strong></p>
<p>Mole balance design equations for A, B, Y, and Z are presented in equations (3) through (6), and an energy balance on the reacting fluid is given in equation (7).</p>
<p><span class="math display">\[
\frac{d \dot{n}_A}{dz} = - \frac{\pi D^2}{4}r_1 \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_B}{dz} = - \frac{\pi D^2}{4}r_1 \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_Y}{dz} = \frac{\pi D^2}{4}r_1 \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_Z}{dz} = \frac{\pi D^2}{4}r_1 \tag{6}
\]</span></p>
<p><span class="math display">\[
\frac{d T}{d z} = -\frac{\pi D^2}{4} \frac{r_1 \Delta H_1}{\rho \dot{V} \tilde{C}_p} \tag{7}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are five IVODE reactor design equations and they contain five dependent variables (<span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and %T%), so there isn’t a need to eliminae a dependent variable or add an IVODE.</p>
<p>Initial values and a stopping criterion are needed when solving IVODEs numerically. I can define <span class="math inline">\(z=0\)</span> to be the inlet to the reactor, in which case the other initial values are the molar flow rates and the temperture at the reactor inlet. The feed only contains A and B, so the inlet molar flow rates of Y and Z are zero. The length of the reactor is given, so that can serve as the stopping criterion.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The assignment also specifies the conversion of A. As such, I could have used the final value of A <span class="math inline">\(\left(\dot{n}_{A,out} = \dot{n}_{A,in}\left( 1 - f_A \right)\right)\)</span> as the stopping criterion. In that case I’d calculate <span class="math inline">\(T_{in}\)</span> below using an implicit equation that requires the reactor length to equal <span class="math inline">\(L\)</span> <span class="math inline">\(\left(T_{in}: z_{out} = L\right)\)</span>.</p>
<p>In the solution presented here I am using <span class="math inline">\(z=L\)</span> as the stopping criterion and calculating <span class="math inline">\(T_{in}\)</span> below using an implicit equation requires the conversion to have the specified value <span class="math inline">\(\left(T_{in}: f_{A} \big \vert_{z=L} = f_A\right)\)</span>.</p>
<p>Both approaches are valid and will produce the same results.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_13_7_2_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_13_7_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.2: Initial values and stopping criterion for solving equations, (3) - (7).
</figcaption>
<div aria-describedby="tbl-example_13_7_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(L\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{B,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(T_{in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to solve the IVODEs numerically I’ll need to do two things: calculate the values of the derivatives at the start of each integration step and calculate all of the initial and final values in <a href="#tbl-example_13_7_2_initial_values" class="quarto-xref">Table&nbsp;<span>13.2</span></a>. At the start of an integration step, the independent (<span class="math inline">\(z\)</span>) and dependent variables (<span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>) will be known, as will the given and known constants listed above. I will need to calculate any other quantities that appear in the derivatives expressions, equations (3) - (7).</p>
<p>In those equations, the reaction rate, <span class="math inline">\(r_1\)</span>, and the volumetric flow rate, <span class="math inline">\(\dot{V}\)</span>, are unknown. The rate can be calculated using the rate expression, equation (2). In order to do that, the rate coefficient and the concentrations of A and B must be calculated. The rate coefficient can be calculated using the Arrhenius expression, <a href="section_2_rates_and_expressions.html#eq-arrhenius" class="quarto-xref">Equation&nbsp;<span>4.8</span></a>. The concentrations can be calculated using the defining equation for concentration in an open system, <a href="section_1_intro_and_defs.html#eq-concentration_open" class="quarto-xref">Equation&nbsp;<span>1.15</span></a>. The reacting fluid is a liquid; assuming it to be an incompressible ideal mixture means that the volumetric flow rate will be constant and equal to the inlet volumetric flow rate.</p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Evaluating the Derivatives</strong></p>
<p><span class="math display">\[
k_1 = k_{0,1} \exp{\left( \frac{-E_1}{RT} \right)} \tag{8}
\]</span></p>
<p><span class="math display">\[
C_A = \frac{\dot{n}_A}{\dot{V}} \tag{9}
\]</span></p>
<p><span class="math display">\[
C_B = \frac{\dot{n}_B}{\dot{V}} \tag{10}
\]</span></p>
<p><span class="math display">\[
\dot{V} = \dot{V}_{in} \tag{11}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When I solve the IVODEs numerically, I’ll also need to calculate the initial and final values in <a href="#tbl-example_13_7_2_initial_values" class="quarto-xref">Table&nbsp;<span>13.2</span></a>. The reactor length, <span class="math inline">\(L\)</span>, is provided in the assignment narrative, and the inlet molar flow rates of A and B can be calculated from their known inlet concentrations and the inlet volumetric flow rate, <a href="section_1_intro_and_defs.html#eq-concentration_open" class="quarto-xref">Equation&nbsp;<span>1.15</span></a>.</p>
<p>The feed temperature, <span class="math inline">\(T_{in}\)</span>, is not specified. Indeed, it is one of the quatntities of interest. Instead, however, a second outlet value, namely the conversion, is provided. The inlet temperature must result in a conversion, <span class="math inline">\(f_A \big \vert_{z=L}\)</span>, equal to the specified conversion, <span class="math inline">\(f_A\)</span>, listed among the given and known quantities above. As described in <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix J</span></a>, this can be written as an implicit equation for calculating <span class="math inline">\(T_{in}: f_A \big \vert_{z=L} = f_{A,out}\)</span>. That implicit equation can be written as a residual expression (see <a href="apndx_solve_ates.html" class="quarto-xref"><span>Appendix I</span></a>) and solved numerically.</p>
<p><span class="math display">\[
0 = f_{A,out} - f_A \big \vert_{z=L}
\]</span></p>
<p><span class="math display">\[
0 = f_{A,out} - \frac{\dot{n}_{A,in} - \dot{n}_A \big\vert_{z=L}}{\dot{n}_{A,in}}
\]</span></p>
<p><span class="math display">\[
0 = \dot{n}_{A,in}f_{A,out} - \dot{n}_{A,in} + \dot{n}_A \big\vert_{z=L}
\]</span></p>
<p><span class="math display">\[
0 = \dot{n}_A \big \vert_{z=L} - \dot{n}_{A,in}\left( 1 - f_A \right) = \epsilon
\]</span></p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Initial and Final Values</strong></p>
<p>The inlet molar flow rates can be calculated using equations (12) and (13). The inlet temperature, <span class="math inline">\(T_{in}: f_A \big \vert_{z=L} = f_{A,out}\)</span>, can be found by numerically solving the implicit equation, (14), for its value.</p>
<p><span class="math display">\[
\dot{n}_{A,in} = \dot{V}_{in}C_{A,in} \tag{12}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,in} = \dot{V}_{in}C_{B,in} \tag{13}
\]</span></p>
<p><span class="math display">\[
0 = \dot{n}_A \big \vert_{z=L} - \dot{n}_{A,in}\left( 1 - f_A \right) = \epsilon \tag{14|}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point the IVODEs can be solved for the feed temperature, <span class="math inline">\(T_{in}\)</span>, and corresponding set of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> that span the range from their initial values to their final values. There aren’t any other quantities of interest that need to be calculated.</p>
</div>
</div>
</div>
<p>Solving the reactor design equations yields <span class="math inline">\(T_{in}\)</span>, and corresponding set of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> that span the range from their initial (feed) values to their final (outlet) values. The quantities of interest are <span class="math inline">\(T_{in}\)</span> and <span class="math inline">\(T_{out} = T \big \vert_{z=L}\)</span>.</p>
<p><strong>Calculations Summary</strong></p>
<ol type="1">
<li>Substitute given and known constants into all equations.</li>
<li>When it is necessary to evaluate the derivatives
<ol type="a">
<li><span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> will be available.</li>
<li>calculate <span class="math inline">\(k_1\)</span> and <span class="math inline">\(\dot{V}\)</span> using equations (8) and (11).</li>
<li>calculate <span class="math inline">\(C_A\)</span> and <span class="math inline">\(C_B\)</span> using equations (9) and (10).</li>
<li>calculate <span class="math inline">\(r_1\)</span> using equation (2).</li>
<li>evaluate the derivatives using equations (3) through (7).</li>
</ol></li>
<li>When it is necessary to calculate the initial and final values other than <span class="math inline">\(T_in\)</span> in <a href="#tbl-example_13_7_2_initial_values" class="quarto-xref">Table&nbsp;<span>13.2</span></a>
<ol type="a">
<li><span class="math inline">\(L\)</span> is a known constant.</li>
<li>calculate <span class="math inline">\(\dot{n}_{A,in}\)</span> and <span class="math inline">\(\dot{n}_{B,in}\)</span> using equations (12) and (13).</li>
</ol></li>
<li>When it is necessary to evaluate the residual, <span class="math inline">\(\epsilon\)</span>, corresponding to the implicit equation for <span class="math inline">\(T_in\)</span>, equation (14)
<ol type="a">
<li>a guess for <span class="math inline">\(T_in\)</span> will be available for use in all equations.</li>
<li>solve the IVODEs, equations (3) through (7), using that guess along with the other initial values and stopping criterion in <a href="#tbl-example_13_7_2_initial_values" class="quarto-xref">Table&nbsp;<span>13.2</span></a> and get the value of <span class="math inline">\(\dot{n}_A \big \vert_{z=L}\)</span>.</li>
<li>calculate <span class="math inline">\(\epsilon\)</span> using equation (14).</li>
</ol></li>
<li>When it is necessary to calculate the quantities of interest, <span class="math inline">\(T_{in}\)</span> and <span class="math inline">\(T_{out}\)</span>
<ol type="a">
<li><span class="math inline">\(T_{in}\)</span> and corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial (inlet) values to their final (outlet) values will be available.</li>
<li><span class="math inline">\(T_{out} = T \big \vert_{z=L}\)</span></li>
</ol></li>
</ol>
</section>
<section id="numerical-implementation-of-the-solution-1" class="level4" data-number="13.7.2.3">
<h4 data-number="13.7.2.3" class="anchored" data-anchor-id="numerical-implementation-of-the-solution-1"><span class="header-section-number">13.7.2.3</span> Numerical implementation of the Solution</h4>
<ol type="1">
<li>Make the given and known constants available for use in all functions.</li>
<li>Define a variable to hold <span class="math inline">\(T_{in}\)</span> and make it available to all functions.</li>
<li>Write a derivatives function that
<ol type="a">
<li>receives the independent and dependent variables, <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, as arguments,</li>
<li>evaluates the derivatives as described in step 2 of the calculations summary, and returns them.</li>
</ol></li>
<li>Write a residuals function that
<ol type="a">
<li>receives a guess for <span class="math inline">\(T_{in}\)</span> and makes it available to all functions,</li>
<li>evaluates <span class="math inline">\(\epsilon\)</span> as described in step 4 of the calculations summary, and returns it.</li>
</ol></li>
<li>Write a reactor model function that
<ol type="a">
<li>has access to <span class="math inline">\(T_in\)</span>,</li>
<li>calculates the other initial and final values in <a href="#tbl-example_13_7_2_initial_values" class="quarto-xref">Table&nbsp;<span>13.2</span></a> as described in step 3 of the calculations summary,</li>
<li>gets corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial values to their final values by calling an IVODE solver and passing the following information to it
<ol type="i">
<li>the initial values and stopping criterion in <a href="#tbl-example_13_7_2_initial_values" class="quarto-xref">Table&nbsp;<span>13.2</span></a> and</li>
<li>the name of the derivatives function from step 3 above, d, checks that the solver successfully solved the IVODEs, and</li>
</ol></li>
<li>returns the values returned by the IVODE solver.</li>
</ol></li>
<li>Perform the analysis by
<ol type="a">
<li>calculating <span class="math inline">\(T_{in}\)</span> by calling an ATE solver using the following arguments
<ol type="i">
<li>an initial guess for <span class="math inline">\(T_{in}\)</span> and</li>
<li>the name of the residuals funtions from step 4</li>
</ol></li>
<li>calling the reactor model function from step 5 to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial (inlet) values to their final (outlet) values,</li>
<li>calculating the quantities of interest as described in step 5 of the calculations summary.</li>
</ol></li>
</ol>
</section>
<section id="results-and-discussion-1" class="level4" data-number="13.7.2.4">
<h4 data-number="13.7.2.4" class="anchored" data-anchor-id="results-and-discussion-1"><span class="header-section-number">13.7.2.4</span> Results and Discussion</h4>
<p>The calculations were performed as described above. When the feed temperature is 46 °C, 95% of the A in the feed is converted and the outlet temperature is 56.2 °C. When an exothermic reaction occurs in an adiabatic reactor, the temperature is expected to rise. In this case the temperature only rises by 10 °C, so it was not necessary to cool the reacting fluid during processing.</p>
</section>
</section>
<section id="sec-example_13_7_3" class="level3" data-number="13.7.3">
<h3 data-number="13.7.3" class="anchored" data-anchor-id="sec-example_13_7_3"><span class="header-section-number">13.7.3</span> Pressure Drop in a Steady-State, Gas-Phase PFR</h3>
<p>The gas-phase decomposition of A according to reaction (1) takes place at steady-state in a PFR. The feed to the reactor is 75% A and 25% inert gas flowing at 100 cm<sup>3</sup> s<sup>-1</sup> (0.44 g s<sup>-1</sup>), 3 atm and 400 °C. The reactor diameter is 2.5 cm and its length is 8 m. It is surrounded by a shell containing a molten salt at a constant temperature of 375 °C. The heat transfer coefficient between the reactor and shell is 187 kJ h<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup>. The reaction is catalytic, and the reactor is packed with catalyst particles with a 0.25 cm diameter, a sphericity of 0.7, and a bed porosity of 0.60. The rate expression for reaction (1) is given in equation (2) where <span class="math inline">\(k_{0,f}\)</span> = 9.0 x 10<sup>17</sup> mol cm<sup>3</sup> s<sup>-1</sup> atm<sup>-1</sup>, <span class="math inline">\(𝐸_𝑓\)</span> = 285 kJ mol<sup>-1</sup>, <span class="math inline">\(𝑘_{0,𝑟}\)</span> = 4.09 x 10<sup>-4</sup> mol cm<sup>-3</sup> s<sup>-1</sup> atm<sup>-4</sup>, and <span class="math inline">\(𝐸_𝑟\)</span> = 85 kJ mol<sup>-1</sup>. The heat of reaction is constant and equal to 200 kJ mol<sup>-1</sup>. The heat capacities of the reagents are also constant: <span class="math inline">\(\hat{C}_{p,A}\)</span> = 11.7 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Y}\)</span> = 8.3 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Z}\)</span> = 4.3 cal mol<sup>-1</sup> K<sup>-1</sup>, and <span class="math inline">\(\hat{C}_{p,I}\)</span> = 5.8 cal mol<sup>-1</sup> K<sup>-1</sup>. The viscosity may be assumed to be constant and equal to 0.027 cP. What are the outlet temperature, pressure and conversion?</p>
<p><span class="math display">\[
A \leftrightarrows Y + 3 Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r_1 = k_fP_A - k_rP_YP_Z^3 \tag{2}
\]</span></p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To begin, I’ll summarize this assignment by assigning appropriate variable symbols to each quantity that is mentioned in the narrative. I’ll use a subscripted “in” to indicate values at the reactor inlet, a subscripted “out” to designate values at the outlet, a “p” to denote values associated with the catalyst particles, and I’ll add the gas constant since I know I’ll need it. I’ll use “I” to represent the inert gas present in the system. The assignment states that the PFR is heated and operates at steady-state.</p>
</div>
</div>
</div>
<section id="assignment-summary-2" class="level4" data-number="13.7.3.1">
<h4 data-number="13.7.3.1" class="anchored" data-anchor-id="assignment-summary-2"><span class="header-section-number">13.7.3.1</span> Assignment Summary</h4>
<p><strong>Given and Known Constants</strong>: <span class="math inline">\(y_{A,in}\)</span> = 0.75, <span class="math inline">\(y_{I,in}\)</span> = 0.25, <span class="math inline">\(\dot{V}_{in}\)</span> = 100 cm<sup>3</sup> s<sup>-1</sup>, <span class="math inline">\(\dot{m}_{in}\)</span> = 0.44 g s<sup>-1</sup>, <span class="math inline">\(P_{in}\)</span> = 3 atm, <span class="math inline">\(T_{in}\)</span> = 400 °C, <span class="math inline">\(D\)</span> = 2.5 cm, <span class="math inline">\(L\)</span> = 8 m, <span class="math inline">\(T_{ex}\)</span> = 375 °C, <span class="math inline">\(U\)</span> = 187 kJ h<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup>, <span class="math inline">\(D_p\)</span> = 0.25 cm, <span class="math inline">\(\Phi_s\)</span> = 0.7, <span class="math inline">\(\varepsilon\)</span> = 0.60, <span class="math inline">\(k_{0,f}\)</span> = 9.0 x 10<sup>17</sup> mol cm<sup>3</sup> s<sup>-1</sup> atm<sup>-1</sup>, <span class="math inline">\(𝐸_𝑓\)</span> = 285 kJ mol<sup>-1</sup>, <span class="math inline">\(𝑘_{0,𝑟}\)</span> = 4.09 x 10<sup>-4</sup> mol cm<sup>-3</sup> s<sup>-1</sup> atm<sup>-4</sup>, <span class="math inline">\(𝐸_𝑟\)</span> = 85 kJ mol<sup>-1</sup>, <span class="math inline">\(\Delta H_1\)</span> = 200 kJ mol<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,A}\)</span> = 11.7 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Y}\)</span> = 8.3 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Z}\)</span> = 4.3 cal mol<sup>-1</sup> K<sup>-1</sup>, and <span class="math inline">\(\hat{C}_{p,I}\)</span> = 5.8 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\mu\)</span> = 0.027 cP, and <span class="math inline">\(R\)</span> = 8.314 J mol<sup>-1</sup> K<sup>-1</sup> = 82.06 cm<sup>3</sup> atm mol<sup>-1</sup> K<sup>1-</sup>.</p>
<p><strong>Reactor System</strong>: heated, steady-state PFR</p>
<p><strong>Quantities of Interest</strong>: <span class="math inline">\(T_{out}\)</span>, <span class="math inline">\(P_{out}\)</span>, and <span class="math inline">\(f_A\)</span></p>
</section>
<section id="mathematical-formulation-of-the-solution-2" class="level4" data-number="13.7.3.2">
<h4 data-number="13.7.3.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-solution-2"><span class="header-section-number">13.7.3.2</span> Mathematical Formulation of the Solution</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I need to generate the reactor design equations for modeling this particular PFR. The reactor design equations will be some combination of mole balances, an energy balance on the reacting fluid, an energy balance on the heat exchange fluid, and, since this is a PFR, a momentum balance. I prefer to write mole balances on every reagent (other than liquid solvents) in the system. The general steady-state form of the PFR mole balance is given in <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>. There is only one reaction, so the summation becomes one term.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z} = \frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j = \frac{\pi D^2}{4} \nu_{i,1}r_1
\]</span></p>
<p>The PFR is not isothermal, so I must add an energy balance on the reacting gas. <a href="section_3_design_equations.html#eq-pfr_ss_energy_balance" class="quarto-xref">Equation&nbsp;<span>6.40</span></a> presents the general, steady-state form of the energy balance. None of the terms in the equation can be eliminated, but the two summations can be expanded, and the equation can be rearranged into the form of a derivative expression (see <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix J</span></a>).</p>
<p><span class="math display">\[
\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right) \frac{d T}{d z} = \pi D U\left( T_{ex} - T  \right) - \frac{\pi D^2}{4}\sum_j r_j \Delta H_j
\]</span></p>
<p><span class="math display">\[
\frac{d T}{d z} =  \frac{\pi DU \left(T_{ex} - T\right)-{\frac{\pi D^2}{4}r_1 \Delta H_1}}{\dot{n}_A \hat{C}_{p,A} + \dot{n}_B \hat{C}_{p,I} + \dot{n}_Y \hat{C}_{p,Y} + \dot{n}_Z \hat{C}_{p,Z}}
\]</span></p>
<p>There is a vapor that is exchanging its latent heat with the reacting gas. Because only latent heat is being exchanged, the temperature of the heat exchange fluid is constant. That temperature is known, so I can solve the mole and energy balances above independently of an energy balance on the exchange fluid. Furthermore, since the assignment does not ask anything about the exchange fluid, I won’t need to use an energy balance on the heat exchange fluid.</p>
<p>The assignment does not mention pressure drop, but it does provide all of the information needed for calculating it using the Ergun equation, <a href="section_3_design_equations.html#eq-pfr_ergun_eqn" class="quarto-xref">Equation&nbsp;<span>6.42</span></a>. More generally, in a real-world engineering assignment, I would not know wheter pressure drop will be significant or not, so I would want to calculate it.</p>
<p><span class="math display">\[
\frac{{dP}}{{dz}} =  - \frac{{1 - \varepsilon }}{{{\varepsilon ^3}}}\frac{{{G^2}}}{{\rho {\Phi _s}{D_p}}}\left[ {\frac{{150\left( {1 - \varepsilon } \right)\mu }}{{{\Phi _s}{D_p}G}} + 1.75} \right]
\]</span></p>
</div>
</div>
</div>
<p><strong>Reactor Design Equations</strong></p>
<p>Mole balance design equations for A, Y, Z, and I are presented in equations (3) through (6). An energy balance on the reacting gas is shown in equation (7), and a momentum balance on the gas is given in equation (8).</p>
<p><span class="math display">\[
\frac{d \dot{n}_A}{dz} = - \frac{\pi D^2}{4}r_1 \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_Y}{dz} = \frac{\pi D^2}{4}r_1 \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_Z}{dz} = 3\frac{\pi D^2}{4}r_1 \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_I}{dz} = 0.0 \tag{6}
\]</span></p>
<p><span class="math display">\[
\frac{d T}{d z} =  \frac{\pi DU \left(T_{ex} - T\right)-{\frac{\pi D^2}{4}r_1 \Delta H_1}}{\dot{n}_A \hat{C}_{p,A} + \dot{n}_B \hat{C}_{p,I} + \dot{n}_Y \hat{C}_{p,Y} + \dot{n}_Z \hat{C}_{p,Z}} \tag{7}
\]</span></p>
<p><span class="math display">\[
\frac{{dP}}{{dz}} =  - \frac{{1 - \varepsilon }}{{{\varepsilon ^3}}}\frac{{{G^2}}}{{\rho {\Phi _s}{D_p}}}\left[ {\frac{{150\left( {1 - \varepsilon } \right)\mu }}{{{\Phi _s}{D_p}G}} + 1.75} \right] \tag{8}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The reactor design equations are six IVODEs, and they contain six dependent variables (<span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span>), so it isn’t necessary to add an IVODE or eliminate a dependent variable. Initial values and a stopping criterion are needed in order to solve the IVODEs numerically. I can define <span class="math inline">\(z=0\)</span> as the inlet to the reactor in which case the other initial values are simply the values of the dependent variables at the reactor inlet. Inlet mole fractions of A and I are specified, and the sum to one, so there isn’t any Y or Z in the feed. The reactor length is specified, so that can be used as the stopping criterion.</p>
</div>
</div>
</div>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_13_7_3_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_13_7_3_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.3: Initial values and stopping criterion for solving equations, (numbers).
</figcaption>
<div aria-describedby="tbl-example_13_7_3_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(L\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_I\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{I,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(T_{in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;"><span class="math inline">\(P_{in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to solve the IVODEs numerically I’ll need to do two things: calculate the values of the derivatives at the start of each integration step and calculate all of the initial and final values in <a href="#tbl-example_13_7_3_initial_values" class="quarto-xref">Table&nbsp;<span>13.3</span></a>. At the start of an integration step the independent and dependent variables (<span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span>) will be known along with the given and known constants listed in the assignment summary. I will need to calculate any other quantities that appear in the derivatives expressions, equations (3) through (8).</p>
<p>Examination of those equations reveals <span class="math inline">\(r_1\)</span>, <span class="math inline">\(G\)</span> and <span class="math inline">\(\rho\)</span> as unknowns that will need to be calculated. The rate expression, equation (2), can be used to calculate <span class="math inline">\(r_1\)</span>, but before that can be done, the two rate coefficients and the partial pressures of the reactants and products must be calculated. The rate coefficients can be calculated using the Arrhenius expression, <a href="section_2_rates_and_expressions.html#eq-arrhenius" class="quarto-xref">Equation&nbsp;<span>4.8</span></a>. The partial pressure of reagent <span class="math inline">\(i\)</span> is simply its mole fraction times the total pressure.</p>
<p><span class="math display">\[
P_i = \frac{\dot{n}_i}{\sum_i \dot{n}_i}P = \frac{\dot{n}_i}{\dot{n}_A + \dot{n}_Y + \dot{n}_Z + \dot{n}_I}P
\]</span></p>
<p><span class="math inline">\(G\)</span> can be calculated using its defining equation. The density could be calculated by multipying each molar flow rate times the corresponding molecular weight, to get mass flow rates of each reagent. These could then be totaled and divided by the volumetric flow rate to calculate the density. However, noting that the mass flow rate is constant (no nuclear reactions are taking place), the density can be calculated simply by dividing the mass flow rate by the volumetric flow rate.</p>
<p><span class="math display">\[
G = \frac{4\dot{m}_{in}}{\pi D^2} = \frac{4\dot{m}}{\pi D^2}
\]</span></p>
<p><span class="math display">\[
\rho = \frac{\dot{m}_{in}}{\dot{V}} = \frac{\dot{m}P}{\left( \dot{n}_A + \dot{n}_Y + \dot{n}_Z + \dot{n}_I \right)RT}
\]</span></p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Evaluating the Derivatives</strong></p>
<p><span class="math display">\[
k_{1,f} = k_{0,f} \exp{\left( \frac{-E_f}{RT} \right)} \tag{9}
\]</span></p>
<p><span class="math display">\[
k_{1,r} = k_{0,r} \exp{\left( \frac{-E_r}{RT} \right)}\tag{10}
\]</span></p>
<p><span class="math display">\[
P_A = \frac{\dot{n}_A}{\dot{n}_A + \dot{n}_Y + \dot{n}_Z + \dot{n}_I}P \tag{11}
\]</span></p>
<p><span class="math display">\[
P_Y = \frac{\dot{n}_Y}{\dot{n}_A + \dot{n}_Y + \dot{n}_Z + \dot{n}_I}P \tag{12}
\]</span></p>
<p><span class="math display">\[
P_Z = \frac{\dot{n}_Z}{\dot{n}_A + \dot{n}_Y + \dot{n}_Z + \dot{n}_I}P \tag{13}
\]</span></p>
<p><span class="math display">\[
\dot{m} = \dot{m}_{in} \tag{14}
\]</span></p>
<p><span class="math display">\[
G = \frac{4\dot{m}}{\pi D^2} \tag{15}
\]</span></p>
<p><span class="math display">\[
\rho = \frac{\dot{m}P}{\left( \dot{n}_A + \dot{n}_Y + \dot{n}_Z + \dot{n}_I \right)RT} \tag{16}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When I solve the IVODEs numerically, I’ll also need to calculate the initial and final values in <a href="#tbl-example_13_7_3_initial_values" class="quarto-xref">Table&nbsp;<span>13.3</span></a>. The inlet temperature and pressure and the reactor length are known constants. To calculate the inlet molar flow rates of A and I, the total molar flow rate can be calculated using the ideal gas law. Multiplying that by the mole fraction of a reagent will then give the molar flow rate of the reagent.</p>
<p><span class="math display">\[
\dot{n}_{i,in} = y_{i,in}\dot{n}_{total} = y_{i,in}\frac{P_{in}\dot{V}_{in}}{RT_{in}}
\]</span></p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Initial and Final Values</strong></p>
<p><span class="math display">\[
\dot{n}_{A,in} = y_{A,in}\frac{P_{in}\dot{V}_{in}}{RT_{in}} \tag{17}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{I,in} = y_{I,in}\frac{P_{in}\dot{V}_{in}}{RT_{in}} \tag{18}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point the reactor design equations can be solved numerically to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span> spanning the range from their initial (inlet) values to their final (outlet) values. Thus, the outlet pressure and temperature are found by solving the IVODEs. The conversion can be calculated using its definition.</p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Quantities of Interest</strong></p>
<p>Solving the reactor design equations yields sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span> spanning the range from their initial (inlet) values to their final (outlet) values. The outlet molar flow of A, temperature and pressure can be found using equations (19) - (21), after which the conversion can be calculated using equation (22).</p>
<p><span class="math display">\[
\dot{n}_{A,out} = \dot{n}_{A} \big \vert_{z=L} \tag{19}
\]</span></p>
<p><span class="math display">\[
T_{out} = T \big \vert_{z=L} \tag{20}
\]</span></p>
<p><span class="math display">\[
P_{out} = P \big \vert_{z=L} \tag{21}
\]</span></p>
<p><span class="math display">\[
f_A = \frac{\dot{n}_{A,in} - \dot{n}_{A,out}}{\dot{n}_{A,in}} \tag{22}
\]</span></p>
<p><strong>Calculations Summary</strong></p>
<ol type="1">
<li>Substitute given and known constants into all equations.</li>
<li>When it is necessary to evaluate the derivatives
<ol type="a">
<li><span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span> will be available.</li>
<li>calculate <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(k_{0,r}\)</span>, <span class="math inline">\(P_A\)</span>, <span class="math inline">\(P_Y\)</span>, <span class="math inline">\(P_Z\)</span>, and <span class="math inline">\(\dot{m}\)</span> using equations (9) - (14).</li>
<li>calculate <span class="math inline">\(r_1\)</span>, <span class="math inline">\(G\)</span>, and <span class="math inline">\(\rho\)</span> using equations (2), (15), and (16).</li>
<li>evaluate the derivatives using equations (3) - (8).</li>
</ol></li>
<li>When it is necessary to calculate the initial and final values in <a href="#tbl-example_13_7_3_initial_values" class="quarto-xref">Table&nbsp;<span>13.3</span></a>
<ol type="a">
<li><span class="math inline">\(T_{in}\)</span>, <span class="math inline">\(P_{in}\)</span>, and <span class="math inline">\(L\)</span> are known constants.</li>
<li>calculate <em>{A,in} and </em>{I,in} using equations (17) and (18).</li>
</ol></li>
<li>When it is necessary to calculate the quantities of interest, <span class="math inline">\(T_{out}\)</span>, <span class="math inline">\(P_{out}\)</span>, and <span class="math inline">\(f_A\)</span>
<ol type="a">
<li>corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span>, spanning the range from their initial (inlet) values to their final (outlet) values will be available.</li>
<li>find <span class="math inline">\(\dot{n}_{A,out}\)</span> using equation (19).</li>
<li>find or calculate <span class="math inline">\(T_{out}\)</span>, <span class="math inline">\(P_{out}\)</span>, and <span class="math inline">\(f_A\)</span> using equations (20) -(22).</li>
</ol></li>
</ol>
</section>
<section id="numerical-implementation-of-the-solution-2" class="level4" data-number="13.7.3.3">
<h4 data-number="13.7.3.3" class="anchored" data-anchor-id="numerical-implementation-of-the-solution-2"><span class="header-section-number">13.7.3.3</span> Numerical implementation of the Solution</h4>
<ol type="1">
<li>Make the given and known constants available for use in all functions.</li>
<li>Write a derivatives function that
<ol type="a">
<li>receives the independent and dependent variables, <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span>, as arguments,</li>
<li>evaluates the derivatives as described in step 2 of the calculations summary, and returns them..</li>
</ol></li>
<li>Write a reactor model function that
<ol type="a">
<li>calculates the initial and final values in <a href="#tbl-example_13_7_3_initial_values" class="quarto-xref">Table&nbsp;<span>13.3</span></a> as described in step 3 of the calculations summary,</li>
<li>gets corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span>, spanning the range from their initial values to their final values by calling an IVODE solver and passing the following information to it
<ol type="i">
<li>the initial values and stopping criterion in <a href="#tbl-example_13_7_3_initial_values" class="quarto-xref">Table&nbsp;<span>13.3</span></a> and</li>
<li>the name of the derivatives function from step 2 above, d, checks that the solver successfully solved the IVODEs, and</li>
</ol></li>
<li>returns the values returned by the IVODE solver.</li>
</ol></li>
<li>Perform the analysis by
<ol type="a">
<li>calling the reactor model function from step 3 above to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, <span class="math inline">\(\dot{n}_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span>, spanning the range from their initial values to their final values, and</li>
<li>calculating the quantities of interest as described in step 4 of the calculations summary.</li>
</ol></li>
</ol>
</section>
<section id="results-and-discussion-2" class="level4" data-number="13.7.3.4">
<h4 data-number="13.7.3.4" class="anchored" data-anchor-id="results-and-discussion-2"><span class="header-section-number">13.7.3.4</span> Results and Discussion</h4>
<p>The calculateions were performed as described above. The outlet temperature is 363 °C, the outlet pressure is 2.91 atm, and the conversion is 83.3%. This system is similar to that of <a href="#sec-example_13_7_1" class="quarto-xref">Example&nbsp;<span>13.7.1</span></a> in that while the feed is at 400 °C and the heat exchange fluid is at 375 °C, the gas leaving the reactor is at 363 °C. Apparently the heat absorbed due to reaction greater than that provided by the heat exchange fluid.</p>
<p>The pressure drop here is only 0.09 atm. It is likely that in this case, ignoring the pressure drop would not have affected the calculated outlet temperature and conversion significantly. However, it is difficult to predict the magnitude of the pressure drop in a packed bed. Consequently, it is wise to account for it in case it proves to be more significant.</p>
</section>
</section>
<section id="sec-example_13_7_4" class="level3" data-number="13.7.4">
<h3 data-number="13.7.4" class="anchored" data-anchor-id="sec-example_13_7_4"><span class="header-section-number">13.7.4</span> Minimum Water-Gas Shift Reactor Volume</h3>
<p>The water-gas shift, equation (1), is used to reduce the amount of CO in gas mixtures containing CO, CO<sub>2</sub>, H<sub>2</sub>, H<sub>2</sub>O, and other gases. It is exothermic, <span class="math inline">\(\Delta H\)</span> = –9120 cal mol<sup>-1</sup>, and reversible with the equilibrium constant given by equation (3) with <span class="math inline">\(K_{0,1}\)</span> = 0.132. The heat capacities of CO, H<sub>2</sub>O, CO<sub>2</sub>, H<sub>2</sub>, and inert, I, can be take to be constant and equal to 29.3, 34.3, 41.3, 29.2, and 40.5 J mol<sup>-1</sup> K<sup>-1</sup>, respectively. Two reactors are often used, one operating at higher temperatures and the other at lower temperatures. The steam to CO feed ratio is often in the range from 3 to 6. Suppose the rate in the first reactor when using a certain catalyst is given by equation (2) with <span class="math inline">\(k_{0.1}\)</span> = 0.0354 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup> and <span class="math inline">\(E_1\)</span> = 9740 cal mol<sup>-1</sup>. The feed to the adiabatic reactor is at 26 atm and 320 °C, and pressure drop is negligible. Using a feed with 1 mol CO h<sup>-1</sup>, 0.359 mol CO<sub>2</sub> h<sup>-1</sup>, 4.44 mol H<sub>2</sub> h<sup>-1</sup>, and 0.180 mol I h<sup>-1</sup> as a basis, what inlet molar flow of H<sub>2</sub>O will minimize the reactor volume if 55% of the CO must be converted? What will the outlet temperature from a reactor of that volume equal?</p>
<p><span class="math display">\[
CO + H_2O \rightleftarrows CO_2 + H_2 \tag{1}
\]</span></p>
<p><span class="math display">\[
r_1 = k_1 \left( P_{CO} P_{H_2O} - \frac{P_{CO_2}P_{H_2}}{K_1} \right) \tag{2}
\]</span></p>
<p><span class="math display">\[
K_1 = K_{0,1} \exp{ \left( \frac{-\Delta H}{RT} \right)} \tag{3}
\]</span></p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This assignment describes an adiabatic PFR. The description of the reactor operation does not mention any changes in reactor inputs that might initiate transient behavior, so it is safe to assume that the reactor operates at steady-state. I will summarize the assignment by assigning appropriate variable symbols to all quantities mentioned in the narrative. I’ll use “in” and “out” subscripts to denote values at the reactor inlet or outlet, and I’ll add values of the gas constant since I know I’ll need them.</p>
</div>
</div>
</div>
<section id="assignment-summary-3" class="level4" data-number="13.7.4.1">
<h4 data-number="13.7.4.1" class="anchored" data-anchor-id="assignment-summary-3"><span class="header-section-number">13.7.4.1</span> Assignment Summary</h4>
<p><strong>Given and Known Constants</strong>: <span class="math inline">\(\Delta H\)</span> = –9120 cal mol<sup>-1</sup>, <span class="math inline">\(K_{0,1}\)</span> = 0.132, <span class="math inline">\(\hat{C}_{p,CO}\)</span> = 29.3 J mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,H_2O}\)</span> = 34.3 J mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,CO_2}\)</span> = 41.3 J mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,H_2}\)</span> = 29.2 J mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,I}\)</span> = 40.5 J mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(k_{0.1}\)</span> = 0.0354 mol cm<sup>-3</sup> min<sup>-1</sup> atm<sup>-2</sup>, <span class="math inline">\(E_1\)</span> = 9740 cal mol<sup>-1</sup>, <span class="math inline">\(P\)</span> = 26 atm, <span class="math inline">\(T_{in}\)</span> = 320 °C, <span class="math inline">\(\dot{n}_{CO,in}\)</span> = 1 mol h<sup>-1</sup>, <span class="math inline">\(\dot{n}_{CO_2,in}\)</span> = 0.359 mol h<sup>-1</sup>, <span class="math inline">\(\dot{n}_{H_2,in}\)</span> = 4.44 mol h<sup>-1</sup>, <span class="math inline">\(\dot{n}_{I,in}\)</span> = 0.180 mol h<sup>-1</sup>, <span class="math inline">\(f_{CO}\)</span> = 0.55, and <span class="math inline">\(R\)</span> = 1.987 cal mol<sup>-1</sup> K<sup>-1</sup>.</p>
<p><strong>Reactor System</strong>: adiabatic, steady-state PFR with negligible pressure drop</p>
<p><strong>Quantities of Interest</strong>: <span class="math inline">\(\dot{n}_{H_2O,in,opt}  = \underset{\dot{n}_{H_2O,in}}{\arg\min}\left( V \right)\)</span> and <span class="math inline">\(T_{out}\)</span></p>
</section>
<section id="mathematical-formulation-of-the-solution-3" class="level4" data-number="13.7.4.2">
<h4 data-number="13.7.4.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-solution-3"><span class="header-section-number">13.7.4.2</span> Mathematical Formulation of the Solution</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I’ll need to generate the equations needed to model this reactor and solve them in order to complete this assignment. The reactor is an adiabatic PFR with negligible pressure drop, so I won’t need an energy balance on the heat exchange fluid (because there isn’t one) or a momentum balance (because pressure drop is negligible). So for this assignment the reactor design equations will consist of mole balances and an energy balance on the reacting gas. I’ll write mole balances for each of the five reagents. The general form of the steady-state PFR mole balance is given in <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>. In this assignment, however, the reactor diameter and length are not mentioned, only the volume. Consequently, both sides of the mole balance can be divided by the cross-sectional area of the reactor. Then noting that <span class="math inline">\(\frac{\pi D^2}{4}dz\)</span> is equal to a differential volume element, <span class="math inline">\(dV\)</span>, the independent variable can be changed from <span class="math inline">\(z\)</span> to <span class="math inline">\(V\)</span>. At the same time, the summataion can be written in terms of the one reaction that is taking place.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z} = \frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j \qquad \Rightarrow \qquad \frac{d \dot{n}_i}{\frac{\pi D^2}{4}dz} = \sum_j \nu_{i,j}r_j
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{dV} = \nu_{i,1}r_1
\]</span></p>
<p>Having changed the independent variable in the mole balances to <span class="math inline">\(V\)</span>, an analogous change must be made to the general form of the steady-state PFR reacting fluid energy balance, <a href="section_3_design_equations.html#eq-pfr_ss_energy_balance" class="quarto-xref">Equation&nbsp;<span>6.40</span></a>, after first noting that the reactor is adiabatic so the heat exchange term is equal to zero.</p>
<p><span class="math display">\[
\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right) \frac{d T}{d z} = \cancelto{0}{\pi D U\left( T_{ex} - T  \right)} - \frac{\pi D^2}{4}\sum_j r_j \Delta H_j
\]</span></p>
<p><span class="math display">\[
\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right) \frac{d T}{dV} = \sum_j r_j \Delta H_j
\]</span></p>
<p>Expanding the summations and rearranging yields the steady-state energy balance in the form of a derivative expression.</p>
<p><span class="math display">\[
\frac{d T}{dV} =  \frac{-r_1 \Delta H_1}{\dot{n}_{CO} \hat{C}_{p,CO} + \dot{n}_{H_2O} \hat{C}_{p,H_2O} + \dot{n}_{CO_2} \hat{C}_{p,CO_2} + \dot{n}_{H_2} \hat{C}_{p,H_2} + \dot{n}_I \hat{C}_{p,I}}
\]</span></p>
</div>
</div>
</div>
<p><strong>Reactor Design Equations</strong></p>
<p>Mole balance design equations for CO, H<sub>2</sub>O, CO<sub>2</sub>, H<sub>2</sub> and I are presented in equations (4) - (8), and the energy balance on the reacting fluid is given in equation (9).</p>
<p><span class="math display">\[
\frac{d \dot{n}_{CO}}{dV} = - r_1 \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_{H_2O}}{dV} = - r_1 \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_{CO_2}}{dV} = r_1 \tag{6}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_{H_2}}{dV} = r_1 \tag{7}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_I}{dV} = 0.0 \tag{8}
\]</span></p>
<p><span class="math display">\[
\frac{d T}{dV} =  \frac{-r_1 \Delta H_1}{\dot{n}_{CO} \hat{C}_{p,CO} + \dot{n}_{H_2O} \hat{C}_{p,H_2O} + \dot{n}_{CO_2} \hat{C}_{p,CO_2} + \dot{n}_{H_2} \hat{C}_{p,H_2} + \dot{n}_I \hat{C}_{p,I}} \tag{9}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The number of IVODE design equations (6) is equal to the number of dependent variables appearing in them (<span class="math inline">\(\dot{n}_{CO}\)</span>, <span class="math inline">\(\dot{n}_{H_2O}\)</span>, <span class="math inline">\(\dot{n}_{CO_2}\)</span>, <span class="math inline">\(\dot{n}_{H_2}\)</span>, <span class="math inline">\(\dot{n}_{I}\)</span>, and <span class="math inline">\(T\)</span>), so it is not necessary to eliminate a dependent variable or add an IVODE.</p>
<p>In order to solve the IVODEs numerically, initial values and a stopping criterion are needed. I can define <span class="math inline">\(V=0\)</span> as the inlet to the reactor so that the remaining intial values become equal to the values of the dependent variables at the reactor inlet. The conversion of CO is specifed, so I will use the correspoinding outlet molar flow of CO as the stopping criterion.</p>
</div>
</div>
</div>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_13_7_4_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_13_7_4_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.4: Initial values and stopping criterion for solving equations, (numbers).
</figcaption>
<div aria-describedby="tbl-example_13_7_4_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(V\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{CO}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{CO,in}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{CO,out}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{H_2O}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{H_2O,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{CO_2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{CO_2,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{H_2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{H_2,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_I\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{I,in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(T_{in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to solve the IVODEs numerically I’ll need to do two things: calculate the values of the derivatives at the start of each integration step and calculate all of the initial and final values in <a href="#tbl-example_13_7_4_initial_values" class="quarto-xref">Table&nbsp;<span>13.4</span></a>.</p>
<p>At the start of each integration step, the independent and dependent variables, <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_{CO}\)</span>, <span class="math inline">\(\dot{n}_{H_2O}\)</span>, <span class="math inline">\(\dot{n}_{CO_2}\)</span>, <span class="math inline">\(\dot{n}_{H_2}\)</span>, <span class="math inline">\(\dot{n}_{I}\)</span>, and <span class="math inline">\(T\)</span>, will be known along with the given and known constants. I will need to calculate any other quantities that appear in the derivatives expressions.</p>
<p>The only unknown quantity appearing in equations (4) through (9) is the rate. It can be calculated using equation (2). Before doing so, the rate coefficient, <span class="math inline">\(k_1\)</span>, the equilibrium constant, <span class="math inline">\(K_1\)</span> and the partial pressures of the reactants and products must be calculated. The rate coefficient can be calculated using the Arrhenius expression, <a href="section_2_rates_and_expressions.html#eq-arrhenius" class="quarto-xref">Equation&nbsp;<span>4.8</span></a>, and the equilibrium coefficient, using equation (3). No additional unknowns appear in the Arrhenius expression or equation (3). The partial pressures of the reactants can be found by calculating the reactant and product mole fractions and multiplying by the total pressure.</p>
<p><span class="math display">\[
P_i = y_i P = \frac{\dot{n}_i}{\sum_i \dot{n}_i}P = \frac{\dot{n}_i}{\dot{n}_{CO} + \dot{n}_{H_2O} + \dot{n}_{CO_2} + \dot{n}_{H_2} + \dot{n}_{I} + }P
\]</span></p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Evaluating the Derivatives</strong></p>
<p><span class="math display">\[
k_1 = k_{0,1} \exp{\left( \frac{-E_1}{RT} \right)} \tag{10}
\]</span></p>
<p><span class="math display">\[
P_{CO} = \frac{\dot{n}_{CO}}{\dot{n}_{CO} + \dot{n}_{H_2O} + \dot{n}_{CO_2} + \dot{n}_{H_2} + \dot{n}_I}P \tag{11}
\]</span></p>
<p><span class="math display">\[
P_{H_2O} = \frac{\dot{n}_{H_2O}}{\dot{n}_{CO} + \dot{n}_{H_2O} + \dot{n}_{CO_2} + \dot{n}_{H_2} + \dot{n}_I}P \tag{12}
\]</span></p>
<p><span class="math display">\[
P_{CO_2} = \frac{\dot{n}_{CO_2}}{\dot{n}_{CO} + \dot{n}_{H_2O} + \dot{n}_{CO_2} + \dot{n}_{H_2} + \dot{n}_I}P \tag{13}
\]</span></p>
<p><span class="math display">\[
P_{H_2} = \frac{\dot{n}_{H_2}}{\dot{n}_{CO} + \dot{n}_{H_2O} + \dot{n}_{CO_2} + \dot{n}_{H_2} + \dot{n}_I}P \tag{14}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When I solve the IVODEs numerically, I’ll also need to calculate the initial and final values in <a href="#tbl-example_13_7_4_initial_values" class="quarto-xref">Table&nbsp;<span>13.4</span></a>. The inlet molar flow rates of CO, CO<sub>2</sub>, H<sub>2</sub>, and I, and the inlet temperature are specified in the assignment narrative. I will choose a range of values for the inlet molar flow rate of H<sub>2</sub>O and calculate the corresponding reactor volumes to find the minimum volume. Thus, at the time when the IVODEs are being solved, the inlet molar flow rate of H<sub>2</sub>O will also be known. The outlet molar flow rate of CO, that is the stopping criterion, can be calculated using the specified CO conversion.</p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Initial and Final Values</strong></p>
<p><span class="math display">\[
\dot{n}_{CO,out} = \dot{n}_{CO,in} \left( 1 - f_{CO} \right) \tag{15}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point I still need a value for inlet the molar flow rate of steam in order to solve the IVODEs. I need to find the value of that flow rate that minimizes the reactor volume. To do that I’ll choose a range of values for the inlet flow rate of steam. The assignment provides some guidance on selecting that range in the statement that the steam to carbon monoxide ratio is normally between 3 and 6.</p>
<p>Having chosen a range of values for the inlet molar flow rate of steam the reactor design equations can be solved numerically for each value in the range to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_{CO}\)</span>, <span class="math inline">\(\dot{n}_{H_2O}\)</span>, <span class="math inline">\(\dot{n}_{CO_2}\)</span>, <span class="math inline">\(\dot{n}_{H_2}\)</span>, <span class="math inline">\(\dot{n}_{I}\)</span>, and <span class="math inline">\(T\)</span> spanning the range from their initial (inlet) values to their final (outlet) values. For each inlet steam flow rate, the corresponding reactor volume is the final value of <span class="math inline">\(V\)</span>. By examining the results, I can identify the mimimum volume and the corresponding inlet steam flow rate. I can then re-solve the IVODEs using the optimum steam feed rate to find the outlet temperature.</p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Quantities of Interest</strong></p>
<p>A range of values of the inlet steam molar flow rate spanning the range from three times the inlet CO flow rate to six times it. For each value in the range the reactor design equations can be solved, yielding values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_{CO}\)</span>, <span class="math inline">\(\dot{n}_{H_2O}\)</span>, <span class="math inline">\(\dot{n}_{CO_2}\)</span>, <span class="math inline">\(\dot{n}_{H_2}\)</span>, <span class="math inline">\(\dot{n}_{I}\)</span>, and <span class="math inline">\(T\)</span> spanning the range from their initial (inlet) values to their final (outlet) values for that inlet steam flow rate. The reactor volume is simply the final value of <span class="math inline">\(V\)</span>. The minimum volume and the corresponding inlet molar flow rate of steam can then be identified.</p>
<p><span class="math display">\[
\dot{n}_{H_2O,in,opt}  = \underset{\dot{n}_{H_2O,in}}{\arg\min}\left( V \right) \\tag{16}
\]</span></p>
<p>The reactor design equations can then be solved using that optimum inlet steam flow rate to verify the minimum volume and to find the outlet temperature.</p>
<p><strong>Calculations Summary</strong></p>
<ol type="1">
<li>Substitute given and known constants into all equations.</li>
<li>When it is necessary to evaluate the derivatives
<ol type="a">
<li><span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_{CO}\)</span>, <span class="math inline">\(\dot{n}_{H_2O}\)</span>, <span class="math inline">\(\dot{n}_{CO_2}\)</span>, <span class="math inline">\(\dot{n}_{H_2}\)</span>, <span class="math inline">\(\dot{n}_{I}\)</span>, and <span class="math inline">\(T\)</span> will be available.</li>
<li>calculate <span class="math inline">\(K_1\)</span>, <span class="math inline">\(k_1\)</span>, <span class="math inline">\(P_{CO}\)</span>, <span class="math inline">\(P_{H_2O}\)</span>, <span class="math inline">\(P_{CO_2}\)</span>, and <span class="math inline">\(P_{H_2}\)</span> using equations (3) and (10) - (14).</li>
<li>calculate <span class="math inline">\(r_1\)</span> using equation (2).</li>
<li>evaluate the derivatives using equations (4) - (9).</li>
</ol></li>
<li>When it is necessary to calculate the initial and final values in <a href="#tbl-example_13_7_4_initial_values" class="quarto-xref">Table&nbsp;<span>13.4</span></a>
<ol type="a">
<li><span class="math inline">\(\dot{n}_{CO,in}\)</span>, <span class="math inline">\(\dot{n}_{CO_2,in}\)</span>, <span class="math inline">\(\dot{n}_{H_2,in}\)</span>, <span class="math inline">\(\dot{n}_{I,in}\)</span>, and <span class="math inline">\(T_{in}\)</span> are known constants.</li>
<li>a value for <span class="math inline">\(\dot{n}_{H_2,in}\)</span> will have been chosen.</li>
<li>calculate <span class="math inline">\(\dot{n}_{CO,out}\)</span> using equation (15).</li>
</ol></li>
</ol>
</section>
<section id="numerical-implementation-of-the-solution-3" class="level4" data-number="13.7.4.3">
<h4 data-number="13.7.4.3" class="anchored" data-anchor-id="numerical-implementation-of-the-solution-3"><span class="header-section-number">13.7.4.3</span> Numerical implementation of the Solution</h4>
<ol type="1">
<li>Make the given and known constants available for use in all functions.</li>
<li>Define a variable to hold <span class="math inline">\(\dot{n}_{H_2O,in}\)</span> and make it available to all functions.</li>
<li>Write a derivatives function that
<ol type="a">
<li>receives the independent and dependent variables, <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_{CO}\)</span>, <span class="math inline">\(\dot{n}_{H_2O}\)</span>, <span class="math inline">\(\dot{n}_{CO_2}\)</span>, <span class="math inline">\(\dot{n}_{H_2}\)</span>, <span class="math inline">\(\dot{n}_{I}\)</span>, and <span class="math inline">\(T\)</span>, as arguments,</li>
<li>evaluates the derivatives as described in step 2 of the calculations summary, and returns their values.</li>
</ol></li>
<li>Write a reactor model function that
<ol type="a">
<li>has access to <span class="math inline">\(\dot{n}_{H_2O,in}\)</span></li>
<li>calculates the initial and final values in <a href="#tbl-example_13_7_4_initial_values" class="quarto-xref">Table&nbsp;<span>13.4</span></a> as described in step 3 of the calculations summary,</li>
<li>gets corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_{CO}\)</span>, <span class="math inline">\(\dot{n}_{H_2O}\)</span>, <span class="math inline">\(\dot{n}_{CO_2}\)</span>, <span class="math inline">\(\dot{n}_{H_2}\)</span>, <span class="math inline">\(\dot{n}_{I}\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial values to their final values by calling an IVODE solver and passing the following information to it
<ol type="i">
<li>the initial values and stopping criterion in <a href="#tbl-example_13_7_4_initial_values" class="quarto-xref">Table&nbsp;<span>13.4</span></a> and</li>
<li>the name of the derivatives function from step 3 above</li>
</ol></li>
<li>checks that the solver successfully solved the IVODEs, and</li>
<li>returns the values returned by the IVODE solver.</li>
</ol></li>
<li>Perform the analysis by
<ol type="a">
<li>setting a range of values for <span class="math inline">\(\dot{n}_{H_2O,in}\)</span> and for each value in the range
<ol type="i">
<li>call the reactor model function from step 4 above to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_{CO}\)</span>, <span class="math inline">\(\dot{n}_{H_2O}\)</span>, <span class="math inline">\(\dot{n}_{CO_2}\)</span>, <span class="math inline">\(\dot{n}_{H_2}\)</span>, <span class="math inline">\(\dot{n}_{I}\)</span>, and <span class="math inline">\(T\)</span></li>
<li>save the resulting values of <span class="math inline">\(V\)</span> and <span class="math inline">\(T_{out}\)</span></li>
</ol></li>
<li>examining the results to find the value of <span class="math inline">\(\dot{n}_{H_2O,in}\)</span> where <span class="math inline">\(V\)</span> was minimized, and</li>
<li>reporting the optimum inlet molar flow rate of steam and the corresponsing reactor volume and outlet temperature.</li>
</ol></li>
</ol>
</section>
<section id="results-and-discussion-3" class="level4" data-number="13.7.4.4">
<h4 data-number="13.7.4.4" class="anchored" data-anchor-id="results-and-discussion-3"><span class="header-section-number">13.7.4.4</span> Results and Discussion</h4>
<p>The calculations were performed as described above. <a href="#fig-example_13_7_4_V_vs_H2O_in" class="quarto-xref">Figure&nbsp;<span>13.9</span></a> shows the reactor volume as a function of the steam feed rate, and <a href="#fig-example_13_7_4_T_vs_H2O_in" class="quarto-xref">Figure&nbsp;<span>13.10</span></a> shows the outlet temperature. The minimum reactor volume, 2.2 x 10<sup>3</sup> cm<sup>3</sup>, occurs at an H<sub>2</sub>O feed rate of 4.82 mol h<sup>-1</sup>. The corresponding outlet temperature is 380 °C.</p>
<div id="fig-example_13_7_4_V_vs_H2O_in" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_13_7_4_V_vs_H2O_in-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_13_7_4/V_vs_H2O_in.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_13_7_4_V_vs_H2O_in-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.9: Reactor volume as a function of H<sub>2</sub>O feed rate.
</figcaption>
</figure>
</div>
<div id="fig-example_13_7_4_T_vs_H2O_in" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_13_7_4_T_vs_H2O_in-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_13_7_4/T_vs_H2O_in.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_13_7_4_T_vs_H2O_in-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.10: Outlet Temperature as a function of H<sub>2</sub>O feed rate.
</figcaption>
</figure>
</div>
<p>The results are reasonable, based upon a quantitative analysis. First, as the amount of steam in the feed increases, it is expected that the outlet temperature will decrease if the conversion is held constant. By holding the conversion constant, the heat given off by the reaction is also constant. As the amount of steam in the feed increases, the heat of reaction gets spread across a larger number of moles, and consequently the temperature rise of the gas is smaller. Since the inlet temperature is constant, this means that the average temperature in the reactor decreases as the amount of steam in the feed increases.</p>
<p>With respect to the rate of reaction, increasing the steam in the feed leads to a greater average partial pressure of steam and a lower average temperature in the reactor. Examining the rate expression, it can be seen that decreasing the average temperature will cause the rate coefficient to decrease, and taken alone, this will always cause the rate to decrease. If the rate is decreasing, then the volume should increase. While that eventually does occur, <a href="#fig-example_13_7_4_V_vs_H2O_in" class="quarto-xref">Figure&nbsp;<span>13.9</span></a> shows that at lower steam feed rates, the volume is decreasing, so there must be other factors that are important.</p>
<p>The temperature also affects the equilibrium constant. It will increase as the average temperature decreases (i. e. as the steam feed rate increases). This causes the second term in parentheses in equation (2) to increase. Since that term is being subtracted, increaseing it, taken alone, would also tend to decrease the rate and increase the volume. Thus, the decreasing temperature, taken alone, would lead to a steadily decreasing rate because the rate coefficient would decrease and the term containing the equilibrium constant, which is being subtracted, would increase.</p>
<p>However, increasing the steam feed rate will also lead to a larger average partial pressure of steam in the reactor. The rate expression shows that, taken alone, this would tend to increase the reaction rate. So, the increasing partial pressure of steam tends to increase the rate while the decreasing temperature tends to decrease it. As such, the minimum in the volume seen is <a href="#fig-example_13_7_4_V_vs_H2O_in" class="quarto-xref">Figure&nbsp;<span>13.9</span></a> can be explained qualitatively. At lower steam feed rates, the increased steam partial pressure predominates over the decreased temperature leading to an increase in the rate and a corresponding decrease in the volume needed to reach the fixed conversion. Eventually, the effects of increasing steam partial pressure and decreasing temperature become equal and the volume reaches a minimum. Upon further increase in the steam feed rate, the effect of decreasing temperature predominates over the effect of increasing steam partial pressure, and the rate decreases, leading to an increased reactor volume.</p>
<p>The water-gas shift reaction offers an excellent example of a reversible, exothermic reaction. It was noted in the assignment narrative that two reactors are often used. The reactor considered in this assignment is representative of the first of the two reactors. While the system is far from thermodynamic equilibrium, this reactor can operate at higher temperatures where the rate is larger and the corresponding volume is smaller. However, the reaction approaches equilibrium at conversions that are much smaller than desired.</p>
<p>Therefore in commercial practice, in order to reach higher conversions, the product stream from the first reactor is cooled and fed to a second reactor that operates at much lower temperature. The rate in the second reactor is not as large, due to the lower temperature, but the reaction can proceed to much higher conversion before it approaches equilibrium because the equilibrium constant is much smaller. This situation creates an interesting system design/oprimization situation where the total volume of the two reactors can be minimized with respect to the steam feed rate, the temperature of the feed entering the first reactor, the conversion in the first reactor, and the temperature of the feed entering the second reactor.</p>
</section>
</section>
<section id="sec-example_13_7_5" class="level3" data-number="13.7.5">
<h3 data-number="13.7.5" class="anchored" data-anchor-id="sec-example_13_7_5"><span class="header-section-number">13.7.5</span> Start-up of the PFR from <a href="#sec-example_13_7_2" class="quarto-xref">Example&nbsp;<span>13.7.2</span></a></h3>
<p>A perfectly insulated PFR with a diameter of 10 cm and a length of 5 m is going to be used for reaction (1). To start up the reactor, a steady, 75 L min<sup>-1</sup> flow of pure water at 25 °C is established. A switching valve is then used to instantaneously change the feed to an aqueous solution containing A and B at concentrations of 1.0 and 1.2 M, respectively. This feed stream is at a constant inlet temperature of 30 °C and flows at the same rate as the water it replaces, 75 L min<sup>-1</sup>. Reagents A and B react according to reaction (1) with a rate of reaction that is accurately described by equation (2). The pre-exponential factor in equation (2) is 8.72 x 10<sup>5</sup> L mol<sup>-1</sup> min<sup>-1</sup> and the activation energy is 7200 cal mol<sup>-1</sup>. The heat of reaction (1) is -10,700 cal mol<sup>-1</sup> and may be assumed to be constant. The heat capacity and density of the solution may be taken to be constant and equal to those of water (1.0 cal g<sup>-1</sup> K<sup>-1</sup> and 1.0 g cm<sup>-3</sup>). The pressure drop in the reactor is negligible. Plot the molar flow rate of A and the temperature as a function of axial position within the reactor 0.131 minutes after the feed was switched. Plot the same variables again 0.262 min, 0.393 min and 0.524 min after the feed was switched. (Note: the specified times correspond to one-fourth of the space time, one-half of the space time, three fourths of the space time and the space time.)</p>
<p><span class="math display">\[
A + B \rightarrow Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r_1 = k_1C_AC_B \tag{2}
\]</span></p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This assignment describes the start-up of a PFR, so the reactor will be operating in a transient mode. However, the changes that are made to initiate the transient only affect the fluid at the reactor inlet. The flow rate of fluid within the reactor does not change, nor does the amount of heat being exchanged through the reactor wall (the reactor is adiabatic). Because there is no mixing in the axial direction, the sudden change in the reagent concentrations and temperature only affect the inlet. The changes will propagate through the reactor as a front, and, in this case, can be described using the steady-state axial profiles before and after the change. I’ll begin by assigning appropriate variable symbols to each quantity mentioned in the assignment. In addition to sub-scripted “in” and “out” to denote quantities at the reactor inlet and outlet, I will use “b” and “a” to indicate values before and after the step changes in concentrations and temperature are applied to the reactor inlet.</p>
</div>
</div>
</div>
<section id="assignment-summary-4" class="level4" data-number="13.7.5.1">
<h4 data-number="13.7.5.1" class="anchored" data-anchor-id="assignment-summary-4"><span class="header-section-number">13.7.5.1</span> Assignment Summary</h4>
<p><strong>Given and Known Constants</strong>: <span class="math inline">\(D\)</span> = 10 cm, <span class="math inline">\(L\)</span> = 5 m, <span class="math inline">\(\dot{V}_{in}\)</span> = 75 L min<sup>-1</sup>, <span class="math inline">\(T_{in,b}\)</span> = 25 °C, <span class="math inline">\(C_{A,in,b}\)</span> = 0.0 M, <span class="math inline">\(C_{B,in,b}\)</span> = 0.0 M, <span class="math inline">\(C_{A,in,a}\)</span> = 1.0 M, <span class="math inline">\(C_{B,in,a}\)</span> = 1.2 M, <span class="math inline">\(T_{in,a}\)</span> = 30 °C, <span class="math inline">\(k_{0.1}\)</span> = 8.72 x 10<sup>5</sup> L mol<sup>-1</sup> min<sup>-1</sup>, <span class="math inline">\(E_1\)</span> = 7200 cal mol<sup>-1</sup>, <span class="math inline">\(\Delta H_1\)</span> = –10,700 cal mol<sup>-1</sup>, <span class="math inline">\(\tilde{C}_p\)</span> = 1.0 cal g<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\rho\)</span> = 1.0 g cm<sup>-3</sup>, <span class="math inline">\(\tau\)</span> = 0.131, 0.262, 0.393, and 0.524 min, and <span class="math inline">\(R\)</span> = 1.987 cal mol<sup>-1</sup> K<sup>-1</sup>.</p>
<p><strong>Reactor System</strong>: Adiabatic PFR with a transient front.</p>
<p><strong>Quantities of Interest</strong>: <span class="math inline">\(\dot{n}_A \left(z\right)\)</span> and <span class="math inline">\(T\left(z\right)\)</span> as graphs at <span class="math inline">\(\tau\)</span> = 0.131, 0.262, 0.393, and 0.524 min</p>
</section>
<section id="mathematical-formulation-of-the-solution-4" class="level4" data-number="13.7.5.2">
<h4 data-number="13.7.5.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-solution-4"><span class="header-section-number">13.7.5.2</span> Mathematical Formulation of the Solution</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Because the change propagates as a front I can calculate the position of the front as a function of time. The concentration and temperature profiles ahead of the front are the steady-state profiles prior to the switch and those behind the front are the steady-state profiles after the switch. Therefore, I only need to calculate the steady-state profiels prior to the switch and after the switch.</p>
<p>I really don’t need to calculate the front prior to the switch. Pure water at <span class="math inline">\(T_{in,b}\)</span> is flowing steadily through the reactor. There isn’t any reaction nor a change in temperature, so the profiles are horizontal lines at <span class="math inline">\(\dot{n}_A\)</span> = 0 and <span class="math inline">\(T_{in,b}\)</span> for all <span class="math inline">\(z\)</span>.</p>
<p>After the feed switch has been made and the system has reached steady-state, I can use the general forms of the steady-state PFR mole and energy balances to model the system. I don’t need an energy balance on the exchange fluid because there isn’t one, and I don’t need a momentum balance because pressure drop is negligible.</p>
<p>The general form of the mole balance is given by <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>. There is only one reaction taking place, so the summation reduces to a single term.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z} = \frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j = \frac{\pi D^2}{4}\nu_{i,1}r_1
\]</span></p>
<p>The general form of the steady-state PFR reacting fluid energy balance is given by <a href="section_3_design_equations.html#eq-pfr_ss_energy_balance" class="quarto-xref">Equation&nbsp;<span>6.40</span></a>. The narrative provides the gravimetric heat capacity and the density of the liquid phase reacting fluid, to the first term can be modified to use that information. This PFR is adiabatic, so the heat exchange term is equal to zero, and again, there is only one reaction taking place.</p>
<p><span class="math display">\[
\cancelto{\rho \dot{V} \breve{C}_p}{\left(\sum_i \dot{n}_i \hat{C}_{p,i} \right)} \frac{d T}{d z} = \cancelto{0}{\pi D U\left( T_{ex} - T  \right)} - \frac{\pi D^2}{4}\cancelto{r_1 \Delta H_1}{\sum_j r_j \Delta H_j}
\]</span></p>
<p>When I solve the design equations numerically, I’m going to need to evaluate the derivatives, so I will re-write the equation in the form of a derivative expression (see <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix J</span></a>).</p>
<p><span class="math display">\[
\frac{d T}{d z} = -\frac{\pi D^2}{4} \frac{r_1 \Delta H_1}{\rho \dot{V} \tilde{C}_p}
\]</span></p>
</div>
</div>
</div>
<p><strong>Reactor Design Equations</strong></p>
<p>Mole balance design equations for A, B, Y, and Z after the feed has been switched and the reactor has reached steady-state are presented in equations (3) through (6). An energy balance on the reacting fluid after the feed has been switched and the reactor has reached steady-state is given in equation (7).</p>
<p><span class="math display">\[
\frac{d \dot{n}_A}{dz} = - \frac{\pi D^2}{4}r_1 \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_B}{dz} = - \frac{\pi D^2}{4}r_1 \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_Y}{dz} = \frac{\pi D^2}{4}r_1 \tag{5}
\]</span></p>
<p><span class="math display">\[
\frac{d \dot{n}_Z}{dz} = \frac{\pi D^2}{4}r_1 \tag{6}
\]</span></p>
<p><span class="math display">\[
\frac{d T}{d z} = -\frac{\pi D^2}{4} \frac{r_1 \Delta H_1}{\rho \dot{V} \tilde{C}_p} \tag{7}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are five IVODE reactor design equations and they contain five dependent variables (<span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>), so there isn’t a need to eliminae a dependent variable or add an IVODE.</p>
<p>Initial values and a stopping criterion are needed when solving IVODEs numerically. I can define <span class="math inline">\(z=0\)</span> to be the inlet to the reactor, in which case the other initial values are the molar flow rates and the temperture at the reactor inlet. The feed only contains A and B, so the inlet molar flow rates of Y and Z are zero. The length of the reactor is given, so that can serve as the stopping criterion.</p>
</div>
</div>
</div>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_13_7_5_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_13_7_5_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.5: Initial values and stopping criterion for solving equations, (numbers).
</figcaption>
<div aria-describedby="tbl-example_13_7_5_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(L\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,in,a}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_B\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{B,in,a}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(T_{in,a}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to solve the IVODEs numerically I’ll need to do two things: calculate the values of the derivatives at the start of each integration step and calculate all of the initial and final values in <a href="#tbl-example_13_7_5_initial_values" class="quarto-xref">Table&nbsp;<span>13.5</span></a>. At the start of an integration step, the independent (<span class="math inline">\(z\)</span>) and dependent variables (<span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>) will be known, as will the given and known constants listed above. I will need to calculate any other quantities that appear in the derivatives expressions, equations (3) - (7).</p>
<p>In those equations, the reaction rate, <span class="math inline">\(r_1\)</span>, and the volumetric flow rate, <span class="math inline">\(\dot{V}\)</span>, are unknown. The rate can be calculated using the rate expression, equation (2). In order to do that, the rate coefficient and the concentrations of A and B must be calculated. The rate coefficient can be calculated using the Arrhenius expression, <a href="section_2_rates_and_expressions.html#eq-arrhenius" class="quarto-xref">Equation&nbsp;<span>4.8</span></a>. The concentrations can be calculated using the defining equation for concentration in an open system, <a href="section_1_intro_and_defs.html#eq-concentration_open" class="quarto-xref">Equation&nbsp;<span>1.15</span></a>. The reacting fluid is a liquid; assuming it to be an incompressible ideal mixture means that the volumetric flow rate will be constant and equal to the inlet volumetric flow rate.</p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Evaluating the Derivatives</strong></p>
<p><span class="math display">\[
k_1 = k_{0,1} \exp{\left( \frac{-E_1}{RT} \right)} \tag{8}
\]</span></p>
<p><span class="math display">\[
C_A = \frac{\dot{n}_A}{\dot{V}} \tag{9}
\]</span></p>
<p><span class="math display">\[
C_B = \frac{\dot{n}_B}{\dot{V}} \tag{10}
\]</span></p>
<p><span class="math display">\[
\dot{V} = \dot{V}_{in} \tag{11}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When I solve the IVODEs numerically, I’ll also need to calculate the initial and final values in <a href="#tbl-example_13_7_5_initial_values" class="quarto-xref">Table&nbsp;<span>13.5</span></a>. The reactor length, <span class="math inline">\(L\)</span>, and the feed temperature, <span class="math inline">\(T_{in,a}\)</span> are provided in the assignment narrative, and the inlet molar flow rates of A and B can be calculated from their known inlet concentrations and the inlet volumetric flow rate, <a href="section_1_intro_and_defs.html#eq-concentration_open" class="quarto-xref">Equation&nbsp;<span>1.15</span></a>.</p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Initial and Final Values</strong></p>
<p>The inlet molar flow rates can be calculated using equations (12) and (13).</p>
<p><span class="math display">\[
\dot{n}_{A,in} = \dot{V}_{in}C_{A,in} \tag{12}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,in} = \dot{V}_{in}C_{B,in} \tag{13}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point the IVODEs can be solved for corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> that span the range from their initial values to their final values. That is, at this point I will have calculated the profiles of <span class="math inline">\(\dot{n}_A\)</span> and <span class="math inline">\(T\)</span> along the length of the reactor at steady-state.</p>
<p>The reacting fluid is an incompressible liquid, so the linear velocity of the front is simply the volumetric flow rate divided by the cross-sectional area of the tubular reactor.</p>
<p><span class="math display">\[
v = \frac{\dot{V}}{\frac{\pi D^2}{4}} = \frac{4 \dot{V}}{\pi D^2}
\]</span></p>
<p>The position of the front at any elapsed time after the switch can be calculated from its velocity.</p>
<p><span class="math display">\[
z_{front} = tv = \frac{4 \dot{V}t}{\pi D^2}
\]</span></p>
<p>As the front propagates through the reactor, the profile ahead of the front will equal the steady-state profile prior to the feed switch and the profile behind the front will equal the steady-state profile after the feed switch.</p>
</div>
</div>
</div>
<p>Solving the reactor design equations yields corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> that span the range from their initial (feed) values to their final (outlet) values. That is, solving the reactor design equations will yield, among other things, <span class="math inline">\(\dot{n}_{A,a}\)</span> and <span class="math inline">\(T_a\)</span> as functions of <span class="math inline">\(z\)</span> when steady-state has been reached after the feed switch. Prior to the feed switch the molar flow rate of A, <span class="math inline">\(\dot{n}_{A,b}\)</span>, and the temperature, <span class="math inline">\(T_b\)</span>, are constant for all <span class="math inline">\(z\)</span></p>
<p>Noting that the fluid is incompressible and the tube diameter is constant, the position of the front at any time following the switch can be calculated using equation (14). The profiles of interest then can be calculated using equations (15) and (16)</p>
<p><span class="math display">\[
z_{front} = \frac{4 \dot{V}t}{\pi D^2} \tag{14}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\dot{n}_A\left(z\right) &amp;= \dot{n}_{A,a}\left(z\right) \qquad z \le z_{front} \\
\dot{n}_A\left(z\right) &amp;= \dot{n}_{A,b}\left(z\right) \qquad z &gt; z_{front}
\end{align} \tag{15}
\]</span></p>
<p><span class="math display">\[
\begin{align}
T\left(z\right) &amp;= T_a\left(z\right) \qquad z \le z_{front} \\
T\left(z\right) &amp;= T_b\left(z\right) \qquad z &gt; z_{front}
\end{align} \tag{16}
\]</span></p>
<p><strong>Calculations Summary</strong></p>
<ol type="1">
<li>Substitute given and known constants into all equations.</li>
<li>When it is necessary to evaluate the derivatives
<ol type="a">
<li><span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span> will be available.</li>
<li>calculate <span class="math inline">\(k_1\)</span> and <span class="math inline">\(\dot{V}\)</span> using equations (8) and (11).</li>
<li>calculate <span class="math inline">\(C_A\)</span> and <span class="math inline">\(C_B\)</span> using equations (9) and (10).</li>
<li>calculate <span class="math inline">\(r_1\)</span> using equation (2).</li>
<li>evaluate the derivatives using equations (3) through (7)</li>
</ol></li>
<li>When it is necessary to calculate the initial and final values in <a href="#tbl-example_13_7_5_initial_values" class="quarto-xref">Table&nbsp;<span>13.5</span></a>
<ol type="a">
<li><span class="math inline">\(T_{in,a}\)</span> and <span class="math inline">\(L\)</span> are known constants.</li>
<li>calculate <span class="math inline">\(\dot{n}_{A,in,a}\)</span> and <span class="math inline">\(\dot{n}_{B,in,a}\)</span> using equations (12) and (13).</li>
</ol></li>
</ol>
</section>
<section id="numerical-implementation-of-the-solution-4" class="level4" data-number="13.7.5.3">
<h4 data-number="13.7.5.3" class="anchored" data-anchor-id="numerical-implementation-of-the-solution-4"><span class="header-section-number">13.7.5.3</span> Numerical implementation of the Solution</h4>
<ol type="1">
<li>Make the given and known constants available for use in all functions.</li>
<li>Write a derivatives function that
<ol type="a">
<li>receives the independent and dependent variables, <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, as arguments,</li>
<li>evaluates the derivatives as described in step 2 of the calculations summary, and returns their values.</li>
</ol></li>
<li>Write a reactor model function that
<ol type="a">
<li>calculates the initial and final values in <a href="#tbl-example_13_7_5_initial_values" class="quarto-xref">Table&nbsp;<span>13.5</span></a> as described in step 3 of the calculations summary,</li>
<li>gets corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial values to their final values by calling an IVODE solver and passing the following information to it
<ol type="i">
<li>the initial values and stopping criterion in <a href="#tbl-example_13_7_5_initial_values" class="quarto-xref">Table&nbsp;<span>13.5</span></a> and</li>
<li>the name of the derivatives function from step 2 above, d, checks that the solver successfully solved the IVODEs, and</li>
</ol></li>
<li>returns the values returned by the IVODE solver.</li>
</ol></li>
<li>Perform the analysis by
<ol type="a">
<li>calling the reactor model function from step 3 above to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>, <span class="math inline">\(\dot{n}_B\)</span>, <span class="math inline">\(\dot{n}_Y\)</span>, <span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(T\)</span>, spanning the range from their initial values to their final values for the steady state after the switch</li>
<li>for each of the four elapsed times of interest
<ol type="i">
<li>calculate the position of the front using equation (14)</li>
<li>plot the molar flow rate of A as a function of <span class="math inline">\(z\)</span> according to equation (15)</li>
<li>plot the temperature as a function of <span class="math inline">\(z\)</span> according to equation (16).</li>
</ol></li>
</ol></li>
</ol>
</section>
<section id="results-and-discussion-4" class="level4" data-number="13.7.5.4">
<h4 data-number="13.7.5.4" class="anchored" data-anchor-id="results-and-discussion-4"><span class="header-section-number">13.7.5.4</span> Results and Discussion</h4>
<p>The calculations were performed as described above. Profiles of the molar flow rate of A and the temperature within the reactor 0.131, 0.262, 0.393, and 0.524 min after the feed switch are shown in <a href="#fig-example_13_7_5_profiles" class="quarto-xref">Figure&nbsp;<span>13.11</span></a>. For an incompressible fluid flowing through a PFR at steady-state, the space time is equal to the amount of time the fluid spends within the reactor. Thus, as the figure shows, the front has just reached the outlet of the PFR at a time equal to the space time. For any times greater than this, the profile be invariant with the shape shown in the bottom panel of the figure because after one spece time, the reactor will have reached its new steady state.</p>
<div id="fig-example_13_7_5_profiles" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_13_7_5_profiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="examples/reb_13_7_5/t_131_min_profiles.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="examples/reb_13_7_5/t_262_min_profiles.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="examples/reb_13_7_5/t_393_min_profiles.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="examples/reb_13_7_5/t_524_min_profiles.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_13_7_5_profiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.11: Concentration (blue) and temperature (red) profiles 0.131, 0.262, 0.393, and 0,524 min after the feed flow started (top to bottom).
</figcaption>
</figure>
</div>
<p>The profiles shown in <a href="#fig-example_13_7_5_profiles" class="quarto-xref">Figure&nbsp;<span>13.11</span></a> seem a bit unrealistic. Consider what the transient PFR model would predict if only the temperature of the water flowing into this had been changed and without adding reactant to the feed. The model would predict that 0.262 minutes later the temperature of the first half of the reactor would be at 30 °C, and the temperature in the second half of the reactor would be 25 °C, with an abrupt change at the middle of the reactor. A very sharp transition like that is counter-intuitive. Instead, one might expect a smoother transition from hot to cold, not an instantaneous step change. The axial dispersion model presented in <a href="section_7_axial_dispersion_model.html" class="quarto-xref"><span>Chapter 24</span></a> pridicts a smoother, and intuitively more reasonable, temperature transition.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The method of analysis used in this example only applies in the special case where the transient is initiated by step changes in reagent concentration and or temperature at the inlet to the PFR. If the volumetric flow rate had changed, this method of analysis would not be applicable because a change in inlet flow rate affects all of the fluid in the reactor, not just the fluid entering it. Similarly, if there had been heat exchange through the reactor wall and the temperature of the exchange fluid had changed, this method of analysis would not be applicable, again because all of the fluid in the reactor would be affected, not just that entering it.</p>
</div>
</div>
</div>
</section>
</section>
<section id="sec-example_13_7_6" class="level3" data-number="13.7.6">
<h3 data-number="13.7.6" class="anchored" data-anchor-id="sec-example_13_7_6"><span class="header-section-number">13.7.6</span> Gas-Phase Reaction in a Packed-Bed PFR with Internal Concentration Gradients</h3>
<p>The gas-phase conversion of A to Z, equation (1), takes place at steady-state in a packed bed PFR operating isothermally at 400 °C. The reaction rate per unit catalyst particle volume is first order in A, equation (2), and at the operating temperature, the rate coefficient is equal to 0.15 cm<sup>3</sup><sub>fluid</sub> cm<sup>3</sup><sub>particle</sub> s<sup>-1</sup>. The void fraction within the packed bed is equal to 0.4. Pure A, flowing at 1.0 cm<sup>3</sup> s<sup>-1</sup> (0.054 g s<sup>-1</sup>), 400 °C, and 30 atm is fed to the reactor. There are no temperature gradients anywhere in the reactor or in the catalyst particles, and there are no concentration gradients external to the spherical catalyst particles which have a diameter, <span class="math inline">\(D_p\)</span> of 4 mm. The effective diffusion coefficient of A within the porous catalyst particles is equal to 0.0029 cm<sup>2</sup> s<sup>-1</sup> and the gas viscosity may be assumed to be constant and equal to 0.022 cP. If the reactor diameter is 1.5 cm and the conversion of A in the reactor is to equal 85%, what reactor length is required?</p>
<p><span class="math display">\[
A \rightarrow Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r_1 = k_1 C_A \tag{2}
\]</span></p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This problem describes operation of an isothermal steady-state PFR. I’ll begin by summarizing the assigmnent, assigning appropriate variable symbols to each quantity it mentions.</p>
</div>
</div>
</div>
<section id="assignment-summary-5" class="level4" data-number="13.7.6.1">
<h4 data-number="13.7.6.1" class="anchored" data-anchor-id="assignment-summary-5"><span class="header-section-number">13.7.6.1</span> Assignment Summary</h4>
<p><strong>Given and Known Constants</strong>: <span class="math inline">\(T\)</span> = 400 °C, <span class="math inline">\(k_1\)</span> = 0.15 cm<sup>3</sup><sub>fluid</sub> cm<sup>3</sup><sub>particle</sub> s<sup>-1</sup>, <span class="math inline">\(\epsilon\)</span> = 0.4, <span class="math inline">\(\dot{V}_{in}\)</span> = 1.0 cm<sup>3</sup> s<sup>-1</sup>, $_{in} = 0.054 g s<sup>-1</sup>, <span class="math inline">\(T_{in}\)</span> = 400 °C, <span class="math inline">\(P_{in}\)</span> = 30, <span class="math inline">\(D_p\)</span> = 4 mm, <span class="math inline">\(D_{A,eff}\)</span> = 0.0029 cm<sup>2</sup> s<sup>-1</sup>, <span class="math inline">\(\mu\)</span> = 0.022 cP, <span class="math inline">\(D\)</span> = 1.5 cm, <span class="math inline">\(f_A\)</span> = 0.85, and <span class="math inline">\(R\)</span> = 82.06 cm<sup>3</sup> atm mol<sup>-1</sup> K<sup>-1</sup>.</p>
<p><strong>Reactor System</strong>: Isothermal, steady-state PFR</p>
<p><strong>Quantities of Interest</strong>: <span class="math inline">\(L\)</span></p>
</section>
<section id="mathematical-formulation-of-the-solution-5" class="level4" data-number="13.7.6.2">
<h4 data-number="13.7.6.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-solution-5"><span class="header-section-number">13.7.6.2</span> Mathematical Formulation of the Solution</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to complete this assignment, I am going to need to generate an appropriate set of reactor design equations and solve them. The reactor design equations must always include mole balances. I will write mole balances for both A and Z. The general form of the steady-state PFR mole balance is shown in <a href="section_3_design_equations.html#eq-pfr_ss_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.39</span></a>.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z}  =\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j
\]</span></p>
<p>However, that form of the mole balance assumes that the rate is normalized per volume of reactor (or here per volume of packed bed), that there aren’t any composition or temperature gradients between the fluid and the catalyst particles, and that there aren’t any gradients within the particles. The rate expression provided in the assignment is normalized per catalyst particle volume. Noting that there is only one reaction taking place, the mole balance can be modified to account for the normalization of the rate.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z}  =\frac{\pi D^2}{4}\nu_{i,1}\frac{V_{part}}{V_{bed}}r_1
\]</span></p>
<p>The particle volume is the bed volume minus the void volume, and the void volume is equal to the bed volume times the void fraction.</p>
<p><span class="math display">\[
\begin{align}
\frac{d \dot{n}_i}{d z} &amp;= \frac{\pi D^2}{4}\nu_{i,1}\frac{V_{part}}{V_{bed}}r_1 \\&amp;= \frac{\pi D^2}{4}\nu_{i,1}\frac{V_{bed} - V_{void}}{V_{bed}}r_1 \\&amp;= \frac{\pi D^2}{4}\nu_{i,1}\frac{V_{bed} -  \epsilon V_{bed}}{V_{bed}}r_1 = \frac{\pi D^2}{4}\nu_{i,1}\left( 1 -  \epsilon \right)r_1
\end{align}
\]</span></p>
<p>That accounts for the rate normalization. The assignment states that there aren’t any gradients external to the particles and that there aren’t any temperature gradients within the particles. However, there may be concentration gradients within the particles. One way to account for any internal concentration gradients is to multiply the rate by the effectiveness factor. Doing so yields a mole balance where the normalization of the rate has been accounted for as have any concentration gradients within the particles.</p>
<p><span class="math display">\[
\frac{d \dot{n}_i}{d z} = \frac{\pi D^2}{4}\nu_{i,1}\left( 1 -  \epsilon \right)\eta r_1
\]</span></p>
<p>The assignment states that the reactor is isothermal and there aren’t any temperature gradients anywhere. In that case, I can solve the mole balance equations independently of the energy balance on the reacting fluid and the energy balance on the heat exchange fluid. Since the assignment does not ask any questions associated with either of those balances, I do not need to include them. The assignment does not mention whether or not there is a pressure drop in the reactor. As such, I’ll need to include a momentum balance in case pressure drop is significant. The steady-state momentum balance for a PFR is given in <a href="section_3_design_equations.html#eq-pfr_ergun_eqn" class="quarto-xref">Equation&nbsp;<span>6.42</span></a>.</p>
</div>
</div>
</div>
<p><strong>Reactor Design Equations</strong></p>
<p>Mole balance design equations for A and Z are presented in equations (3) and (4), and a momentum balance is shown in equation (5).</p>
<p><span class="math display">\[
\frac{\dot{n}_A}{dz} = - \frac{\pi D^2}{4}\left(1-\varepsilon \right)\eta r_1 \tag{3}
\]</span></p>
<p><span class="math display">\[
\frac{\dot{n}_Z}{dz} = \frac{\pi D^2}{4}\left(1-\varepsilon \right)\eta r_1 \tag{4}
\]</span></p>
<p><span class="math display">\[
\frac{{dP}}{{dz}} =  - \frac{{1 - \varepsilon }}{{{\varepsilon ^3}}}\frac{{{G^2}}}{{\rho {\Phi _s}{D_p}}}\left[ {\frac{{150\left( {1 - \varepsilon } \right)\mu }}{{{\Phi _s}{D_p}G}} + 1.75} \right] \tag{5}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The reactor design equations consist of three IVODEs and they contain three dependent variables (<span class="math inline">\(\dot{n}_A\)</span>,<span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(P\)</span>) so there isn’t any need to add an IVODE or eliminate a dependent variable.</p>
<p>Initial values and a stopping criterion are needed when solving IVODEs numerically. I can define <span class="math inline">\(z=0\)</span> as the reactor inlet, in which case the other initial values are simply the values of the dependent variables at the reactor inlet. Here the reactor is fed pure A, so the initial molar flow rate of Z is equal to zero. I know the conversion, so I can calculate the outlet molar flow rate of A and use it as the stopping criterion.</p>
</div>
</div>
</div>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_13_7_6_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_13_7_6_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.6: Initial values and stopping criterion for solving equations, (numbers).
</figcaption>
<div aria-describedby="tbl-example_13_7_6_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,in}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{n}_{A,out}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\dot{n}_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;"><span class="math inline">\(P_{in}\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In order to solve the IVODEs numerically I’ll need to do two things: calculate the values of the derivatives at the start of each integration step and calculate all of the initial and final values in <a href="#tbl-example_13_7_6_initial_values" class="quarto-xref">Table&nbsp;<span>13.6</span></a>.</p>
<p>At the start of each integration step <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>,<span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(P\)</span> will be known along with the given and known constants listed in the assignment summary. I will need to calculate any other quantities that appear in the derivatives expressions. Examination of equations (3) - (5) shows that for this assigment I’ll need to calculate <span class="math inline">\(\eta\)</span>, <span class="math inline">\(r_1\)</span>, <span class="math inline">\(G\)</span>, <span class="math inline">\(\rho\)</span>, and <span class="math inline">\(\Phi_s\)</span>.</p>
<p>The catalyst particles are spherical, so I can calculate the effectiveness factor using <a href="#eq-effectiveness_factor" class="quarto-xref">Equation&nbsp;<span>13.32</span></a>. In order to do that, I will first need to calculate the Thiele modulus for a spherical particle using <a href="#eq-Thiele_modulus" class="quarto-xref">Equation&nbsp;<span>13.29</span></a> and noting that the particle radius is half of its diameter.</p>
<p><span class="math display">\[
\eta = \frac{3}{\phi}\left( \frac{1}{\tanh{\phi}} - \frac{1}{\phi} \right)
\]</span></p>
<p><span class="math display">\[
\phi = R_{\text{part}}\sqrt{\frac{k}{D_{eA}}} = \frac{D_{\text{part}}}{2}\sqrt{\frac{k}{D_{eA}}}
\]</span></p>
<p>The rate can be calculated using the given rate expression, equation (2), but in order to do so the concentration must first be calculated. Than can be done using the defining equation for concentration in an open system and the ideal gas equation.</p>
<p><span class="math display">\[
C_A = \frac{\dot{n}_A}{\dot{V}} = \frac{\dot{n}_A}{\dot{n}_A + \dot{n}_Z}\frac{P}{RT}
\]</span></p>
<p>The mass flux, <span class="math inline">\(G\)</span>, can be calculated using its definition. To do that, the mass flow rate is needed. Here the inlet mass flow rate is given, but at steady state, the mass flow rate does not change because no nuclear reactions are taking place.</p>
<p><span class="math display">\[
G = \frac{4\dot{m}}{\pi D^2} = \frac{4\dot{m}_{in}}{\pi D^2}
\]</span></p>
<p>I don’t know the molecular weight of A and Z, but I can calculate the density of the fluid by dividing the mass flow rate by the volumetric flow rate, again noting that the mass flow rate is constant and equal to the inlet mass flow rate.</p>
<p><span class="math display">\[
\rho = \frac{\dot{m}}{\dot{V}} = \frac{\dot{m}_{in}P}{\left( \dot{n}_A + \dot{n}_Z \right)RT}
\]</span></p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Evaluating the Derivatives</strong></p>
<p><span class="math display">\[
\phi = \frac{D_{\text{part}}}{2}\sqrt{\frac{k}{D_{eA}}} \tag{6}
\]</span></p>
<p><span class="math display">\[
\eta = \frac{3}{\phi}\left( \frac{1}{\tanh{\phi}} - \frac{1}{\phi} \right) \tag{7}
\]</span></p>
<p><span class="math display">\[
C_A = \frac{\dot{n}_A}{\dot{n}_A + \dot{n}_Z}\frac{P}{RT} \tag{8}
\]</span></p>
<p><span class="math display">\[
G = \frac{4\dot{m}_{in}}{\pi D^2} \tag{9}
\]</span></p>
<p><span class="math display">\[
\rho = \frac{\dot{m}_{in}P}{\left( \dot{n}_A + \dot{n}_Z \right)RT} \tag{10}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When I solve the IVODEs numerically, I’ll also need to calculate the initial and final values in <a href="#tbl-example_13_7_6_initial_values" class="quarto-xref">Table&nbsp;<span>13.6</span></a>. The inlet pressure is given in the assignment narrative. The inlet molar flow rate of A can be calculated using the ideal gas law. Once that has been done, the outlet molar flow rate of A can be calculated using its known conversion.</p>
</div>
</div>
</div>
<p><strong>Ancillary Equations for Calculating the Initial and Final Values</strong></p>
<p><span class="math display">\[
\dot{n}_{A,in} = \frac{\dot{V}_{in}P_{in}}{RT_{in}} \tag{11}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{A,out} = \dot{n}_{A,in} \left( 1 - f_A \right) \tag{12}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>At this point the reactor design equations can be solved numerically to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>,<span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(P\)</span> spanning the range from their initial values to their final values (i.e.&nbsp;from the reactor inlet to the reactor outlet). The final value of <span class="math inline">\(z\)</span> is the length of the reactor, which is what the assignment asked for.</p>
</div>
</div>
</div>
<p>Solving the reactor design equations yields corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>,<span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(P\)</span> spanning the range from the reactor inlet to the reactor outlet. The final value of <span class="math inline">\(z\)</span>, then, is the length of the reactor, <span class="math inline">\(L\)</span>.</p>
<p><strong>Calculations Summary</strong></p>
<ol type="1">
<li>Substitute given and known constants into all equations.</li>
<li>When it is necessary to evaluate the derivatives
<ol type="a">
<li><span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>,<span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(P\)</span> will be available.</li>
<li>calculate <span class="math inline">\(\phi\)</span>, <span class="math inline">\(C_A\)</span>, <span class="math inline">\(G\)</span>, and <span class="math inline">\(\rho\)</span> using equations (6), (8), (9), and (10).</li>
<li>calculate <span class="math inline">\(\eta\)</span> using equation (7).</li>
<li>evaluate the derivatives using equations (3) - (5).</li>
</ol></li>
<li>When it is necessary to calculate the initial and final values in <a href="#tbl-example_13_7_6_initial_values" class="quarto-xref">Table&nbsp;<span>13.6</span></a>
<ol type="a">
<li><span class="math inline">\(P_{in}\)</span> is a known constant.</li>
<li>calculate <span class="math inline">\(\dot{n}_{A,in}\)</span> and <span class="math inline">\(\dot{n}_{A,out}\)</span> using equations (11) and (12)</li>
</ol></li>
</ol>
</section>
<section id="numerical-implementation-of-the-solution-5" class="level4" data-number="13.7.6.3">
<h4 data-number="13.7.6.3" class="anchored" data-anchor-id="numerical-implementation-of-the-solution-5"><span class="header-section-number">13.7.6.3</span> Numerical implementation of the Solution</h4>
<ol type="1">
<li>Make the given and known constants available for use in all functions.</li>
<li>Write a derivatives function that
<ol type="a">
<li>receives the independent and dependent variables, <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>,<span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(P\)</span>, as arguments,</li>
<li>evaluates the derivatives as described in step 2 of the calculations summary, and returns their values.</li>
</ol></li>
<li>Write a reactor model function that
<ol type="a">
<li>alculates the initial and final values in <a href="#tbl-example_13_7_6_initial_values" class="quarto-xref">Table&nbsp;<span>13.6</span></a> as described in step 3 of the calculations summary,</li>
<li>gets corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>,<span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(P\)</span>, spanning the range from their initial values to their final values by calling an IVODE solver and passing the following information to it
<ol type="i">
<li>the initial values and stopping criterion in <a href="#tbl-example_13_7_6_initial_values" class="quarto-xref">Table&nbsp;<span>13.6</span></a> and</li>
<li>the name of the derivatives function from step 3 above, d, checks that the solver successfully solved the IVODEs, and</li>
</ol></li>
<li>returns the values returned by the IVODE solver.</li>
</ol></li>
<li>Perform the analysis by
<ol type="a">
<li>calling the reactor model function from step 3 above to get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(\dot{n}_A\)</span>,<span class="math inline">\(\dot{n}_Z\)</span>, and <span class="math inline">\(P\)</span>, spanning the range from their initial values to their final values.</li>
<li>extracting the final value of <span class="math inline">\(z\)</span>, which is the length of the reactor <span class="math inline">\(L\)</span>.</li>
</ol></li>
</ol>
</section>
<section id="results-and-discussion-5" class="level4" data-number="13.7.6.4">
<h4 data-number="13.7.6.4" class="anchored" data-anchor-id="results-and-discussion-5"><span class="header-section-number">13.7.6.4</span> Results and Discussion</h4>
<p>The calculations were performed as described above. During the calculations it is found that the effectiveness factor is 0.885, resulting in a reactor length of 13.5 cm. If the effectiveness factor was not used to correct for the concentration gradients within the catalyst particles, a significantly shorter length of 11.9 cm would have been calculated corresponding to an error of almost 12%.</p>
<p>The calculations also show that the pressure drop is negligible; the calculated outlet pressure is 30 atm, which is equal to the inlet pressure. Nonetheless, this calculation was necessary because there was no way of knowing ahead of time whether the pressure drop would be significant.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>This example serves to show that when a reacting system consists of more than one phase, it is essential to check for gradients in the fluid phases close to interfaces and, if there are porous solids, within the pores. The equations developed and used in <em>Reaction Engineering Basics</em> assume that the reacting fluid is homogeneous, i. e. that no such gradients exist. Using those reactor design equations to model systems where gradients do exist can result is significant error.</p>
<p>There are much more rigorous ways to account for gradients in a reacting system. Doing so is often a substantial component of intermediate and advanced reaction engineering textbooks and courses.</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="symbols-used-in-chapter--sec-4_pfr_analysis" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="symbols-used-in-chapter--sec-4_pfr_analysis"><span class="header-section-number">13.8</span> Symbols Used in <a href="#sec-4_pfr_analysis" class="quarto-xref">Chapter&nbsp;<span>13</span></a></h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(ex\)</span></td>
<td style="text-align: left;">Subscript denoting the heat exchange fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(f\)</span></td>
<td style="text-align: left;">Friction factor.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(i\)</span></td>
<td style="text-align: left;">Subscript denoting a fluid phase reagent.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(j\)</span></td>
<td style="text-align: left;">Subscript denoting a reaction occurring in the system.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(j_D\)</span></td>
<td style="text-align: left;">Dimensionless <span class="math inline">\(j\)</span> factor for mass transfer.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(k_c\)</span></td>
<td style="text-align: left;">Concentration based mass transfer coefficient.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{m}_{ex}\)</span></td>
<td style="text-align: left;">Mass flow rate of the exchange fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_i\)</span></td>
<td style="text-align: left;">Molar flow rate of reagent <span class="math inline">\(i\)</span>; an additional subscripted “in” denotes the inlet value; an additional subscripted “out” denotes the outlet value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r_j\)</span></td>
<td style="text-align: left;">Net rate of reaction <span class="math inline">\(j\)</span> per unit volume of reacting fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: left;">Time.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(z\)</span></td>
<td style="text-align: left;">Distance from the inlet along the axis of a PFR.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(A\)</span></td>
<td style="text-align: left;">Heat transfer area.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(C_i\)</span></td>
<td style="text-align: left;">Concentration of reagent <span class="math inline">\(i\)</span>; an additional subscripted “out” denotes the outlet value, “in” denotes the inlet value, or “0” denotes the initial value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\tilde C_{p,ex}\)</span></td>
<td style="text-align: left;">Mass-specific heat capacity of the exchange fluid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\tilde C_{p}\)</span></td>
<td style="text-align: left;">Mass-specific heat capacity of the reacting fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\breve C_{p,ex}\)</span></td>
<td style="text-align: left;">Volume-specific heat capacity of the exchange fluid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\breve C_{p}\)</span></td>
<td style="text-align: left;">Volume-specific heat capacity of the reacting fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\hat C_{p,ex}\)</span></td>
<td style="text-align: left;">Molar heat capacity of the exchange fluid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\hat C_{p,i}\)</span></td>
<td style="text-align: left;">Molar heat capacity of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(D\)</span></td>
<td style="text-align: left;">Diameter of a PFR.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(D_A\)</span></td>
<td style="text-align: left;">Diffusion coefficient for reagent A; an additional subscripted “eff” denotes an effective diffusion coefficient.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(L\)</span></td>
<td style="text-align: left;">Length of a PFR.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(M_{ex}\)</span></td>
<td style="text-align: left;">Molecular weight of the exchange fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(N_{Re}\)</span></td>
<td style="text-align: left;">Reynold’s number.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Pressure of the reacting fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P_i\)</span></td>
<td style="text-align: left;">Partial pressure of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot Q\)</span></td>
<td style="text-align: left;">Rate of heat transfer from the exchange fluid to the reacting fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(R\)</span></td>
<td style="text-align: left;">Ideal gas constant.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T\)</span></td>
<td style="text-align: left;">Temperture of the reacting fluid; an additional subscripted “in” denotes the inlet value; an additional subscripted “0” denotes the initial value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T_{ex}\)</span></td>
<td style="text-align: left;">Temperature of the exchange fluid within the shell/jacket and at the outlet; an additional subscripted “in” denoes the inlet value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(U\)</span></td>
<td style="text-align: left;">Heat transfer coefficient.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(V\)</span></td>
<td style="text-align: left;">Volume of reacting fluid within a reactor.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{V}\)</span></td>
<td style="text-align: left;">Volumetric flow rate of the reacting fluid; an additional subscripted “in” denotes the value at the inlet.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(V_{ex}\)</span></td>
<td style="text-align: left;">Volume of exchange fluid contained within the reactor shell/jacket.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{W}\)</span></td>
<td style="text-align: left;">Rate at which the reacting fluid does work on the surroundings via shafts, moving boundaries, etc.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\gamma\)</span></td>
<td style="text-align: left;">Fraction of the exchange fluid that undergoes phase change or term defined in <a href="#eq-surf_conc" class="quarto-xref">Equation&nbsp;<span>13.35</span></a>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\delta\)</span></td>
<td style="text-align: left;">Boundary layer thickness.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\epsilon\)</span></td>
<td style="text-align: left;">Bed void fraction.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\varepsilon\)</span></td>
<td style="text-align: left;">Catalyst particle void fraction.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\eta\)</span></td>
<td style="text-align: left;">Effectiveness factor; a subscripted “G” denotes the global effectiveness factor.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mu\)</span></td>
<td style="text-align: left;">Viscosity.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\nu_{i,j}\)</span></td>
<td style="text-align: left;">Stoichiometric coefficient of reagent <span class="math inline">\(i\)</span> in reaction <span class="math inline">\(j\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\rho\)</span></td>
<td style="text-align: left;">Density of the reacting fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\rho_{ex}\)</span></td>
<td style="text-align: left;">Density of the exchange fluid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\tau\)</span></td>
<td style="text-align: left;">Pore tortuosity.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\tau_{PFR}\)</span></td>
<td style="text-align: left;">PFR space time.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: left;">Thiele modulus.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\Delta H_j\)</span></td>
<td style="text-align: left;">Heat of reaction <span class="math inline">\(j\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\Delta H_{\text{latent},ex}^0\)</span></td>
<td style="text-align: left;">Latent heat for the phase change the exchange fluid undergoes.</td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./section_4_cstr_analysis.html" class="pagination-link" aria-label="CSTR Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./section_4_continuous_design.html" class="pagination-link" aria-label="Design of Continuous Reactors">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>