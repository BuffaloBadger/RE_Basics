# Analysis of Kinetics Data from a BSTR {#sec-bstr-data-analysis}

@sec-kin-data-gen presented an overview of the design of kinetics experiments and the generation and analysis of kinetics data. This chapter focuses specifically on using reactors for those activities that conform to the assumptions of the ideal BSTR model described in @sec-modeling-ideal-reactors and [Appendix -@sec-ideal-reactor-models]. The most critical aspect of the ideal BSTR model is the assumption of perfect mixing, so the chapter begins with a few examples of devices that can be modeled as ideal BSTRs.

## Laboratory BSTRs

The name Batch *Stirred Tank* Reactor may conjure up a mental image of a BSTR as a vessel shaped much like a simple laboratory beaker, but perhaps fabricated from metal, with some means of stirring the contents vigourously. In fact, it is quite possible to use a simple beaker or Erlenmeyer flask placed on a heated magnetic stir plate and equipped with magnetic stir bar as a BSTR. When a round-bottomed flask is used, the rotating shaft from a motor often extends into the flask with a paddle on its end that is curved to match the bottom of the flask. As the paddle rotates, it mixes the contents of the reactor. In either case, there must be some means of withdrawing a small sample of fluid from the reactor as it operates to that the composition can be measured as the reaction proceeds.

![Round-bottomed flask used as a laboratory BSTR.](Graphics/laboratory_stirred_tank_reactor.png){#fig-laboratory_bstr width=70%}

For higher pressure reactions, a metal "autoclave" can be used. The top of this type of autoclave is a flange with a gasket that can be bolted onto the reactor to seal it for use at higher pressures. Typically autoclaves can be heated or cooled and they use a shaft and paddle for agitation. Special fittings or magnetic couplings are used so that the rotating shaft can pass into the autoclave without allowing the high pressure contents to leak out.

In fact, devices that do not resemble a stirred beaker can also be used as BSTRs for kinetics data generation. The primary requirement is that the contents of the reactor be perfectly mixed. As an example, @fig-batch_recirc_reactor shows a recirculation loop reactor. Fluid is rapidly recirculated in the reactor by a pump. In-line mixing devices can be placed in the flow path to promote thorough mixing of the fluid. The reactor must be operated at a very high recirculation rate, and for isothermal operation, the pump and other components all must be maintained at the same constant temperature. If heterogeneous catalytic reactions are being studied, a packed catalyst bed can be inserted somewhere within the loop. In this case, the amount of reactant converted during a single pass through the bed should be very small so that the compositions at the beginning and at the end of the bed are essentially equal. In this way the composition in the loop will change with time, but within it, the composition will be essentially uniform everywhere, just as the batch reactor model assumes. A recirculation reactor such as that shown in @fig-batch_recirc_reactor is particularly useful for the study of a single gas phase reaction that involves a change in the total number of moles. In such a system, if the initial composition, temperature and pressure are known, the composition at any other time can be found from a measurement of the total pressure. Thus kinetics data can be measured simply by recording the total pressure as a function of time.

![Batch recirculation loop reactor schematic.](Graphics/batch_recirculation_schematic.png){#fig-batch_recirc_reactor width="60%"}

The stopped flow reactor, shown schematically in @fig-stopped_flow_reactor, is a batch reactor that is especially useful for the study of rapid, liquid-phase, bimolecular reactions. Solutions containing the reactants are fed in separate streams to a small mixing chamber. This chamber is designed so that the fluids enter as high velocity jets. The high velocity of these jets causes instantaneous, perfect mixing when the jets enter the reactor. Downstream from the mixing chamber, but still near to it, a detector is located. Typically the detector is a spectrophotometer. This device shines radiation of a given frequency through the fluid and measures how much of the radiation is absorbed. The frequency of the radiation is chosen so that only one of the reactants or products absorbs the radiation. In this way the response from the spectrophotometer is directly proportional to the amount of that one reactant or product. In a typical experiment the fluids begin flowing and a steady state is established. The flow is then stopped instantaneously, and the response of the spectrophotometer is recorded as a function of time. The instant the flow stops, the volume through which the radiation passes becomes a very small batch reactor.

![Stopped-flow reactor schematic.](Graphics/stopped_flow_schematic.png){#fig-stopped_flow_reactor width=80%}

### Testing the Ideality of a BSTR

Before a laboratory BSTR is used to generate kinetics data, it should be tested to ensure that it conforms to the assumptions of an ideal BSTR. The most important assumption is that of perfect mixing. If the reactor walls are transparent or if there is a window in the walls, a "smoke test" is a simple way to check the mixing. To perform this kind of test a small amount of colored fluid is added to the reactor. For a gas phase reactor the added fluid is some form of smoke, for a liquid phase system it is often a colored dye. The contents of the reactor are observed at the instant the smoke or dye is added. The smoke of dye should instantaneously mix and fill the entire contents of the reactor. Importantly, there should not be any "corners" or other locations where the color changes slowly. Locations where the color changes slowly are called stagnant zones. They are places where the mixing is not perfect.

A second way of testing the assumption of perfect mixing involves performing the same experiment several times. Each time the experiment is repeated, the only difference from the other experiments is the rate of agitation. That is, a different stirrer speed or recirculation rate is used in each experiment. As the agitation rate is increased in successive experiments, a point should be reached where the experimental results are identical to the previous experiment. At that rate of agitation, the assumption of perfect mixing can be assumed to be satisfied. In subsequent experiments where kinetics data are being generated, an agitation rate somewhat above that critical rate should then be used.

## BSTR Kinetics Experiments and Data

In @sec-kin-data-gen it was recommended that experiments for the generation of kinetics data be performed in blocks where all of the experiments in any one block occur at the same temperature. The basis for this recommendation is that rates are typcially more strongly affected by changes in temperature than by changes in composition. If both temperature and composition change at the same time, the stronger temperature effects may mask the more subtle composition effects.

In order to follow that recommendation, reactors being used to generate kinetics data should operate isothermally. In *Reaction Engineering Basics* it is always assumed that kinetics data have been generated using an isothermal reactor wherein only one reaction is occurring. If the kinetics data will be analzed using a linearized reactor model (see @sec-kin-data-gen), there is a second reason for operating a BSTR isothermally. If the reactor is isothermal, it is possible to write only one mole balance, and that mole balance can be solved separately from the energy balance. If the reactor is non-isothermal, the energy and mole balances must be solved simultaneously, and this will typically make it impossible to linearize the reactor model.

In a typical BSTR kinetics experiment, the reactants are first loaded into the reactor; this is also called charging the reactor. If the charge to the reactor has not been pre-heated, then once the reagents are in the vessel, it may be necessary to heat the contents to the desired temperature. If the reaction being studied involves two or more reactants, they can be pre-heated separately to the desired temperature before adding them to the reactor. Alternatively, it may be necessary to add catalyst to start the reaction.

In any of these situations, **as soon as the reactor is charged and has stabilized at the desired temperature**, the "initial composition" is analyzed. The kinetics experiment is taken to begin at the instant the initial composition is analyzed. The reaction then is allowed to proceed over time. Periodically during this period the elapsed time and some quantity that can be related to the composition (the response) are recorded. As such, each experiment typically yields multiple measurements of the response variable.

## Design of BSTR Experiments

The purpose of kinetics experiments is to generate kinetics data that can be used to develop a rate expression. Generally there will be a critical range of temperatures and critical ranges of the concentration of each reagent within which the rate expression needs to be as accurate as possible. The experiments should be designed so that the temperature and each concentration (or partial pressure) spans its critical range. A factorial design like that described in @sec-kin-data-gen then can be used.

### Adjusted Experimental Inputs

As already noted, each BSTR experiment will be isothermal, so one of the experimental adjusted reactor inputs will be the reactor temperature. The number of different temperatures to be used will depend upon the critical range of the temperature. If the rate expression needs to be accurate over a range of 150 °C, a greater number of temperatures should be studied than if it needs to be accurate over a range of 30 °C.

Two experimental inputs affect the concentrations of the reagents during the experiments. One is the initial composition at the start of the experiment. In any one experiment, the composition will change continually as the reaction proceeds, so responses measured at different elapsed times during the same experiment will correspond to different compositions. It makes sense to measure the response as many times as possible during each experiment to minimize the time and cost of the experimental study. Consequently the temperature and the initial concentration are the primary inputs that are adjusted from experiment to experiment, with as many response measurements as possible or practical during each experiment. These were the adjusted experimental inputs specified in [Example -@sec-example_7_1].

The number of times the response can be measured may be determined by the time it takes to make the measurement. For example changes in the absorbance radiation at a particular frequency where one reactant or product absorbs can be measured almost continuously, but analysis using gas chromatography may require several minutes per measurement. The temperature of the experiment may also affect the possible number of response measurements. Consider an irreversible reaction. The reaction rate will be greater in experiments where the temperature is higher. As a consequence, the reaction will go to completion in a shorter period of time in higher temperature experiments than in low temperature experiments. That may mean that fewer responses can be measured in a high temperature experiment than in a low temperature experiment.

### Experimental Responses

Many different quantities can be used as the experimental response. The only requirement is that it must be possible to relate the measured response to the composition of the system. Obvious choices for the measured response are the concentration or partial pressure of any one reactant or product. (Recall from @sec-reaction-progress that knowing the initial molar amounts and any one final amount allows calculation of the apparent extent of reaction, which, in turn allows the calculation of all other final amounts.)

Similar quantities that could be measured as the experimental response include the mole fraction of any reactant or product or the conversion of any reactant. There are other, less obvious possibilities for the measured response. As noted above, for a gas phase reaction where the total number of moles changes as a result of the reaction, the total pressure of the system can be used as the response variable. Properties such as the refactive index of a liquid, the electrical conductivity of a liquid, the absorbance of radiation of a specific frequency, etc. can often be related to the amount of one reagent in the fluid, in which case that property can also be used as the measured response.

One other possibility for the measured response from BSTR kinetics experiments is known as the half-life. This response variable is the elapsed time required for the amount of any one reactant to decrease to one-half of its initial value. Measuring the half-life is particularly easy with a stopped-flow reactor like that depicted in @fig-stopped_flow_reactor. One simply measures the elapsed time between the instant the flow is stopped and the instant the spectrophotometer signal becomes one-half of its original value. (This assumes that the spectrophotometer signal is linearly proportional to the amount of the reagent absorbing the light.) The analysis of kinetics data where the measured response is the half-life is discussed below.

## BSTR Data Analysis

The analysis of kinetics data generated using an ideal, isothermal BSTR makes use of the ideal BSTR mole balance, @eq-bstr_mole_balance. In *Reaction Engineering Basics* there will alway be one reaction taking place within the reactor, so the mole balance on any reactant or product, $i$, will take the from shown in @eq-bstr_mole_bal_one_reaction. Because only one reaction is taking place, it is not necessary to use an index for the reaction.

$$
\frac{dn_i}{dt} = \nu_i r V
$$ {#eq-bstr_mole_bal_one_reaction}

@sec-kin-data-gen described three general approaches to the analysis of kinetics data. The preferred approach uses exact mole balances to model the reactor. Another popular approach uses a linearized reactor model, but this is not always possible. The third approach uses an approximate mole balance. The use of each of those three approaches for the analysis of BSTR kinetics data is considered in this section. In addition, a fourth method of data analysis based on using the half-life of the reaction as the response variable is described.

### Analysis Using a Response Function

Analysis using a response function is straightforward. Because it sacrifices no accuracy and can be used in every situation, kinetics data analysis using a response function is the preferred approach in *Reaction Engineering Basics*. A BSTR response function is a computer function. The experimental adjusted reactor inputs and the kinetics parameters in the rate expression are passed to it as arguments. Within the BSTR response function the mole balance design equations, @eq-bstr_mole_bal_one_reaction, are solved to find the molar amounts of all reagents at each of the times the experimental response was measured. In turn, those results are used to calculate the value of the experimental response predicted by the BSTR model for each experiment.  The BSTR response function returns those model-predicted responses.

The BSTR response function is used with computer software for parameter estimation. Typically the response function is provided to the parameter estimation software along with a guess for the values of the kinetics parameters, the experimental adjusted reactor inputs and the experimental measured responses. The parameter estimation software returns the best estimate and 95% confidence interval (or an equivalent quantity) for each of the kinetics parameters together with the coefficient of determination, $R^2$.

The estimated kinetics parameters can then be used to calculate the model-predicted response and the residual (difference between the model-predicted response and the experimentally measured response) for each experiment. From those a parity plot (model-predicted response *vs*. experimentally measured response) and residuals plots (residual *vs*. each adjusted reactor input) can be created.

The accuracy of the model can then be assessed and a recommendation made by noting that when the model is accurate the following criteria will be satisfied.

* The coefficient of determination, $R^2$, will be close to 1.
* The uncertainty in each parameter estimate will be small compared to the estimate.
* The points in the parity plot will all be close to a diagonal line ($y_{\text{expt}} = y_{\text{model}}$).
* In each residuals plot, the points will scatter randomly about zero (the horizontal axis), and no systematic deviations will be apparent.

### Analysis Using a Linearized Model

In this approach, a single mole balance design equation, @eq-bstr_mole_bal_one_reaction, is used. It is solved analytically to obtain an integrated form of the reactor model. This is shown in @eq-integrated_bstr_mole_bal where $f$ represents the function obtained upon solving the mole balance analytically. It isn't always possible to solve the mole balance in this way; when it isn't possible, this approach cannot be used.

$$
\frac{dn_i}{dt} = \nu_i r V \qquad \Rightarrow \qquad n_i = f\left( n_i, t \right)
$$ {#eq-integrated_bstr_mole_bal}

Assuming that the mole balance can be solved to find the function, $f$, the solution of the IVODE is re-written so that by defining new variables it becomes a linear equation. Sometimes this can be done using only algebraic manipulations. When the integrated model equation contains a fraction with multiple terms in the denominator, taking the reciprocal of both sides sometimes leads to a linearized equation. Similarly, if the integrated model equation contains an exponential, taking the log of both sides sometimes leads to a linearized equation. The note following [Example -@sec-example_4_4] provides an example of linearizing an equation containing an exponential, specifically the Arrhenius expression. It isn't always possible to linearize the integrated reactor model, in which case this approach again can't be used. If the integrated reactor model can be linearized, it will have the linear form shown in @eq-linear_equation.

$$
y = m_1x_1 + m_2x_2 + \cdots + m_nx_n + b
$$

It is important to understand that *the kinetics parameters cannot appear in the defining equation for the new variables*, $y$ and the $x_i$. Also, *each slope, $m_i$, and the intercept, $b$, must contain a unique combination of the kinetics parameters in its definition, and it may not contain any adjusted inputs*. That means that if the rate expression contains $n$ kinetics parameters, the linearized reactor model will have $n-1$ slopes, $m_i$, and one intercept, $b$.

At this point, the analysis proceeds as described in @sec-kin-data-gen. The primary advantage of this approach is that the linearized model can be fit to the new $y$ and $x$ data using linear least squares. It is not necessary to write a response function, nor to use general parameter estimation software. As noted in @sec-kin-data-gen, if there are only two kinetics parameters in the rate expression, the linearized model, $y=mx+b$ can be fit to the $x$ - $y$ data using a spreadsheet.

The criteria for assessing the accuracy of the rate expression is the same as when using a response function. When the rate expression contains two kinetics parameters and a spreadsheet is used for analysis, it isn't necessary to generate parity and residuals plots. Instead, a plot showning the $x$ - $y$ data and the fitted model (trendline) can be used instead. If the model is accurate, the plotted points lie close to the trendline with no systematic deviations from the line. That is, with random scatter about the line.

### Analysis Using the Rate Expression as the Model (Differential Analysis)

In this approach, an approximate form of the mole balance, @eq-bstr_diff_mol_bal, is used. The primary advantage of this approach is that it converts the reactor model from an IVODE to an algebraic/transcendental equation (ATE). The derivative can be approximated using backward, forward or central differences (see [Appendix -@sec-pre-knowledge]). In the past, before computers were readily available, the derivative was also estimated graphically. That is $n_i$ was plotted *vs*. $t$, a smooth curve was drawn through the data, and the slopes of tangents to that curve were measured and used to approximate the derivative.

$$
\frac{dn_i}{dt} = \nu_i r V \approx \frac{\Delta n_i}{\Delta t} = \nu_i r V
$$ {#eq-bstr_diff_mol_bal}

If the measured response is not the molar amount of $i$, it becomes necessary to process the data when using this approach. That is, it is necessary to use the measured response to calculate $n_i$, so that the derivative can be approximated. In practice, the approximate reactor model is typically linearized and analyzed as described above when using this approach.

As one might expect, this approach to kinetics data analysis is not as accurate as using the exact reactor model. As the data becomes noisier (i. e. the greater the random error in the data), the accuracy decreases. If the noise in the data is very small and the intervals between response measurements are also small, the accuracy can approach the accuracy of analysis using the exact reactor model. Nonetheless, analysis using the exact reactor model is generally preferred, while this approach is often used to perform a quick, preliminary analysis.

One variation on this approach uses **initial rates**. The only difference in this approach is that @eq-bstr_diff_mol_bal is only applied at the start of the experiment. As a result, each experiment yields only the value of the rate at the initial conditions. This approach is typically applied graphically by plotting the molar amount of $i$ *vs*. $t$. The initial slope then can be measured graphically. It facilitates a quick, preliminary assessment of possible rate expressions. As personal computers have become popular and available, the use of this approach appears to have declined.

### Half-life Methods of Analysis

Another method that appears to have declined in popularity is the half-life method. It involves measuring the “half-life” of the reaction as described above. The half-life method is most commonly applied when the rate is expected to depend upon the concentration of a single reactant, e. g. reactant A, in a power-law fashion, @eq-half_life_rate_expr. The half-life, $t_{1/2}$, is the amount of time that it takes for the concentration of the reactant to decrease to one-half of its initial value. This rate expression can be substituted into the batch reactor design equation, @eq-bstr_mole_bal_one_reaction, as shown in @eq-half_life_ode.

$$
r_A = - kC_A^\alpha
$$ {#eq-half_life_rate_expr}

$$
\frac{dn_i}{dt} = - kVC_A^\alpha = -kV\left( \frac{n_A}{V} \right)^\alpha = -kV^{1-\alpha}n_A^\alpha
$$ {#eq-half_life_ode}

@eq-half_life_ode can be solved by separating the variables and integrating. The lower limit of integration is that the moles of A equal $n_{A,0}$ at $t$ equals zero, and the upper limit of integration is that the moles of A equal $0.5n_{A,0}$ at $t$ equals $t_{1/2}$. If the reaction order, $\alpha$, is equal to one, the result is given in @eq-half_life_first_order; for reaction orders other than one, @eq-half_life_other_order results.

$$
t_{1/2} = \frac{0.693}{k}
$$ {#eq-half_life_first_order}

$$
t_{1/2} = \frac{\left(2^{\alpha -1} - 1\right)}{kC_{A,0}^{\alpha - 1}\left( \alpha - 1 \right)}
$$ {#eq-half_life_other_order}

@eq-half_life_first_order and @eq-half_life_other_order suggest that the reaction order, $\alpha$, can be determined by measuring the half-life in a series of experiments using different initial concentrations of A. If the half-life is the same for all initial concentrations, the reaction is first order. Otherwise, a log-log plot of the half-life *vs*. the initial concentration should yield a straight line, and the slope should equal $1-\alpha$ as can be seen by taking the logs of each side of equation @eq-half_life_other_order. Note that $k$ and $\alpha$ were treated as constants in this analysis, so each block of experiments at a single temperature must be evaluated separately.

## Examples

All of the examples in [Chapters -@sec-bstr-data-analysis], -@sec-cstr-data-analysis, and -@sec-pfr-data-analysis involve using experimental data to generate and assess a rate expression. Here in @sec-bstr-data-analysis the experimental data have been generated using an ideal BSTR. This type of problem can be called a "kinetics data analysis problem." When one is assigned any problem to solve, one of the first things they need to do is to identify what type of problem it is. Instead of repeating how an expert would identify each problem in this chapter as a kinetics data analysis problem at the start of the problem, a single expert thinking callout is provided here. Readers should mentally insert this callout at the start of every example in this chapter.

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking after Reading each Problem Statement in this Chapter

This is what I call a "kinetics data analysis problem." It has 3 distinguishing characteristics.

* The problem statement describes reactor experiments.
* The data resulting from performing those experiments are provided.
* The problem asks you to generate a rate expression or to assess the accuracy of a proposed rate expression using those data.

I know that to solve a kinetics data analysis problem I will need to do the following things.

* Identify the experimental adjusted reactor inputs. These are the things that the person doing the experiment had control over and was able to set their value.
* Identify the experimental response. This is some quantity that is related to the composition of the reacting fluid at the time it was measured.
* Formulate some type of mathematical model of the experiments. In this book, where kinetics experiments are isothermal and involve only one reaction, the model will be based upon one or more mole balances.
* Fit the model to the experimental data. This yields the value of the kinetics parameters in the rate expression that minimize the difference between the responses the model predicts and the responses that were measured experimentally.
* Assess whether the model is sufficiently accurate and make a recommendation based upon that assessment.

:::

### Differential Analysis Using Initial Rates {#sec-example_8_1}

{{< include ../RE_Basics_Examples/reb_8_1/problem_statement.qmd >}}

```{r}
#| echo: false
#| output: false
library(tidyverse)
source("~/Libraries/R/fmt_tibble_col.R")
d <- read.csv("Data/reb_8_1_data.csv")
# Experiment, T, CA0, t, CA
```

The first few data points are shown in @tbl-example_8_1_data. The full data set is available in the .csv file [reb_8_1_data.csv](./Data/reb_8_1_data.csv)

```{r}
#| echo: false
#| warning: false
#| label: tbl-example_8_1_data
#| tbl-cap: First 8 of the 72 experimentally generated data.
library(kableExtra)
library(knitr)
kbl(d[1:8,], format = "markdown", align = "cc", col.names = c('Experiment','T (°C)',
    'C~A,0~ (M)', 't~rxn~ (min)', 'C~A~ (M)'))
```

---

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

Having identified this as a kinetics data analysis problem as described in the expert thinking callout at the start of this section, I know that I need to identify the adjusted experimental inputs and the measured experimental response. I like to start by additionally summarizing information from the problem statement including the type of reactor used in the experiments and constant quantities provided in the problem statement. Knowing that I need to estimate the values of all of the kinetics parameters appearing in the rate expression, it is also useful to identify and list them, too. Creating these lists at the start of the analysis makes it easier to formulate the model for the experiments. Note that in listing the adjusted experimental inputs and the measured experimental response, the variable symbols are underlined to indicate that they are vector quantities.

I know that the data will be analyzed in two phases as described in [add ref to chapter 7]. In this problem, data were generated at 4 different temperatures. For the first phase of the analysis, I will separate the data into four blocks. One block will contain the data from all experiments conducted at 60 °C, one will contain the 73 °C data, one, the 82 °C data and one, the 90 °C data. I will analyze each of these blocks separately to estimate the best value of $k$ at that temperature and to assess the accuracy of the rate expression at that temperature.

:::

**Reactor Type**: BSTR

**Given Constants**: $V = 1\text{ L}$.

**Adjusted Inputs**: $\underline{T}$, $\underline{C_{A,0}}$, and $\underline{t}$

**Experimental Response**: $\underline{C_{A,\text{ expt}}}$

**Kinetics Parameters**: $k_0$, and $E$

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

In this phase of the analysis, I will be analyzing the data in blocks where the temperature is the same in all of the experiments being analyzed. It isn't possible to estimate values of $k_0$ and $E$ for the individual blocks, so the rate expression will be written using $k$ in place of $k_0 \exp \left( \frac{-E}{RT} \right)$. The values of $k_0$ and $E$ will be estimated in the second phase of the analysis.

I am instructed to perform differential data analysis in this problem. That means that I will model the reactor using just one mole balance, and in that mole balance I will approximate the derivative using a finite difference. Since the response in this problem is the concentration of A, it makes sense to write that approximate mole balance on A. 

:::

**Reactor Design Equation**

An approximate mole balances on A for the first measured response in each experiment is presented in equation (3). For the rest of the measured responses in that experiment, the approximate mole balance is given by equation (4), where $i$ indexes the measurement times during that experiment.

$$
\frac{n_A \Big\vert_{t=t_1} - n_A \Big\vert_{t=0}}{t_1} = -r V \tag{3}
$$

$$
\frac{n_A \Big\vert_{t=t_i} - n_A \Big\vert_{t=t_{i-1}}}{t_i - t_{i-1}} = -r V \tag{4}
$$

:::{.callout-tip collapse="true"}
## Click Here to See Where That Came From

Start from @eq-bstr_diff_mol_bal written for reagent A.

$$
\frac{dn_A}{dt} = \nu_A r V \approx \frac{\Delta n_A}{\Delta t} = \nu_A r V
$$

The stoichiometric coefficient of A is -1. If backward differences are used, it is possible to approximate the derivative at each of the times the response was measured in any one experiment. (If forward differences were used, the derivative could not be approximated at the time of the final measurement.) For the first measurement, the previous values of $n_A$ and $t$ are the initial values. If the start of the each experiments is defined to be $t=0$, equation (3) results. For the remaining times when the response is measured, the previous values are simply those from the previous measurement, equation (4). 

:::

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

I know that the next thing I need to do is to substitute the rate expression into the reactor model and then fit the model to the experimental data. I could fit the model using a response function. However, when differential analysis is used, it is common to linearize the reactor model and use linear least squares for the fitting. That is the approach I will use here.

:::

Substitution of the rate expression into equation (4) and rearrangement leads to equation (5). Recognizing that $t_0 = 0$, this equation can be used for every data point.

$$
\frac{C_{A,i-1} - C_{A,i}}{t_i - t_{i-1}} = k C_{A,i} \tag{5}
$$

:::{.callout-tip collapse="true"}
## Click Here to See Where That Came From

Start by substituting the rate expression, equation (2), into equation (4) and letting $n_{A,i} = n_A \Big\vert_{t=t_i}$.

$$
\frac{n_{A,i} - n_{A,i-1}}{t_i - t_{i-1}} = -k V C_{A,i}
$$

Then divide each side of the equation by $-V$.

$$
\frac{n_{A,i} - n_{A,i-1}}{t_i - t_{i-1}} \frac{-1}{V} = k C_{A,i}
$$

Finally, note that $\frac{n_{A,i}}{V} = C_{A,i}$ and $\frac{n_{A,i-1}}{V} = C_{A,i-1}$.

$$
\frac{C_{A,i-1} - C_{A,i}}{t_i - t_{i-1}} = k C_{A,i}
$$

:::

If $x$ and $y$ are defined as shown in equations (6) and (7), it is apparent that equation (5) is a linear equation with a slope of $k$ and an intercept of 0, equation (8).

$$
x_i = C_{A,i} \tag{6}
$$

$$
y_i = \frac{C_{A,i-1} - C_{A,i}}{t_i - t_{i-1}} \tag{7}
$$

$$
y = kx \tag{8}
$$

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

The next step is to estimate the parameters. Since the model is a linear equation, I can do that using linear least squares. I could use a spreadsheet program to do this, but I prefer write a short computer program that calls a linear least squares function. My main reason for this preference is that it the software will provide the coefficient of determination, the parameter estimates, *and* the 95% confidence intervals (or an equivalent measure of uncertainty) for the estimated parameter. When a spreadsheet is used to plot the data and add a trendline, the uncertainties are shown. Additional calculations must be performed in the spreadsheet to generate those uncertainties. 

In either case, the values of $x$ and $y$ must first be calculated for each experiment using equations (6) and (7). A straight line can then be fit to the resulting $x$ - $y$ data to obtain the coefficient of determination, the parameter estimates, and the 95% confidence intervals for the parameters. The model in this problem, $y=mx$, is linear with only one parameter, so a model plot can be used to assess its accuracy as described in [Chapter 7].

:::

**Parameter Estimation and Assessment of Accuracy**

```{r}
#| echo: false
#| output: false
library(tidyverse)
source("~/Libraries/R/fmt_tibble_col.R")
d <- read.csv("../RE_Basics_Examples/reb_8_1/python/reb_8_1_phase_1_results.csv")
# T, k, k_ll, k_ul, R_sq_
d <- fmt_tibble_col(d, 2:5, 3, 2, 2)
d$k_full = paste0(d$k,' min^-1^, 95% CI [',d$k_ll,', ',d$k_ul,']')
```

Within each block of data, values of $x$ and $y$ were calculated for each experimental data point, equation (8) was fit to the resulting data, and a model plot was created. The fitting results are given in @tbl-example_8_1_phase_1_results, and the model plots are shown in @fig-example_8_1_phase_1_plots.

```{r}
#| echo: false
#| warning: false
#| label: tbl-example_8_1_phase_1_results
#| tbl-cap: Phase 1 fitting results
d <- d %>% select(T, k_full, R_sq)
library(kableExtra)
library(knitr)
kbl(d, format = "markdown", align = "cc", col.names = c("T (°C)", "k", "R^2^"))
```

::: {#fig-example_8_1_phase_1_plots layout-ncol=2}

![](Graphics/reb_8_1_model_T_equals_65.png)

![](Graphics/reb_8_1_model_T_equals_73.png)

![](Graphics/reb_8_1_model_T_equals_82.png)

![](Graphics/reb_8_1_model_T_equals_90.png)

Model Plots for each of the four temperature blocks.
:::

The 95% confidence intervals for each of the four estimated rate coefficients are relatively small compared to the estimated values and the $R^2$ values are all close to 1. Looking at the model plots, the deviations of the experimental data appear to be random. In general, the magnitude of the deviations are acceptable. The deviations are greater for the experiments at lower temperatures. If this is a concern, additional experiments should be performed at the lower temperatures.

```{r}
#| echo: false
#| output: false
library(tidyverse)
source("~/Libraries/R/fmt_tibble_col.R")
d <- read.csv("../RE_Basics_Examples/reb_8_1/python/reb_8_1_Arrhenius_results.csv")
d <- fmt_tibble_col(d, 2, 3, 2, 2)
a <- c('k~0~','E','R^2^')
b1 <- paste0(d$value[1],' ',d$units[1],', 95% CI [',d$value[2],', ',d$value[3],']')
b2 <- paste0(d$value[4],' ',d$units[4],', 95% CI [',d$value[5],', ',d$value[6],']')
b <- c(b1,b2,d$value[7])
# item, value, units
d <- data.frame(a,b)
```

The Arrhenius expression was fit to the estimated rate coefficients in @tbl-example_8_1_phase_1_results. The parameter estimation results are shown in @tbl-example_8_1_arrhenius_results.

```{r}
#| echo: false
#| warning: false
#| label: tbl-example_8_1_arrhenius_results
#| tbl-cap: Parameter estimation results
library(kableExtra)
library(knitr)
kbl(d, format = "markdown", align = "cc", col.names = NULL)
```

The 95% confidence interval for the pre-exponential factor is quite large, but this is often observed for the pre-exponential factor. The confidence interval for the activation energy is small relative to its value, suggesting a good fit. Additionally, the coefficient of determination is equal to 1, which indicates a very good fit. The Arrhenius plot is shown in @fig-example_8_1_arrhenius_plot. The estimated rate coefficients fall almost exactly on the line representing the Arrhenius expression.

![Arrhenius plot resulting from the estimated parameters.](Graphics/reb_8_1_Arrhenius_plot.png){#fig-example_8_1_arrhenius_plot width=80%}

**Recommendation**

As the problem instructed, the kinetics data were analyzed using an approximate reactor model. This is expected to introduce some error. Despite the use of differential data analysis, the model was found to describe the experimental results with reasonable accuracy. The greatest discrepancies between the experiments and the model predictions occurred at low temperature. While additional low-temperature experiment could be performed to try to improve the accuracy, doing so is not necessary. Given that the instructions said to use differential analysis, one can infer that extremely high accuracy is not needed here.

:::{.callout-note collapse="false"}
## Note

In this experimental study 3 experiments were performed at each temperature, differing only in the initial concentration of A. The elapsed time between each measurement of the response was 5 min in those experiments. Had it been possible to measure the response very quickly, say every 0.25 min, a single experiment could have been used at each temperature.

In addition to reducing the time required to perform the experiments, this might have improved the accuracy of the results. In the present study, the derivative of the molar amount of a with respect to time was approximated using two data points that were 5 min apart. If the data points had been 0.25 min apart, the approximation would have been more accurate.

:::

### Analysis Using a Linearized Reactor Model and a Spreadsheet {#sec-example_8_2}

{{< include ../RE_Basics_Examples/reb_8_2/problem_statement.qmd >}}

---

:::{.callout-note collapse="false"}
## Note

Alternative approach is to analyze data for each temperature separately to get k at each temperature, then fit Arrhenius expression to the resulting data. (refer to earlier example)

:::


### A Gas-Phase Reaction With Total Pressure as the Response {#sec-example_8_3}

{{< include ../RE_Basics_Examples/reb_8_3/problem_statement.qmd >}}

:::{.callout-note collapse="false"}
## Note

problem is not realistic because can't pre-heat reactant and can't heat it instantly.

:::

### Assessing a Michaelis-Menten Rate Expression {#sec-example_8_4}

{{< include ../RE_Basics_Examples/reb_8_4/problem_statement.qmd >}}





---

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

This problem asks me to linearize the reactor model for []. I know that this means I can only use one mole balance as the design equations, and since the mole balances for this system are IVODEs, I need to solve that mole balance analytically. Here I will use the mole balance on A.

:::

**Linearized Reactor Model**

A mole balance on reagent A is presented in quation (3). It is an IVODE, and solving it yields equation (4).

$$
\frac{dn_A}{dt} = -r_1 V \tag{3}
$$

$$
\ln \left(-\frac{\ln \frac{n_{A}}{n_{A,0}}}{t} \right) =  E_1\left( \frac{-1}{RT} \right) + \ln k_{0,1} \tag{4}
$$

:::{.callout-tip collapse="true"}
## Click Here to See Where That Came From

Start from equation (3), substitute the rate expression, equation (2), and the defining equation for the concentration of A, and cancel out the reacting fluid volume.

$$
\frac{dn_A}{dt} = -k_{0,1} \exp \left( \frac{-E_1}{RT} \right)C_A V \Rightarrow -k_{0,1} \exp \left( \frac{-E_1}{RT} \right)\frac{n_A}{V} V
$$

$$
\frac{dn_A}{dt} = -k_{0,1} \exp \left( \frac{-E_1}{RT} \right)n_A
$$

Separate the variables and integrate. Defining the instant that the reaction starts as $t=0$ and letting $n_{A,0}$ represent the initial moles of A gives the lower limits of integration, and use unspecified upper limits.

$$
\frac{dn_A}{n_A} = -k_{0,1} \exp \left( \frac{-E_1}{RT} \right)dt
$$

$$
\int_{n_{A,0}}^{n_{A}}\frac{dn_A}{n_A} = -k_{0,1} \exp \left( \frac{-E_1}{RT} \right) \int_0^{t}dt
$$

$$
\ln \frac{n_{A}}{n_{A,0}} = -k_{0,1} \exp \left( \frac{-E_1}{RT} \right) t
$$

The resulting integrated mole balance is not a linear equation. Divide both sides of the equation by $t$ and then take the log of both sides to eliminate the exponential.

$$
-\frac{\ln \frac{n_{A}}{n_{A,0}}}{t} = k_{0,1} \exp \left( \frac{-E_1}{RT} \right)
$$

$$
\ln \left(-\frac{\ln \frac{n_{A}}{n_{A,0}}}{t} \right) =  E_1\left( \frac{-1}{RT} \right) + \ln k_{0,1}
$$

:::

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

I know that I'm going to need to calculate the new variables, $x$ and $y$. It is useful to list the known constants, the adjusted experimental inputs, and the experimental responses, because they can be used to calculate $x$ and $y$. These are all the same as in [Example ]. I won't list the kinetics parameters here, though, because when I solve the problem using a linearized model, these are unknown quantities that won't be available at the time I need to calculate $x$ and $y$.

:::

**Given Constants**: $V = 1\text{ L}$.

**Adjusted Inputs**: $\underline{T}$, $\underline{C_{A,0}}$, and $\underline{t}$

**Experimental Responses**: $\underline{C_{A,\text{ expt}}}$

If $x$ and $y$ for experiment $i$ are defined as shown in equations (5) and (6), it can be seen that the model has the linear form shown in equation (7), with the slope equal to $E_1$, equation (8), and an intercept equal to $\ln k_{0,1}$, equation (9).

$$
x_i= \frac{-1}{RT_i} \tag{5}
$$

$$
y_i = \ln \left(-\frac{\ln \frac{n_{A,i}}{n_{A,0,i}}}{t_i} \right) = \ln \left(-\frac{\ln \frac{n_{A,i}/V}{n_{A,0,i}/V}}{t_i} \right) = \ln \left(-\frac{\ln \frac{C_{A,i}}{C_{A,0,i}}}{t_i} \right) \tag{6}
$$

$$
y = m x + b \tag{7}
$$

$$
m = E_1 \tag{8}
$$

$$
b =\ln k_{0,1} \tag{9}
$$

The problem asks for a description of how the linearized equation can be used to assess the accuracy of the rate expression, equation (2). This can be done using a spreadsheet program. First, the values of $x$ and $y$ are calculated using equations (5) and (6), and a plot of $y$ vs. $x$ is created. Adding a trendline to the plot will provide the best estimates for the slope, $m$, and intercept, $b$. Equations (8) and (9) can be used to calculate the best estimates for $E_1$ and $k_{0,1}$. The coefficient of determination, $R^2$, and the uncertainties in $m$ and $b$ can also be obtained from the spreadsheet. If the model is accurate, the following criteria will be satisfied.

* The coefficient of determination, $R^2$, is close to 1.
* The uncertainty in $k_{0,1}$ is small compared to the value of $k_{0,1}$.
* The uncertainty in $E_1$ is small compared to the value of $E_1$.
* The $x-y$ data points in the plot scatter randomly about the trendline with no apparent systematic trends.

Analysis of Kinetics Data Using a Rate Expression Model



---

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

This problem asks me to calculate the value of the rate for each experimental data point. I will use a mole balance on A to do that. In the mole balance I will approximate the derivative using backwards differences (see [Appendix -@sec-pre-knowledge]). Before doing that, it is useful to list the known constants, the adjusted experimental inputs, and the experimental responses, because they can be used in the calculations.

:::

**Given Constants**: $V = 1\text{ L}$.

**Adjusted Inputs**: $\underline{T}$, $\underline{C_{A,0}}$, and $\underline{t}$

**Experimental Responses**: $\underline{C_{A,\text{ expt}}}$

A mole balance on A, equation (3), can be solved for the reaction rate, equation (4). The derivative in that equation can be approximated using backward differences. If the response sampling time for data point $i$ is 5 min, then it is the first measurement of the response in that experiment. Consequently, the time prior to it is $t=0$, and the concentration of A at the time prior to it is $C_{A,0}$, equation (5). Otherwise the differences simply use data point $i-1$, equation (6).

$$
\frac{dn_A}{dt} = -r_1V \tag{3}
$$

$$
r_1 = -\frac{1}{V} \frac{dn_A}{dt} = -\frac{dC_A}{dt} \approx -\frac{\Delta C_A}{\Delta t} \tag{4}
$$

$$
r_{1,i} \approx -\frac{C_{A,i} - C_{A,0,i}}{t_i - 0} = \frac{C_{A,0,} - C_{A,i}}{t_i} \tag{5}
$$

$$
r_{1,i} \approx -\frac{C_{A,i} - C_{A,i-1}}{t_i - t_{i-1}} \tag{6}
$$

The problem asks for a description of how the resulting data, i. e. the set of values of $r_1$ for each of the experiments can be used to assess the accuracy of the rate expression, equation (2). This is accomplished by using the values of $r_{1,i}$ from equation (6) as the experimental responses and using equation (7) as the response function. From that point on, the assessment of the accuracy of the model is analogous to [Example ].

$$
r_{1,i,\text{model}} = k_{0,1} \exp \left( \frac{-E_1}{RT_i} \right) C_{A,i} \tag{7}
$$

## Symbols Used in @sec-bstr-data-analysis
| Symbol | Meaning |
|:-------|:--------|
|   |  . |

: {tbl-colwidths="[20,80]"}