# Analysis of Kinetics Data from a BSTR {#sec-bstr-data-analysis}

@sec-kin-data-gen presented an overview of the design of kinetics experiments and the generation and analysis of kinetics data. This chapter focuses specifically on using reactors for those activities that conform to the assumptions of the ideal BSTR model described in @sec-modeling-ideal-reactors and [Appendix -@sec-ideal-reactor-models]. The most critical aspect of the ideal BSTR model is the assumption of perfect mixing, so the chapter begins with a few examples of devices that can be modeled as ideal BSTRs.

## Laboratory BSTRs

The name Batch *Stirred Tank* Reactor may conjure up a mental image of a BSTR as a vessel shaped much like a simple laboratory beaker, but perhaps fabricated from metal, with some means of stirring the contents vigourously. In fact, it is quite possible to use a simple beaker or Erlenmeyer flask placed on a heated magnetic stir plate and equipped with magnetic stir bar as a BSTR. When a round-bottomed flask is used, the rotating shaft from a motor often extends into the flask with a paddle on its end that is curved to match the bottom of the flask. As the paddle rotates, it mixes the contents of the reactor. In either case, there must be some means of withdrawing a small sample of fluid from the reactor as it operates to that the composition can be measured as the reaction proceeds. 

For higher pressure reactions, a metal "autoclave" can be used. The top of this type of autoclave is a flange with a gasket that can be bolted onto the reactor to seal it for use at higher pressures. Typically autoclaves can be heated or cooled and they use a shaft and paddle for agitation. Special fittings or magnetic couplings are used so that the rotating shaft can pass into the autoclave without allowing the high pressure contents to leak out.

In fact, devices that do not resemble a stirred beaker can also be used as BSTRs for kinetics data generation. The primary requirement is that the contents of the reactor be perfectly mixed. As an example, @fig-batch_recirc_reactor shows a recirculation loop reactor. Fluid is rapidly recirculated in the reactor by a pump. In-line mixing devices can be placed in the flow path to promote thorough mixing of the fluid. The reactor must be operated at a very high recirculation rate, and the pump and other components must be operated at a constant temperature. If heterogeneous catalytic reactions are being studied, a packed catalyst bed can be inserted somewhere within the loop. In this case, the amount of reactant converted during a single pass through the bed should be very small so that the compositions at the beginning and at the end of the bed are essentially equal. In this way the composition in the loop will change with time, but within it, the composition will be essentially uniform everywhere, just as the batch reactor model assumes. A recirculation reactor such as that shown in @fig-batch_recirc_reactor is particularly useful for the study of a single gas phase reaction that involves a change in the total number of moles. In such a system, if the initial composition, temperature and pressure are known, the composition at any other time can be found from a measurement of the total pressure. Thus kinetics data can be measured simply by recording the total pressure as a function of time. [Example -@sec-example_8_3] illustrate the analysis of data of this type.

![Batch recirculation loop reactor schematic.](Graphics/batch_recirculation_schematic.png){#fig-batch_recirc_reactor width="60%"}

The stopped flow reactor, shown schematically in @fig-stopped_flow_reactor, is a batch reactor that is especially useful for the study of rapid, liquid-phase, bimolecular reactions. Solutions containing the reactants are fed in separate streams to a small mixing chamber. This chamber is designed so that the fluids enter as high velocity jets. The high velocity of these jets causes instantaneous, perfect mixing when the jets enter the reactor. Downstream from the mixing chamber, but still near to it, a detector is located. Typically the detector is a spectrophotometer. This device shines radiation of a given frequency through the fluid and measures how much of the radiation is absorbed. The frequency of the radiation is chosen so that only one of the reactants or products absorbs the radiation. In this way the response from the spectrophotometer is directly proportional to the amount of that one reactant or product. In a typical experiment the fluids begin flowing and a steady state is established. The flow is then stopped instantaneously, and the response of the spectrophotometer is recorded as a function of time. The instant the flow stops, the volume through which the radiation passes becomes a very small batch reactor.

![Stopped-flow reactor schematic.](Graphics/stopped_flow_schematic.png){#fig-stopped_flow_reactor width=80%}

### Testing the Ideality of a BSTR

Before a laboratory BSTR is used to generate kinetics data, it should be tested to ensure that it conforms to the assumptions of an ideal BSTR. The most important assumption is that of perfect mixing. If the reactor walls are transparent or if there is a window in the walls, a "smoke test" is a simple way to check the mixing. To perform this kind of test a small amount of colored fluid is added to the reactor. For a gas phase reactor the added fluid is some form of smoke, for a liquid phase system it is often a colored dye. The contents of the reactor are observed at the instant the smoke or dye is added. The smoke of dye should instantaneously mix and fill the entire contents of the reactor. Importantly, there should not be any "corners" or other locations where the color changes slowly. Locations where the color changes slowly are called stagnant zones. They are places where the mixing is not perfect.

A second way of testing the assumption of perfect mixing involves performing the same experiment several times. Each time the experiment is repeated, the only difference from the other experiments is the rate of agitation. That is, a different stirrer speed or recirculation rate is used in each experiment. As the agitation rate is increased in successive experiments, a point should be reached where the experimental results are identical to the previous experiment. At that rate of agitation, the assumption of perfect mixing can be assumed to be satisfied. In subsequent experiments where kinetics data are being generated, an agitation rate well above that critical rate should then be used.

## BSTR Kinetics Experiments and Data

In @sec-kin-data-gen it was recommended that experiments for the generation of kinteics data be performed in blocks where all of the experiments in any one block occur at the same temperature. The basis for this recommendation is that rates are typcially more strongly affected by changes in temperature than be changes in composition. If both temperature and composition change at the same time, the stronger temperature effects may mask the more subtle composition effects.

In order to follow that recommendation, reactors being used to generate kinetics data should operate isothermally. **In *Reaction Engineering Basics* it is always assumed that kinetics data have been generated using an isothermal reactor wherein only one reaction is occurring**. If the kinetics data will be analzed using a linearized reactor model (see @sec-kin-data-gen), there is a second reason for operating a BSTR isothermally. If the reactor is isothermal, it is possible to write only one mole balance, and that mole balance can be solved separately from the energy balance. If the reactor is non-isothermal, the energy and mole balances must be solved simultaneously, and this will typically make it impossible to linearize the reactor model.

In a typical BSTR kinetics experiment, the reactants are first loaded into the reactor; this is also called charging the reactor. If the charge to the reactor has not been pre-heated, then once the reagents are in the vessel, it may be necessary to heat the contents to the desired temperature. If the reaction being studied involves two or more reactants, they can be pre-heated separately to the desired temperature before adding them to the reactor. Alternatively, it may be necessary to add catalyst to start the reaction.

In any of these situations, **as soon as the reactor is charged and has stabilized at the desired temperature**, the "initial composition" is analyzed. The kinetics experiment is taken to begin at the instant the initial composition is analyzed. The reaction is allowed to proceed over time. Periodically during this period the elapsed time and the composition are recorded. As such, each experiment typically yields multiple measurements of the response variable.

## Design of BSTR Experiments

The purpose of kinetics experiments is to generate kinetics data that can be used to develop a rate expression. Generally there will be a critical range of temperatures and critical ranges of the concentration of each reagent within which the rate expression needs to be as accurate as possible. The experiments should be designed so that the temperature and each concentration (or partial pressure) spans its critical range. A factorial design like that described in @sec-kin-data-gen then can be used.

### Adjusted Experimental Inputs

As already noted, each BSTR experiment will be isothermal, so by sets or blocks of experiments at different temperatures, the critical range of temperatures can be studied. Two experimental inputs affect the concentrations of the reagents during the experiments. One is the initial composition at the start of the experiment, and the other is the elapsed times at which the response is measured. Due to the reaction taking place, the composition is changing over time, each measurement of the response during a single experiment will occur at a different composition, but those compositions are related to each other through the reaction stoichiometry. Consequently the temperature and the initial concentrations of each of the reagents are typically the experimental inputs that are adjusted from experiment to experiment.

There is one reason for adjusting the number of response measurements during each experiment of the elapsed times at which the responses are measured. Consider an irreversible reaction. The reaction rate will be greater in experiments where the temperature is higher. As a consequence, the reaction will go to completion in a shorter period of time in higher temperature experiments than in low temperature experiments. So, if the time it takes for the reaction to go to completion changes significantly depending on the temperature of the experiment, it may be necessary to adjust the number of response measurements or the elapsed time between experiments depending on the experimental temperature. 

### Experimental Responses

Many different quantities can be used as the experimental response. The only requirement is that it must be possible to relate the measured response to the composition of the system. Obvious choices for the measured response are the concentration or partial pressure of any one reactant or product. (Recall from @sec-reaction-progress that knowing the initial molar amounts and any one final amount allows calculation of the apparent extent of reaction, which, in turn allows the calculation of all other final amounts.)

Other quantities that could be measured as the experimental response include the mole fraction of any reactant or product or the conversion of any reactant. There are other, less obvious possibilities for the measured response. As noted above, for a gas phase reaction where the total number of moles changes as a result of the reaction, the total pressure of the system can be used as the response variable. Properties such as the refactive index of a liquid, the electrical conductivity of a liquid, the absorbance of radiation of a specific frequency, etc. can often be related to the amount of one reagent in the fluid, in which case that property can also be used as the measured response.

One other possibility for the measured response from BSTR kinetics experiments is known as the half-life. This response variable is the elapsed time required for the amount of any one reactant to decrease to one-half of its initial value. Measuring the half-life is particularly easy with a stopped-flow reactor like that depicted in @fig-stopped_flow_reactor. One simply measures the elapsed time between the instant the flow is stopped and the instant the spectrophotometer signal becomes one-half of its original value. (This assumes that the spectrophotometer signal is linearly proportional to the amount of the reagent absorbing the light.) The analysis of kinetics data where the measured response is the half-life is discussed below.

## BSTR Data Analysis

The analysis of kinetics data generated using an ideal, isothermal BSTR makes use of the ideal BSTR mole balance, @eq-bstr_mole_balance. In *Reaction Engineering Basics* there will alway be one reaction taking place within the reactor, so the mole balance on any reactant or product, $i$, will take the from shown in @eq-bstr_mole_bal_one_reaction. Because only one reaction is taking place, it is not necessary to use an index for the reaction.

$$
\frac{dn_i}{dt} = \nu_i r V
$$ {#eq-bstr_mole_bal_one_reaction}

@sec-kin-data-gen described three ways of using the mole balance on a reactant or product for the analysis of kinetics data. In fact, the examples in @sec-kin-data-gen were all based on an ideal BSTR. For that reason, the application of those three methods of data analysis are summarized very briefly here. In addition, a fourth method of data analysis based on using the half-life of the reaction as the response variable is described.

### Analysis Using a Response Function

A BSTR response function is a computer function. The experimental adjusted reactor inputs and the kinetics parameters in the rate expression are passed to it as arguments. The BSTR response function solves the mole balance design equations, @eq-bstr_mole_bal_one_reaction, to find the molar amounts of all reagents at each of the times the experimental response was measured. It then uses those results to predict the value of the experimental response and returns the model-predicted response.

The BSTR response function is used with computer software for parameter estimation. Typically it is provided to that software along with a guess for the values of the kinetics parameters, the experimental adjusted reactor inputs and the experimental measured responses. The parameter estimation software returns the best estimate and 95% confidence interval (or an equivalent quantity) for the kinetics parameters and the coefficient of determination, $R^2$.

The estimated kinetics parameters can then be used to calculate the model-predicted response and the residual (difference between the model-predicted response and the experimentally measured response) for each experiment. From those a parity plot (model-predicted response *vs*. experimentally measured response) and residuals plots (residual *vs*. each adjusted reactor input) can be created.

The accuracy of the model can then be assessed and a recommendation made by noting that when the model is accurate the following criteria will be satisfied.

* The coefficient of determination, $R^2$, will be close to 1.
* The uncertainty in each parameter estimate will be small compared to the estimate.
* The points in the parity plot will all be close to a diagonal line ($y_{\text{expt}} = y_{\text{model}}$).
* In each residuals plot, the points will scatter randomly about zero (the horizontal axis), and no systematic deviations will be apparent.

### Analysis Using a Linearized Model

In this approach, a single mole balance design equation, @eq-bstr_mole_bal_one_reaction, is used. It is solved analytically to obtain an integrated form of the reactor model. New variables are then defined in a way that results in an equation that is linear. That is, it is rearranged to have the form shown in @eq-linear_equation where $y$ and the $x_i$ represent the new variables. The kinetics parameters do not appear in the defining equations for the new variables and each slope, $m_i$, and the intercept, $b$, *must* contain a *unique* combination of the kinetics parameters in its definition. The number of kinetics parameters must equal $n+1$.

$$
y = m_1x_1 + m_2x_2 + \cdots + m_nx_n + b
$$ {#eq-linear_equation}

The experimental adjusted inputs and the measured responses are then used to calculate the values of the new variables, $y$ and $x_1$ through $x_n$, for each experiment. @eq-linear_equation is then fit to the new variables. In the situation where there are only two kinetics parameters, the linearized reactor model takes the from $y=mx+b$. In this case, a spreadsheet can be used to plot $y$ *vs*. $x$ and to fit the equation to the data. Doing so will yield the best estimates of $m$ and $b$ along with a coefficient of determination, $R^2$.

If the model is accurate, in other words, if the rate expression is accurate, the value of $R^2$ will be close to 1 and the plotted points lie close to the fitted line with no systematic trends in their deviations from the line.

### Analysis Using the Rate Expression as the Model (Differential Analysis)

In this approach, an approximate form of the mole balance, @eq-bstr_diff_mol_bal, is used. It is used to calculate the value of the rate, $r$, for each experiment. Then, instead of writing a response function to fit the reactor model to the original experimental data, a response function is written to fit the rate expression directly to the processed experimental data. In other words, the calculated values of the rate are treated as the experimental response and the rate expression is used as the model.

$$
\frac{dn_i}{dt} = \nu_i r V \approx \frac{\Delta n_i}{\Delta t}
$$ {#eq-bstr_diff_mol_bal}

One variation on this approach uses **initial rates**. The only difference in this approach is that @eq-bstr_diff_mol_bal is only applied at the start of the experiment. As a result, each experiment yields only the value of the rate at the initial conditions. This approach was typically applied graphically. The molar amount of $i$ was plotted *vs*. $t$, and the initial slope was measured graphically. It facilitated a quick, preliminary assessment of possible rate expressions. As personal computers have become popular and available, the use of this approach appears to have declined.

### Half-life Methods of Analysis

Another method that appears to have declined in popularity is the half-life method. It involves measuring the “half-life” of the reaction as described above. The half-life method is most commonly applied when the rate is expected to depend upon the concentration of a single reactant, e. g. reactant A, in a power-law fashion, @eq-half_life_rate_expr. The half-life, $t_{1/2}$, is the amount of time that it takes for the concentration of the reactant to decrease to one-half of its initial value. This rate expression can be substituted into the batch reactor design equation, @eq-bstr_mole_bal_one_reaction, as shown in @eq-half_life_ode.

$$
r_A = - kC_A^\alpha
$$ {#eq-half_life_rate_expr}

$$
\frac{dn_i}{dt} = - kVC_A^\alpha = -kV\left( \frac{n_A}{V} \right)^\alpha = -kV^{1-\alpha}n_A^\alpha
$$ {#eq-half_life_ode}

@eq-half_life_ode can be solved by separating the variables and integrating. The lower limit of integration is that the moles of A equal $n_{A,0}$ at $t$ equals zero, and the upper limit of integration is that the moles of A equal $0.5n_{A,0}$ at $t$ equals $t_{1/2}$. If the reaction order, $\alpha$, is equal to one, the result is given in @eq-half_life_first_order; for reaction orders other than one, @eq-half_life_other_order results.

$$
t_{1/2} = \frac{0.693}{k}
$$ {#eq-half_life_first_order}

$$
t_{1/2} = \frac{\left(2^{\alpha -1} - 1\right)}{kC_{A,0}^{\alpha - 1}\left( \alpha - 1 \right)}
$$ {#eq-half_life_other_order}

@eq-half_life_first_order and @eq-half_life_other_order suggest that the reaction order, $\alpha$, can be determined by measuring the half-life in a series of experiments using different initial concentrations of A. If the half-life is the same for all initial concentrations, the reaction is first order. Otherwise, a log-log plot of the half-life *vs*. the initial concentration should yield a straight line, and the slope should equal $1-\alpha$ as can be seen by taking the logs of each side of equation @eq-half_life_other_order. Note that $k$ and $\alpha$ were treated as constants in this analysis, so each block of experiments at a single temperature must be evaluated separately.

## Examples

examples from chapter 7 were all BSTRs

### Differential Analysis Using Initial Rates {#sec-example_8_1}

### Assessing a Second-Order Rate Expression {#sec-example_8_2}

solve with both linearized model and response function

### A Gas-Phase Reaction With Total Pressure as the Response {#sec-example_8_3}

### Assessing a Michaelis-Menten Rate Expression {#sec-example_8_4}

## Symbols Used in @sec-bstr-data-analysis
| Symbol | Meaning |
|:-------|:--------|
|   |  . |

: {tbl-colwidths="[20,80]"}