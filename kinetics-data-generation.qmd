# Generation and Analysis of Kinetics Data {#sec-kin-data-gen}

If the rate of a reaction has been studied previously, an expression for the rate of that reaction may be available. When a rate expression is not available, it is necessary to develop one. In this situation, the mathematical form of the rate expression is not known. Whatever rate expression is eventually developed will contain kinetics parameters that also are unknown. Theory alone cannot provide the mathematical form of the rate expression nor the values of the kinetics parameters that appear in it. For this reason, to develop a rate expression, kinetics data are needed.

Reaction rates depend upon temperature, pressure and composition. Temperature can be measured using thermometers or thermocouples. Pressure can be measured using manometers or a wide variety of pressure gauges. Fluid composition can be measured using gas chromatography, mass spectrometry or many other instruments. The same is not true for reaction rates. There isn't a meter, gauge, or instrument that one can put in or attach to a chemical reactor to measure the rate of the reaction or reactions going on within it. 

Since rates cannot be measured directly, changes in composition (or something related to composition) that occur in chemical reactors are measured instead. Those changes are measured experimentally at different reactor temperatures, pressures and compositions, resulting in a set of experimental kinetics data. Three different approaches can be used to analyze those data and develop a rate expression. This brief chapter considers the design of kinetics experiments and presents an overview of the three approaches that can be used to analyze the data generated in those experiments. Before doing so, it is useful to recall the process used to develop rate expressions.

## Procedure for Developing a Rate Expression

The development of a rate expression for a reaction begins by postulating its mathematical form. As discussed in @sec-rates-rate-express and @sec-mechanisms, the form might be chosen empirically, theoretically or mechanistically. Then a reactor must be chosen for use in kinetics experiments. Chapters [-@sec-bstr-data-analysis], [-@sec-cstr-data-analysis], and [-@sec-pfr-data-analysis] discuss the use of ideal BSTRs, CSTRs, and PFRs, respectively, in the development of rate expressions.

Once a rate expression has been proposed and a reactor has been selected, kinetics experiments can be designed and performed. The experimental data then are used to find the best values for the kinetics parameters appearing in the proposed rate expression and to assess its accuracy. This is accomplished using a model of the reactor that predicts the experimental results for all of the experiments. Specifically, the values of the unknown kinetics parameters are adjusted so as to minimize the differences between the experimental results and those predicted by the model. This process is called statistical parameter estimation. It is sometimes also referred to as least-squares fitting, curve fitting, or fitting the model to the experimental data.

In addition to the estimates for the values of the kinetics parameters, the software used for parameter estimation will provide statistical measures that can be used to assess the accuracy of the resulting model. Those can be combined with graphical procedures (see [Appendix -@sec-parameter-est]), leading to a recommendation to accept the rate expression, to gather more experimental data and re-assess the rate expression, or to reject the rate expression.

## Design of Kinetics Experiments

The development of a rate expression for a reaction is usually preceded by some preliminary experimental work. That work establishes a range of temperature, pressure and composition that is suitable and appropriate for running the reaction. The purpose of kinetics experiments is to generate experimental data that span that range of temperature and composition with sufficient resolution to capture how temperature and the concentration or partial pressure of each reagent affect the rate. Ideally, the experiments will span a slightly broader range of temperature and compositions than those at which the reactor is expected to operate.

The nature of kinetics experiments is relatively straightforward. Selected reactor inputs are adjusted to pre-determined values and then an output from the reactor is measured. As discussed in subsequent chapters, it is preferable to conduct kinetics experiments using an isothermal reactor. This means that the temperature is adjusted to a known value for each experiment. Many different reactor inputs can affect the composition of the reacting fluid in the reactor. Those inputs include the feed composition, the feed flow rate, the space time, the input molar flow rates of individual reagents, etc. When preparing to perform kinetics experiments, a set of reactor inputs that will permit the independent adjustment of temperature and concentration of each reagent is identified and selected for use as the adjusted inputs. Some easily measurable quantity that is related to the change in the composition from input to output is similarly identified and selected as the reactor output or "response". Examples include the outlet concentration of a reagent, the conversion of a reactant, the outlet molar amount or flow rate of a reactant or product, the outlet mole fraction of a reagent, etc. In the kinetics experiments the selected inputs are systematically varied from experiment to experiment and the corresponding experimental response is measured.

Once the adjusted inputs and the response have been chosen it is necessary to plan how the reactor inputs will be varied from experiment to experiment. There are a number of ways of doing so, but it is a good idea to use blocks of experiments where all of the experiments in each block are run at the same temperature and each block uses a different temperature. The reason is that typically reaction rates are much more sensitive to temperature than to reagent concentrations or partial pressures. The Arrhenius expression indicates an exponential effect of inverse temperature upon the rate. This is much stronger than the concentration dependence found in most rate expressions. Consequently, if concentration and temperature are varied simultaneously, the strong temperature effect may mask weaker concentration effects. The use of temperature blocks allows the composition variables within a block to be varied while the temperature is held constant.

Factorial design provides a systematic way to vary the adjusted inputs. A set of levels that span the desired range is chosen for each adjusted input. The experimental design then simply includes every possible combination of those levels. Clearly, the number of levels determines the total number of experiments that are included in the design. This can result in a trade off between the resolution of the experimental data and the amount of time available for performing the experiments. A design with more levels should capture the effect of changing an adjusted input more fully, but it will require more experimental time. A design with fewer levels will reduce the experimental time required, but may not fully capture the effects of changing temperature and composition. [Example -@sec-example_7_1] illustrates factorial design of kinetics experiments.

## Analysis of Kinetics Data

*Reaction Engineering Basics* only considers kinetics data analysis for **systems where a single reaction is taking place isothermally and where only one response is measured**. This is sufficient to illustrate the process of developing a rate expression. Systems with more than one reaction taking place require multiple responses, and when done properly, the statistics of parameter estimation using multiple response data are more complicated. Readers interested in the analysis of multiple response kinetics data should consult an intermediate level reaction enginering or statistics textbook.

It was noted in @sec-modeling-ideal-reactors that when a reactor operates isothermally at a known temperature, the mole balance design equations can be solved separately from the energy and momentum balance design equations. Since all kinetics data in *Reaction Engineering Basics* is generated in isothermal reactors, **only mole balances are needed to model the reactor during kinetics data analysis**. In fact, since only one reaction is taking place, it is possible to use a single mole balance on one reactant or product. The amounts of the other reagents are related to that one reactant or product through the reaction stoichiometry. Three different ways of analyzing single response data from an isothermal reactor with only one reaction taking place are considered here.

### Using a Response Function

In this approach to kinetics data analysis, the reactor model is used to write a **response function**. The response function is just that, a computer function or subroutine. It is passed the adjusted inputs data from the experiments as an argument. It is also passed a set of values for the kinetics parameters in the rate expression. Using that information, it calculates the model-predicted responses for all of the experiments and returns them.

In this approach either the full set of mole balances or a single mole balance can be used as the reactor model. This approach can *always* be used and it does not introduce any approximations that can affect the accuracy of the results. For this reason, this is the approach used in most examples in *Reaction Engineering Basics*.

Once the response function has been written, it is passed to parameter estimation software along with the experimental adjusted inputs data and the experimental responses data. In addition, most parameter estimation software also requires that a guess for the values of the kinetics parameters be provided. A number of different computer programs can be used for parameter estimation. [Appendix -@sec-parameter-est] describes how parameter estimation software works. In essence, it finds values for the kinetics parameters that minimize the difference between the responses predicted by the model and the responses that were measured experimentally.

Typically the parameter estimation software yields (a) the best estimates for the values of the kinetics parameters, (b) some measure of the uncertainty in the parameter estimates, e. g. a 95% confidence interval, and (c) the coefficient of determination, $R^2$.

### Using an Approximate Response Function (Differential Analysis)

The mole balances for a BSTR or a steady-state PFR are initial value ODEs (IVODEs). In this approach, a single mole balance on one of the reactants or products is used. Unlike the first approach described above, here that IVODE is not solved directly. Instead, the value of the derivative is approximated, for example using finite differences (see [Appendix -@sec-pre-knowledge]). The resulting approximate mole balance is then fit to the experimental data.

There isn't any real advantage to this approach today, because it is easy to solve the IVODE form of the mole balance numerically using a computer. In the past, however, computers were not as readily available and it was often necessary to solve the mole balance analytically. Generally it is much easier to analytically solve the approximate mole balance than the IVODE mole balance. Under those circumstances, this approach did offer an advantage, but it is not as accurate as solving the IVODE form of the mole balance. Today it is sometimes used for a quick, preliminary analysis of kinetics data, but the other approaches described in this section are preferred.

### Analysis Using a Linearized Reactor Model

The third way of analyzing single response data from an isothermal reactor with one reaction occurring also uses one mole balance as the reactor model. If the mole balance is an IVODE, it must be solved analytically in order to use this approach. The model then must be rearranged so that by defining new variables it becomes a linear equation like that shown in @eq-linear_equation, where $y$ and the $x_i$ represent the new variables. The kinetics parameters *do not* appear in the defining equations for the new variables. Additionally, each slope, $m_i$, and the intercept, $b$, *must* contain a *unique* combination of the kinetics parameters in its definition. That means that if there is only one kinetics parameter, the linearized reactor model is of the form, $y=mx$, and if there are two kinetics parameters it has the form $y=mx+b$. Generally, when there are $n+1$ kinetics parameters, the form will be as shown in @eq-linear_equation.

$$
y = m_1x_1 + m_2x_2 + \cdots + m_nx_n + b
$$ {#eq-linear_equation}

The experimental adjusted inputs and the measured responses are then used to calculate the values of the new variables, $y$ and $x_1$ through $x_n$, for each experiment. @eq-linear_equation is then fit to the new variables. This approach is often used, even today, because in the situation where there are only two kinetics parameters and the linearized reactor model takes the form $y=mx+b$. In this case, a spreadsheet can be used to calculate the values of $y$ and $x$, plot the results and fit a linear equation to them. Most spreadsheet programs can be used to estimates for $m$ and $b$, uncertainties in those estimates, and the coefficient of determination, $R^2$.

If the model is accurate, in other words, if the rate expression is accurate, the value of $R^2$ will be close to 1 and the plotted points will lie close to the fitted line with no systematic trends in their deviations from the line. Uncertainties in the slope and intercept should be small compared to the values of the slope and intercept.

It is *not always possible* to analytically solve mole balances that are IVODEs or to linearize the reactor model equation. As such, this approach cannot always be used. When it can be used, it offers the advantages of using a spreadsheet to analyze the data and not requiring a guess for the values of the parameters.

## Assessment of Accuracy and Recommendations

The next step after fitting the reactor model to the data is **assessment of the accuracy of the resulting model**. This was discussed and illustrated in [Example -@sec-example_4_4]. Briefly, the estimated parameters can be used to calculate the model-predicted response for each experimental data point. A parity plot of the experimental responses *vs*. the model-predicted responses can be constructed. The difference between each experimental response and the corresponding model-predicted response, i. e. the residuals, can be calculated and plotted against each of the adjusted input variables to get a set of residuals plots. These plots, together with the results from parameter estimation are then used to assess the accuracy of the model. The following criteria suggest that the model is accurate.

* The coefficient of determination, $R^2$, is close to 1.
* The uncertainty in each parameter estimate is small compared to the estimate.
* The points in the parity plot are all close to a diagonal line ($y_{\text{expt}} = y_{\text{model}}$).
* In each residuals plot, the points scatter randomly about zero (the horizontal axis), and no systematic deviations are apparent.

The final step in kinetics data analysis involves **making a recommendation** to accept, reassess with additional data, or reject the rate expression. The intended use of the rate expression, and more importantly the potential consequences of accepting an inaccurate rate expression, can affect the criteria used in making this recommendation. That is, if accepting an inaccurate rate expression might result in severe personal injury, significant property damage or catastrophic financial loss, much more stringent criteria would likely be used than if the model was only going to be used to size a small laboratory reactor.

## Example

### Design of Kinetics Experiments {#sec-example_7_1}

{{< include ../RE_Basics_Examples/reb_7_1/problem_statement.qmd >}}

---

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

I am asked to design kinetics experiments, so I need to decide which variables will be adjusted in the experiments. I further need to decide how many levels to use for each adjusted variable and what those levels should be. The problem states that the rate expression developed using these data will be used to design a new process, so I want to be sure to generate a sizeable data set that spans the expected ranges of the adjusted variables and also captures the effects of each of them upon the response. Based upon the information presented in the problem statement, the experimental response here will be the concentration of A.

Reaction rates can be affected by the temperature and the concentration of each reagent present. Here the problem states that the rate is not affected by the concentration of Z, so the temperature and the concentration of A should vary from one experiment to the next. The reactor is isothermal, so the temperature can be adjusted directly in the experiments. The concentration of A will change as the reaction proceeds. This suggests two ways to vary the concentration of A from experiment to experiment. The first is to adjust the initial concentration of A and the second is to adjust the time at which the response is measured. Longer times will lead to smaller concentrations of A because at longer times more of the A will have reacted. I will use both the initial concentration of A and the reaction time as adjusted variables.

Next I need to decide how many levels to use for each adjusted variable and what those levels should be. Normally I would use levels that span a slightly wider range than the range where the rate expression will be used. Here, however, I'm told that the rate is too low below 65 °C and undesireable reactions occur above 90 °C, so I will choose levels that just span that range. The range only spans 25 °C, so four temperature levels seem reasonable, as does spacing them equally across the range.

I want to span a range of concentrations that is slightly wider than the expected range where the rate expression will be used. Three initial concentration levels of 0.5, 1.0, and 1.5 M will do so. Then, in order to ensure that the data are sensitive to the effect of the concentration of A, I will use six levels of reaction time. Noting that at 80 °C it takes 30 min for the reaction to go to completion, spacing the reaction times 5 minutes apart will lead to samples that span a wide range of conversions.

:::

**Experimental Design**

Three reactor inputs will be adjusted in the experiments: the temperature, $T$, the initial concentration of A, $C_{A,0}$, and the reaction time, $t$. The temperature levels will be 65, 73, 82, and 90 °C; the initial concentration levels will be 0.5, 1.0, and 1.5 M; the reaction time levels will be 5, 10, 15, 20, 25, and 30 min. All possible combinations of these levels will be studied giving a total of 72 experimental data points.

It will not be necessary to perform 72 experiments, however. Using a reactor at 65 °C with an initial concentration of A equal to 0.5 M, six responses can be recorded in the experiment. The number of experiments needed to record all 72 responses is 12. The initial conditions for those 12 experiments are shown in @tbl-example_7_1. Each experiment in the table will yield responses at all six reaction time levels.

| Experiment | T (°C) | C~A,0~ (M) |
|:------:|:-------:|:----------:|
| 1 | 65 | 0.5 |
| 2 | 65 | 1.0 |
| 3 | 65 | 1.5 |
| 4 | 73 | 0.5 |
| 5 | 73 | 1.0 |
| 6 | 73 | 1.5 |
| 7 | 82 | 0.5 |
| 8 | 82 | 1.0 |
| 9 | 82 | 1.5 |
| 10 | 90 | 0.5 |
| 11 | 90 | 1.0 |
| 12 | 90 | 1.5 |

: Initial conditions for kinetics experiments. {#tbl-example_7_1 tbl-colwidths="[30,35,35]"}

:::{.callout-note collapse="false"}
## Note

Some readers might have difficulty with this problem because it relies upon an understanding of how BSTR kinetics experiments are performed and the data they generate, and that information has not been presented yet. BSTR kinetics experiments are considered in @sec-bstr-data-analysis. The important aspects of this example are that it was first necessary to decide which reactor model input variables to adjust, and then it was necessary to decide how many levels of each variable to use and what those levels should be. After doing that, the experimental design simply involves performing an experiment at every combination of the adjusted variable levels.

:::

## Symbols Used in @sec-kin-data-gen

| Symbol | Meaning |
|:-------|:--------|
| $b$ | The intercept, a unique combination of the kinetics parameters, resulting from the linearization of the reactor model. |
| $m_i$ | A slope, some unique combination of the kinetics parameters resulting from the linearization of the reactor model. |
| $x_i$ | Some combination of the experimentally adjusted inputs and the experimental response defined so that the resulting reactor model is a linear equation. |
| $y_{\text{expt}}$ | Experimentally measured response. |
| $y$ | Some combination of the experimentally adjusted inputs and the experimental response defined so that the resulting reactor model is a linear equation. |
| $y_{\text{model}}$ | Model-predicted response. |
| $R^2$ | Coefficient of determination. |

: {tbl-colwidths="[20,80]"}