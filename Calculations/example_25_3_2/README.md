This example is based on Example 12.7.1