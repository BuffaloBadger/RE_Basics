<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix H — Ideal Reactor Models – Reaction Engineering Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./apndx_solve_ates.html" rel="next">
<link href="./apndx_transition_state_theory.html" rel="prev">
<link href="./Graphics/BuffaloBadger_16_16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="http://buffalobadger.github.io" class="navbar-brand navbar-brand-logo">
    <img src="./Graphics/Banner.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/RE_Basics"> 
<span class="menu-text">Reaction Engineering Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/SCoRE"> 
<span class="menu-text">SCoRE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/ToTaL_Engineering"> 
<span class="menu-text">ToTaL Engineering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/The_Sett"> 
<span class="menu-text">The Sett</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./apndx_useful_eqns.html">Appendices</a></li><li class="breadcrumb-item"><a href="./apndx_ideal_reactor_models.html"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_intro_and_defs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reactions, Reactors, and Reaction Engineering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_safety_and_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reaction Engineering Ethics and Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_reaction_progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measures of Reaction Progress</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rate Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_rates_and_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reaction Rates and Rate Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reaction Mechanisms and Mechanistic Rate Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_3_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formulating Reactor Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_design_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reactor Design Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_4_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Isolated Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_reaction_engineering_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Response, Optimization and Design of Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_bstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">BSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_sbstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">SBSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_non_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design of Non-Continuous Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_cstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_pfr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_5_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Ideal Reactor Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_reactor_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reactor Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_thermally_backmixed_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thermally Back-Mixed PFRs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_recycle_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recycle PFRs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_6_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kinetics Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_data_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_bstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_cstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_pfr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_7_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Non-Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Axial Dispersion Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_segregated_flow_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Segregated Flow Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_zoned_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Zoned Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_useful_eqns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Frequently Used Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_prereq_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Prerequisite Knowledge</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_nomenclature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Acronyms, Notation, Sign Conventions, and Computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_reaction_thermo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Reaction Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_heat_exchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Reactor Heat Exchange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_collision_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Collision Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_transition_state_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Transition State Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_ideal_reactor_models.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Solving Algebraic/Transcendental Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ivodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Solving Initial-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_mvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Solving Missing-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_cvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Solving Coupled-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_estimate_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Parameter Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#bstr-mole-and-energy-balances" id="toc-bstr-mole-and-energy-balances" class="nav-link active" data-scroll-target="#bstr-mole-and-energy-balances"><span class="header-section-number">H.1</span> BSTR Mole and Energy Balances</a>
  <ul class="collapse">
  <li><a href="#the-bstr-mole-balance" id="toc-the-bstr-mole-balance" class="nav-link" data-scroll-target="#the-bstr-mole-balance"><span class="header-section-number">H.1.1</span> The BSTR Mole Balance</a></li>
  <li><a href="#the-bstr-energy-balance" id="toc-the-bstr-energy-balance" class="nav-link" data-scroll-target="#the-bstr-energy-balance"><span class="header-section-number">H.1.2</span> The BSTR Energy Balance</a></li>
  </ul></li>
  <li><a href="#sbstr-mole-and-energy-balances" id="toc-sbstr-mole-and-energy-balances" class="nav-link" data-scroll-target="#sbstr-mole-and-energy-balances"><span class="header-section-number">H.2</span> SBSTR Mole and Energy Balances</a>
  <ul class="collapse">
  <li><a href="#the-sbstr-mole-balance" id="toc-the-sbstr-mole-balance" class="nav-link" data-scroll-target="#the-sbstr-mole-balance"><span class="header-section-number">H.2.1</span> The SBSTR Mole Balance</a></li>
  <li><a href="#the-sbstr-energy-balance" id="toc-the-sbstr-energy-balance" class="nav-link" data-scroll-target="#the-sbstr-energy-balance"><span class="header-section-number">H.2.2</span> The SBSTR Energy Balance</a></li>
  </ul></li>
  <li><a href="#cstr-mole-and-energy-balances" id="toc-cstr-mole-and-energy-balances" class="nav-link" data-scroll-target="#cstr-mole-and-energy-balances"><span class="header-section-number">H.3</span> CSTR Mole and Energy Balances</a>
  <ul class="collapse">
  <li><a href="#the-cstr-mole-balance" id="toc-the-cstr-mole-balance" class="nav-link" data-scroll-target="#the-cstr-mole-balance"><span class="header-section-number">H.3.1</span> The CSTR Mole Balance</a></li>
  <li><a href="#the-cstr-energy-balance" id="toc-the-cstr-energy-balance" class="nav-link" data-scroll-target="#the-cstr-energy-balance"><span class="header-section-number">H.3.2</span> The CSTR Energy Balance</a></li>
  </ul></li>
  <li><a href="#pfr-mole-and-energy-balances" id="toc-pfr-mole-and-energy-balances" class="nav-link" data-scroll-target="#pfr-mole-and-energy-balances"><span class="header-section-number">H.4</span> PFR Mole and Energy Balances</a>
  <ul class="collapse">
  <li><a href="#the-pfr-mole-balance" id="toc-the-pfr-mole-balance" class="nav-link" data-scroll-target="#the-pfr-mole-balance"><span class="header-section-number">H.4.1</span> The PFR Mole Balance</a></li>
  <li><a href="#the-pfr-energy-balance" id="toc-the-pfr-energy-balance" class="nav-link" data-scroll-target="#the-pfr-energy-balance"><span class="header-section-number">H.4.2</span> The PFR Energy Balance</a></li>
  </ul></li>
  <li><a href="#symbols-used-in-this-appendix" id="toc-symbols-used-in-this-appendix" class="nav-link" data-scroll-target="#symbols-used-in-this-appendix"><span class="header-section-number">H.5</span> Symbols Used in this Appendix</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./apndx_useful_eqns.html">Appendices</a></li><li class="breadcrumb-item"><a href="./apndx_ideal_reactor_models.html"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-apndx_ideal_reactor_models" class="quarto-section-identifier">Appendix H — Ideal Reactor Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this appendix, mole and energy balances are derived for each of the four kinds of ideal reactors considered in <em>Reaction Engineering Basics</em>.</p>
<section id="bstr-mole-and-energy-balances" class="level2" data-number="H.1">
<h2 data-number="H.1" class="anchored" data-anchor-id="bstr-mole-and-energy-balances"><span class="header-section-number">H.1</span> BSTR Mole and Energy Balances</h2>
<p>The BSTR model makes the following assumptions.</p>
<ul>
<li>The fluid within the system is perfectly mixed.</li>
<li>Mass neither enters nor leaves the system while the reactions are taking place.</li>
</ul>
<p>During the derivation of the forms of the BSTR mole and energy balances used in <em>Reaction Engineering Basics</em>, the following additional assumptions are made.</p>
<ul>
<li>Kinetic energy terms and gravitational potential energy terms are negligible.</li>
<li>Pressure variation associated with the hydrostatic head can be ignored.</li>
<li>Reaction rates are normalized per fluid volume.</li>
<li>Exchange of energy with the surroundings takes the form of heat or mechanical work associated with shafts, moving boundaries, etc.</li>
<li>The fluid mixture is ideal.
<ul>
<li>Both <span class="math inline">\(\Delta H\)</span> and <span class="math inline">\(\Delta V\)</span> of mixing are zero.</li>
</ul></li>
<li>No phase changes occur within the system while the reactions are taking place.</li>
</ul>
<section id="the-bstr-mole-balance" class="level3" data-number="H.1.1">
<h3 data-number="H.1.1" class="anchored" data-anchor-id="the-bstr-mole-balance"><span class="header-section-number">H.1.1</span> The BSTR Mole Balance</h3>
<p>The system being modeled is the volume of the fluid within the reactor at any instant in time. The derivation of the BSTR mole balance begins with a general balance equation written for the moles of any one species, <span class="math inline">\(i\)</span>, present in that system.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>In a BSTR no mass enters or leaves the reactor while the reaction is occurring, so the Input Rate and Output Rate terms are equal to zero.</p>
<p><span class="math display">\[\text{Input Rate} = \text{Output Rate} = 0\]</span></p>
<p>With the assumption that the rate of reaction is normalized per unit volume of the reacting fluid, the rate of generation of any reagent, <span class="math inline">\(i\)</span>, due to the occurrence of reaction, <span class="math inline">\(j\)</span>, is equal to <span class="math inline">\(\nu _{i,j}V r_j\)</span>. Summing the rate of generation of <span class="math inline">\(i\)</span> over all reactions taking place then gives Generation Rate term.</p>
<p><span class="math display">\[\text{Generation Rate} = V \sum_j \nu_{i,j}r_j\]</span></p>
<p>The instantaneous Accumulation Rate of <span class="math inline">\(i\)</span> is simply the derrivative on <span class="math inline">\(n_i\)</span> with respect to <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{dn_i}{dt}\]</span></p>
<p>Substituting into the general balance equation and rearranging yields the BSTR mole balance.</p>
<p><span class="math display">\[
\frac{dn_i}{dt} = V \sum_j \nu_{i,j}r_j
\]</span></p>
</section>
<section id="the-bstr-energy-balance" class="level3" data-number="H.1.2">
<h3 data-number="H.1.2" class="anchored" data-anchor-id="the-bstr-energy-balance"><span class="header-section-number">H.1.2</span> The BSTR Energy Balance</h3>
<p>The derivation of the BSTR energy balance begins with a general balance equation, written for energy at any one instant of time during the operation of the reactor.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>While no <em>mass</em> enters or leaves a BSTR while the reaction is occurring, it is possible for <em>energy</em> to enter or leave it. Here any energy that enters or leaves the system is assumed to do so either as heat or as mechanical work. The variable, <span class="math inline">\(\dot Q\)</span>, is used to represent the instantaneous net rate of heat <em>input</em> to the reactor from the surroundings. If heat actually leaves the reactor, <span class="math inline">\(\dot Q\)</span> will be negative.</p>
<p><span class="math display">\[\text{Input Rate} = \dot Q\]</span></p>
<p>The variable, <span class="math inline">\(\dot W\)</span>, is used to represent the instantaneous net rate at which the reactor performs work on the surroundings.</p>
<p><span class="math display">\[\text{Output Rate} = \dot W\]</span></p>
<p>In the absence of nuclear reactions energy cannot be generated, so the Generation Rate is equal to zero. (The heat of reaction is a result of the transformation of chemical potential energy to heat, and not energy generation.)</p>
<p><span class="math display">\[\text{Generation Rate} = 0\]</span></p>
<p>With the assumption that kinetic and potential energy terms are negligible, accumulation of energy is limited to the form of internal (chemical) energy. Letting <span class="math inline">\(\hat u_i\)</span> represent the molar specific internal energy of reagent <span class="math inline">\(i\)</span>, the instantaneous internal energy of <span class="math inline">\(i\)</span> is then <span class="math inline">\(n_i \hat u_i\)</span>. With the assumption that the fluid is an ideal mixture (no heat of mixing), the total instantaneous internal energy is simply the sum of the instantaneous internal energies of all reagents, <span class="math inline">\(\sum_i n_i \hat u_i\)</span>, and by definition, the instantaneous rate of accumulation of internal energy is the time derivative of instantaneous internal energy.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>Substitution of these terms into the general balance equation leads to a form of the BSTR energy balance that isn’t particularly useful because it is expressed in terms of specific internal energies.</p>
<p><span class="math display">\[\dot Q = \dot W + \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>This equation can be rearranged and the derivative taken inside the summation.</p>
<p><span class="math display">\[\sum_i \frac{d}{dt} \left(  n_i \hat u_i \right) = \dot Q - \dot W\]</span></p>
<p>The specific molar internal energy of each reagent can be expressed in terms of its specific molar enthalpy and volume.</p>
<p><span class="math display">\[\sum_i \frac{d}{dt} \left(  n_i \left(\hat h_i - P \hat V_i \right) \right) = \dot Q - \dot W\]</span></p>
<p>The distributive property of multiplication then can be applied.</p>
<p><span class="math display">\[\sum_i \frac{d}{dt} \left(  n_i \hat h_i - n_iP \hat V_i  \right) = \dot Q - \dot W\]</span></p>
<p>The derivative of the difference is then equal to the difference of the derivatives.</p>
<p><span class="math display">\[\sum_i \left( \frac{d}{dt} \left(  n_i \hat h_i \right) -\frac{d}{dt} \left( n_iP \hat V_i  \right) \right) = \dot Q - \dot W\]</span></p>
<p>The summation can be separated into two sums.</p>
<p><span class="math display">\[\sum_i \frac{d}{dt} \left(  n_i \hat h_i \right) - \sum_i \frac{d}{dt} \left( n_iP \hat V_i  \right)  = \dot Q - \dot W\]</span></p>
<p>The chain rule for differentiation can be applied to both the first and second terms.</p>
<p><span class="math display">\[ \sum_i n_i \frac{d\hat h_i}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - \frac{dP}{dt} \sum_i \left(  n_i \hat V_i \right) - P \sum_i \frac{d}{dt}\left(  n_i \hat V_i \right)  = \dot Q - \dot W\]</span></p>
<p>With the assumption that the fluid is an ideal mixture (no volume change upon mixing), <span class="math inline">\(\sum_i \left(  n_i \hat V_i \right) = V\)</span> in the third term.</p>
<p><span class="math display">\[ \sum_i n_i \frac{d\hat h_i}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - V\frac{dP}{dt}  - P \sum_i \frac{d}{dt}\left(  n_i \hat V_i \right)  = \dot Q - \dot W\]</span></p>
<p>In the fourth term, the sum of the derivatives can be replaced with the derivative of the sum.</p>
<p><span class="math display">\[ \sum_i n_i \frac{d\hat h_i}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - V\frac{dP}{dt}  - P  \frac{d}{dt}\sum_i\left(  n_i \hat V_i \right)  = \dot Q - \dot W\]</span></p>
<p>Then in the fourth term, as before, <span class="math inline">\(\sum_i \left(  n_i \hat V_i \right) = V\)</span>, because the mixture has been assumed to be ideal.</p>
<p><span class="math display">\[ \sum_i n_i \frac{d\hat h_i}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>With the assumption that no phase changes occur while the reaction is taking place, the change in specific enthalpy involves only sensible heat, <span class="math inline">\(d\hat h_i = \hat C_{p,i}dT\)</span>.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>The BSTR mole balance can be used to express derivative of the moles of <span class="math inline">\(i\)</span> in terms of the reaction rates.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + \sum_i \hat h_i V \sum_j \nu_{i,j}r_j - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>In the second term, the distributive property of multiplication can be applied and the volume can be factored out of the summation.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + V\sum_i  \sum_j \nu_{i,j}\hat h_i r_j - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>In the second term, the order of the summations can be switched and the rate can be factored out of the inner sum.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + V \sum_j r_j \sum_i \nu_{i,j}\hat h_i  - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>With the assumption of an ideal mixture (no heat of mixing), the inner sum in the second term is equal to the standard heat of reaction, <span class="math inline">\(\sum_i \nu_{i,j}\hat h_i = \Delta H_j\)</span>.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + V \sum_j \left(r_j \Delta H_j \right)  - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>Rearranging to put all of the derivatives on one side of the equation leads to a more useful form of the BSTR energy balance where the temperature, pressure and volume are used instead of specific internal energies.</p>
<p><span class="math display">\[
\left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W - V \sum_j \left(r_j \Delta H_j \right)
\]</span></p>
</section>
</section>
<section id="sbstr-mole-and-energy-balances" class="level2" data-number="H.2">
<h2 data-number="H.2" class="anchored" data-anchor-id="sbstr-mole-and-energy-balances"><span class="header-section-number">H.2</span> SBSTR Mole and Energy Balances</h2>
<p>In <em>Reaction Engineering Basics</em>, only one type of semi-batch reactor operation is considered. It is sometimes referred to as “fed-batch” operation. In this type of semi-batch processing, one or more reagents are added to the system while the reaction is taking place, but no reagents are removed from the reactor while it is operating. The SBSTR model makes the following assumptions.</p>
<ul>
<li>The fluid within the system is perfectly mixed.</li>
<li>One or more reagents enter the system, but no mass leaves it while the reactor is operating.</li>
</ul>
<p>During the derivation of the forms of the SBSTR mole and energy balances used in <em>Reaction Engineering Basics</em>, the following additional assumptions are made.</p>
<ul>
<li>Kinetic energy terms and gravitational potential energy terms are negligible.</li>
<li>Pressure variation associated with the hydrostatic head can be ignored.</li>
<li>Reaction rates are normalized per fluid volume.</li>
<li>Exchange of energy with the surroundings takes the form of heat or mechanical work associated with shafts, moving boundaries, etc.</li>
<li>The fluid mixture is ideal.
<ul>
<li>Both <span class="math inline">\(\Delta H\)</span> and <span class="math inline">\(\Delta V\)</span> of mixing are zero.</li>
</ul></li>
<li>No phase changes occur within the system nor upon entering it while the reactor is operating.</li>
</ul>
<section id="the-sbstr-mole-balance" class="level3" data-number="H.2.1">
<h3 data-number="H.2.1" class="anchored" data-anchor-id="the-sbstr-mole-balance"><span class="header-section-number">H.2.1</span> The SBSTR Mole Balance</h3>
<p>The system being modeled is the volume of the fluid within the reactor at any instant in time. The derivation of the SBSTR mole balance begins with a general balance equation, written for the moles of any one species at any one instant in time during the operation of the reactor.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>The mole balance for an SBSTR is very similar to the mole balance derived above for a BSTR. The Output Rate, Generation Rate and Accumulation Rate terms are the same as for a BSTR.</p>
<p><span class="math display">\[\text{Output Rate} = 0\]</span></p>
<p><span class="math display">\[\text{Generation Rate} = V \sum_j \nu_{i,j}r_j\]</span></p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{dn_i}{dt}\]</span></p>
<p>In contrast to a BSTR, the Input Rate term does not equal zero, it is equal to the molar flow of reagent <span class="math inline">\(i\)</span> into the system.</p>
<p><span class="math display">\[\text{Input Rate} = \dot n_{i,in}\]</span></p>
<p>Substitution into the general balance equation yields the SBSTR mole balance.</p>
<p><span class="math display">\[ \frac{dn_i}{dt} = \dot n_{i,in} + V \sum_j \nu_{i,j}r_j\]</span></p>
</section>
<section id="the-sbstr-energy-balance" class="level3" data-number="H.2.2">
<h3 data-number="H.2.2" class="anchored" data-anchor-id="the-sbstr-energy-balance"><span class="header-section-number">H.2.2</span> The SBSTR Energy Balance</h3>
<p>To begin, a general balance equation, written for energy at any one instant of time during the operation of the reactor is used.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>The Generation Rate, Output Rate and Accumulation Rate are the same as the BSTR.</p>
<p><span class="math display">\[\text{Generation Rate} = 0\]</span></p>
<p><span class="math display">\[\text{Output Rate} = \dot W\]</span></p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>With the assumption of negligible kinetic energy and gravitational potential energy terms, there are two input rate terms in addition to the heat entering the system, <span class="math inline">\(\dot Q\)</span>. First, the fluid must do <span class="math inline">\(PV\)</span> or flow work on the system to enter it, and second, the reagents entering the system carry their internal energy with them.</p>
<p><span class="math display">\[\text{Input Rate} = \dot Q + P\dot V_{in} + \sum_i \dot n_{i,in}\hat u_{i,in}\]</span></p>
<p>Substitution in the general balance equation yields the SBSTR energy balance, but once again it is expressed in terms of specific internal energies, which isn’t particularly useful.</p>
<p><span class="math display">\[\dot Q + P\dot V_{in} + \sum_i \dot n_{i,in}\hat u_{i,in} = \dot W + \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>With the assumption that the fluid is an ideal mixture (no <span class="math inline">\(\Delta V\)</span> of mixing), the inlet volumetric flow rate in the second term can be expressed in terms of the inlet molar flow rates and molar specific volumes, <span class="math inline">\(\dot V_{in} = \sum_i \dot n_{i,in} \hat V_{i,in}\)</span>.</p>
<p><span class="math display">\[\dot Q + P\sum_i \dot n_{i,in} \hat V_{i,in} + \sum_i \dot n_{i,in}\hat u_{i,in} = \dot W + \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>The second and third terms then can be combined.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \left(  \hat u_{i,in} + P\hat V_{i,in} \right) = \dot W + \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>The molar specific energies can be expressed in terms of the molar specific enthalpies and volumes, <span class="math inline">\(\hat u_{i,in} + P\hat V_{i,in} = \hat h_{i,in}\)</span> and <span class="math inline">\(\hat u_i = \hat h_i - P\hat V_i\)</span>.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}\left(  \sum_i n_i \left( \hat h_i - P\hat V_i \right) \right)\]</span></p>
<p>The distributive property of multiplication can be applied to the final term.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}  \sum_i \left( n_i  \hat h_i - Pn_i\hat V_i  \right)\]</span></p>
<p>The final term can then be split into two summations.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}  \sum_i \left( n_i  \hat h_i \right) - \frac{d}{dt}  \sum_i \left(Pn_i\hat V_i  \right)\]</span></p>
<p>The pressure can be factored out of the final sum.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}  \sum_i \left( n_i  \hat h_i \right) - \frac{d}{dt} \left( P\sum_i \left(n_i\hat V_i \right) \right)\]</span></p>
<p>With the assumption that the fluid mixture is ideal, <span class="math inline">\(\sum_i \left(n_i\hat V_i \right) = V\)</span>.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}  \sum_i \left( n_i  \hat h_i \right) - \frac{d}{dt} \left( PV\right)\]</span></p>
<p>The derivative in the fourth term can be moved inside the summation and chain rule for differentiation then can be applied to it and the final term.</p>
<p><span class="math display">\[
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W +  \sum_i \left( n_i \frac{d \hat h_i}{dt} + \hat h_i \frac{dn_i}{dt} \right) -V\frac{dP}{dt} - P\frac{dV}{dt}
\]</span></p>
<p>The summation in the fourth term can be written as two terms.</p>
<p><span class="math display">\[
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W +  \sum_i \left( n_i \frac{d \hat h_i}{dt}\right) + \sum_i \left( \hat h_i \frac{dn_i}{dt} \right) -V\frac{dP}{dt} - P\frac{dV}{dt}
\]</span></p>
<p>With the assumption that no phase changes occur, the change in specific enthalpy in the fourth term involves only sensible heat, <span class="math inline">\(d\hat h_i = \hat C_{p,i}dT\)</span>.</p>
<p><span class="math display">\[
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \left(\sum_i  \hat h_i \frac{dn_i}{dt} \right) -V\frac{dP}{dt} - P\frac{dV}{dt}
\]</span></p>
<p>The time derivative of <span class="math inline">\(n_i\)</span> can be replaced using the STSTR mole balance.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \left(\sum_i  \hat h_i \left(\dot n_{i,in} + V \sum_j \nu_{i,j}r_j \right)\right) \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>The distributive property of multiplication can be applied to the fifth term after which it can be written as two terms.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \sum_i   \dot n_{i,in}\hat h_i + \sum_i   \left(V\hat h_i \sum_j \nu_{i,j}r_j \right) \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>The order of the sums in the sixth term can be switched.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \sum_i   \dot n_{i,in}\hat h_i + V\sum_j  \sum_i \hat h_i\nu_{i,j}r_j  \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>The rate can be factored out of the inner sum in the sixth term.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \sum_i   \dot n_{i,in}\hat h_i + V\sum_j r_j \sum_i \hat h_i\nu_{i,j}  \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>With the assumption that the fluid is an ideal mixture (no <span class="math inline">\(\Delta H\)</span> of mixing), the inner sum in the sixth term is equal to the standard heat of reaction, <span class="math inline">\(\sum_i \hat h_i\nu_{i,j} = \Delta H_j\)</span>.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \sum_i   \dot n_{i,in}\hat h_i + V\sum_j r_j \Delta H_j  \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>The derivatives can all be moved to one side of the equation.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} - V\frac{dP}{dt} - P\frac{dV}{dt} &amp;= \dot Q - \dot W + \sum_i \dot n_{i,in} \hat h_{i,in} - \sum_i   \dot n_{i,in}\hat h_i \\&amp;- V\sum_j r_j \Delta H_j
\end{split}
\]</span></p>
<p>The third and fourth terms following the equals sign can be combined and the molar flow rate of <span class="math inline">\(i\)</span> factored out.</p>
<p><span class="math display">\[
\sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} -V\frac{dP}{dt} - P\frac{dV}{dt} = \dot Q - \dot W + \sum_i \dot n_{i,in} \left(\hat h_{i,in} - \hat h_i \right)- V\sum_j r_j \Delta H_j
\]</span></p>
<p>With the assumption that no phase change occurs upon entering the system, the enthalpy difference in the third term following the equals sign involves only sensible heat and can be expressed in terms of the molar heat capacities. Doing so results in the desired form of the SBSTR energy balance, expressed in terms of temperature, pressure and volume instead of specific internal energies or enthalpies.</p>
<p><span class="math display">\[
\sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} -V\frac{dP}{dt} - P\frac{dV}{dt} = \dot Q - \dot W - \sum_i \dot n_{i,in} \int_{T_{in}}^T \hat C_{p,i}dT  - V\sum_j r_j \Delta H_j
\]</span></p>
</section>
</section>
<section id="cstr-mole-and-energy-balances" class="level2" data-number="H.3">
<h2 data-number="H.3" class="anchored" data-anchor-id="cstr-mole-and-energy-balances"><span class="header-section-number">H.3</span> CSTR Mole and Energy Balances</h2>
<p>CSTRs are another variant on a perfectly-mixed reactor. They differ from BSTRs and SBSTRs in that fluid flows into <strong>and</strong> out of CSTRs. The CSTR model makes the following assumptions.</p>
<ul>
<li>The fluid within the system is perfectly mixed.</li>
<li>Reagents continuously flow into and out of the system as it operates.</li>
</ul>
<p>During the derivation of the forms of the CSTR mole and energy balances used in <em>Reaction Engineering Basics</em>, the following additional assumptions are made.</p>
<ul>
<li>Kinetic energy terms and gravitational potential energy terms are negligible.</li>
<li>Pressure variation associated with the hydrostatic head can be ignored.</li>
<li>Reaction rates are normalized per fluid volume.</li>
<li>Exchange of energy with the surroundings takes the form of heat or mechanical work associated with shafts, moving boundaries, etc.</li>
<li>The fluid mixture is ideal.
<ul>
<li>Both <span class="math inline">\(\Delta H\)</span> and <span class="math inline">\(\Delta V\)</span> of mixing are zero.</li>
</ul></li>
<li>No phase changes occur within the system while the reactions are taking place nor upon entering the system.</li>
</ul>
<section id="the-cstr-mole-balance" class="level3" data-number="H.3.1">
<h3 data-number="H.3.1" class="anchored" data-anchor-id="the-cstr-mole-balance"><span class="header-section-number">H.3.1</span> The CSTR Mole Balance</h3>
<p>The system being modeled is the volume of the fluid within the reactor at any instant in time. The derivation of the CSTR mole balance begins with a general balance equation written for the moles of any one species, <span class="math inline">\(i\)</span>, present in that system.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>The Input Rate and Output Rate terms are straightforward.</p>
<p><span class="math display">\[\text{Input Rate} = \dot n_{i,in}\]</span></p>
<p><span class="math display">\[\text{Output Rate} = \dot n_i\]</span></p>
<p>The Generation Rate is the same as the BSTR and SBSTR.</p>
<p><span class="math display">\[\text{Generation Rate} = V \sum_j \nu_{i,j}r_j\]</span></p>
<p>The Accumulation Rate term is also the same as the BSTR and SBSTR, but the equation will be easier to work with if the accumulation is expressed in terms of the molar flow rate of <span class="math inline">\(i\)</span>, <span class="math inline">\(\dot n_i\)</span>, instead of the number of moles of <span class="math inline">\(i\)</span>, <span class="math inline">\(n_i\)</span>. This can be accomplished by noting that the number of moles is equal to the product of the volume and the concentration, <span class="math inline">\(n_i = C_iV\)</span>. With the assumption that the reactor is perfectly mixed, the concentration within the reactor is equal to the concentration leaving the reactor, <span class="math inline">\(C_i = \frac{\dot n_i}{\dot V}\)</span>.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{dn_i}{dt} = \frac{d}{dt}\left( \frac{\dot n_iV}{\dot V}  \right)\]</span></p>
<p>Substitution into the general balance equation yields the CSTR mole balance equation.</p>
<p><span class="math display">\[\dot n_{i,in} + V \sum_j \nu_{i,j}r_j = \dot n_i + \frac{d}{dt}\left( \frac{\dot n_iV}{\dot V}  \right)\]</span></p>
<p>This equation can be rearranged to put the derivative on one side of the equation and the remaining terms on the other.</p>
<p><span class="math display">\[\frac{d}{dt}\left( \frac{\dot n_iV}{\dot V}  \right) = \dot n_{i,in} - \dot n_i + V \sum_j \nu_{i,j}r_j\]</span></p>
<p>Applying the chain rule for differentiation then yields the desired form of the CSTR mole balance equation.</p>
<p><span class="math display">\[\frac{V}{\dot V}\frac{d \dot n_i}{dt} + \frac{\dot n_i}{\dot V}\frac{dV}{dt} - \frac{\dot n_iV}{\dot V^2}\frac{d \dot V}{dt} = \dot n_{i,in} - \dot n_i + V \sum_j \nu_{i,j}r_j\]</span></p>
</section>
<section id="the-cstr-energy-balance" class="level3" data-number="H.3.2">
<h3 data-number="H.3.2" class="anchored" data-anchor-id="the-cstr-energy-balance"><span class="header-section-number">H.3.2</span> The CSTR Energy Balance</h3>
<p>The CSTR energy balance begins with a general balance equation written for energy at any one instant of time during the operation of the reactor.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>The Input Rate and Generation Rate are the same as the SBSTR.</p>
<p><span class="math display">\[\text{Input Rate} = \dot Q + P\dot V_{in} + \sum_i \dot n_{i,in}\hat u_{i,in}\]</span></p>
<p><span class="math display">\[\text{Generation Rate} = 0\]</span></p>
<p>The Output Rate includes the shaft work term that appears in the BSTR and SBSTR and adds flow work and internal energy of the fluid leaving the reactor that are analogous to the input terms.</p>
<p><span class="math display">\[\text{Output Rate} = \dot W + P\dot V + \sum_i \dot n_i\hat u_i\]</span></p>
<p>The Accumulation Rate term is the same as a BSTR or SBSTR, but as it was in the CSTR mole balance, it is convient to express it in terms of the molar flow rate, <span class="math inline">\(\dot n_i\)</span>, instead of the moles, <span class="math inline">\(n_i\)</span>. This is accomplished in the same way as in the CSTR mole balance.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right) = \frac{d}{dt}\left(  \sum_i \frac{\dot n_i \hat u_iV}{\dot V} \right)\]</span></p>
<p>Substituting into the general balance equation yields a form of the CSTR energy balance expressed in terms of specific internal energies.</p>
<p><span class="math display">\[\dot Q + P\dot V_{in} + \sum_i \dot n_{i,in}\hat u_{i,in} = \dot W + P\dot V + \sum_i \dot n_i\hat u_i + \frac{d}{dt}\left(  \sum_i \frac{\dot n_i \hat u_iV}{\dot V} \right)\]</span></p>
<p>With the assumption that the fluid is an ideal mixture, no <span class="math inline">\(\Delta V\)</span> of mixing, the volumetric flow rates in the second and fifth terms are equal to the sums of the molar flow rates times the molar specific volumes.</p>
<p><span class="math display">\[
\begin{split}\dot Q + P\sum_i\left(  \dot n_{i,in}\hat V_{i,in} \right) + \sum_i \dot n_{i,in}\hat u_{i,in} &amp;= \dot W + P\sum_i\left(  \dot n_i\hat V_i \right) + \sum_i \dot n_i\hat u_i \\&amp;+ \frac{d}{dt}\left(  \sum_i \frac{\dot n_i \hat u_iV}{\dot V} \right)
\end{split}
\]</span></p>
<p>The second and third summations and the fifth and sixth summations can each be combined.</p>
<p><span class="math display">\[\dot Q + \sum_i\left(\dot n_{i,in}\left( P \hat V_{i,in} + \hat u_{i,in} \right)\right) = \dot W + \sum_i\left(  \dot n_i\left(P\hat V_i  + \hat u_i \right) \right) + \frac{d}{dt}\left(  \sum_i \frac{\dot n_i \hat u_iV}{\dot V} \right)\]</span></p>
<p>The specific energy can be expressed in terms of the specific enthalpy and specific volume, <span class="math inline">\(\hat u_{i,in} + P\hat V_{i,in} = \hat h_{i,in}\)</span> and <span class="math inline">\(\hat u_i + P\hat V_i = \hat h_i\)</span>.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i \dot n_i \hat h_i   + \frac{d}{dt}\left(  \sum_i \frac{\dot n_i \hat u_iV}{\dot V} \right)\]</span></p>
<p>Similarly, the specific internal energy in the last term can be expressed in terms of the specific enthalpy and volume.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_i \hat h_i   + \frac{d}{dt}\left(  \sum_i \left( \hat h_i - P\hat V_i  \right)\frac{\dot n_i V}{\dot V} \right)\]</span></p>
<p>The distributive property of multiplication can be applied to the last term.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_i \hat h_i + \frac{d}{dt}  \sum_i \left( \frac{\dot n_i\hat h_i V}{\dot V} - \frac{\dot n_i VP\hat V_i}{\dot V}  \right)\]</span></p>
<p>The last term can be split into two terms.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_i \hat h_i + \frac{d}{dt}  \sum_i \left( \frac{\dot n_i\hat h_i V}{\dot V}  \right) - \frac{d}{dt}  \sum_i \left( \frac{\dot n_i VP\hat V_i}{\dot V}  \right)\]</span></p>
<p>Then <span class="math inline">\(\frac{PV}{\dot V}\)</span> can be factored out of the final summation.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_i \hat h_i + \frac{d}{dt}  \sum_i \left( \frac{\dot n_i\hat h_i V}{\dot V}  \right) - \frac{d}{dt} \left(\frac{PV}{\dot V} \sum_i \left(\dot n_i \hat V_i \right)\right)\]</span></p>
<p>With the assumption that the mixture is ideal <span class="math inline">\(\left(\sum_i \left(\dot n_i \hat V_i \right) = \dot V\right)\)</span>, the final term can be simplified.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_i \hat h_i   + \frac{d}{dt}  \sum_i \left( \frac{\dot n_i\hat h_i V}{\dot V}  \right) - \frac{d}{dt} \left( PV\right)\]</span></p>
<p>The chain rule can be applied to the fifth term.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i \dot n_i \hat h_i \\&amp;+ \sum_i \hat h_i\frac{d}{dt}\left( \frac{\dot n_i V}{\dot V}  \right) +   \sum_i \left( \frac{\dot n_i V}{\dot V}  \right)\frac{d\hat h_i}{dt} - \frac{d}{dt} \left( PV\right)
\end{split}
\]</span></p>
<p>With the assumption of no phase changes, changes in enthalpy only involve sensible heat and the time-derivative of the specific enthalpy can be expressed in terms of the heat capacity and the temperature.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_i \hat h_i \\&amp;+ \sum_i \hat h_i\left[\frac{d}{dt}\left( \frac{\dot n_i V}{\dot V}  \right)\right] +   \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right)
\end{split}
\]</span></p>
<p>The term containing square brackets can be moved to the end of the equation.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_i \hat h_i +   \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ \sum_i \hat h_i\left[\frac{d}{dt}\left( \frac{\dot n_i V}{\dot V}  \right)\right]
\end{split}
\]</span></p>
<p>The chain rule can be applied to the term containing square brackets.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_i \hat h_i +   \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ \sum_i \hat h_i\left[\frac{V}{\dot V}\frac{d \dot n_i}{dt} + \frac{\dot n_i}{\dot V}\frac{dV}{dt} - \frac{\dot n_iV}{\dot V^2}\frac{d \dot V}{dt}\right]
\end{split}
\]</span></p>
<p>The term in the square brackets is equal to one side of the CSTR mole balance. The other side of the CSTR mole balance can be substituted in its place.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_i \hat h_i +   \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ \sum_i \hat h_i\left[\dot n_{i,in} - \dot n_i + V \sum_j \nu_{i,j}r_j\right]
\end{split}
\]</span></p>
<p>The distributive property of multiplication can be applied to the term with the square brackets.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_i \hat h_i +   \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ \sum_i \hat h_i\dot n_{i,in} - \sum_i \hat h_i\dot n_i + V\sum_i \hat h_i \sum_j \nu_{i,j}r_j
\end{split}
\]</span></p>
<p>The first term on the second line can be moved to the other side of the equation, and two other terms cancel out.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} - \sum_i \hat h_i\dot n_{i,in} &amp;= \dot W + \cancel{\sum_i  \dot n_i \hat h_i} +   \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} \\&amp;- \frac{d}{dt} \left( PV\right)   - \cancel{\sum_i \hat h_i\dot n_i} + \sum_i \hat h_iV \sum_j \nu_{i,j}r_j
\end{split}
\]</span></p>
<p>The second and third terms can be combined.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \left( \hat h_{i,in} - \hat h_i \right) &amp;= \dot W + \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ V\sum_i \hat h_i \sum_j \nu_{i,j}r_j
\end{split}
\]</span></p>
<p>The distributive property of multiplication can be applied to the last term.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \left( \hat h_{i,in} - \hat h_i \right) &amp;= \dot W + \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ V\sum_i  \sum_j \hat h_i\nu_{i,j}r_j
\end{split}
\]</span></p>
<p>The order of the sums in the last term can be switched and <span class="math inline">\(r_j\)</span> can be factored out of the inner summation.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \left( \hat h_{i,in} - \hat h_i \right) &amp;= \dot W + \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ V\sum_j r_j \sum_i \hat h_i\nu_{i,j}
\end{split}
\]</span></p>
<p>With the assumption of no phase changes, the specific enthalpy difference in the second term can be expressed in terms of the heat capacity and temperature, and with the assumption that the fluid is an ideal mixture (no <span class="math inline">\(\Delta H\)</span> of mixing), the final summation is simply equal to the heat of reaction <span class="math inline">\(j\)</span>.</p>
<p><span class="math display">\[\dot Q - \sum_i\dot n_{i,in} \int_{T_{in}}^T \hat C_{p,i}dT = \dot W + \sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) + V\sum_j r_j \Delta H_j\]</span></p>
<p>The derivatives can be moved to one side of the equation.</p>
<p><span class="math display">\[\sum_i \left( \frac{\dot n_i \hat C_{p,i} V}{\dot V}  \right)\frac{dT}{dt} - \frac{d}{dt} \left( PV\right) = \dot Q - \dot W - \sum_i\dot n_{i,in} \int_{T_{in}}^T \hat C_{p,i}dT - V\sum_j r_j \Delta H_j\]</span></p>
<p>Finally, <span class="math inline">\(V\)</span> and <span class="math inline">\(\dot V\)</span> can be factored out of the first term and the chain rule can be applied to the second term, yielding the desired form of the CSTR energy balance.</p>
<p><span class="math display">\[
\begin{split}
\frac{V}{\dot V}\sum_i \left( \dot n_i \hat C_{p,i}  \right)\frac{dT}{dt} - P\frac{dV}{dt} - V \frac{dP}{dt} &amp;= \dot Q - \dot W - \sum_i\dot n_{i,in} \int_{T_{in}}^T \hat C_{p,i}dT \\&amp;- V\sum_j r_j \Delta H_j
\end{split}
\]</span></p>
</section>
</section>
<section id="pfr-mole-and-energy-balances" class="level2" data-number="H.4">
<h2 data-number="H.4" class="anchored" data-anchor-id="pfr-mole-and-energy-balances"><span class="header-section-number">H.4</span> PFR Mole and Energy Balances</h2>
<p>The PFR model makes the following assumptions.</p>
<ul>
<li>The reactor is a cylinder with fluid continuously flowing in one end and out the other.</li>
<li>The fluid velocity does not vary across the diameter of the reactor; i. e. there is plug flow.
<ul>
<li>Heat and mass are perfectly mixed across the radius.</li>
<li>Heat and mass do not mix at all along the axis.</li>
</ul></li>
<li>If there is a packed bed of catalyst particles within the reactor it is assumed that
<ul>
<li>there are no concentration gradients and no temperature gradients within the fluid near the external surfaces of the catalyst particles,</li>
<li>there are no concentration gradients and no temperature gradients within the fluid that is in the pores inside the catalyst particles, and consequently,</li>
<li>the reactor volume can be treated as a single phase (the so-called pseudo homogeneous model) by properly re-normalizing the rate of reaction.</li>
</ul></li>
</ul>
<p>During the derivation of the forms of the PFR mole and energy balances used in <em>Reaction Engineering Basics</em>, the following additional assumptions are made.</p>
<ul>
<li>The reactor diameter is constant.</li>
<li>Kinetic energy terms and gravitational potential energy terms are negligible.</li>
<li>Reaction rates are normalized per fluid volume.</li>
<li>Exchange of energy with the surroundings takes the form of heat that is transferred through the wall of the reactor.</li>
<li>Mechanical work is not performed on or by the system.</li>
<li>The fluid mixture is ideal.
<ul>
<li>Both <span class="math inline">\(\Delta H\)</span> and <span class="math inline">\(\Delta V\)</span> of mixing are zero.</li>
</ul></li>
<li>No phase changes occur within or upon entering the system.</li>
</ul>
<p>Unlike the perfectly mixed stirred tank reactors, the composition in an ideal PFR is not uniform; it changes along the length of the reactor. As a consequence, it becomes necessary to write the mole and energy balance equations on a differential element of reactor volume and then take the limit as the size of this element goes to zero. With the assumption of perfect mixing in the radial direction, in the limit where its thickness goes to zero, the volume element is perfectly mixed. Here, we will assume that the reactor is cylindrical with a constant diameter, D, and a length, L, as shown in <a href="#fig-pfr-vol-element" class="quarto-xref">Figure&nbsp;<span>H.1</span></a> which additionally shows a differentially thick cross section that will be used in formulating the mole and energy balances.</p>
<div id="fig-pfr-vol-element" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pfr-vol-element-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Graphics/pfr_differential_element.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pfr-vol-element-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;H.1: Differential PFR Element
</figcaption>
</figure>
</div>
<section id="the-pfr-mole-balance" class="level3" data-number="H.4.1">
<h3 data-number="H.4.1" class="anchored" data-anchor-id="the-pfr-mole-balance"><span class="header-section-number">H.4.1</span> The PFR Mole Balance</h3>
<p>The system being modeled is the fluid within the differential volume element of axial thickness, <span class="math inline">\(dz\)</span>, and diameter, <span class="math inline">\(D\)</span>, at any instant in time. The derivation begins with a general balance equation written for the moles of any one species, <span class="math inline">\(i\)</span>, present in the system.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>As with the CSTR, the Input Rate and Output Rate terms are simply equal to the molar flow rates at <span class="math inline">\(z\)</span> and <span class="math inline">\(z + dz\)</span>, respectively.</p>
<p><span class="math display">\[\text{Input Rate} = \dot n_i \biggr\rvert_z\]</span></p>
<p><span class="math display">\[\text{Output Rate} = \dot n_i \biggr\rvert_{z+dz}\]</span></p>
<p>With the assumption that the rates are normalized per fluid volume, the rate of generation of species <span class="math inline">\(i\)</span> via reaction <span class="math inline">\(j\)</span> is the volume of the fluid element, <span class="math inline">\(\frac{\pi D^2}{4}dz\)</span>, times the rate of generation of <span class="math inline">\(i\)</span> per fluid volume, <span class="math inline">\(\nu_{i,j}r_j\)</span>. The Generation Rate term then is the sum over all reactions.</p>
<p><span class="math display">\[\text{Generation Rate} = \frac{\pi D^2}{4}dz \sum_j \nu_{i,j}r_j\]</span></p>
<p>The Accumulation Rate is the instantaneous time-derivative of the number of moles in the differential element. The number of moles equals the volume of the differential element times the concentration of the species. In a flow system, the concentration is the ratio of the molar flow rate to the volumetric flow rate.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{\partial n_i}{\partial t} = \frac{\pi D^2}{4}dz \frac{\partial}{\partial t}\left( \frac{\dot n_i \big\rvert_z}{\dot V} \right)\]</span></p>
<p>Substitution into the general balance equation yields a mole balance expressed in terms of the differential thickness of the fluid element.</p>
<p><span class="math display">\[\dot n_i \biggr\rvert_z + \frac{\pi D^2}{4}dz \sum_j \nu_{i,j}r_j = \dot n_i \biggr\rvert_{z+dz} + \frac{\pi D^2}{4}dz \frac{\partial}{\partial t}\left( \frac{\dot n_i \big\rvert_z}{\dot V} \right)\]</span></p>
<p>That equation can be rearranged and divided by <span class="math inline">\(dz\)</span>.</p>
<p><span class="math display">\[\frac{\dot n_i \biggr\rvert_{z+dz} - \dot n_i \biggr\rvert_z}{dz}=\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j - \frac{\pi D^2}{4} \frac{\partial}{\partial t}\left( \frac{\dot n_i \big\rvert_z}{\dot V} \right)\]</span></p>
<p>Taking the limit as <span class="math inline">\(dz\)</span> approaches zero yields the mole balance in the form of a partial differential equation.</p>
<p><span class="math display">\[\frac{\partial \dot n_i}{\partial z}=\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j - \frac{\pi D^2}{4} \frac{\partial}{\partial t}\left( \frac{\dot n_i \big\rvert_z}{\dot V} \right)\]</span></p>
<p>Applying the chain rule and moving all of the derivatives to one side of the equation leads to the desired form of the PFR mole balance.</p>
<p><span class="math display">\[\frac{\partial \dot n_i}{\partial z} + \frac{\pi D^2}{4\dot V} \frac{\partial\dot n_i}{\partial t} - \frac{\pi D^2\dot n_i}{4\dot V^2} \frac{\partial \dot V}{\partial t}  =\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j \]</span></p>
</section>
<section id="the-pfr-energy-balance" class="level3" data-number="H.4.2">
<h3 data-number="H.4.2" class="anchored" data-anchor-id="the-pfr-energy-balance"><span class="header-section-number">H.4.2</span> The PFR Energy Balance</h3>
<p>The PFR energy balance begins with a general balance on the same fluid element, <a href="#fig-pfr-vol-element" class="quarto-xref">Figure&nbsp;<span>H.1</span></a>, as was used for the PFR mole balance only written for energy at any one instant of time during the operation of the reactor.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>As was the case for the SBSTR and CSTR, the Input Rate term includes internal energy carried into the volume by the fluid, flow work done by the fluid on the volume element and heat transfer through the wall of the differential element. It is assumed that the heat transfer coefficient, <span class="math inline">\(U\)</span>, is constant.</p>
<p><span class="math display">\[\text{Input Rate} = \sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_z + \left(  P\dot V \right)\biggr\rvert_z + \pi D U\left( T_e - T  \right)dz\]</span></p>
<p>The Output Rate term is also like that for the CSTR except that there is no shaft work for a PFR.</p>
<p><span class="math display">\[\text{Output Rate} = \sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_{z+dz} + \left(  P\dot V \right)\biggr\rvert_{z+dz}\]</span></p>
<p>As with all of the reactors, the Generation Rate is zero.</p>
<p><span class="math display">\[\text{Generation Rate} = 0\]</span></p>
<p>The Rate of Accumulation term is like that for the CSTR except that the volume is the volume of the differential element. Also, because there are quantities that vary with both axial position and time, the derivative is a partial derivative.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right)\]</span></p>
<p>The Input Rate, Generation Rate, Output Rate and Accumulation Rate terms can be substituted into the general balance equation.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_z + \left(  P\dot V \right)\biggr\rvert_z + \pi D U\left( T_e - T  \right)dz &amp;= \sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_{z+dz} + \left(  P\dot V \right)\biggr\rvert_{z+dz} \\&amp;+ \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right)
\end{split}
\]</span></p>
<p>With the assumption that the fluid is an ideal mixture with no <span class="math inline">\(\Delta V\)</span> of mixing, the volumetric flow rates can be related to the molar flow rates and the molar specific volumes, <span class="math inline">\(\dot V = \sum_i \dot n_i \hat V_i\)</span>.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_z + \left(  P \sum_i \dot n_i \hat V_i \right)\biggr\rvert_z &amp;+ \pi D U\left( T_e - T  \right)dz = \sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_{z+dz} \\&amp;+ \left(  P \sum_i \dot n_i \hat V_i \right)\biggr\rvert_{z+dz} + \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right)
\end{split}
\]</span></p>
<p>The first two terms can be combined and <span class="math inline">\(\dot n_i\)</span> can be factored out, and the same can be done with the first two terms following the equals sign.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left(\dot n_i \left(  \hat u_i + P \hat V_i\right) \right) \biggr\rvert_z + \pi D U\left( T_e - T  \right)dz &amp;= \sum_i \left(\dot n_i \left(  \hat u_i + P \hat V_i\right) \right) \biggr\rvert_{z+dz} \\&amp;+ \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right)
\end{split}
\]</span></p>
<p>The specific internal energy can be expressed in terms of the specfic volume and the specific enthalpy (<span class="math inline">\(\hat u_i + P \hat V_i = \hat h_i\)</span>).</p>
<p><span class="math display">\[\sum_i \left(\dot n_i \hat h_i \right) \biggr\rvert_z + \pi D U\left( T_e - T  \right)dz = \sum_i \left(\dot n_i\hat h_i  \right) \biggr\rvert_{z+dz} + \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right) \]</span></p>
<p>The equation can be rearranged and divided by <span class="math inline">\(dz\)</span>.</p>
<p><span class="math display">\[\sum_i \frac{\left(\dot n_i\hat h_i  \right) \biggr\rvert_{z+dz}-\left(\dot n_i\hat h_i  \right) \biggr\rvert_z}{dz} = \pi D U\left( T_e - T  \right) - \frac{\pi D^2}{4} \sum_i \frac{\partial}{\partial t} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)\]</span></p>
<p>In the limit where <span class="math inline">\(dz\)</span> goes to zero, the left side of the equation becomes a partial derivative.</p>
<p><span class="math display">\[\sum_i \frac{\partial}{\partial z} \left(  \dot n_i\hat h_i \right) = \pi D U\left( T_e - T  \right) - \frac{\pi D^2}{4} \sum_i \frac{\partial}{\partial t} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right) \]</span></p>
<p>The chain rule can be applied to both derivatives and they can be split into separate summations.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} + \sum_i \hat h_i \frac{\partial \dot n_i}{\partial z}  &amp;= \pi D U\left( T_e - T  \right) - \frac{\pi D^2}{4\dot V} \sum_i  \hat u_i \frac{\partial\dot n_i }{\partial t} + \frac{\pi D^2}{4\dot V^2} \sum_i \dot n_i\hat u_i \frac{\partial \dot V}{\partial t} \\&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat u_i}{\partial t}
\end{split}
\]</span></p>
<p>As before, the specific internal energy can be expressed in terms of the specific enthalpy.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} + \sum_i \hat h_i \frac{\partial \dot n_i}{\partial z}  &amp;= \pi D U\left( T_e - T  \right) \\&amp;- \frac{\pi D^2}{4\dot V} \sum_i  \hat h_i \frac{\partial\dot n_i }{\partial t} + \frac{\pi D^2}{4\dot V}\sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\&amp;+ \frac{\pi D^2}{4\dot V^2} \sum_i \dot n_i\hat h_i \frac{\partial \dot V}{\partial t} - \frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t} \\&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t} + \frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)
\end{split}
\]</span></p>
<p>All terms including <span class="math inline">\(\hat h_i\)</span> can be gathered.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \hat h_i \frac{\partial \dot n_i}{\partial z} + \frac{\pi D^2}{4\dot V} \sum_i  \hat h_i \frac{\partial\dot n_i }{\partial t} - \frac{\pi D^2}{4\dot V^2} \sum_i \dot n_i\hat h_i \frac{\partial \dot V}{\partial t} &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right) \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The specific enthalpy can be factored out of those terms.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left(\hat h_i \left[   \frac{\partial \dot n_i}{\partial z} + \frac{\pi D^2}{4\dot V} \frac{\partial\dot n_i }{\partial t} - \frac{\pi D^2}{4\dot V^2} \dot n_i \frac{\partial \dot V}{\partial t} \right] \right) &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The term in square brackets is equal to the left side of the PFR mole balance equation. It can be replaced with the right side of the PFR mole balance equation.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left(\hat h_i \left[\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j \right] \right) &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The distributive property of multiplication can be applied to the first term and the constant area term can be factored out.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_i \sum_j \hat h_i\nu_{i,j}r_j  &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+ \frac{\pi D^2}{4\dot V}\sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The order of the summations in the first term can be switched and the rate can be factored out of the inner summation.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j\left( r_j\sum_i \hat h_i\nu_{i,j}\right)  &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+ \frac{\pi D^2}{4\dot V}\sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>With the assumption that the fluid is an ideal mixture with no <span class="math inline">\(\Delta H\)</span> of mixing, the second sum within the first term is simply the heat of reaction <span class="math inline">\(j\)</span>.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>With the assumption of no phase changes, the derivative of the specific enthalpy involves only sensible heat and can be expressed in terms of the heat capacity and temperature.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The chain rule can be applied to the term on the fourth line.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_iP \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i\hat V_i \frac{\partial P}{\partial t}\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>Common quantities can be factored out of each of the sums on the second through fifth lines.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V^2} \frac{\partial \dot V}{\partial t}\sum_i \dot n_i\hat V_i \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \frac{\partial P}{\partial t}\sum_i \dot n_i\hat V_i \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>As above, with the assumption that the fluid is an ideal mixture, <span class="math inline">\(\sum_i \dot n_i \hat V_i = \dot V\)</span>.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V^2} \frac{\partial \dot V}{\partial t}\dot V \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \frac{\partial P}{\partial t} \dot V \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The volumetric flow rate appears in both the numerator and denominator of the terms on the third and fifth lines and can be canceled.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V} \frac{\partial \dot V}{\partial t} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>With the assumption that the fluids is an ideal mxiture, the derivative of the volumetric flow rate in the term on the third line can be expressed in terms of the molar flow rates and specific volumes.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V} \frac{\partial}{\partial t}\left(\sum_i \dot n_i \hat V_i \right) \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The chain rule can be applied to the term on the third line.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V} \sum_i\dot n_i\frac{\partial \hat V_i}{\partial t} -\frac{\pi D^2P}{4\dot V} \sum_i\hat V_i\frac{\partial \dot n_i}{\partial t}\\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The four terms on the second, third and fourth lines cancel.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>With the assumption of no phase change, the derivative of the specific enthalpy can be expressed in terms of the heat capacity and temperature.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \left(\dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial t}
\end{split}
\]</span></p>
<p>Finally, moving all of the derivatives to one side of the equation yields the desired form of the PFR energy balance.</p>
<p><span class="math display">\[
\begin{split}
\left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} +\frac{\pi D^2}{4\dot V} \sum_i \left(\dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial t} - \frac{\pi D^2}{4} \frac{\partial P}{\partial t} &amp;= \pi D U\left( T_e - T  \right) \\
&amp;- \frac{\pi D^2}{4}\sum_j r_j \Delta H_j
\end{split}
\]</span></p>
</section>
</section>
<section id="symbols-used-in-this-appendix" class="level2" data-number="H.5">
<h2 data-number="H.5" class="anchored" data-anchor-id="symbols-used-in-this-appendix"><span class="header-section-number">H.5</span> Symbols Used in this Appendix</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\hat h_i\)</span></td>
<td style="text-align: left;">Enthalpy per mole of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(i\)</span></td>
<td style="text-align: left;">As a subscript, denotes a specific reagent present in the system.<br>
As a summation or continuous product index, indexes all reagents present in the system.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(j\)</span></td>
<td style="text-align: left;">As a subscript, denotes a specific reaction occurring in the system.<br>
As a summation or continuous product index, indexes all reactions occurring in the system..</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n_i\)</span></td>
<td style="text-align: left;">Moles of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot n_i\)</span></td>
<td style="text-align: left;">Molar flow rate of reagent <span class="math inline">\(i\)</span>; an additional subscripted <span class="math inline">\(in\)</span> indicates the inlet molar flow rate of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(r_j\)</span></td>
<td style="text-align: left;">Rate of reaction <span class="math inline">\(j\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: left;">Time.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\hat u_i\)</span></td>
<td style="text-align: left;">Internal energy per mole of reagent <span class="math inline">\(i\)</span>; an additional subscripted <span class="math inline">\(in\)</span> indicates the internal energy per mole of reagent <span class="math inline">\(i\)</span> at the inlet to the system.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(z\)</span></td>
<td style="text-align: left;">Distance from the inlet along the axis of a PFR.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(C_i\)</span></td>
<td style="text-align: left;">Molar concentratin of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\hat C_{p,i}\)</span></td>
<td style="text-align: left;">Molar heat capacity of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(D\)</span></td>
<td style="text-align: left;">Diameter of a PFR.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(L\)</span></td>
<td style="text-align: left;">Length of a PFR.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Pressure.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot Q\)</span></td>
<td style="text-align: left;">Instantaneous net rate of heat input to the system.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T\)</span></td>
<td style="text-align: left;">Temperature of the system; a subscripted <span class="math inline">\(in\)</span> indicates the temperature at the inlet to the system.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_e\)</span></td>
<td style="text-align: left;">Temperature of the external heat exchange fluid; an additional subscripted <span class="math inline">\(in\)</span> indicates the temperature a the inlet to the jacket or shell holding the external heat exchange fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(U\)</span></td>
<td style="text-align: left;">Local, overall heat transfer coefficient.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(V\)</span></td>
<td style="text-align: left;">Volume of the (fluid) system.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\hat V_i\)</span></td>
<td style="text-align: left;">Volume per mole of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot V\)</span></td>
<td style="text-align: left;">Volumetric flow rate; ; an additional subscripted <span class="math inline">\(in\)</span> indicates the inlet volumetric flow rate. <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot W\)</span></td>
<td style="text-align: left;">Instantaneous net rate at which the system does mechanical work on the surroundings.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\nu_{i,j}\)</span></td>
<td style="text-align: left;">Stoichiometric coefficient of reagent <span class="math inline">\(i\)</span> in reaction <span class="math inline">\(j\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\Delta H\)</span></td>
<td style="text-align: left;">Change in enthalpy; used in this appendix to represent the change in enthalpy when fliuds mix.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\Delta H_j\)</span></td>
<td style="text-align: left;">Heat of reaction <span class="math inline">\(j\)</span>; a superscripted <span class="math inline">\(0\)</span> indicates the standard heat of reaction.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\Delta V\)</span></td>
<td style="text-align: left;">Change in volume; used in this appendix to represent the change in enthalpy when fliuds mix.</td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./apndx_transition_state_theory.html" class="pagination-link" aria-label="Transition State Theory">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Transition State Theory</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./apndx_solve_ates.html" class="pagination-link" aria-label="Solving Algebraic/Transcendental Equations">
        <span class="nav-page-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Solving Algebraic/Transcendental Equations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>