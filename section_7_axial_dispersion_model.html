<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>22&nbsp; The Steady-State Axial Dispersion Model – Reaction Engineering Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./section_7_segregated_flow_model.html" rel="next">
<link href="./section_7_intro.html" rel="prev">
<link href="./Graphics/BuffaloBadger_16_16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="http://buffalobadger.github.io" class="navbar-brand navbar-brand-logo">
    <img src="./Graphics/Banner.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/RE_Basics"> 
<span class="menu-text">Reaction Engineering Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/SCoRE"> 
<span class="menu-text">SCoRE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/ToTaL_Engineering"> 
<span class="menu-text">ToTaL Engineering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/The_Sett"> 
<span class="menu-text">The Sett</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_7_intro.html">Modeling Non-Ideal Reactors</a></li><li class="breadcrumb-item"><a href="./section_7_axial_dispersion_model.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_intro_and_defs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reactions, Reactors, and Reaction Engineering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_safety_and_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reaction Engineering Ethics and Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_reaction_progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measures of Reaction Progress</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rate Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_rates_and_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reaction Rates and Rate Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reaction Mechanisms and Mechanistic Rate Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_3_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formulating Reactor Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_design_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reactor Design Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_4_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Isolated Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_reaction_engineering_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Response, Optimization and Design of Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_bstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">BSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_sbstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">SBSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_non_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design of Non-Continuous Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_cstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_pfr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_5_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Ideal Reactor Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_reactor_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reactor Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_thermally_backmixed_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thermally Back-Mixed PFRs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_recycle_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recycle PFRs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_6_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kinetics Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_data_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_bstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_cstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_pfr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section_7_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Non-Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_axial_dispersion_model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_segregated_flow_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Segregated Flow Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_zoned_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Zoned Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_useful_eqns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Frequently Used Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_prereq_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Prerequisite Knowledge</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_nomenclature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Acronyms, Notation, Sign Conventions, and Computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_reaction_thermo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Reaction Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_heat_exchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Reactor Heat Exchange</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_collision_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Collision Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_transition_state_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Transition State Theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_ideal_reactor_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Ideal Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Axial Dispersion Reactor Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Solving Algebraic/Transcendental Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_ivodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Solving Initial-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_mvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Solving Missing-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_solve_cvodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Solving Coupled-Value ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_estimate_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Parameter Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#axial-dispersion" id="toc-axial-dispersion" class="nav-link active" data-scroll-target="#axial-dispersion"><span class="header-section-number">22.1</span> Axial Dispersion</a></li>
  <li><a href="#axial-dispersion-reactor-design-equations" id="toc-axial-dispersion-reactor-design-equations" class="nav-link" data-scroll-target="#axial-dispersion-reactor-design-equations"><span class="header-section-number">22.2</span> Axial Dispersion Reactor Design Equations</a></li>
  <li><a href="#axial-dispersion-reactor-model" id="toc-axial-dispersion-reactor-model" class="nav-link" data-scroll-target="#axial-dispersion-reactor-model"><span class="header-section-number">22.3</span> Axial Dispersion Reactor Model</a>
  <ul class="collapse">
  <li><a href="#multiplicy-of-steady-states" id="toc-multiplicy-of-steady-states" class="nav-link" data-scroll-target="#multiplicy-of-steady-states"><span class="header-section-number">22.3.1</span> Multiplicy of Steady States</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">22.4</span> Examples</a>
  <ul class="collapse">
  <li><a href="#sec-example_22_4_1" id="toc-sec-example_22_4_1" class="nav-link" data-scroll-target="#sec-example_22_4_1"><span class="header-section-number">22.4.1</span> Liquid Phase Reaction in a Tubular Reactor with Axial Dispersion</a></li>
  <li><a href="#sec-example_22_4_2" id="toc-sec-example_22_4_2" class="nav-link" data-scroll-target="#sec-example_22_4_2"><span class="header-section-number">22.4.2</span> Gas Phase Reaction in a Packed Bed Reactor with Axial Dispersion and Pressure Drop</a></li>
  </ul></li>
  <li><a href="#symbols-used-in-sec-7_axial_dispersion" id="toc-symbols-used-in-sec-7_axial_dispersion" class="nav-link" data-scroll-target="#symbols-used-in-sec-7_axial_dispersion"><span class="header-section-number">22.5</span> Symbols Used in <span>Chapter 22</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_7_intro.html">Modeling Non-Ideal Reactors</a></li><li class="breadcrumb-item"><a href="./section_7_axial_dispersion_model.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-7_axial_dispersion" class="quarto-section-identifier"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The ideal PFR model assumes there is no mixing in the axial direction. This chapter presents the steady-state version of a model wherein terms have been added to the PFR mole and energy balances to allow mixing in the axial direction. It is called the axial dispersion model. The design equations for the axial dispersion model are derived from the PFR design equations in <a href="apndx_axial_dispersion_model.html" class="quarto-xref"><span>Appendix I</span></a>. It should be noted that the axial dispersion model is usually written using the linear velocity of the fluid in the <span class="math inline">\(z\)</span> direction, <span class="math inline">\(u_z\)</span>, but for consistenccy with the other chapters of <em>Reaction Engineering Basics,</em> it is written in terms of the volumetric flow rate, <span class="math inline">\(\dot{V}\)</span>, in this chapter.</p>
<section id="axial-dispersion" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="axial-dispersion"><span class="header-section-number">22.1</span> Axial Dispersion</h2>
<p>A tubular or packed bed reactor only approaches plug flow at large Reynolds numbers where the flow is highly turbulent. As a consequence, there are small eddies and currents that flow in the axial direction at velocities above and below the mean fluid velocity. These small eddies cause some mixing in the axial direction. To account for this, the term, <span class="math inline">\(-D_{ax} \frac{\pi D^2}{4} \frac{d^2C_i}{dz^2}\)</span>, can be added to the ideal PFR mole balance, and the term, <span class="math inline">\(-\lambda_{ax} \frac{\pi D^2}{4} \frac{d^2T}{dz^2}\)</span>, can be added to the PFR energy balance. To those familiar with heat and mass transfer, these terms look terms for mass diffusion and thermal conduction in the <span class="math inline">\(z\)</span> direction, but they are not.</p>
<p>The coefficient, <span class="math inline">\(D_{ax}\)</span>, is <u>not</u> a diffusion coefficient. It is called a <strong>dispersion coefficient</strong>, and it is typically obtained from correlations (in dimensionless form) as an axial or longitudinal Peclet number, <a href="#eq-peclet_number" class="quarto-xref">Equation&nbsp;<span>22.1</span></a>. Unlike diffusion coefficients, for a given flow stream, there is a single axial dispersion coefficient that applies for every reagent in the system. Similarly, the coefficient, <span class="math inline">\(\lambda_{ax}\)</span>, is not a thermal condictivity, it is a thermal dispersion coefficient. It can be found in correlations as a dimensionless longitudinal Bodenstein number, <a href="#eq-bodenstein_number" class="quarto-xref">Equation&nbsp;<span>22.2</span></a>. As noted, the axial dispersion and thermal dispersion coefficients are meant to account for axial mixing due to the turbulence of the flow. Typically, axial mixing of this type is only significant in extremely short tubular reactors.</p>
<p><span id="eq-peclet_number"><span class="math display">\[
Pe_{ax} = \frac{4\dot{V}L}{\pi D^2 D_{ax}}
\tag{22.1}\]</span></span></p>
<p><span id="eq-bodenstein_number"><span class="math display">\[
Bo_{ax} = \frac{4\rho \tilde{C}_p \dot{V}L}{\pi D^2 \lambda_{ax}}
\tag{22.2}\]</span></span></p>
<p>So, when used to account for axial mixing due to turbulence, the axial dispersion terms are only necessary if the reactor is very short. However, if the flow in a tubular reactor, and particularly in a packed bed reactor, is irregular, the axial dispersion model can be used as an empirical reactor model. In this situation, <span class="math inline">\(D_{ax}\)</span> and <span class="math inline">\(\lambda_{ax}\)</span> are used as adjustable parameters whose values are chosen to make the reactor model as accurate as possible. Generally when <span class="math inline">\(Pe_{ax}\)</span> is less than 10 and <span class="math inline">\(Bo_{ax}\)</span> is less than 1, backmixing is significant, and when <span class="math inline">\(Pe_{ax}\)</span> and <span class="math inline">\(Bo_{ax}\)</span> are greater than 100, backmixing is minimal. Thus, in an empirical reactor model, <span class="math inline">\(D_{ax}\)</span> and <span class="math inline">\(\lambda_{ax}\)</span> become parameters that are adjusted to tune the amount of backmixing.</p>
</section>
<section id="axial-dispersion-reactor-design-equations" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="axial-dispersion-reactor-design-equations"><span class="header-section-number">22.2</span> Axial Dispersion Reactor Design Equations</h2>
<p>As noted, the axial dispersion model is simply the ideal PFR model with dispersion terms added to the mole and energy balances. Importantly, plug flow is still assumed. In <a href="apndx_axial_dispersion_model.html" class="quarto-xref"><span>Appendix I</span></a> the axial dispersion mole and energy balances and the associated initial values and boundary conditions are derived, the steady-state forms are generated, and then they are converted to an equivalent set of first-order CVODEs. Familiarity with the first-order design equations and the variables (<span class="math inline">\(\omega_i\)</span> and <span class="math inline">\(\omega_T\)</span>) introduced with them is assumed here.</p>
<p><a href="apndx_axial_dispersion_model.html#fig-axial_dispersion_inlet" class="quarto-xref">Figure&nbsp;<span>I.1</span></a> presents a schematic representation of an adiabatic reactor that can be modeled using the axial dispersion model. It is important to note that the concentrations and temperature at the inlet to the reactor will not equal the feed concentrations and temperature. This is a result of axial mixing occurring at the reactor inlet thereby causing some of the feed to mix with fluid already in the reactor.</p>
<div id="fig-axial_dispersion_inlet" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-axial_dispersion_inlet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/axial_dispersion_adiabatic.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-axial_dispersion_inlet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.1: Due to mixing in the axial direction, the concentrations and temperature at the inlet are not equal to the feed concentrations and temperature.
</figcaption>
</figure>
</div>
<p>It becomes important to differentiate between the values of variables in the feed, at the reactor inlet, and at the reactor outlet. Here, if the location is not identified using a vertical bar and subscript, e. g. <span class="math inline">\(C_A \big\vert_{z=0}\)</span> for the concentration of reagent A at the reactor inlet, an additional subscript is added to the variable symbol. Thus, <span class="math inline">\(C_{A,feed}\)</span> denotes the concentration of A in the feed, <span class="math inline">\(C_A \big\vert_{z=0}\)</span> or <span class="math inline">\(C_{A,0}\)</span> denotes the concentration of A at the reactor inlet, and <span class="math inline">\(C_A \big\vert_{z=L}\)</span> or <span class="math inline">\(C_{A,1}\)</span> denotes the concentration at the reactor outlet.</p>
<p>The mole and energy balances for the axial dispersion model are shown in <a href="#eq-axial_disp_conc" class="quarto-xref">Equations&nbsp;<span>22.3</span></a> through <a href="#eq-axial_disp_temp_var" class="quarto-xref"><span>22.7</span></a>. <a href="#eq-axial_disp_conc" class="quarto-xref">Equations&nbsp;<span>22.3</span></a> and <a href="#eq-axial_disp_temp" class="quarto-xref"><span>22.4</span></a> are the PFR design equations with the dispersion terms added. <a href="#eq-axial_disp_vfr_deriv" class="quarto-xref">Equation&nbsp;<span>22.5</span></a> is the total mass balance, re-written in terms of the volumetric flow rate. If the reacting fluid is an ideal, incompressible liquid mixture, the volumetric flow rate is constant and equal to <span class="math inline">\(\dot{V}_{feed}\)</span>, the derivative of the volumetric flow rate in <a href="#eq-axial_disp_conc" class="quarto-xref">Equation&nbsp;<span>22.3</span></a> equals zero, and <a href="#eq-axial_disp_vfr_deriv" class="quarto-xref">Equation&nbsp;<span>22.5</span></a> is not needed. <a href="#eq-axial_disp_conc_var" class="quarto-xref">Equations&nbsp;<span>22.6</span></a> and <a href="#eq-axial_disp_temp_var" class="quarto-xref"><span>22.7</span></a> are essentially defining equations for <span class="math inline">\(\omega_i\)</span> and <span class="math inline">\(\omega_T\)</span>. If there is pressure drop in the reactor, a momentum balance must be added to the design equations. If an external heat exchange fluid transfers sensible heat to or from the reactor, an energy balance on the exchange fluid must be added, but it will be an ATE, not an ODE.</p>
<p><span id="eq-axial_disp_conc"><span class="math display">\[
- D_{ax}\frac{d \omega_i}{d z} + \frac{4 C_i}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_i + \sum_j \nu_{i,j}r_j
\tag{22.3}\]</span></span></p>
<p><span id="eq-axial_disp_temp"><span class="math display">\[
- \lambda_{ax}\frac{d \omega_T}{d z} = - \frac{4 \dot{V}}{\pi D^2} \left(\sum_i C_i \hat{C}_{p,i}\right) \omega_T + \frac{4U}{D}\left(T_{ex} - T\right) - \sum_j r_j \Delta H_j
\tag{22.4}\]</span></span></p>
<p><span id="eq-axial_disp_vfr_deriv"><span class="math display">\[
\frac{d\dot{V}}{dz} = \frac{-\sum_i \left(M_i \frac{dC_i}{dz}\right)}{\sum_i \left(M_i C_i\right)}
\tag{22.5}\]</span></span></p>
<p><span id="eq-axial_disp_conc_var"><span class="math display">\[
\frac{dC_i}{dz} = \omega_i
\tag{22.6}\]</span></span></p>
<p><span id="eq-axial_disp_temp_var"><span class="math display">\[
\frac{dT}{dz} = \omega_T
\tag{22.7}\]</span></span></p>
<p>The initial values of each <span class="math inline">\(\omega_i\)</span> and of <span class="math inline">\(\omega_T\)</span> are coupled values. They can be found by solving the implicit, coupled values equations, <a href="#eq-implicit_omega_i" class="quarto-xref"><span>22.8</span></a> and <a href="#eq-implicit_omega_T" class="quarto-xref"><span>22.9</span></a>. If the design equations include an energy balance on a heat exchange fluid, the exchange fluid energy balance can be added to these coupled values equations they can be solved to additionally find <span class="math inline">\(T_{ex}\)</span>.</p>
<p><span id="eq-implicit_omega_i"><span class="math display">\[
\left(\omega_{i,0},\, \omega_{T,0}\right) \,:\, \omega_{i,1} = 0
\tag{22.8}\]</span></span></p>
<p><span id="eq-implicit_omega_T"><span class="math display">\[
\left(\omega_{i,0},\, \omega_{T,0}\right) \,:\, \omega_{T,1} = 0
\tag{22.9}\]</span></span></p>
<p>The Danckwerts boundary conditions,<a href="#eq-danckwerts_conc" class="quarto-xref">Equations&nbsp;<span>22.10</span></a> and <a href="#eq-danckwerts_temp" class="quarto-xref"><span>22.11</span></a> can be used to calculate initial values for the concentrations and the temperature. Noting that at stead-state, the mass flow rate of the feed equals the mass flow rate at the reactor inlet leads to <a href="#eq-vfr_bound_cond" class="quarto-xref">Equation&nbsp;<span>22.12</span></a> for the initial value of the volumetric flow rate if the reacting fluid is an ideal gas. If a momentum balance is included among the design equations, the feed pressure can be used as the initial value.</p>
<p><span id="eq-danckwerts_conc"><span class="math display">\[
C_{i,0} = \frac{\dot{V}_{feed}C_{i,feed} - D_{ax} \frac{\pi D^2}{4} \omega_{i,0}}{\dot{V}_0}
\tag{22.10}\]</span></span></p>
<p><span id="eq-danckwerts_temp"><span class="math display">\[
T_0 = \frac{\dot{V}_{feed}\sum_i\left(C_{i,feed} \hat{C}_{p,i} \right) T_{feed} - \lambda_{ax} \frac{\pi D^2}{4} \omega_{T,0}}{\dot{V}_{0} \sum_i\left(C_{i,0} \hat{C}_{p,i} \right) }
\tag{22.11}\]</span></span></p>
<p><span id="eq-vfr_bound_cond"><span class="math display">\[
\dot{V}_0 = \frac{\dot{m}}{\displaystyle \sum_i \left(M_i C_{i,0}\right)}
\tag{22.12}\]</span></span></p>
</section>
<section id="axial-dispersion-reactor-model" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="axial-dispersion-reactor-model"><span class="header-section-number">22.3</span> Axial Dispersion Reactor Model</h2>
<p>This section describes the essential components of an axial dispersion reactor model. Upon first reading, it may seem abstract and difficult to follow. If so, it may be helpful to review the examples at the end of the chapter and then re-read this section. <a href="#fig-axial_disp_model_components" class="quarto-xref">Figure&nbsp;<span>22.2</span></a> illustrates the essential components of an axial dispersion reactor model and their relation to numerical equation solvers.</p>
<div id="fig-axial_disp_model_components" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-axial_disp_model_components-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/CVODE_Reactor_Model.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-axial_disp_model_components-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.2: Components of an axial dispersion reactor model.
</figcaption>
</figure>
</div>
<p>The gray box in <a href="#fig-axial_disp_model_components" class="quarto-xref">Figure&nbsp;<span>22.2</span></a> represents the axial dispersion reactor model. As indicated by the yellow and orange boxes at the bottom of the figure, any constants provided in the assignment narrative, any known universal constants, and any quantities that have been made globally available (see below) can be used anywhere within the reactor model. The three functions included within the model (i. e. the derivatives, coupled value residuals, and reactor functions) must be written by the person solving the design equations. In constast, the two red boxes represent numerical equation solvers. They are not part of the model, but instead are parts of a mathematics software package that is used when solving the design equations. The black arrows indicate that the ATE solver is called by the reactor function and the IVODE solver is called by both the reactor function and the coupled values residuals function. ATE and IVODE solvers are described in <a href="apndx_solve_ates.html" class="quarto-xref">Appendices&nbsp;<span>J</span></a> and <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>K</span></a>.</p>
<p>The red arrows in <a href="#fig-axial_disp_model_components" class="quarto-xref">Figure&nbsp;<span>22.2</span></a> indicate that the IVODE solver calls the model’s derivatives function and the ATE solver calls the model’s coupled values residuals function. The solvers expect the derivatives function and the residuals function to accept specific arguments and to return the values of specific quantities. Put differently, the only arguments that can be passed to the derivatives function and the residuals function are those specified by the solver mathematics package, and the derivatives and residuals functions must return only the values specified by the solver mathematics package. <a href="apndx_solve_ates.html" class="quarto-xref">Appendices&nbsp;<span>J</span></a> and <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>K</span></a> identify the arguments that must be passed to these solvers and the values they must return.</p>
<p>As indicated by the dashed orange arrow in <a href="#fig-axial_disp_model_components" class="quarto-xref">Figure&nbsp;<span>22.2</span></a>, if any other quantities need to be passed to the derivatives or residuals function, those quantities can be made globally available. Once they are made globally available, they can be used within the derivatives and residuals functions. (There are ways of providing quantities to the derivatives and residuals functions other than by making the quantities globally available, but that is a programming issue and won’t be discussed here.)</p>
<p>To summarize the axial dispersion model can access external given and known constants and globally available quantities. It also interfaces with an external ATE solver and an external IVODE solver. As <a href="#fig-axial_disp_model_components" class="quarto-xref">Figure&nbsp;<span>22.2</span></a> shows, the axial dispersion reactor model has several internal components that now can be described.</p>
<p><strong>Design Equations</strong> As with other reactor models, the first component of the axial dispersion reactor model is the design equations. The design equations were listed above, <a href="#eq-axial_disp_conc" class="quarto-xref">Equations&nbsp;<span>22.3</span></a> through <a href="#eq-axial_disp_temp_var" class="quarto-xref"><span>22.7</span></a>. If there is pressure drop, a momentum balance must be added to them, as must an energy balance on an exchange fluid that transfers sensible heat at an unknown exchnage fluid temperature. As previously noted, the design equations are a set of CVODEs (see <a href="apndx_solve_cvodes.html" class="quarto-xref"><span>Appendix M</span></a>). They will be solved using an IVODE solver, so they should be written as derivative expressions (see <a href="apndx_solve_ivodes.html" class="quarto-xref"><span>Appendix K</span></a>).</p>
<p><strong>Initial Values and Stopping Criterion</strong> When solving the CVODE design equations numerically, initial values and a stopping criterion must be provided to the IVODE solver. The initial values for solving the design equations were also listed in the preceding section. They are summarized in <a href="#tbl-axial_disp_init_value_table" class="quarto-xref">Table&nbsp;<span>22.1</span></a> which indicates that the initial values for each <span class="math inline">\(\omega_i\)</span> and for <span class="math inline">\(\omega_T\)</span> are coupled values that cannot be calculated directly. If a momentum balance is included in the design equations, the table will have an additional row for the initial value of the pressure. Similarly, if the reacting fluid is a liquid, there will not be a row for the initial value of the volumetric flow rate.</p>
<div id="tbl-axial_disp_init_value_table" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-axial_disp_init_value_table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;22.1: Initial values and stopping criterion for solving the axial dispersion design equations.
</figcaption>
<div aria-describedby="tbl-axial_disp_init_value_table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(L\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\omega_i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\omega_{i,0}\)</span> (coupled value)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\omega_T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\omega_{T,0}\)</span> (coupled value)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{V}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{V}_0 = \frac{\dot{m}_{feed}}{\displaystyle \sum_i \left(M_i C_{i,0}\right)}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(C_i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C_{i,0} = \frac{\dot{V}_{feed}C_{i,feed} - D_{ax} \frac{\pi D^2}{4} \omega_{i,0}}{\dot{V}_0}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(T_0 = \frac{\dot{V}_{feed}\sum_i\left(C_{i,feed} \hat{C}_{p,i} \right) T_{feed} - \lambda_{ax} \frac{\pi D^2}{4} \omega_{T,0}}{\dot{V}_{0} \sum_i\left(C_{i,0} \hat{C}_{p,i} \right) }\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>While <a href="#tbl-axial_disp_init_value_table" class="quarto-xref">Table&nbsp;<span>22.1</span></a> indicates the reactor length as the stopping criterion it could also be an outlet concentration or the outlet temperature. The final values of each <span class="math inline">\(\omega_i\)</span> and of <span class="math inline">\(\omega_T\)</span> are also known (<a href="#eq-implicit_omega_i" class="quarto-xref">Equations&nbsp;<span>22.8</span></a> and <a href="#eq-implicit_omega_T" class="quarto-xref"><span>22.9</span></a>) but they cannot be used as the stopping criterion when solving the IVODEs because they are used to solve the coupled value equations.</p>
<p><strong>Derivatives Function</strong> In addition to initial values and a stopping criterion, a derivatives function must be provided to the IVODE solver. The derivatives function is essentially the same as for any other reactor type where the design equations are IVODEs. It is used by the IVODE solver. The only arguments passed to it are values of the independent and dependent variables at the start of an integration step, and the only values it returns are those of the derivative of each dependent variable with respect to the independent variable.</p>
<p>In an axial dispersion reactor model, the derivatives function must receive <span class="math inline">\(z\)</span>, each <span class="math inline">\(C_i\)</span>, <span class="math inline">\(T\)</span>, each <span class="math inline">\(\omega_i\)</span>, <span class="math inline">\(\omega_T\)</span>, <span class="math inline">\(\dot{V}\)</span> (if the system is gas phase), and <span class="math inline">\(P\)</span> (if there is a momentum balance amoung the design equations). It must return the corresponding values of each <span class="math inline">\(\frac{dC_i}{dz}\)</span>, <span class="math inline">\(\frac{dT}{dz}\)</span>, each <span class="math inline">\(\frac{d\omega_i}{dz}\)</span>, <span class="math inline">\(\frac{d\omega_T}{dz}\)</span>, <span class="math inline">\(\frac{d\dot{V}}{dz}\)</span> (if <span class="math inline">\(\dot{V}\)</span> is an argument), and <span class="math inline">\(\frac{dP}{dz}\)</span> (if <span class="math inline">\(P\)</span> is an argument). The definition of the derivatives function should include the sequence of calculations that is used to calculate the return values starting from the given and known constants, globally available quantities, and the arguments it receives.</p>
<p><strong>Coupled Values Equations</strong> The coupled value equations, <a href="#eq-implicit_omega_i" class="quarto-xref"><span>22.8</span></a> and <a href="#eq-implicit_omega_T" class="quarto-xref"><span>22.9</span></a>, are reproduced below. They are called coupled value equations because to calculate the <span class="math inline">\(\omega_{i,0}\)</span> and <span class="math inline">\(\omega_{T,0}\)</span> values, it is necessary to solve the IVODEs, but the <span class="math inline">\(\omega_{i,0}\)</span> and <span class="math inline">\(\omega_{T,0}\)</span> values are needed to solve the IVODEs. The equations are implicit, effectively stating that the desired <span class="math inline">\(\omega_{i,0}\)</span> and <span class="math inline">\(\omega_{T,0}\)</span> values are those that, when used to solve the IVODEs, yield values of each <span class="math inline">\(\omega_{i,1}\)</span> and <span class="math inline">\(\omega_{T,1}\)</span> that equal zero. They are treated like ATEs and are solved numerically. Hence, they are written as residual expressions.</p>
<p><span class="math display">\[
\left(\omega_{i,0}, \omega_{T,0}\right)\,:\, \omega_{i,L} = 0 = \epsilon_i
\]</span></p>
<p><span class="math display">\[
\left(\omega_{i,0}, \omega_{T,0}\right)\,:\, \omega_{T,L} = 0 = \epsilon_T
\]</span></p>
<p>If the model requires an exchange fluid energy balance involving sensible heat, <a href="#eq-axial_disp_ss_ex_energy_bal" class="quarto-xref">Equation&nbsp;<span>22.13</span></a>, the exchange fluid temperature is also a coupled value. It is coupled because <span class="math inline">\(T_{ex}\)</span> is needed to solve the IVODEs, but the reactor temperture profile (found by solving the IVODEs) in the first integral below is needed to calculate <span class="math inline">\(T_{ex}\)</span>.</p>
<p><span id="eq-axial_disp_ss_ex_energy_bal"><span class="math display">\[
0 = \int_0^L \pi DU\left( T_{ex} - T \right)dz + \dot m_{ex} \int_{T_{ex,in}}^{T_{ex}} \tilde C_{p,ex}dT = \epsilon_{ex}
\tag{22.13}\]</span></span></p>
<p><strong>Coupled Values Guess</strong> Since an ATE solver is used to solve the coupled values equations, a guess for the coupled values must be provided to it. Specifically guesses are need for each <span class="math inline">\(\omega_{i,0}\)</span> and for <span class="math inline">\(\omega_{T,0}\)</span>. Looking at <a href="#eq-axial_disp_conc_var" class="quarto-xref">Equations&nbsp;<span>22.6</span></a> and <a href="#eq-axial_disp_temp_var" class="quarto-xref"><span>22.7</span></a> shows that these variables are the slope of the concentration and temperature profiles at the reactor inlet.</p>
<p>While it is just a guess, if it is too far off the ATE solver may not converge. As was found for steady-state CSTRs, convergence is often most affected by the guess for the temperature. The examples at the end of the chapter illustrate a few strategies for guessing the coupled values.</p>
<p><strong>Coupled Values Residuals Function</strong> The other thing that must be provided to the ATE solver when solving the coupled values equations is a residuals function. As is true any time an ATE solver is used, the residuals function must receive only values for the ATE unknowns as arguments, and it must return only the corresponding values of the residuals for the equations being solved. In the case of axial dispersion models, the residuals function will receive values for each <span class="math inline">\(\omega_i\)</span> and for <span class="math inline">\(\omega_T\)</span>. If the reactor exchanges heat with an external heat exchange fluid, it will also receive the temperature of that fluid as an argument.</p>
<p>Before the coupled values equations can be solved the IVODEs must be solved. Consequently, the residuals function must first calculate each <span class="math inline">\(C_i\)</span> and <span class="math inline">\(T\)</span> using <a href="#eq-danckwerts_conc" class="quarto-xref">Equations&nbsp;<span>22.10</span></a> and <a href="#eq-danckwerts_temp" class="quarto-xref"><span>22.11</span></a>. Then, having all of the initial values, it can call the IVODE solver using those initial guesses along with the stopping criterion and derivatives function as arguments. The IVODE solver will return sets of values of <span class="math inline">\(z\)</span>, each <span class="math inline">\(C_i\)</span>, <span class="math inline">\(T\)</span>, each <span class="math inline">\(\omega_i\)</span>, and <span class="math inline">\(\omega_T\)</span>, spanning the range from <span class="math inline">\(z=0\)</span> to <span class="math inline">\(z=L\)</span>. If a momentum balance is among the design equations, it also will receive values of <span class="math inline">\(P\)</span>, spanning the range from the reactor inlet to the reactor outlet. The returned values of each <span class="math inline">\(\omega_i\)</span> and of <span class="math inline">\(\omega_T\)</span> at the reactor outlet can then be used to evaluate the residuals using <a href="#eq-implicit_omega_i" class="quarto-xref">Equations&nbsp;<span>22.8</span></a> and <a href="#eq-implicit_omega_T" class="quarto-xref"><span>22.9</span></a>.</p>
<p><strong>Reactor Model Function</strong> The reactor model function is the final component of the axial dispersion reactor model. Briefly, it simply needs to solve the coupled values equations using an ATE solver and then use the results to solve the axial dispersion design equations using an IVODE solver. More specifically the reactor model function works as follows.</p>
<ul>
<li>Guess values for each <span class="math inline">\(\omega_i\)</span> and for <span class="math inline">\(\omega_T\)</span>.</li>
<li>Get values for each <span class="math inline">\(\omega_i\)</span> and for <span class="math inline">\(\omega_T\)</span> by calling an ATE solver, passing the coupled values guesses and the residuals function as arguments.</li>
<li>Calculate the other initial values in <a href="#tbl-axial_disp_init_value_table" class="quarto-xref">Table&nbsp;<span>22.1</span></a>.</li>
<li>Get sets of values of <span class="math inline">\(z\)</span>, each <span class="math inline">\(C_i\)</span>, <span class="math inline">\(T\)</span>, each <span class="math inline">\(\omega_i\)</span>, <span class="math inline">\(\omega_T\)</span>, and <span class="math inline">\(P\)</span> (if there is a momentum balance among the design equations), spanning the range from <span class="math inline">\(z=0\)</span> to <span class="math inline">\(z=L\)</span> by calling an IVODE solver passing the initial values, stopping criterion, and derivatives function as arguments.</li>
<li>Return the profiles that the IVODE solver returned.</li>
</ul>
<section id="multiplicy-of-steady-states" class="level3" data-number="22.3.1">
<h3 data-number="22.3.1" class="anchored" data-anchor-id="multiplicy-of-steady-states"><span class="header-section-number">22.3.1</span> Multiplicy of Steady States</h3>
<p>Just as was seen with steady-state CSTRs, there can be multiple solutions to the steady-state axial dispersion model design equations. Multiple steady states are a consequence of mixing between the reactor inlet and its outlet. They are not observed in steady-state PFRs because there isn’t any axial mixing, but by adding the axial dispersion term, multiple steady states become possible.</p>
</section>
</section>
<section id="examples" class="level2" data-number="22.4">
<h2 data-number="22.4" class="anchored" data-anchor-id="examples"><span class="header-section-number">22.4</span> Examples</h2>
<p>The first example that follows involves an adiabatic reaction of a liquid feed stream. As such, only the axial dispersion reactor design equations are needed. The second example considers an adiabatic gas phase reaction in a packed bed with a pressure drop. Its solution requires use of the differential ideal gas law and a momentum balance in addition to the axial dispersion reactor design equations.</p>
<section id="sec-example_22_4_1" class="level3" data-number="22.4.1">
<h3 data-number="22.4.1" class="anchored" data-anchor-id="sec-example_22_4_1"><span class="header-section-number">22.4.1</span> Liquid Phase Reaction in a Tubular Reactor with Axial Dispersion</h3>
</section>
<section id="sec-example_22_4_2" class="level3" data-number="22.4.2">
<h3 data-number="22.4.2" class="anchored" data-anchor-id="sec-example_22_4_2"><span class="header-section-number">22.4.2</span> Gas Phase Reaction in a Packed Bed Reactor with Axial Dispersion and Pressure Drop</h3>
<p>The steady-state feed to a PFR is 75% A and 25% inert gas flowing at 100 cm<sup>3</sup> s<sup>-1</sup> , 3 atm and 400 °C. Reaction(1) takes place within the reactor. The reactor diameter is 2.5 cm and its length is 8 m. It is surrounded by a shell containing a molten salt at a constant temperature of 375 °C. The heat transfer coefficient between the reactor and shell is 187 kJ h<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup>. The reaction is catalytic, and the reactor is packed with catalyst particles with a 0.25 cm diameter, a sphericity of 0.7, and a bed porosity of 0.60. The rate expression for reaction (1) is given in equation (2) where <span class="math inline">\(k_{0,f}\)</span> = 9.0 x 10<sup>17</sup> mol cm<sup>3</sup> s<sup>-1</sup> atm<sup>-1</sup>, <span class="math inline">\(E_f\)</span> = 285 kJ mol<sup>-1</sup>, <span class="math inline">\(k_{0,r}\)</span> = 4.09 x 10<sup>-4</sup> mol cm<sup>-3</sup> s<sup>-1</sup> atm<sup>-4</sup>, and <span class="math inline">\(E_r\)</span> = 85 kJ mol<sup>-1</sup>. The heat of reaction is constant and equal to 200 kJ mol<sup>-1</sup>. The heat capacities of the reagents are also constant: <span class="math inline">\(\hat{C}_{p,A}\)</span> = 11.7 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Y}\)</span> = 8.3 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Z}\)</span> = 4.3 cal mol<sup>-1</sup> K<sup>-1</sup>, and <span class="math inline">\(\hat{C}_{p,I}\)</span> = 5.8 cal mol<sup>-1</sup> K<sup>-1</sup>. The viscosity may be assumed to be constant and equal to 0.027 cP. What are the outlet temperature, pressure and conversion if axial dispersion is included in the model with <span class="math inline">\(D_{ax}\)</span> equal to ? and <span class="math inline">\(\lambda_{ax}\)</span> equal to ?? The molecular weights of I, A, Y, and Z are 28, 84, 78, and 2 g/mol, respectively.</p>
<p><span class="math display">\[
A \rightleftarrows Y + 3Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = k_fP_A - k_rP_YP_Z^3 \tag{2}
\]</span></p>
<hr>
<section id="assignment-summary" class="level4" data-number="22.4.2.1">
<h4 data-number="22.4.2.1" class="anchored" data-anchor-id="assignment-summary"><span class="header-section-number">22.4.2.1</span> Assignment Summary</h4>
<p><strong>Reactor System”</strong> Heated steady-State Packed Bed Reactor with Pressure Drop and Axial Dispersion.</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_22_4_2_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_22_4_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/axial_dispersion_non_adiabatic.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_22_4_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.3: Schematic representation of the packed bed reactor.
</figcaption>
</figure>
</div>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(T_1\)</span>, <span class="math inline">\(P_1\)</span>, and <span class="math inline">\(f_A\)</span>.</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(y_{A,feed}\)</span> = 0.75, <span class="math inline">\(y_{I,feed}\)</span> = 0.25, <span class="math inline">\(\dot{V}_{0}\)</span> = 100 cm<sup>3</sup> s<sup>-1</sup>, <span class="math inline">\(\dot{m}_{0}\)</span> = 0.44 g s<sup>-1</sup>, <span class="math inline">\(P_{0}\)</span> = 3 atm, <span class="math inline">\(T_{feed}\)</span> = 400 °C, <span class="math inline">\(D\)</span> = 2.5 cm, <span class="math inline">\(L\)</span> = 8 m, <span class="math inline">\(T_{ex}\)</span> = 375 °C, <span class="math inline">\(U\)</span> = 187 kJ h<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup>, <span class="math inline">\(D_p\)</span> = 0.25 cm, <span class="math inline">\(\Phi_s\)</span> = 0.7, <span class="math inline">\(\varepsilon\)</span> = 0.60, <span class="math inline">\(k_{0,f}\)</span> = 9.0 x 10<sup>17</sup> mol cm<sup>3</sup> s<sup>-1</sup> atm<sup>-1</sup>, <span class="math inline">\(𝐸_𝑓\)</span> = 285 kJ mol<sup>-1</sup>, <span class="math inline">\(𝑘_{0,𝑟}\)</span> = 4.09 x 10<sup>-4</sup> mol cm<sup>-3</sup> s<sup>-1</sup> atm<sup>-4</sup>, <span class="math inline">\(𝐸_𝑟\)</span> = 85 kJ mol<sup>-1</sup>, <span class="math inline">\(\Delta H_1\)</span> = 200 kJ mol<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,A}\)</span> = 11.7 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Y}\)</span> = 8.3 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\hat{C}_{p,Z}\)</span> = 4.3 cal mol<sup>-1</sup> K<sup>-1</sup>, and <span class="math inline">\(\hat{C}_{p,I}\)</span> = 5.8 cal mol<sup>-1</sup> K<sup>-1</sup>, <span class="math inline">\(\mu\)</span> = 0.027 cP, <span class="math inline">\(D_{ax}\)</span> = ?, <span class="math inline">\(\lambda_{ax}\)</span> = ?, and <span class="math inline">\(R\)</span> = 8.314 J mol<sup>-1</sup> K<sup>-1</sup> = 82.06 cm<sup>3</sup> atm mol<sup>-1</sup> K<sup>1-</sup>.</p>
</section>
<section id="mathematical-formulation-of-the-calculations" class="level4" data-number="22.4.2.2">
<h4 data-number="22.4.2.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-calculations"><span class="header-section-number">22.4.2.2</span> Mathematical Formulation of the Calculations</h4>
<center>
<strong>Axial Dispersion Reactor Model</strong>
</center>
<p><strong>Design Equations</strong></p>
<p><span class="math display">\[
- D_{ax}\frac{d \omega_A}{d z} + \frac{4 C_A}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_A - r \tag{3}
\]</span></p>
<p><span class="math display">\[
- D_{ax}\frac{d \omega_Y}{d z} + \frac{4 C_Y}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_Y + r \tag{4}
\]</span></p>
<p><span class="math display">\[
- D_{ax}\frac{d \omega_Z}{d z} + \frac{4 C_Z}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_Z + 3r \tag{5}
\]</span></p>
<p><span class="math display">\[
- D_{ax}\frac{d \omega_I}{d z} + \frac{4 C_I}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_I \tag{6}
\]</span></p>
<p><span class="math display">\[
- \lambda_{ax}\frac{d \omega_T}{d z} =- \frac{4 \dot{V}}{\pi D^2} \left(\sum_i C_i \hat{C}_{p,i}\right) \omega_T + \frac{4U}{D}\left(T_{ex} - T\right) - r \Delta H_j \tag{7}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{V}}{dz} = \frac{- \left(M_I \omega_I + M_A \omega_A + M_Y \omega_Y + M_Z \omega_Z \right)}{\left( M_I C_I + M_A C_A + M_Y C_Y + M_Z C_Z\right)
} \tag{8}
\]</span></p>
<p><span class="math display">\[
\frac{dC_A}{dz} = \omega_A \tag{9}
\]</span></p>
<p><span class="math display">\[
\frac{dC_Y}{dz} = \omega_Y \tag{10}
\]</span></p>
<p><span class="math display">\[
\frac{dC_Z}{dz} = \omega_Z \tag{11}
\]</span></p>
<p><span class="math display">\[
\frac{dC_I}{dz} = \omega_I \tag{12}
\]</span></p>
<p><span class="math display">\[
\frac{dT}{dz} = \omega_T \tag{13}
\]</span></p>
<p><span class="math display">\[
\frac{{dP}}{{dz}} =  - \frac{{1 - \varepsilon }}{{{\varepsilon ^3}}}\frac{{{G^2}}}{{\rho {\Phi _s}{D_p}}}\left[ {\frac{{150\left( {1 - \varepsilon } \right)\mu }}{{{\Phi _s}{D_p}G}} + 1.75} \right] \tag{14}
\]</span></p>
<p><strong>Initial Values and Stopping Criterion</strong></p>
<div id="tbl-example_22_4_2_initial_values" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_22_4_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;22.2: Initial values and stopping criterion for solving the axial dispersion design equations with <span class="math inline">\(z=0\)</span> defined as the inlet to the reactor.
</figcaption>
<div aria-describedby="tbl-example_22_4_2_initial_values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Initial Value</th>
<th style="text-align: center;">Stopping Criterion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(L\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\omega_i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\omega_{i,0}\)</span> (coupled value)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\omega_T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\omega_{T,0}\)</span> (coupled value)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\dot{V}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dot{V}_0 = \frac{\dot{m}}{M_A C_{A,0} + M_Y C_{Y,0} + M_Z C_{Z,0} + M_I C_{I,0}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(C_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C_{A,0} = \frac{\dot{V}_{0}C_{A,feed} + D_{ax} \frac{\pi D^2}{4} \omega_{A,0}}{\dot{V}_{0}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(C_Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C_{Y,0} = \frac{\dot{V}_{0}C_{Y,feed} + D_{ax} \frac{\pi D^2}{4} \omega_{Y,0}}{\dot{V}_{0}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(C_Z\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C_{Z,0} = \frac{\dot{V}_{0}C_{Z,feed} + D_{ax} \frac{\pi D^2}{4} \omega_{Z,0}}{\dot{V}_{0}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(C_I\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C_{I,0} = \frac{\dot{V}_{0}C_{I,feed} + D_{ax} \frac{\pi D^2}{4} \omega_{I,0}}{\dot{V}_{0}}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(T\)</span></td>
<td style="text-align: center;"><span class="math inline">\(T_0 = \frac{\dot{V}_{feed} \left(C_A \hat{C}_{p,A} + C_Y \hat{C}_{p,Y} + C_Z \hat{C}_{p,X} + C_I \hat{C}_{p,I} \right) T_{feed} + \lambda_{ax} \frac{\pi D^2}{4} \omega_{T,0}}{\dot{V}_{feed} \left(C_A \hat{C}_{p,A} + C_Y \hat{C}_{p,Y} + C_Z \hat{C}_{p,X} + C_I \hat{C}_{p,I} \right)}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(P\)</span></td>
<td style="text-align: center;"><span class="math inline">\(P_0\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><strong>Derivatives Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(z\)</span>, <span class="math inline">\(\omega_A\)</span>, <span class="math inline">\(\omega_Y\)</span>, <span class="math inline">\(\omega_Z\)</span>, <span class="math inline">\(\omega_I\)</span>, <span class="math inline">\(\omega_T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_A\)</span>, <span class="math inline">\(C_Y\)</span>, <span class="math inline">\(C_Z\)</span>, <span class="math inline">\(C_I\)</span>, <span class="math inline">\(T\)</span>, and <span class="math inline">\(P\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\frac{d\omega_A}{dz}\)</span>, <span class="math inline">\(\frac{d\omega_Y}{dz}\)</span>, <span class="math inline">\(\frac{d\omega_Z}{dz}\)</span>, <span class="math inline">\(\frac{d\omega_I}{dz}\)</span>, <span class="math inline">\(\frac{d\omega_T}{dz}\)</span>, <span class="math inline">\(\frac{d\dot{V}}{dz}\)</span>, <span class="math inline">\(\frac{dC_A}{dz}\)</span>, <span class="math inline">\(\frac{dC_Y}{dz}\)</span>, <span class="math inline">\(\frac{dC_Z}{dz}\)</span>, <span class="math inline">\(\frac{dC_I}{dz}\)</span>, <span class="math inline">\(\frac{dT}{dz}\)</span>, and <span class="math inline">\(\frac{dP}{dz}\)</span>.</p>
<p><u>Algorithm</u>:</p>
<p><span class="math display">\[
\frac{d\dot{V}}{dz} = \frac{- \left(M_I \omega_I + M_A \omega_A + M_Y \omega_Y + M_Z \omega_Z \right)}{\left( M_I C_I + M_A C_A + M_Y C_Y + M_Z C_Z\right)
} \tag{8}
\]</span></p>
<p><span class="math display">\[
k_f = k_{0,f} \exp{\left( \frac{-E_f}{RT} \right)} \tag{15}
\]</span></p>
<p><span class="math display">\[
k_r = k_{0,r} \exp{\left( \frac{-E_r}{RT} \right)} \tag{16}
\]</span></p>
<p><span class="math display">\[
P_A = \frac{C_A}{C_A + C_Y + C_Z +C_I}P \tag{17}
\]</span></p>
<p><span class="math display">\[
P_Y = \frac{C_Y}{C_A + C_Y + C_Z +C_I}P \tag{18}
\]</span></p>
<p><span class="math display">\[
P_Z = \frac{C_Z}{C_A + C_Y + C_Z +C_I}P \tag{19}
\]</span></p>
<p><span class="math display">\[
r = k_fP_A - k_rP_YP_Z^3 \tag{2}
\]</span></p>
<p><span class="math display">\[
- D_{ax}\frac{d \omega_A}{d z} + \frac{4 C_A}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_A - r \tag{3}
\]</span></p>
<p><span class="math display">\[
- D_{ax}\frac{d \omega_Y}{d z} + \frac{4 C_Y}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_Y + r \tag{4}
\]</span></p>
<p><span class="math display">\[
- D_{ax}\frac{d \omega_Z}{d z} + \frac{4 C_Z}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_Z + 3r \tag{5}
\]</span></p>
<p><span class="math display">\[
- D_{ax}\frac{d \omega_I}{d z} + \frac{4 C_I}{\pi D^2}\frac{d \dot{V}}{d z} = - \frac{4 \dot{V}}{\pi D^2}\omega_I \tag{6}
\]</span></p>
<p><span class="math display">\[
- \lambda_{ax}\frac{d \omega_T}{d z} =- \frac{4 \dot{V}}{\pi D^2} \left(\sum_i C_i \hat{C}_{p,i}\right) \omega_T + \frac{4U}{D}\left(T_{ex} - T\right) - r \Delta H_j \tag{7}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{V}}{dz} = \frac{- \left(M_I \omega_I + M_A \omega_A + M_Y \omega_Y + M_Z \omega_Z \right)}{\left( M_I C_I + M_A C_A + M_Y C_Y + M_Z C_Z\right)
} \tag{8}
\]</span></p>
<p><span class="math display">\[
\frac{dC_A}{dz} = \omega_A \tag{9}
\]</span></p>
<p><span class="math display">\[
\frac{dC_Y}{dz} = \omega_Y \tag{10}
\]</span></p>
<p><span class="math display">\[
\frac{dC_Z}{dz} = \omega_Z \tag{11}
\]</span></p>
<p><span class="math display">\[
\frac{dC_I}{dz} = \omega_I \tag{12}
\]</span></p>
<p><span class="math display">\[
\frac{dT}{dz} = \omega_T \tag{13}
\]</span></p>
<p><span class="math display">\[
\rho = \sum_i \left(M_i C_i\right) \tag{20}
\]</span></p>
<p><span class="math display">\[
\frac{{dP}}{{dz}} =  - \frac{{1 - \varepsilon }}{{{\varepsilon ^3}}}\frac{{{G^2}}}{{\rho {\Phi _s}{D_p}}}\left[ {\frac{{150\left( {1 - \varepsilon } \right)\mu }}{{{\Phi _s}{D_p}G}} + 1.75} \right] \tag{14}
\]</span></p>
<p><strong>Coupled Values Equations</strong></p>
<p><span class="math display">\[
\left(\omega_{A,0}, \omega_{Y,0}, \omega_{Z,0}, \omega_{I,0}, \omega_{T,0}\right)\,:\, \omega_{A,1} = 0 = \epsilon_A \tag{26}
\]</span></p>
<p><span class="math display">\[
\left(\omega_{A,0}, \omega_{Y,0}, \omega_{Z,0}, \omega_{I,0}, \omega_{T,0}\right)\,:\, \omega_{Y,1} = 0 = \epsilon_Y \tag{27}
\]</span></p>
<p><span class="math display">\[
\left(\omega_{A,0}, \omega_{Y,0}, \omega_{Z,0}, \omega_{I,0}, \omega_{T,0}\right)\,:\, \omega_{Z,1} = 0 = \epsilon_Z \tag{28}
\]</span></p>
<p><span class="math display">\[
\left(\omega_{A,0}, \omega_{Y,0}, \omega_{Z,0}, \omega_{I,0}, \omega_{T,0}\right)\,:\, \omega_{I,1} = 0 = \epsilon_I \tag{29}
\]</span></p>
<p><span class="math display">\[
\left(\omega_{A,0}, \omega_{Y,0}, \omega_{Z,0}, \omega_{I,0}, \omega_{T,0}\right)\,:\, \omega_{T,1} = 0 = \epsilon_T \tag{30}
\]</span></p>
<p><strong>Coupled Values Guess</strong></p>
<p><span class="math display">\[
\omega_{A,0,guess} = -\frac{0.5 C_{A,feed}}{L} \tag{31}
\]</span></p>
<p><span class="math display">\[
\omega_{Y,0,guess} = \frac{0.5 C_{A,feed}}{L} \tag{32}
\]</span></p>
<p><span class="math display">\[
\omega_{Z,0,guess} = 3\frac{0.5 C_{A,feed}}{L} \tag{33}
\]</span></p>
<p><span class="math display">\[
\omega_{I,0,guess} = 0.0 \tag{34}
\]</span></p>
<p><span class="math display">\[
\omega_{T,0,guess} = \frac{10}{L} \tag{35}
\]</span></p>
<p><strong>Coupled Values Residuals Function</strong></p>
<p><u>Arguments</u>: <span class="math inline">\(\omega_{A,0}\)</span>, <span class="math inline">\(\omega_{Y,0}\)</span>, <span class="math inline">\(\omega_{Z,0}\)</span>, <span class="math inline">\(\omega_{I,0}\)</span>, and <span class="math inline">\(\omega_{T,0}\)</span>.</p>
<p><u>Returns</u>: <span class="math inline">\(\epsilon_A\)</span>, <span class="math inline">\(\epsilon_Y\)</span>, <span class="math inline">\(\epsilon_Z\)</span>, <span class="math inline">\(\epsilon_I\)</span>, and <span class="math inline">\(\epsilon_T\)</span>.</p>
<p><u>Algorithm</u>:</p>
<ol type="1">
<li>Calculate <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(C_{I,0}\)</span>, <span class="math inline">\(T_0\)</span>, and <span class="math inline">\(\dot{V}_0\)</span>, <a href="#tbl-example_22_4_2_initial_values" class="quarto-xref">Table&nbsp;<span>22.2</span></a>.</li>
<li>Get corresponding sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(C_A\)</span>, <span class="math inline">\(C_Y\)</span>, <span class="math inline">\(C_Z\)</span>, <span class="math inline">\(C_I\)</span>, <span class="math inline">\(T\)</span>, <span class="math inline">\(\omega_A\)</span>, <span class="math inline">\(\omega_Y\)</span>, <span class="math inline">\(\omega_Z\)</span>, <span class="math inline">\(\omega_I\)</span>, <span class="math inline">\(\omega_T\)</span>, <span class="math inline">\(\dot{V}\)</span>, and <span class="math inline">\(P\)</span> spanning the range from <span class="math inline">\(z=0\)</span> to <span class="math inline">\(z=L\)</span> by calling an IVODE solver with the initial values, stopping criterion, and derivatives function as arguments.</li>
<li>Use the returned values of <span class="math inline">\(\omega_A\)</span>, <span class="math inline">\(\omega_Y\)</span>, <span class="math inline">\(\omega_Z\)</span>, <span class="math inline">\(\omega_I\)</span>, and <span class="math inline">\(\omega_T\)</span> at <span class="math inline">\(z=L\)</span> to evaluate the residuals using equations (26) through (30).</li>
</ol>
<p><strong>Reactor Function</strong></p>
<p><u>Arguments</u>: none.</p>
<p><u>Returns</u>: sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(C_A\)</span>, <span class="math inline">\(C_Y\)</span>, <span class="math inline">\(C_Z\)</span>, <span class="math inline">\(C_I\)</span>, <span class="math inline">\(T\)</span>, <span class="math inline">\(\omega_A\)</span>, <span class="math inline">\(\omega_Y\)</span>, <span class="math inline">\(\omega_Z\)</span>, <span class="math inline">\(\omega_I\)</span>, <span class="math inline">\(\omega_T\)</span>, <span class="math inline">\(\dot{V}\)</span>, and <span class="math inline">\(P\)</span> spanning the range from <span class="math inline">\(z=0\)</span> to <span class="math inline">\(z=L\)</span>.</p>
<p><u>Algorithm</u>:</p>
<ol type="1">
<li>Guess values for the coupled values, e. g. using equations (31) through (35).</li>
<li>Get <span class="math inline">\(\omega_{A,0}\)</span>, <span class="math inline">\(\omega_{Y,0}\)</span>, <span class="math inline">\(\omega_{Z,0}\)</span>, <span class="math inline">\(\omega_{I,0}\)</span>, and <span class="math inline">\(\omega_{T,0}\)</span> by calling an ATE solver with the guess and the residuals function as arguments.</li>
<li>Calculate the initial values and stopping criterion, <a href="#tbl-example_22_4_2_initial_values" class="quarto-xref">Table&nbsp;<span>22.2</span></a>.</li>
<li>Get and return sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(C_A\)</span>, <span class="math inline">\(C_Y\)</span>, <span class="math inline">\(C_Z\)</span>, <span class="math inline">\(C_I\)</span>, <span class="math inline">\(T\)</span>, <span class="math inline">\(\omega_A\)</span>, <span class="math inline">\(\omega_Y\)</span>, <span class="math inline">\(\omega_Z\)</span>, <span class="math inline">\(\omega_I\)</span>, <span class="math inline">\(\omega_T\)</span>, <span class="math inline">\(\dot{V}\)</span>, and <span class="math inline">\(P\)</span> spanning the range from <span class="math inline">\(z=0\)</span> to <span class="math inline">\(z=L\)</span> by calling an IVODE solver with the initial values, stopping criterion, and derivatives function as arguments.</li>
</ol>
<center>
<strong>Quantities of Interest</strong>
</center>
<ol type="1">
<li>Call the reactor function to get sets of values of <span class="math inline">\(z\)</span>, <span class="math inline">\(C_A\)</span>, <span class="math inline">\(C_Y\)</span>, <span class="math inline">\(C_Z\)</span>, <span class="math inline">\(C_I\)</span>, <span class="math inline">\(T\)</span>, <span class="math inline">\(\omega_A\)</span>, <span class="math inline">\(\omega_Y\)</span>, <span class="math inline">\(\omega_Z\)</span>, <span class="math inline">\(\omega_I\)</span>, <span class="math inline">\(\omega_T\)</span>, <span class="math inline">\(\dot{V}\)</span>, and <span class="math inline">\(P\)</span> spanning the range from <span class="math inline">\(z=0\)</span> to <span class="math inline">\(z=L\)</span>.</li>
<li>Use the values at <span class="math inline">\(z=L\)</span> to calculate the quantities of interest.</li>
</ol>
<p><span class="math display">\[
T_1 = T\big\vert_{z=L} \tag{45}
\]</span></p>
<p><span class="math display">\[
P_1 = P\big\vert_{z=L} \tag{46}
\]</span></p>
<p><span class="math display">\[
f_A = \frac{\dot{V}_0 C_{A,feed} - \dot{V}\big\vert_{z=L} C_A\big\vert_{z=L}}{\dot{V}_0 C_{A,feed}} \tag{47}
\]</span></p>
</section>
<section id="results-analysis-and-discussion" class="level4" data-number="22.4.2.3">
<h4 data-number="22.4.2.3" class="anchored" data-anchor-id="results-analysis-and-discussion"><span class="header-section-number">22.4.2.3</span> Results, Analysis, and Discussion</h4>
<p>The calculations were performed as described above.</p>
</section>
</section>
</section>
<section id="symbols-used-in-sec-7_axial_dispersion" class="level2" data-number="22.5">
<h2 data-number="22.5" class="anchored" data-anchor-id="symbols-used-in-sec-7_axial_dispersion"><span class="header-section-number">22.5</span> Symbols Used in <a href="#sec-7_axial_dispersion" class="quarto-xref"><span>Chapter 22</span></a></h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: left;">Time.</td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./section_7_intro.html" class="pagination-link" aria-label="Modeling Non-Ideal Reactors">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Modeling Non-Ideal Reactors</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./section_7_segregated_flow_model.html" class="pagination-link" aria-label="Segregated Flow Reactor Models">
        <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Segregated Flow Reactor Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>