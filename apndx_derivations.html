<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix E — Derivation of Model Equations – Reaction Engineering Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./apndx_mathematics.html" rel="next">
<link href="./apndx_kinetics_theories.html" rel="prev">
<link href="./Graphics/BuffaloBadger_16_16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="http://buffalobadger.github.io" class="navbar-brand navbar-brand-logo">
    <img src="./Graphics/Banner.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/RE_Basics"> 
<span class="menu-text">Reaction Engineering Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/SCoRE"> 
<span class="menu-text">SCoRE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/ToTaL_Engineering"> 
<span class="menu-text">ToTaL Engineering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/The_Sett"> 
<span class="menu-text">The Sett</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./apndx_prereq_knowledge.html">Appendices</a></li><li class="breadcrumb-item"><a href="./apndx_derivations.html"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Derivation of Model Equations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_intro_safety_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reaction Engineering, Ethics and Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_rxns_reactors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reactions and Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_reaction_progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reaction Progress</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Rate Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_rates_and_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reaction Rates and Rate Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reaction Mechanisms and Mechanistic Rate Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Reaction Engineering Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_react_eng_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reaction Engineering Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_reaction_engineering_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reaction Engineering Tasks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_formulating_calcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Completing Reaction Engineering Tasks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_bstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">BSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_sbstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">SBSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_non_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design of Non-Continuous Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_cstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_pfr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling Ideal Reactor Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_reactor_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reactor Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_thermally_backmixed_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thermally Back-Mixed PFRs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_recycle_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recycle PFRs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Kinetics Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_data_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_bstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_cstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_pfr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling Non-Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_age_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Age Distribution Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_segregated_flow_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">A Segregated Flow Reactor Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_zoned_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Zoned Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_prereq_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prerequisite Knowledge</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_nomenclature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Terminology and Sign Conventions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_reaction_thermo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Reaction Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_kinetics_theories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Kinetics Theories{#sec-apndx_kin_theories}</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_derivations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Derivation of Model Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_mathematics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Mathematics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_useful_eqns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Frequently Used Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-apndx_heat_exch" id="toc-sec-apndx_heat_exch" class="nav-link active" data-scroll-target="#sec-apndx_heat_exch"><span class="header-section-number">E.1</span> Reactor Heat Exchange</a>
  <ul class="collapse">
  <li><a href="#mass-and-energy-balances-on-the-heat-exchange-fluid" id="toc-mass-and-energy-balances-on-the-heat-exchange-fluid" class="nav-link" data-scroll-target="#mass-and-energy-balances-on-the-heat-exchange-fluid"><span class="header-section-number">E.1.1</span> Mass and Energy Balances on the Heat Exchange Fluid</a></li>
  <li><a href="#heat-exchange-with-the-reacting-fluid-in-a-stirred-tank" id="toc-heat-exchange-with-the-reacting-fluid-in-a-stirred-tank" class="nav-link" data-scroll-target="#heat-exchange-with-the-reacting-fluid-in-a-stirred-tank"><span class="header-section-number">E.1.2</span> Heat Exchange with the Reacting Fluid in a Stirred Tank</a></li>
  <li><a href="#heat-exchange-with-the-reacting-fluid-in-a-tubular-reactor" id="toc-heat-exchange-with-the-reacting-fluid-in-a-tubular-reactor" class="nav-link" data-scroll-target="#heat-exchange-with-the-reacting-fluid-in-a-tubular-reactor"><span class="header-section-number">E.1.3</span> Heat Exchange with the Reacting Fluid in a Tubular Reactor</a></li>
  </ul></li>
  <li><a href="#sec-apndx_BSTR_balances" id="toc-sec-apndx_BSTR_balances" class="nav-link" data-scroll-target="#sec-apndx_BSTR_balances"><span class="header-section-number">E.2</span> BSTR Mole and Energy Balances</a>
  <ul class="collapse">
  <li><a href="#the-bstr-mole-balance" id="toc-the-bstr-mole-balance" class="nav-link" data-scroll-target="#the-bstr-mole-balance"><span class="header-section-number">E.2.1</span> The BSTR Mole Balance</a></li>
  <li><a href="#the-bstr-energy-balance" id="toc-the-bstr-energy-balance" class="nav-link" data-scroll-target="#the-bstr-energy-balance"><span class="header-section-number">E.2.2</span> The BSTR Energy Balance</a></li>
  </ul></li>
  <li><a href="#sec-apndx_SBSTR_balances" id="toc-sec-apndx_SBSTR_balances" class="nav-link" data-scroll-target="#sec-apndx_SBSTR_balances"><span class="header-section-number">E.3</span> SBSTR Mole and Energy Balances</a>
  <ul class="collapse">
  <li><a href="#the-sbstr-mole-balance" id="toc-the-sbstr-mole-balance" class="nav-link" data-scroll-target="#the-sbstr-mole-balance"><span class="header-section-number">E.3.1</span> The SBSTR Mole Balance</a></li>
  <li><a href="#the-sbstr-energy-balance" id="toc-the-sbstr-energy-balance" class="nav-link" data-scroll-target="#the-sbstr-energy-balance"><span class="header-section-number">E.3.2</span> The SBSTR Energy Balance</a></li>
  </ul></li>
  <li><a href="#sec-apndx_CSTR_balances" id="toc-sec-apndx_CSTR_balances" class="nav-link" data-scroll-target="#sec-apndx_CSTR_balances"><span class="header-section-number">E.4</span> CSTR Mole and Energy Balances</a>
  <ul class="collapse">
  <li><a href="#the-cstr-mole-balance" id="toc-the-cstr-mole-balance" class="nav-link" data-scroll-target="#the-cstr-mole-balance"><span class="header-section-number">E.4.1</span> The CSTR Mole Balance</a></li>
  <li><a href="#the-cstr-energy-balance" id="toc-the-cstr-energy-balance" class="nav-link" data-scroll-target="#the-cstr-energy-balance"><span class="header-section-number">E.4.2</span> The CSTR Energy Balance</a></li>
  </ul></li>
  <li><a href="#sec-apndx_PFR_balances" id="toc-sec-apndx_PFR_balances" class="nav-link" data-scroll-target="#sec-apndx_PFR_balances"><span class="header-section-number">E.5</span> PFR Mole and Energy Balances</a>
  <ul class="collapse">
  <li><a href="#the-pfr-mole-balance" id="toc-the-pfr-mole-balance" class="nav-link" data-scroll-target="#the-pfr-mole-balance"><span class="header-section-number">E.5.1</span> The PFR Mole Balance</a></li>
  <li><a href="#the-pfr-energy-balance" id="toc-the-pfr-energy-balance" class="nav-link" data-scroll-target="#the-pfr-energy-balance"><span class="header-section-number">E.5.2</span> The PFR Energy Balance</a></li>
  </ul></li>
  <li><a href="#sec-apndx_axial_dispersion" id="toc-sec-apndx_axial_dispersion" class="nav-link" data-scroll-target="#sec-apndx_axial_dispersion"><span class="header-section-number">E.6</span> Axial Dispersion Reactor Models</a>
  <ul class="collapse">
  <li><a href="#axial-dispersion-reactor-design-equations" id="toc-axial-dispersion-reactor-design-equations" class="nav-link" data-scroll-target="#axial-dispersion-reactor-design-equations"><span class="header-section-number">E.6.1</span> Axial Dispersion Reactor Design Equations</a></li>
  <li><a href="#first-order-steady-state-empirical-axial-dispersion-model" id="toc-first-order-steady-state-empirical-axial-dispersion-model" class="nav-link" data-scroll-target="#first-order-steady-state-empirical-axial-dispersion-model"><span class="header-section-number">E.6.2</span> First-Order, Steady-State Empirical Axial Dispersion Model</a></li>
  </ul></li>
  <li><a href="#symbols-used-in-this-appendix" id="toc-symbols-used-in-this-appendix" class="nav-link" data-scroll-target="#symbols-used-in-this-appendix"><span class="header-section-number">E.7</span> Symbols Used in This Appendix</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./apndx_prereq_knowledge.html">Appendices</a></li><li class="breadcrumb-item"><a href="./apndx_derivations.html"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Derivation of Model Equations</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-apndx_derivations" class="quarto-section-identifier">Appendix E — Derivation of Model Equations</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Reaction engineering analysis requires models for reactors. This appendix derives model equations used in <em>Reaction Engineering Basics.</em> It begins with equations for modeling heat exchange in reactors, because those equations can be included in the design equations for any of the ideal reactors. Next the mole and energy balances are derived for ideal batch, semi-batch and continuous stirred tanks and for ideal plug flow reactors. Finally, the model equations for the ideal plug flow reactor are modified to allow for mixing in the axial direction.</p>
<section id="sec-apndx_heat_exch" class="level2" data-number="E.1">
<h2 data-number="E.1" class="anchored" data-anchor-id="sec-apndx_heat_exch"><span class="header-section-number">E.1</span> Reactor Heat Exchange</h2>
<p>There are many different system geometries and heat exchanger types that can be used to add or remove heat from a reactor. In order to maintain a focus on the reaction, <em>Reaction Engineering Basics</em> problems involving heat exchange always use a perfectly mixed shell or jacket geometry through which a heat exchange fluid flows. The heat exchange fluid exchanges <em>either</em> sensible heat <em>or</em> latent heat, but <em>not both</em>. This appendix presents a brief overview on using this form of heat exchange with stirred tanks and tubular reactors.</p>
<section id="mass-and-energy-balances-on-the-heat-exchange-fluid" class="level3" data-number="E.1.1">
<h3 data-number="E.1.1" class="anchored" data-anchor-id="mass-and-energy-balances-on-the-heat-exchange-fluid"><span class="header-section-number">E.1.1</span> Mass and Energy Balances on the Heat Exchange Fluid</h3>
<p><a href="#fig-heat-exch-stirred" class="quarto-xref">Figure&nbsp;<span>E.1</span></a> depicts batch, semi-batch and continuous stirred tank reactors with heat exchange. <a href="#fig-heat-exch-tube" class="quarto-xref">Figure&nbsp;<span>E.2</span></a> similarly depicts a tubular reactor with heat exchange. The figures are not intended to convey the actual geometry of the reactors. The blue shading represents the reacting fluid within the reactor and the yellow shading represents perfectly mixed heat exchange fluid within the shell/jacket. The red line represents the wall separating the reacting fluid from the heat exchange fluid. Heat is transferred through this wall, while all other walls are assumed to be perfectly insulated.</p>
<div id="fig-heat-exch-stirred" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heat-exch-stirred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-heat-exch-stirred" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-heat-exch-batch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-heat-exch-batch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Graphics/bstr_non_adiabatic.png" class="img-fluid figure-img" data-ref-parent="fig-heat-exch-stirred">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-heat-exch-batch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Batch
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-heat-exch-stirred" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-heat-exch-semi" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-heat-exch-semi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Graphics/sbstr_non_adiabatic.png" class="img-fluid figure-img" data-ref-parent="fig-heat-exch-stirred">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-heat-exch-semi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Semi-Batch
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-heat-exch-stirred" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-heat-exch-cstr" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-heat-exch-cstr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Graphics/cstr_non_adiabatic.png" class="img-fluid figure-img" data-ref-parent="fig-heat-exch-stirred">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-heat-exch-cstr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Continuous
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heat-exch-stirred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.1: Stirred Tank Heat Exchange
</figcaption>
</figure>
</div>
<div id="fig-heat-exch-tube" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heat-exch-tube-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Graphics/pfr_non_adiabatic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heat-exch-tube-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.2: Tubular Reactor with Heat Exchange
</figcaption>
</figure>
</div>
<p>The inputs, outputs and flow patterns on the reaction side differ for each of the four reactors shown in <a href="#fig-heat-exch-stirred" class="quarto-xref">Figures&nbsp;<span>E.1</span></a> and <a href="#fig-heat-exch-tube" class="quarto-xref"><span>E.2</span></a>. However, the inputs, outputs and flow pattern on the shell/jacket sides of the four reactors are identical. Consequently, the mass balance and the energy balance on the heat exchange fluid is the same for all four reactors.</p>
<section id="mass-balance-on-the-heat-exchange-fluid" class="level4" data-number="E.1.1.1">
<h4 data-number="E.1.1.1" class="anchored" data-anchor-id="mass-balance-on-the-heat-exchange-fluid"><span class="header-section-number">E.1.1.1</span> Mass Balance on the Heat Exchange Fluid</h4>
<p>In <em>Reaction Engineering Basics</em> it is always assumed that there is no accumulation of mass in the reactor shell/jacket. Mass cannot be generated (other than by nuclear reactions), so there is no generation of mass within the reactor shell/jacket, either. Consequently the inlet and outlet mass flow rates are always equal, as shown in the figures. Note that the mass flow rate of the heat exchange fluid can vary with time, but any change in the inlet mass flow rate is accompanied instantaneously by an equal change in the outlet mass flow rate.</p>
</section>
<section id="energy-balance-on-the-heat-exchange-fluid" class="level4" data-number="E.1.1.2">
<h4 data-number="E.1.1.2" class="anchored" data-anchor-id="energy-balance-on-the-heat-exchange-fluid"><span class="header-section-number">E.1.1.2</span> Energy Balance on the Heat Exchange Fluid</h4>
<p>As noted, in <em>Reaction Engineering Basics</em> the heat exchange fluid undergoes <em>either</em> a temperature change <em>or</em> a phase change, <em>but not both</em>. The form of the energy balance is different for each of these situations.</p>
<p><strong>Energy Balance for Exchange of Sensible Heat</strong></p>
<p>With the assumptions of no mass accumulation in the shell/jacket and that the heat exchange fluid does not undergo phase change, an energy balance on the heat exchange fluid takes the form shown in <a href="#eq-ext_fluid_energy_bal_sens" class="quarto-xref">Equation&nbsp;<span>E.1</span></a>.</p>
<p><span id="eq-ext_fluid_energy_bal_sens"><span class="math display">\[
\rho_{ex} V_{ex} \tilde C_{p,ex}\frac{dT_{ex}}{dt} = \dot Q_{ex} - \dot m_{ex} \int_{T_{ex,in}}^{T_{ex}} \tilde C_{p,ex}dT
\tag{E.1}\]</span></span></p>
<p><strong>Energy Balance for Exchange of Latent Heat</strong></p>
<p>Again assuming no accumulation of mass in the shell/jacket, and additionally assuming that the temperature of the heat exchange fluid does not change, an energy balance on the heat exchange fluid takes the form shown in <a href="#eq-ext_fluid_energy_bal_latent" class="quarto-xref">Equation&nbsp;<span>E.2</span></a>. Typically, if the reacting fluid is being heated, the heat exchange fluid enters the shell/jacket as a saturated vapor. Within the shell/jacket, some fraction, <span class="math inline">\(\gamma\)</span>, of the heat exchange fluid condenses. This occurs at a constant and known temperature, namely, the boiling point. Less commonly, if the reacting fluid is being cooled by boiling the heat exchange fluid, the heat exchange fluid enters the shell/jacket as a saturated liquid, and within the shell/jacket, some fraction of the heat exchange fluid vaporizes.</p>
<p><span id="eq-ext_fluid_energy_bal_latent"><span class="math display">\[
\frac{\rho_{ex} V_{ex} \Delta H_{\text{latent},ex}^0}{M_{ex}} \frac{d \gamma}{dt} = \dot Q_{ex} - \gamma \dot m_{ex} \frac{\Delta H_{\text{latent},ex}^0}{M_{ex}}
\tag{E.2}\]</span></span></p>
<p>The maximum <em>latent</em> heat that can be provided or removed corresponds to complete condensation or complete vaporization of the heat exchange fluid. That is, the maximum amount of heat is exchanged with <span class="math inline">\(\gamma\)</span> is equal to 1.</p>
<p>In both <a href="#eq-ext_fluid_energy_bal_sens" class="quarto-xref">Equation&nbsp;<span>E.1</span></a> and <a href="#eq-ext_fluid_energy_bal_latent" class="quarto-xref">Equation&nbsp;<span>E.2</span></a>, the rate of heat input into the reacting fluid, <span class="math inline">\(\dot Q\)</span>, and the rate of heat input to the shell/jacket, <span class="math inline">\(\dot Q_{ex}\)</span> are related as shown in <a href="#eq-equal-heat-exchange" class="quarto-xref">Equation&nbsp;<span>E.3</span></a>.</p>
<p><span id="eq-equal-heat-exchange"><span class="math display">\[
\dot Q_{ex} = - \dot Q
\tag{E.3}\]</span></span></p>
</section>
</section>
<section id="heat-exchange-with-the-reacting-fluid-in-a-stirred-tank" class="level3" data-number="E.1.2">
<h3 data-number="E.1.2" class="anchored" data-anchor-id="heat-exchange-with-the-reacting-fluid-in-a-stirred-tank"><span class="header-section-number">E.1.2</span> Heat Exchange with the Reacting Fluid in a Stirred Tank</h3>
<p>In stirred tanks, <a href="#fig-heat-exch-stirred" class="quarto-xref">Figure&nbsp;<span>E.1</span></a>, the reacting fluid is perfectly mixed. As a consequence, at any instant in time, the temperature, <span class="math inline">\(T\)</span> is the same everywhere within the blue volume. Similarly, because the heat exchange fluid is perfectly mixed, the temperature, <span class="math inline">\(T_{ex}\)</span> is the same everywhere within the yellow volume. Consequently, the instantaneous rate of heat transfer from the heat exchange fluid to the reacting fluid, <span class="math inline">\(\dot Q\)</span>, can be calculated using the overall heat transfer coefficient, <span class="math inline">\(U\)</span>, and the area, <span class="math inline">\(A\)</span>, of the wall separating the two sides of the reactor, <a href="#eq-heat-trans-rate" class="quarto-xref">Equation&nbsp;<span>E.4</span></a>.</p>
<p><span id="eq-heat-trans-rate"><span class="math display">\[
\dot Q = UA\left(T_{ex} - T\right)
\tag{E.4}\]</span></span></p>
<p>Of the stirred tank reactor types, only CSTRs can operate at steady state. When a CSTR is operating at steady state, the derivative in either of the energy balances, <a href="#eq-ext_fluid_energy_bal_sens" class="quarto-xref">Equation&nbsp;<span>E.1</span></a> or <a href="#eq-ext_fluid_energy_bal_latent" class="quarto-xref">Equation&nbsp;<span>E.2</span></a>, is equal to zero.</p>
</section>
<section id="heat-exchange-with-the-reacting-fluid-in-a-tubular-reactor" class="level3" data-number="E.1.3">
<h3 data-number="E.1.3" class="anchored" data-anchor-id="heat-exchange-with-the-reacting-fluid-in-a-tubular-reactor"><span class="header-section-number">E.1.3</span> Heat Exchange with the Reacting Fluid in a Tubular Reactor</h3>
<p>In a tubular reactor, the reaction side fluid is perfectly mixed in the radial direction, but it is completely unmixed in the axial direction. The gradient in the blue shading in <a href="#fig-heat-exch-tube" class="quarto-xref">Figure&nbsp;<span>E.2</span></a> is meant to convey this point. As a consequence, the temperature difference between the reacting fluid and the heat exchange fluid changes along the length of the tube. That means that the rate of heat transfer also varies along the length of the tube. In <em>Reaction Engineering Basics</em>, it is assumed that the overall, local heat transfer coefficient, <span class="math inline">\(U\)</span>, is constant along the length of the reactor so that the total heat input to the reacting fluid from the heat exchange fluid is given by <a href="#eq-heat-trans-rate-tube" class="quarto-xref">Equation&nbsp;<span>E.5</span></a>.</p>
<p><span id="eq-heat-trans-rate-tube"><span class="math display">\[
\dot Q = \int_0^L \pi DU\left( T_{ex} - T \right)dz
\tag{E.5}\]</span></span></p>
<p>As is the case for steady-state CSTR, when a tubular reactor operates at steady state, the derivative in either of the energy balances, <a href="#eq-ext_fluid_energy_bal_sens" class="quarto-xref">Equation&nbsp;<span>E.1</span></a> or <a href="#eq-ext_fluid_energy_bal_latent" class="quarto-xref">Equation&nbsp;<span>E.2</span></a>, is equal to zero.</p>
</section>
</section>
<section id="sec-apndx_BSTR_balances" class="level2" data-number="E.2">
<h2 data-number="E.2" class="anchored" data-anchor-id="sec-apndx_BSTR_balances"><span class="header-section-number">E.2</span> BSTR Mole and Energy Balances</h2>
<p>The BSTR model makes the following assumptions.</p>
<ul>
<li>The fluid within the system is perfectly mixed.</li>
<li>Mass neither enters nor leaves the system while the reactions are taking place.</li>
</ul>
<p>During the derivation of the forms of the BSTR mole and energy balances used in <em>Reaction Engineering Basics</em>, the following additional assumptions are made.</p>
<ul>
<li>Kinetic energy terms and gravitational potential energy terms are negligible.</li>
<li>Pressure variation associated with the hydrostatic head can be ignored.</li>
<li>Reaction rates are normalized per fluid volume.</li>
<li>Exchange of energy with the surroundings takes the form of heat or mechanical work associated with shafts, moving boundaries, etc.</li>
<li>The fluid mixture is ideal.
<ul>
<li>Both <span class="math inline">\(\Delta H\)</span> and <span class="math inline">\(\Delta V\)</span> of mixing are zero.</li>
</ul></li>
<li>No phase changes occur within the system while the reactions are taking place.</li>
</ul>
<section id="the-bstr-mole-balance" class="level3" data-number="E.2.1">
<h3 data-number="E.2.1" class="anchored" data-anchor-id="the-bstr-mole-balance"><span class="header-section-number">E.2.1</span> The BSTR Mole Balance</h3>
<p>The system being modeled is the volume of the fluid within the reactor at any instant in time. The derivation of the BSTR mole balance begins with a general balance equation written for the moles of any one species, <span class="math inline">\(i\)</span>, present in that system.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>In a BSTR no mass enters or leaves the reactor while the reaction is occurring, so the Input Rate and Output Rate terms are equal to zero.</p>
<p><span class="math display">\[\text{Input Rate} = \text{Output Rate} = 0\]</span></p>
<p>With the assumption that the rate of reaction is normalized per unit volume of the reacting fluid, the rate of generation of any reagent, <span class="math inline">\(i\)</span>, due to the occurrence of reaction, <span class="math inline">\(j\)</span>, is equal to <span class="math inline">\(\nu _{i,j}V r_j\)</span>. Summing the rate of generation of <span class="math inline">\(i\)</span> over all reactions taking place then gives Generation Rate term.</p>
<p><span class="math display">\[\text{Generation Rate} = V \sum_j \nu_{i,j}r_j\]</span></p>
<p>The instantaneous Accumulation Rate of <span class="math inline">\(i\)</span> is simply the derrivative on <span class="math inline">\(n_i\)</span> with respect to <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{dn_i}{dt}\]</span></p>
<p>Substituting into the general balance equation and rearranging yields the BSTR mole balance.</p>
<p><span class="math display">\[
\frac{dn_i}{dt} = V \sum_j \nu_{i,j}r_j
\]</span></p>
</section>
<section id="the-bstr-energy-balance" class="level3" data-number="E.2.2">
<h3 data-number="E.2.2" class="anchored" data-anchor-id="the-bstr-energy-balance"><span class="header-section-number">E.2.2</span> The BSTR Energy Balance</h3>
<p>The derivation of the BSTR energy balance begins with a general balance equation, written for energy at any one instant of time during the operation of the reactor.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>While no <em>mass</em> enters or leaves a BSTR while the reaction is occurring, it is possible for <em>energy</em> to enter or leave it. Here any energy that enters or leaves the system is assumed to do so either as heat or as mechanical work. The variable, <span class="math inline">\(\dot Q\)</span>, is used to represent the instantaneous net rate of heat <em>input</em> to the reactor from the surroundings. If heat actually leaves the reactor, <span class="math inline">\(\dot Q\)</span> will be negative.</p>
<p><span class="math display">\[\text{Input Rate} = \dot Q\]</span></p>
<p>The variable, <span class="math inline">\(\dot W\)</span>, is used to represent the instantaneous net rate at which the reactor performs work on the surroundings.</p>
<p><span class="math display">\[\text{Output Rate} = \dot W\]</span></p>
<p>In the absence of nuclear reactions energy cannot be generated, so the Generation Rate is equal to zero. (The heat of reaction is a result of the transformation of chemical potential energy to heat, and not energy generation.)</p>
<p><span class="math display">\[\text{Generation Rate} = 0\]</span></p>
<p>With the assumption that kinetic and potential energy terms are negligible, accumulation of energy is limited to the form of internal (chemical) energy. Letting <span class="math inline">\(\hat u_i\)</span> represent the molar specific internal energy of reagent <span class="math inline">\(i\)</span>, the instantaneous internal energy of <span class="math inline">\(i\)</span> is then <span class="math inline">\(n_i \hat u_i\)</span>. With the assumption that the fluid is an ideal mixture (no heat of mixing), the total instantaneous internal energy is simply the sum of the instantaneous internal energies of all reagents, <span class="math inline">\(\sum_i n_i \hat u_i\)</span>, and by definition, the instantaneous rate of accumulation of internal energy is the time derivative of instantaneous internal energy.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>Substitution of these terms into the general balance equation leads to a form of the BSTR energy balance that isn’t particularly useful because it is expressed in terms of specific internal energies.</p>
<p><span class="math display">\[\dot Q = \dot W + \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>This equation can be rearranged and the derivative taken inside the summation.</p>
<p><span class="math display">\[\sum_i \frac{d}{dt} \left(  n_i \hat u_i \right) = \dot Q - \dot W\]</span></p>
<p>The specific molar internal energy of each reagent can be expressed in terms of its specific molar enthalpy and volume.</p>
<p><span class="math display">\[\sum_i \frac{d}{dt} \left(  n_i \left(\hat h_i - P \hat V_i \right) \right) = \dot Q - \dot W\]</span></p>
<p>The distributive property of multiplication then can be applied.</p>
<p><span class="math display">\[\sum_i \frac{d}{dt} \left(  n_i \hat h_i - n_iP \hat V_i  \right) = \dot Q - \dot W\]</span></p>
<p>The derivative of the difference is then equal to the difference of the derivatives.</p>
<p><span class="math display">\[\sum_i \left( \frac{d}{dt} \left(  n_i \hat h_i \right) -\frac{d}{dt} \left( n_iP \hat V_i  \right) \right) = \dot Q - \dot W\]</span></p>
<p>The summation can be separated into two sums.</p>
<p><span class="math display">\[\sum_i \frac{d}{dt} \left(  n_i \hat h_i \right) - \sum_i \frac{d}{dt} \left( n_iP \hat V_i  \right)  = \dot Q - \dot W\]</span></p>
<p>The chain rule for differentiation can be applied to both the first and second terms.</p>
<p><span class="math display">\[ \sum_i n_i \frac{d\hat h_i}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - \frac{dP}{dt} \sum_i \left(  n_i \hat V_i \right) - P \sum_i \frac{d}{dt}\left(  n_i \hat V_i \right)  = \dot Q - \dot W\]</span></p>
<p>With the assumption that the fluid is an ideal mixture (no volume change upon mixing), <span class="math inline">\(\sum_i \left(  n_i \hat V_i \right) = V\)</span> in the third term.</p>
<p><span class="math display">\[ \sum_i n_i \frac{d\hat h_i}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - V\frac{dP}{dt}  - P \sum_i \frac{d}{dt}\left(  n_i \hat V_i \right)  = \dot Q - \dot W\]</span></p>
<p>In the fourth term, the sum of the derivatives can be replaced with the derivative of the sum.</p>
<p><span class="math display">\[ \sum_i n_i \frac{d\hat h_i}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - V\frac{dP}{dt}  - P  \frac{d}{dt}\sum_i\left(  n_i \hat V_i \right)  = \dot Q - \dot W\]</span></p>
<p>Then in the fourth term, as before, <span class="math inline">\(\sum_i \left(  n_i \hat V_i \right) = V\)</span>, because the mixture has been assumed to be ideal.</p>
<p><span class="math display">\[ \sum_i n_i \frac{d\hat h_i}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>With the assumption that no phase changes occur while the reaction is taking place, the change in specific enthalpy involves only sensible heat, <span class="math inline">\(d\hat h_i = \hat C_{p,i}dT\)</span>.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + \sum_i \hat h_i \frac{dn_i}{dt} - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>The BSTR mole balance can be used to express derivative of the moles of <span class="math inline">\(i\)</span> in terms of the reaction rates.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + \sum_i \hat h_i V \sum_j \nu_{i,j}r_j - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>In the second term, the distributive property of multiplication can be applied and the volume can be factored out of the summation.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + V\sum_i  \sum_j \nu_{i,j}\hat h_i r_j - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>In the second term, the order of the summations can be switched and the rate can be factored out of the inner sum.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + V \sum_j r_j \sum_i \nu_{i,j}\hat h_i  - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>With the assumption of an ideal mixture (no heat of mixing), the inner sum in the second term is equal to the standard heat of reaction, <span class="math inline">\(\sum_i \nu_{i,j}\hat h_i = \Delta H_j\)</span>.</p>
<p><span class="math display">\[ \left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} + V \sum_j \left(r_j \Delta H_j \right)  - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W\]</span></p>
<p>Rearranging to put all of the derivatives on one side of the equation leads to a more useful form of the BSTR energy balance where the temperature, pressure and volume are used instead of specific internal energies.</p>
<p><span class="math display">\[
\left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} - V\frac{dP}{dt}  - P  \frac{dV}{dt}  = \dot Q - \dot W - V \sum_j \left(r_j \Delta H_j \right)
\]</span></p>
</section>
</section>
<section id="sec-apndx_SBSTR_balances" class="level2" data-number="E.3">
<h2 data-number="E.3" class="anchored" data-anchor-id="sec-apndx_SBSTR_balances"><span class="header-section-number">E.3</span> SBSTR Mole and Energy Balances</h2>
<p>In <em>Reaction Engineering Basics</em>, only one type of semi-batch reactor operation is considered. It is sometimes referred to as “fed-batch” operation. In this type of semi-batch processing, one or more reagents are added to the system while the reaction is taking place, but no reagents are removed from the reactor while it is operating. The SBSTR model makes the following assumptions.</p>
<ul>
<li>The fluid within the system is perfectly mixed.</li>
<li>One or more reagents enter the system, but no mass leaves it while the reactor is operating.</li>
</ul>
<p>During the derivation of the forms of the SBSTR mole and energy balances used in <em>Reaction Engineering Basics</em>, the following additional assumptions are made.</p>
<ul>
<li>Kinetic energy terms and gravitational potential energy terms are negligible.</li>
<li>Pressure variation associated with the hydrostatic head can be ignored.</li>
<li>Reaction rates are normalized per fluid volume.</li>
<li>Exchange of energy with the surroundings takes the form of heat or mechanical work associated with shafts, moving boundaries, etc.</li>
<li>The fluid mixture is ideal.
<ul>
<li>Both <span class="math inline">\(\Delta H\)</span> and <span class="math inline">\(\Delta V\)</span> of mixing are zero.</li>
</ul></li>
<li>No phase changes occur within the system nor upon entering it while the reactor is operating.</li>
</ul>
<section id="the-sbstr-mole-balance" class="level3" data-number="E.3.1">
<h3 data-number="E.3.1" class="anchored" data-anchor-id="the-sbstr-mole-balance"><span class="header-section-number">E.3.1</span> The SBSTR Mole Balance</h3>
<p>The system being modeled is the volume of the fluid within the reactor at any instant in time. The derivation of the SBSTR mole balance begins with a general balance equation, written for the moles of any one species at any one instant in time during the operation of the reactor.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>The mole balance for an SBSTR is very similar to the mole balance derived above for a BSTR. The Output Rate, Generation Rate and Accumulation Rate terms are the same as for a BSTR.</p>
<p><span class="math display">\[\text{Output Rate} = 0\]</span></p>
<p><span class="math display">\[\text{Generation Rate} = V \sum_j \nu_{i,j}r_j\]</span></p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{dn_i}{dt}\]</span></p>
<p>In contrast to a BSTR, the Input Rate term does not equal zero, it is equal to the molar flow of reagent <span class="math inline">\(i\)</span> into the system.</p>
<p><span class="math display">\[\text{Input Rate} = \dot n_{i,in}\]</span></p>
<p>Substitution into the general balance equation yields the SBSTR mole balance.</p>
<p><span class="math display">\[ \frac{dn_i}{dt} = \dot n_{i,in} + V \sum_j \nu_{i,j}r_j\]</span></p>
</section>
<section id="the-sbstr-energy-balance" class="level3" data-number="E.3.2">
<h3 data-number="E.3.2" class="anchored" data-anchor-id="the-sbstr-energy-balance"><span class="header-section-number">E.3.2</span> The SBSTR Energy Balance</h3>
<p>To begin, a general balance equation, written for energy at any one instant of time during the operation of the reactor is used.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>The Generation Rate, Output Rate and Accumulation Rate are the same as the BSTR.</p>
<p><span class="math display">\[\text{Generation Rate} = 0\]</span></p>
<p><span class="math display">\[\text{Output Rate} = \dot W\]</span></p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>With the assumption of negligible kinetic energy and gravitational potential energy terms, there are two input rate terms in addition to the heat entering the system, <span class="math inline">\(\dot Q\)</span>. First, the fluid must do <span class="math inline">\(PV\)</span> or flow work on the system to enter it, and second, the reagents entering the system carry their internal energy with them.</p>
<p><span class="math display">\[\text{Input Rate} = \dot Q + P\dot V_{in} + \sum_i \dot n_{i,in}\hat u_{i,in}\]</span></p>
<p>Substitution in the general balance equation yields the SBSTR energy balance, but once again it is expressed in terms of specific internal energies, which isn’t particularly useful.</p>
<p><span class="math display">\[\dot Q + P\dot V_{in} + \sum_i \dot n_{i,in}\hat u_{i,in} = \dot W + \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>With the assumption that the fluid is an ideal mixture (no <span class="math inline">\(\Delta V\)</span> of mixing), the inlet volumetric flow rate in the second term can be expressed in terms of the inlet molar flow rates and molar specific volumes, <span class="math inline">\(\dot V_{in} = \sum_i \dot n_{i,in} \hat V_{i,in}\)</span>.</p>
<p><span class="math display">\[\dot Q + P\sum_i \dot n_{i,in} \hat V_{i,in} + \sum_i \dot n_{i,in}\hat u_{i,in} = \dot W + \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>The second and third terms then can be combined.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \left(  \hat u_{i,in} + P\hat V_{i,in} \right) = \dot W + \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right)\]</span></p>
<p>The molar specific energies can be expressed in terms of the molar specific enthalpies and volumes, <span class="math inline">\(\hat u_{i,in} + P\hat V_{i,in} = \hat h_{i,in}\)</span> and <span class="math inline">\(\hat u_i = \hat h_i - P\hat V_i\)</span>.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}\left(  \sum_i n_i \left( \hat h_i - P\hat V_i \right) \right)\]</span></p>
<p>The distributive property of multiplication can be applied to the final term.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}  \sum_i \left( n_i  \hat h_i - Pn_i\hat V_i  \right)\]</span></p>
<p>The final term can then be split into two summations.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}  \sum_i \left( n_i  \hat h_i \right) - \frac{d}{dt}  \sum_i \left(Pn_i\hat V_i  \right)\]</span></p>
<p>The pressure can be factored out of the final sum.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}  \sum_i \left( n_i  \hat h_i \right) - \frac{d}{dt} \left( P\sum_i \left(n_i\hat V_i \right) \right)\]</span></p>
<p>With the assumption that the fluid mixture is ideal, <span class="math inline">\(\sum_i \left(n_i\hat V_i \right) = V\)</span>.</p>
<p><span class="math display">\[\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W + \frac{d}{dt}  \sum_i \left( n_i  \hat h_i \right) - \frac{d}{dt} \left( PV\right)\]</span></p>
<p>The derivative in the fourth term can be moved inside the summation and chain rule for differentiation then can be applied to it and the final term.</p>
<p><span class="math display">\[
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W +  \sum_i \left( n_i \frac{d \hat h_i}{dt} + \hat h_i \frac{dn_i}{dt} \right) -V\frac{dP}{dt} - P\frac{dV}{dt}
\]</span></p>
<p>The summation in the fourth term can be written as two terms.</p>
<p><span class="math display">\[
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W +  \sum_i \left( n_i \frac{d \hat h_i}{dt}\right) + \sum_i \left( \hat h_i \frac{dn_i}{dt} \right) -V\frac{dP}{dt} - P\frac{dV}{dt}
\]</span></p>
<p>With the assumption that no phase changes occur, the change in specific enthalpy in the fourth term involves only sensible heat, <span class="math inline">\(d\hat h_i = \hat C_{p,i}dT\)</span>.</p>
<p><span class="math display">\[
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} = \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \left(\sum_i  \hat h_i \frac{dn_i}{dt} \right) -V\frac{dP}{dt} - P\frac{dV}{dt}
\]</span></p>
<p>The time derivative of <span class="math inline">\(n_i\)</span> can be replaced using the STSTR mole balance.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \left(\sum_i  \hat h_i \left(\dot n_{i,in} + V \sum_j \nu_{i,j}r_j \right)\right) \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>The distributive property of multiplication can be applied to the fifth term after which it can be written as two terms.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \sum_i   \dot n_{i,in}\hat h_i + \sum_i   \left(V\hat h_i \sum_j \nu_{i,j}r_j \right) \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>The order of the sums in the sixth term can be switched.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \sum_i   \dot n_{i,in}\hat h_i + V\sum_j  \sum_i \hat h_i\nu_{i,j}r_j  \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>The rate can be factored out of the inner sum in the sixth term.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \sum_i   \dot n_{i,in}\hat h_i + V\sum_j r_j \sum_i \hat h_i\nu_{i,j}  \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>With the assumption that the fluid is an ideal mixture (no <span class="math inline">\(\Delta H\)</span> of mixing), the inner sum in the sixth term is equal to the standard heat of reaction, <span class="math inline">\(\sum_i \hat h_i\nu_{i,j} = \Delta H_j\)</span>.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i \dot n_{i,in} \hat h_{i,in} &amp;= \dot W +  \sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} + \sum_i   \dot n_{i,in}\hat h_i + V\sum_j r_j \Delta H_j  \\&amp; -V\frac{dP}{dt} - P\frac{dV}{dt}
\end{split}
\]</span></p>
<p>The derivatives can all be moved to one side of the equation.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} - V\frac{dP}{dt} - P\frac{dV}{dt} &amp;= \dot Q - \dot W + \sum_i \dot n_{i,in} \hat h_{i,in} - \sum_i   \dot n_{i,in}\hat h_i \\&amp;- V\sum_j r_j \Delta H_j
\end{split}
\]</span></p>
<p>The third and fourth terms following the equals sign can be combined and the molar flow rate of <span class="math inline">\(i\)</span> factored out.</p>
<p><span class="math display">\[
\sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} -V\frac{dP}{dt} - P\frac{dV}{dt} = \dot Q - \dot W + \sum_i \dot n_{i,in} \left(\hat h_{i,in} - \hat h_i \right)- V\sum_j r_j \Delta H_j
\]</span></p>
<p>With the assumption that no phase change occurs upon entering the system, the enthalpy difference in the third term following the equals sign involves only sensible heat and can be expressed in terms of the molar heat capacities. Doing so results in the desired form of the SBSTR energy balance, expressed in terms of temperature, pressure and volume instead of specific internal energies or enthalpies.</p>
<p><span class="math display">\[
\sum_i \left( n_i \hat C_{p,i}\right) \frac{dT}{dt} -V\frac{dP}{dt} - P\frac{dV}{dt} = \dot Q - \dot W - \sum_i \dot n_{i,in} \int_{T_{in}}^T \hat C_{p,i}dT  - V\sum_j r_j \Delta H_j
\]</span></p>
</section>
</section>
<section id="sec-apndx_CSTR_balances" class="level2" data-number="E.4">
<h2 data-number="E.4" class="anchored" data-anchor-id="sec-apndx_CSTR_balances"><span class="header-section-number">E.4</span> CSTR Mole and Energy Balances</h2>
<p>CSTRs are another variant on a perfectly mixed reactor. They differ from BSTRs and SBSTRs in that fluid flows into <strong>and</strong> out of CSTRs. The CSTR model makes the following assumptions.</p>
<ul>
<li>The fluid within the system is perfectly mixed.</li>
<li>Reagents continuously flow into and out of the system as it operates.</li>
</ul>
<p>During the derivation of the forms of the CSTR mole and energy balances used in <em>Reaction Engineering Basics</em>, the following additional assumptions are made.</p>
<ul>
<li>Kinetic energy terms and gravitational potential energy terms are negligible.</li>
<li>Pressure variation associated with the hydrostatic head can be ignored.</li>
<li>Reaction rates are normalized per fluid volume.</li>
<li>Exchange of energy with the surroundings takes the form of heat or mechanical work associated with shafts, moving boundaries, etc.</li>
<li>The fluid mixture is ideal.
<ul>
<li>Both <span class="math inline">\(\Delta H\)</span> and <span class="math inline">\(\Delta V\)</span> of mixing are zero.</li>
</ul></li>
<li>No phase changes occur within the system while the reactions are taking place nor upon entering the system.</li>
</ul>
<section id="the-cstr-mole-balance" class="level3" data-number="E.4.1">
<h3 data-number="E.4.1" class="anchored" data-anchor-id="the-cstr-mole-balance"><span class="header-section-number">E.4.1</span> The CSTR Mole Balance</h3>
<p>The system being modeled is the volume of the fluid within the reactor at any instant in time. The derivation of the CSTR mole balance begins with a general balance equation written for the moles of any one species, <span class="math inline">\(i\)</span>, present in that system.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>The Input Rate and Output Rate terms are straightforward.</p>
<p><span class="math display">\[\text{Input Rate} = \dot n_{i,in}\]</span></p>
<p><span class="math display">\[\text{Output Rate} = \dot n_{i,out}\]</span></p>
<p>The Generation Rate is the same as the BSTR and SBSTR.</p>
<p><span class="math display">\[\text{Generation Rate} = V \sum_j \nu_{i,j}r_j\]</span></p>
<p>The Accumulation Rate term is also the same as the BSTR and SBSTR, but the equation will be easier to work with if the accumulation is expressed in terms of the molar flow rate of <span class="math inline">\(i\)</span>, <span class="math inline">\(\dot n_i\)</span>, instead of the number of moles of <span class="math inline">\(i\)</span>, <span class="math inline">\(n_i\)</span>. This can be accomplished by noting that the number of moles is equal to the product of the volume and the concentration, <span class="math inline">\(n_i = C_iV\)</span>. With the assumption that the reactor is perfectly mixed, the concentration within the reactor is equal to the concentration leaving the reactor, <span class="math inline">\(C_i = \frac{\dot n_i}{\dot V}\)</span>.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{dn_i}{dt} = \frac{d}{dt}\left( \frac{\dot n_iV}{\dot V}  \right)\]</span></p>
<p>Substitution into the general balance equation yields the CSTR mole balance equation.</p>
<p><span class="math display">\[\dot n_{i,in} + V \sum_j \nu_{i,j}r_j = \dot n_{i,out} + \frac{d}{dt}\left( \frac{\dot n_iV}{\dot V}  \right)\]</span></p>
<p>This equation can be rearranged to put the derivative on one side of the equation and the remaining terms on the other.</p>
<p><span class="math display">\[\frac{d}{dt}\left( \frac{\dot n_iV}{\dot V}  \right) = \dot n_{i,in} - \dot n_{i,out} + V \sum_j \nu_{i,j}r_j\]</span></p>
<p>Applying the chain rule for differentiation then yields the desired form of the CSTR mole balance equation.</p>
<p><span class="math display">\[\frac{V}{\dot V}\frac{d \dot n_i}{dt} + \frac{\dot n_i}{\dot V}\frac{dV}{dt} - \frac{\dot n_iV}{\dot V^2}\frac{d \dot V}{dt} = \dot n_{i,in} - \dot n_{i,out} + V \sum_j \nu_{i,j}r_j\]</span></p>
</section>
<section id="the-cstr-energy-balance" class="level3" data-number="E.4.2">
<h3 data-number="E.4.2" class="anchored" data-anchor-id="the-cstr-energy-balance"><span class="header-section-number">E.4.2</span> The CSTR Energy Balance</h3>
<p>The CSTR energy balance begins with a general balance equation written for energy at any one instant of time during the operation of the reactor.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>The Input Rate and Generation Rate are the same as the SBSTR.</p>
<p><span class="math display">\[\text{Input Rate} = \dot Q + P\dot V_{in} + \sum_i \dot n_{i,in}\hat u_{i,in}\]</span></p>
<p><span class="math display">\[\text{Generation Rate} = 0\]</span></p>
<p>The Output Rate includes the shaft work term that appears in the BSTR and SBSTR and adds flow work and internal energy of the fluid leaving the reactor that are analogous to the input terms.</p>
<p><span class="math display">\[\text{Output Rate} = \dot W + P\dot{V}_{out} + \sum_i \dot n_{i,out}\hat u_{i,out}\]</span></p>
<p>The Accumulation Rate term is the same as a BSTR or SBSTR, but it is convient to express it in terms of the molar flow rate, <span class="math inline">\(\dot n_{i,out}\)</span>, instead of the moles, <span class="math inline">\(n_i\)</span>. This is accomplished in the same way as in the CSTR mole balance.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{d}{dt}\left(  \sum_i n_i \hat u_i \right) = \frac{d}{dt}\left(  \sum_i \frac{\dot n_{i,out} \hat u_{i,out}V}{\dot{V}_{out}} \right)\]</span></p>
<p>Substituting into the general balance equation yields a form of the CSTR energy balance expressed in terms of specific internal energies.</p>
<p><span class="math display">\[\dot Q + P\dot V_{in} + \sum_i \dot n_{i,in}\hat u_{i,in} = \dot W + P\dot{V}_{out} + \sum_i \dot n_{i,out}\hat u_{i,out} + \frac{d}{dt}\left(  \sum_i \frac{\dot n_{i,out} \hat u_{i,out}V}{\dot{V}_{out}} \right)\]</span></p>
<p>With the assumption that the fluid is an ideal mixture, i. e. no <span class="math inline">\(\Delta V\)</span> of mixing, the volumetric flow rates in the second and fifth terms are equal to the sums of the molar flow rates times the molar specific volumes.</p>
<p><span class="math display">\[
\begin{split}\dot Q + P\sum_i\left(  \dot n_{i,in}\hat V_{i,in} \right) + \sum_i \dot n_{i,in}\hat u_{i,in} &amp;= \dot W + P\sum_i\left(  \dot n_{i,out}\hat V_{i,out} \right) + \sum_i \dot n_{i,out}\hat u_{i,out} \\&amp;+ \frac{d}{dt}\left(  \sum_i \frac{\dot n_{i,out} \hat u_{i,out}V}{\dot{V}_{out}} \right)
\end{split}
\]</span></p>
<p>The second and third summations and the fifth and sixth summations can each be combined.</p>
<p><span class="math display">\[\dot Q + \sum_i\left(\dot n_{i,in}\left( P \hat V_{i,in} + \hat u_{i,in} \right)\right) = \dot W + \sum_i\left(  \dot n_{i,out}\left(P\hat V_{i,out}  + \hat u_{i,out} \right) \right) + \frac{d}{dt}\left(  \sum_i \frac{\dot n_{i,out} \hat u_{i,out}V}{\dot{V}_{out}} \right)\]</span></p>
<p>The specific energy can be expressed in terms of the specific enthalpy and specific volume, <span class="math inline">\(\hat u_{i,in} + P\hat V_{i,in} = \hat h_{i,in}\)</span> and <span class="math inline">\(\hat u_{i,out} + P\hat V_{i,out} = \hat h_{i,out}\)</span>.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i \dot n_{i,out} \hat h_{i,out}   + \frac{d}{dt}\left(  \sum_i \frac{\dot n_{i,out} \hat u_{i,out}V}{\dot{V}_{out}} \right)\]</span></p>
<p>Similarly, the specific internal energy in the last term can be expressed in terms of the specific enthalpy and volume.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out}   + \frac{d}{dt}\left(  \sum_i \left( \hat h_{i,out} - P\hat V_{i,out}  \right)\frac{\dot n_{i,out} V}{\dot{V}_{out}} \right)\]</span></p>
<p>The distributive property of multiplication can be applied to the last term.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out} + \frac{d}{dt}  \sum_i \left( \frac{\dot n_{i,out}\hat h_{i,out} V}{\dot{V}_{out}} - \frac{\dot n_{i,out} VP\hat V_{i,out}}{\dot{V}_{out}}  \right)\]</span></p>
<p>The last term can be split into two terms.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out} + \frac{d}{dt}  \sum_i \left( \frac{\dot n_{i,out}\hat h_{i,out} V}{\dot{V}_{out}}  \right) - \frac{d}{dt}  \sum_i \left( \frac{\dot n_{i,out} VP\hat V_{i,out}}{\dot{V}_{out}}  \right)\]</span></p>
<p>Then <span class="math inline">\(\frac{PV}{\dot{V}_{out}}\)</span> can be factored out of the final summation.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out} + \frac{d}{dt}  \sum_i \left( \frac{\dot n_{i,out}\hat h_{i,out} V}{\dot{V}_{out}}  \right) - \frac{d}{dt} \left(\frac{PV}{\dot{V}_{out}} \sum_i \left(\dot n_{i,out} \hat V_{i,out} \right)\right)\]</span></p>
<p>With the assumption that the mixture is ideal <span class="math inline">\(\left(\sum_i \left(\dot n_{i,out} \hat V_{i,out} \right) = \dot{V}_{out}\right)\)</span>, the final term can be simplified.</p>
<p><span class="math display">\[\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} = \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out}   + \frac{d}{dt}  \sum_i \left( \frac{\dot n_{i,out}\hat h_{i,out} V}{\dot{V}_{out}}  \right) - \frac{d}{dt} \left( PV\right)\]</span></p>
<p>The chain rule can be applied to the fifth term.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i \dot n_{i,out} \hat h_{i,out} \\&amp;+ \sum_i \hat h_{i,out}\frac{d}{dt}\left( \frac{\dot n_{i,out} V}{\dot{V}_{out}}  \right) +   \sum_i \left( \frac{\dot n_{i,out} V}{\dot{V}_{out}}  \right)\frac{d\hat h_{i,out}}{dt} - \frac{d}{dt} \left( PV\right)
\end{split}
\]</span></p>
<p>With the assumption of no phase changes, changes in enthalpy only involve sensible heat and the time derivative of the specific enthalpy can be expressed in terms of the heat capacity and the temperature.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out} \\&amp;+ \sum_i \hat h_{i,out}\left[\frac{d}{dt}\left( \frac{\dot n_{i,out} V}{\dot{V}_{out}}  \right)\right] +   \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right)
\end{split}
\]</span></p>
<p>The term containing square brackets can be moved to the end of the equation.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out} +   \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ \sum_i \hat h_{i,out}\left[\frac{d}{dt}\left( \frac{\dot n_{i,out} V}{\dot{V}_{out}}  \right)\right]
\end{split}
\]</span></p>
<p>The chain rule can be applied to the term containing square brackets.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out} +   \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ \sum_i \hat h_{i,out}\left[\frac{V}{\dot{V}_{out}}\frac{d \dot n_{i,out}}{dt} + \frac{\dot n_{i,out}}{\dot{V}_{out}}\frac{dV}{dt} - \frac{\dot n_{i,out}V}{\dot{V}_{out}^2}\frac{d \dot{V}_{out}}{dt}\right]
\end{split}
\]</span></p>
<p>The term in the square brackets is equal to one side of the CSTR mole balance. The other side of the CSTR mole balance can be substituted in its place.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out} +   \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ \sum_i \hat h_{i,out}\left[\dot n_{i,in} - \dot n_{i,out} + V \sum_j \nu_{i,j}r_j\right]
\end{split}
\]</span></p>
<p>The distributive property of multiplication can be applied to the term with the square brackets.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} &amp;= \dot W + \sum_i  \dot n_{i,out} \hat h_{i,out} +   \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ \sum_i \hat h_{i,out}\dot n_{i,in} - \sum_i \hat h_{i,out}\dot n_{i,out} + V\sum_i \hat h_{i,out} \sum_j \nu_{i,j}r_j
\end{split}
\]</span></p>
<p>The first term on the second line can be moved to the other side of the equation, and two other terms cancel out.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \hat h_{i,in} - \sum_i \hat h_{i,out}\dot n_{i,in} &amp;= \dot W + \cancel{\sum_i  \dot n_{i,out} \hat h_{i,out}} +   \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} \\&amp;- \frac{d}{dt} \left( PV\right)   - \cancel{\sum_i \hat h_{i,out}\dot n_{i,out}} + \sum_i \hat h_{i,out}V \sum_j \nu_{i,j}r_j
\end{split}
\]</span></p>
<p>The second and third terms can be combined.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \left( \hat h_{i,in} - \hat h_{i,out} \right) &amp;= \dot W + \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ V\sum_i \hat h_{i,out} \sum_j \nu_{i,j}r_j
\end{split}
\]</span></p>
<p>The distributive property of multiplication can be applied to the last term.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \left( \hat h_{i,in} - \hat h_{i,out} \right) &amp;= \dot W + \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ V\sum_i  \sum_j \hat h_{i,out}\nu_{i,j}r_j
\end{split}
\]</span></p>
<p>The order of the sums in the last term can be switched and <span class="math inline">\(r_j\)</span> can be factored out of the inner summation.</p>
<p><span class="math display">\[
\begin{split}
\dot Q + \sum_i\dot n_{i,in} \left( \hat h_{i,in} - \hat h_{i,out} \right) &amp;= \dot W + \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) \\&amp;+ V\sum_j r_j \sum_i \hat h_{i,out}\nu_{i,j}
\end{split}
\]</span></p>
<p>With the assumption of no phase changes, the specific enthalpy difference in the second term can be expressed in terms of the heat capacity and temperature, and with the assumption that the fluid is an ideal mixture (no <span class="math inline">\(\Delta H\)</span> of mixing), the final summation is simply equal to the heat of reaction <span class="math inline">\(j\)</span>.</p>
<p><span class="math display">\[\dot Q - \sum_i\dot n_{i,in} \int_{T_{in}}^{T_{out}} \hat C_{p,i}dT = \dot W + \sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) + V\sum_j r_j \Delta H_j\]</span></p>
<p>The derivatives can be moved to one side of the equation.</p>
<p><span class="math display">\[\sum_i \left( \frac{\dot n_{i,out} \hat C_{p,i} V}{\dot{V}_{out}}  \right)\frac{dT_{out}}{dt} - \frac{d}{dt} \left( PV\right) = \dot Q - \dot W - \sum_i\dot n_{i,in} \int_{T_{in}}^{T_{out}} \hat C_{p,i}dT - V\sum_j r_j \Delta H_j\]</span></p>
<p>Finally, <span class="math inline">\(V\)</span> and <span class="math inline">\(\dot V\)</span> can be factored out of the first term and the chain rule can be applied to the second term, yielding the desired form of the CSTR energy balance.</p>
<p><span class="math display">\[
\begin{split}
\frac{V}{\dot{V}_{out}}\sum_i \left( \dot n_{i,out} \hat C_{p,i}  \right)\frac{dT_{out}}{dt} - P\frac{dV}{dt} - V \frac{dP}{dt} &amp;= \dot Q - \dot W - \sum_i\dot n_{i,in} \int_{T_{in}}^{T_{out}} \hat C_{p,i}dT \\&amp;- V\sum_j r_j \Delta H_j
\end{split}
\]</span></p>
</section>
</section>
<section id="sec-apndx_PFR_balances" class="level2" data-number="E.5">
<h2 data-number="E.5" class="anchored" data-anchor-id="sec-apndx_PFR_balances"><span class="header-section-number">E.5</span> PFR Mole and Energy Balances</h2>
<p>The PFR model makes the following assumptions.</p>
<ul>
<li>The reactor is a cylinder with fluid continuously flowing in one end and out the other.</li>
<li>The fluid velocity does not vary across the diameter of the reactor; i. e. there is plug flow.
<ul>
<li>Heat and mass are perfectly mixed across the radius.</li>
<li>Heat and mass do not mix at all along the axis.</li>
</ul></li>
<li>If there is a packed bed of catalyst particles within the reactor it is assumed that
<ul>
<li>there are no concentration gradients and no temperature gradients within the fluid near the external surfaces of the catalyst particles,</li>
<li>there are no concentration gradients and no temperature gradients within the fluid that is in the pores inside the catalyst particles, and consequently,</li>
<li>the reactor volume can be treated as a single phase (the so-called pseudo homogeneous model) by properly renormalizing the rate of reaction.</li>
</ul></li>
</ul>
<p>During the derivation of the forms of the PFR mole and energy balances used in <em>Reaction Engineering Basics</em>, the following additional assumptions are made.</p>
<ul>
<li>The reactor diameter is constant.</li>
<li>Kinetic energy terms and gravitational potential energy terms are negligible.</li>
<li>Reaction rates are normalized per fluid volume.</li>
<li>Exchange of energy with the surroundings takes the form of heat that is transferred through the wall of the reactor.</li>
<li>Mechanical work is not performed on or by the system.</li>
<li>The fluid mixture is ideal.
<ul>
<li>Both <span class="math inline">\(\Delta H\)</span> and <span class="math inline">\(\Delta V\)</span> of mixing are zero.</li>
</ul></li>
<li>No phase changes occur within or upon entering the system.</li>
</ul>
<p>Unlike the perfectly mixed stirred tank reactors, the composition in an ideal PFR is not uniform; it changes along the length of the reactor. As a consequence, it becomes necessary to write the mole and energy balance equations on a differential element of reactor volume and then take the limit as the size of this element goes to zero. With the assumption of perfect mixing in the radial direction, in the limit where its thickness goes to zero, the volume element is perfectly mixed. Here, we will assume that the reactor is cylindrical with a constant diameter, D, and a length, L, as shown in <a href="#fig-pfr-vol-element" class="quarto-xref">Figure&nbsp;<span>E.3</span></a> which additionally shows a differentially thick cross section that will be used in formulating the mole and energy balances.</p>
<div id="fig-pfr-vol-element" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pfr-vol-element-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Graphics/pfr_differential_element.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pfr-vol-element-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.3: Differential PFR Element
</figcaption>
</figure>
</div>
<section id="the-pfr-mole-balance" class="level3" data-number="E.5.1">
<h3 data-number="E.5.1" class="anchored" data-anchor-id="the-pfr-mole-balance"><span class="header-section-number">E.5.1</span> The PFR Mole Balance</h3>
<p>The system being modeled is the fluid within the differential volume element of axial thickness, <span class="math inline">\(dz\)</span>, and diameter, <span class="math inline">\(D\)</span>, at any instant in time. The derivation begins with a general balance equation written for the moles of any one species, <span class="math inline">\(i\)</span>, present in the system.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>As with the CSTR, the Input Rate and Output Rate terms are simply equal to the molar flow rates at <span class="math inline">\(z\)</span> and <span class="math inline">\(z + dz\)</span>, respectively.</p>
<p><span class="math display">\[\text{Input Rate} = \dot n_i \biggr\rvert_z\]</span></p>
<p><span class="math display">\[\text{Output Rate} = \dot n_i \biggr\rvert_{z+dz}\]</span></p>
<p>With the assumption that the rates are normalized per fluid volume, the rate of generation of species <span class="math inline">\(i\)</span> via reaction <span class="math inline">\(j\)</span> is the volume of the fluid element, <span class="math inline">\(\frac{\pi D^2}{4}dz\)</span>, times the rate of generation of <span class="math inline">\(i\)</span> per fluid volume, <span class="math inline">\(\nu_{i,j}r_j\)</span>. The Generation Rate term then is the sum over all reactions.</p>
<p><span class="math display">\[\text{Generation Rate} = \frac{\pi D^2}{4}dz \sum_j \nu_{i,j}r_j\]</span></p>
<p>The Accumulation Rate is the instantaneous time derivative of the number of moles in the differential element. The number of moles equals the volume of the differential element times the concentration of the species. In perfectly mixed, differential volume element, the concentration is the ratio of the outlet molar flow rate to the outlet volumetric flow rate.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \frac{\partial n_i}{\partial t} = \frac{\pi D^2}{4}dz \frac{\partial}{\partial t}\left( \frac{\dot n_i }{\dot V} \right)\biggr\rvert_{z+dz}\]</span></p>
<p>Substitution into the general balance equation yields a mole balance expressed in terms of the differential thickness of the fluid element.</p>
<p><span class="math display">\[\dot n_i \biggr\rvert_z + \frac{\pi D^2}{4}dz \sum_j \nu_{i,j}r_j = \dot n_i \biggr\rvert_{z+dz} + \frac{\pi D^2}{4}dz \frac{\partial}{\partial t}\left( \frac{\dot n_i}{\dot V} \right)\biggr\rvert_{z+dz}\]</span></p>
<p>That equation can be rearranged and divided by <span class="math inline">\(dz\)</span>.</p>
<p><span class="math display">\[\frac{\dot n_i \biggr\rvert_{z+dz} - \dot n_i \biggr\rvert_z}{dz}=\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j - \frac{\pi D^2}{4} \frac{\partial}{\partial t}\left( \frac{\dot n_i }{\dot V} \right)\biggr\rvert_{z+dz}\]</span></p>
<p>Taking the limit as <span class="math inline">\(dz\)</span> approaches zero yields the mole balance in the form of a partial differential equation.</p>
<p><span class="math display">\[\frac{\partial \dot n_i}{\partial z}=\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j - \frac{\pi D^2}{4} \frac{\partial}{\partial t}\left( \frac{\dot n_i}{\dot V} \right)\]</span></p>
<p>Applying the chain rule and moving all of the derivatives to one side of the equation leads to the desired form of the PFR mole balance.</p>
<p><span class="math display">\[\frac{\partial \dot n_i}{\partial z} + \frac{\pi D^2}{4\dot V} \frac{\partial\dot n_i}{\partial t} - \frac{\pi D^2\dot n_i}{4\dot V^2} \frac{\partial \dot V}{\partial t}  =\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j \]</span></p>
</section>
<section id="the-pfr-energy-balance" class="level3" data-number="E.5.2">
<h3 data-number="E.5.2" class="anchored" data-anchor-id="the-pfr-energy-balance"><span class="header-section-number">E.5.2</span> The PFR Energy Balance</h3>
<p>The PFR energy balance begins with a general balance on the same fluid element, <a href="#fig-pfr-vol-element" class="quarto-xref">Figure&nbsp;<span>E.3</span></a>, as was used for the PFR mole balance only written for energy at any one instant of time during the operation of the reactor.</p>
<p><span class="math display">\[\text{Input Rate} + \text{Generation Rate} = \text{Output Rate} + \text{Accumulation Rate}\]</span></p>
<p>As was the case for the SBSTR and CSTR, the Input Rate term includes internal energy carried into the volume by the fluid, flow work done by the fluid on the volume element and heat transfer through the wall of the differential element. It is assumed that the heat transfer coefficient, <span class="math inline">\(U\)</span>, is constant.</p>
<p><span class="math display">\[\text{Input Rate} = \sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_z + \left(  P\dot V \right)\biggr\rvert_z + \pi D U\left( T_e - T  \right)dz\]</span></p>
<p>The Output Rate term is also like that for the CSTR except that there is no shaft work for a PFR.</p>
<p><span class="math display">\[\text{Output Rate} = \sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_{z+dz} + \left(  P\dot V \right)\biggr\rvert_{z+dz}\]</span></p>
<p>As with all of the reactors, the Generation Rate is zero.</p>
<p><span class="math display">\[\text{Generation Rate} = 0\]</span></p>
<p>The Rate of Accumulation term is like that for the CSTR except that the volume is the volume of the differential element. Also, because there are quantities that vary with both axial position and time, the derivative is a partial derivative.</p>
<p><span class="math display">\[\text{Accumulation Rate} = \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right)\]</span></p>
<p>The Input Rate, Generation Rate, Output Rate and Accumulation Rate terms can be substituted into the general balance equation.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_z + \left(  P\dot V \right)\biggr\rvert_z + \pi D U\left( T_e - T  \right)dz &amp;= \sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_{z+dz} + \left(  P\dot V \right)\biggr\rvert_{z+dz} \\&amp;+ \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right)
\end{split}
\]</span></p>
<p>With the assumption that the fluid is an ideal mixture with no <span class="math inline">\(\Delta V\)</span> of mixing, the volumetric flow rates can be related to the molar flow rates and the molar specific volumes, <span class="math inline">\(\dot V = \sum_i \dot n_i \hat V_i\)</span>.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_z + \left(  P \sum_i \dot n_i \hat V_i \right)\biggr\rvert_z &amp;+ \pi D U\left( T_e - T  \right)dz = \sum_i \left( \dot n_i \hat u_i  \right) \biggr\rvert_{z+dz} \\&amp;+ \left(  P \sum_i \dot n_i \hat V_i \right)\biggr\rvert_{z+dz} + \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right)
\end{split}
\]</span></p>
<p>The first two terms can be combined and <span class="math inline">\(\dot n_i\)</span> can be factored out, and the same can be done with the first two terms following the equals sign.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left(\dot n_i \left(  \hat u_i + P \hat V_i\right) \right) \biggr\rvert_z + \pi D U\left( T_e - T  \right)dz &amp;= \sum_i \left(\dot n_i \left(  \hat u_i + P \hat V_i\right) \right) \biggr\rvert_{z+dz} \\&amp;+ \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right)
\end{split}
\]</span></p>
<p>The specific internal energy can be expressed in terms of the specfic volume and the specific enthalpy (<span class="math inline">\(\hat u_i + P \hat V_i = \hat h_i\)</span>).</p>
<p><span class="math display">\[\sum_i \left(\dot n_i \hat h_i \right) \biggr\rvert_z + \pi D U\left( T_e - T  \right)dz = \sum_i \left(\dot n_i\hat h_i  \right) \biggr\rvert_{z+dz} + \sum_i \frac{\partial}{\partial t} \left(  \frac{\pi D^2}{4} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)dz \right) \]</span></p>
<p>The equation can be rearranged and divided by <span class="math inline">\(dz\)</span>.</p>
<p><span class="math display">\[\sum_i \frac{\left(\dot n_i\hat h_i  \right) \biggr\rvert_{z+dz}-\left(\dot n_i\hat h_i  \right) \biggr\rvert_z}{dz} = \pi D U\left( T_e - T  \right) - \frac{\pi D^2}{4} \sum_i \frac{\partial}{\partial t} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right)\]</span></p>
<p>In the limit where <span class="math inline">\(dz\)</span> goes to zero, the left side of the equation becomes a partial derivative.</p>
<p><span class="math display">\[\sum_i \frac{\partial}{\partial z} \left(  \dot n_i\hat h_i \right) = \pi D U\left( T_e - T  \right) - \frac{\pi D^2}{4} \sum_i \frac{\partial}{\partial t} \left(  \frac{\dot n_i \hat u_i}{\dot V} \right) \]</span></p>
<p>The chain rule can be applied to both derivatives and they can be split into separate summations.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} + \sum_i \hat h_i \frac{\partial \dot n_i}{\partial z}  &amp;= \pi D U\left( T_e - T  \right) - \frac{\pi D^2}{4\dot V} \sum_i  \hat u_i \frac{\partial\dot n_i }{\partial t} + \frac{\pi D^2}{4\dot V^2} \sum_i \dot n_i\hat u_i \frac{\partial \dot V}{\partial t} \\&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat u_i}{\partial t}
\end{split}
\]</span></p>
<p>As before, the specific internal energy can be expressed in terms of the specific enthalpy.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} + \sum_i \hat h_i \frac{\partial \dot n_i}{\partial z}  &amp;= \pi D U\left( T_e - T  \right) \\&amp;- \frac{\pi D^2}{4\dot V} \sum_i  \hat h_i \frac{\partial\dot n_i }{\partial t} + \frac{\pi D^2}{4\dot V}\sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\&amp;+ \frac{\pi D^2}{4\dot V^2} \sum_i \dot n_i\hat h_i \frac{\partial \dot V}{\partial t} - \frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t} \\&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t} + \frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)
\end{split}
\]</span></p>
<p>All terms including <span class="math inline">\(\hat h_i\)</span> can be gathered.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \hat h_i \frac{\partial \dot n_i}{\partial z} + \frac{\pi D^2}{4\dot V} \sum_i  \hat h_i \frac{\partial\dot n_i }{\partial t} - \frac{\pi D^2}{4\dot V^2} \sum_i \dot n_i\hat h_i \frac{\partial \dot V}{\partial t} &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right) \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The specific enthalpy can be factored out of those terms.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left(\hat h_i \left[   \frac{\partial \dot n_i}{\partial z} + \frac{\pi D^2}{4\dot V} \frac{\partial\dot n_i }{\partial t} - \frac{\pi D^2}{4\dot V^2} \dot n_i \frac{\partial \dot V}{\partial t} \right] \right) &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The term in square brackets is equal to the left side of the PFR mole balance equation. It can be replaced with the right side of the PFR mole balance equation.</p>
<p><span class="math display">\[
\begin{split}
\sum_i \left(\hat h_i \left[\frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j \right] \right) &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The distributive property of multiplication can be applied to the first term and the constant area term can be factored out.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_i \sum_j \hat h_i\nu_{i,j}r_j  &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+ \frac{\pi D^2}{4\dot V}\sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The order of the summations in the first term can be switched and the rate can be factored out of the inner summation.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j\left( r_j\sum_i \hat h_i\nu_{i,j}\right)  &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+ \frac{\pi D^2}{4\dot V}\sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>With the assumption that the fluid is an ideal mixture with no <span class="math inline">\(\Delta H\)</span> of mixing, the second sum within the first term is simply the heat of reaction <span class="math inline">\(j\)</span>.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \sum_i \dot n_i \frac{\partial \hat h_i}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>With the assumption of no phase changes, the derivative of the specific enthalpy involves only sensible heat and can be expressed in terms of the heat capacity and temperature.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial}{\partial t}\left( P\hat V_i \right)\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The chain rule can be applied to the term on the fourth line.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i  P\hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V^2} \sum_i \dot n_iP\hat V_i \frac{\partial \dot V}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_iP \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \sum_i \dot n_i\hat V_i \frac{\partial P}{\partial t}\\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>Common quantities can be factored out of each of the sums on the second through fifth lines.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V^2} \frac{\partial \dot V}{\partial t}\sum_i \dot n_i\hat V_i \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \frac{\partial P}{\partial t}\sum_i \dot n_i\hat V_i \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>As above, with the assumption that the fluid is an ideal mixture, <span class="math inline">\(\sum_i \dot n_i \hat V_i = \dot V\)</span>.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V^2} \frac{\partial \dot V}{\partial t}\dot V \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4\dot V} \frac{\partial P}{\partial t} \dot V \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The volumetric flow rate appears in both the numerator and denominator of the terms on the third and fifth lines and can be canceled.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V} \frac{\partial \dot V}{\partial t} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>With the assumption that the fluids is an ideal mxiture, the derivative of the volumetric flow rate in the term on the third line can be expressed in terms of the molar flow rates and specific volumes.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V} \frac{\partial}{\partial t}\left(\sum_i \dot n_i \hat V_i \right) \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The chain rule can be applied to the term on the third line.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i  \hat V_i \frac{\partial\dot n_i }{\partial t} \\
&amp;-\frac{\pi D^2P}{4\dot V} \sum_i\dot n_i\frac{\partial \hat V_i}{\partial t} -\frac{\pi D^2P}{4\dot V} \sum_i\hat V_i\frac{\partial \dot n_i}{\partial t}\\
&amp;+\frac{\pi D^2P}{4\dot V} \sum_i \dot n_i \frac{\partial \hat V_i}{\partial t}\\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>The four terms on the second, third and fourth lines cancel.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \dot n_i \frac{\partial \hat h_i}{\partial t}
\end{split}
\]</span></p>
<p>With the assumption of no phase change, the derivative of the specific enthalpy can be expressed in terms of the heat capacity and temperature.</p>
<p><span class="math display">\[
\begin{split}
\frac{\pi D^2}{4}\sum_j r_j \Delta H_j  &amp;= \pi D U\left( T_e - T  \right) - \left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} \\
&amp;+\frac{\pi D^2}{4} \frac{\partial P}{\partial t} \\
&amp;-\frac{\pi D^2}{4\dot V} \sum_i \left(\dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial t}
\end{split}
\]</span></p>
<p>Finally, moving all of the derivatives to one side of the equation yields the desired form of the PFR energy balance.</p>
<p><span class="math display">\[
\begin{split}
\left(\sum_i \dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial z} +\frac{\pi D^2}{4\dot V} \sum_i \left(\dot n_i \hat C_{p,i} \right) \frac{\partial T}{\partial t} - \frac{\pi D^2}{4} \frac{\partial P}{\partial t} &amp;= \pi D U\left( T_e - T  \right) \\
&amp;- \frac{\pi D^2}{4}\sum_j r_j \Delta H_j
\end{split}
\]</span></p>
</section>
</section>
<section id="sec-apndx_axial_dispersion" class="level2" data-number="E.6">
<h2 data-number="E.6" class="anchored" data-anchor-id="sec-apndx_axial_dispersion"><span class="header-section-number">E.6</span> Axial Dispersion Reactor Models</h2>
<p>Dispersion terms representing axial mixing can be added to the ideal plug flow reactor model equations. The resulting axial dispersion model equations can be used to simulate tubular reactors where axial mixing might occur. They are not used for that purpose in <em>Reaction Engineering Basics,</em> though. Instead, they are used as empirical models for non-ideal reactors. Only steady-state reactors are considered.</p>
<section id="axial-dispersion-reactor-design-equations" class="level3" data-number="E.6.1">
<h3 data-number="E.6.1" class="anchored" data-anchor-id="axial-dispersion-reactor-design-equations"><span class="header-section-number">E.6.1</span> Axial Dispersion Reactor Design Equations</h3>
<p>The transient mole and energy balances for a PFR are derived above. When used to model a steady-state reactor, all of the time derivatives are set equal to zero, and the derivatives with respect to axial position become ordinary derivatives. The assumption of plug flow is retained in the axial dispersion model. The only modification to the PFR mole and energy balances is addition of the term, <span class="math inline">\(-D_{ax} \frac{\pi D^2}{4} \frac{d^2C_i}{dz^2}\)</span>, to the ideal PFR mole balance, and the term, <span class="math inline">\(-\lambda_{ax} \frac{\pi D^2}{4} \frac{d^2T}{dz^2}\)</span>, to the ideal PFR reacting fluid energy balance. These terms are discussed in <a href="section_7_axial_dispersion_model.html" class="quarto-xref"><span>Chapter 24</span></a>.</p>
<section id="the-steady-state-axial-dispersion-mole-balance" class="level4" data-number="E.6.1.1">
<h4 data-number="E.6.1.1" class="anchored" data-anchor-id="the-steady-state-axial-dispersion-mole-balance"><span class="header-section-number">E.6.1.1</span> The Steady-State Axial Dispersion Mole Balance</h4>
<p>The generation of the axial dispersion mole balance begins with the steady-state ideal PFR mole balance.</p>
<p><span class="math display">\[
\frac{d \dot n_i}{d z} = \frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j
\]</span></p>
<p>Adding the dispersion term leads to the presence of two dependent variables, <span class="math inline">\(C_i\)</span> and <span class="math inline">\(\dot{n}_i\)</span>.</p>
<p><span class="math display">\[
- D_{ax} \frac{\pi D^2}{4} \frac{d^2C_i}{d z^2} + \frac{d \dot n_i}{dz} = \frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j
\]</span></p>
<p>Noting that <span class="math inline">\(\dot{n}_i\)</span> = <span class="math inline">\(\dot{V} C_i\)</span> eliminates the molar flow rate as a dependent varible, but for compressible fluids it introduces the volumetric flow rate as a dependent variable.</p>
<p><span class="math display">\[
- D_{ax} \frac{\pi D^2}{4} \frac{d^2C_i}{dz^2} + \frac{d}{d z}\left( \dot{V} C_i \right) = \frac{\pi D^2}{4} \sum_j \nu_{i,j}r_j
\]</span></p>
<p>Applying the chain rule for differentiation yields the complete form of the steady-state axial dispersion mole balance.</p>
<p><span class="math display">\[
- D_{ax} \frac{\pi D^2}{4} \frac{d^2C_i}{dz^2} + \dot{V} \frac{dC_i}{dz} + C_i \frac{d\dot{V}}{dz} = \frac{\pi D^2}{4} \sum_j \nu_{i,j}r_j
\]</span></p>
</section>
<section id="the-steady-state-axial-dispersion-energy-balance" class="level4" data-number="E.6.1.2">
<h4 data-number="E.6.1.2" class="anchored" data-anchor-id="the-steady-state-axial-dispersion-energy-balance"><span class="header-section-number">E.6.1.2</span> The Steady-State Axial Dispersion Energy Balance</h4>
<p>The steady-state form of the PFR energy balance is again generated from the transient energy balance by setting all time derivatives equal to zero and converting the remaining partial derivatives to ordinary derivatives.</p>
<p><span class="math display">\[
\left( \sum_i \dot{n}_i\hat{C}_{p,i} \right)\frac{dT}{dz} = \pi DU\left( T_{ex} - T \right) - \frac{\pi D^2}{4} \sum_j r_j\Delta H_j
\]</span></p>
<p>Adding the thermal dispersion term and noting that <span class="math inline">\(\dot{n}_i\)</span> = <span class="math inline">\(\dot{V} C_i\)</span> then yields the complete form of the steady-state axial dispersion energy balance with concentration as the composition variable.</p>
<p><span class="math display">\[
- \lambda_{ax} \frac{\pi D^2}{4} \frac{d^2T}{dz^2} + \dot{V} \left( \sum_i C_i\hat{C}_{p,i} \right)\frac{dT}{dz} = \pi D U \left( T_{ex} - T \right) - \frac{\pi D^2}{4} \sum_j r_j\Delta H_j
\]</span></p>
</section>
<section id="steady-state-axial-dispersion-model-boundary-conditions" class="level4" data-number="E.6.1.3">
<h4 data-number="E.6.1.3" class="anchored" data-anchor-id="steady-state-axial-dispersion-model-boundary-conditions"><span class="header-section-number">E.6.1.3</span> Steady-State Axial Dispersion Model Boundary Conditions</h4>
<p>The axial dispersion design equations include second derivatives of the concentrations and temperature and the first derivative of the volumetric flow rate. Solving them then requires two boundary conditions for each of the concentrations and for the temperature and one boundary condition for the volumetric flow rate. There are a few different ways to write the boundary conditions. The Danckwerts boundary conditions will be presented here.</p>
<p>The Danckwerts boundary conditions assume that upstream from the reactor inlet, the flow of each reagent is purely convective. Within the reactor the net flow of each reagent is the combination of convection and the diffusion-like mixing flux. Similar assumptions are made for energy. This is emphasized in <a href="#fig-axial_dispersion_inlet" class="quarto-xref">Figure&nbsp;<span>E.4</span></a> where a subscripted “feed” is used for feed properties, a “0” for properties at the reactor inlet, and a “1” for properties at the reactor outlet.</p>
<div id="fig-axial_dispersion_inlet" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-axial_dispersion_inlet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/axial_dispersion_adiabatic.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-axial_dispersion_inlet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.4: Due to mixing in the axial direction, the concentrations and temperature at the inlet are not equal to the feed concentrations and temperature.
</figcaption>
</figure>
</div>
<p>The Danckwerts boundary conditions simply assume that the purely convective feed flow is equal to the combined convective and flux-like mixing flow at the reactor inlet. Similarly, for the energy balance they assume the purely convective heat flow associated with the feed equals the combined convective flow and conduction-like mixing flux at the reactor inlet.</p>
<p><span class="math display">\[
\dot{V}_{feed}C_{i,feed} = \dot{V}_0 C_{i,0} - D_{ax} \frac{\pi D^2}{4} \frac{dC_i}{dz}\Bigg\vert_{z=0}
\]</span></p>
<p><span class="math display">\[
\dot{V}_{feed}\sum_i\left(C_{i,feed} \hat{C}_{p,i} \right) T_{feed} = \dot{V}_0 \sum_i\left(C_{i,0} \hat{C}_{p,i} \right) T_0 - \lambda_{ax} \frac{\pi D^2}{4} \frac{dT}{dz}\Bigg\vert_{z=0}
\]</span></p>
<p>A second boundary condition is needed for each <span class="math inline">\(C_i\)</span> and for <span class="math inline">\(T\)</span>. Because the reactor ends at <span class="math inline">\(z=L\)</span>, it can be assumed that the concentrations and temperature will stop changing at that point. Doing so yields the additional boundary conditions.</p>
<p><span class="math display">\[
\frac{dC_i}{dz}\Bigg\vert_{z=L} = 0
\]</span></p>
<p><span class="math display">\[
\frac{dT}{dz}\Bigg\vert_{z=L} = 0
\]</span></p>
<p>If the volumetric flow rate is not constant, an additional boundary condition is needed for it.</p>
</section>
</section>
<section id="first-order-steady-state-empirical-axial-dispersion-model" class="level3" data-number="E.6.2">
<h3 data-number="E.6.2" class="anchored" data-anchor-id="first-order-steady-state-empirical-axial-dispersion-model"><span class="header-section-number">E.6.2</span> First-Order, Steady-State Empirical Axial Dispersion Model</h3>
<p>If the axial dispersion model is used empirically to model a non-ideal reactor, the dispersion coefficient and the thermal dispersion coefficient are treated as model parameters that are adjusted to obtain the best agreement between the model and an actual reactor system. In this situation the derivative of the volumetric flow rate can be set equal to zero. Then, for consistency with the other reactor models in <em>Reaction Engineering Basics,</em> the empirical axial dispersion model equations can be rewritten with the molar flow rates as the dependent variables instead of concentrations.</p>
<p>Substituting <span class="math inline">\(C_i = \frac{\dot{n}_i}{\dot{V}}\)</span> into the steady-state axial dispersion models above and setting <span class="math inline">\(\frac{d\dot{V}}{dz}\)</span> equal to zero yields the second-order model equations and boundary conditions in terms of molar flow rates.</p>
<p><span class="math display">\[
- D_{ax} \frac{\pi D^2}{4\dot{V}} \frac{d^2\dot{n}_i}{dz^2} + \frac{d\dot{n}_i}{dz} = \frac{\pi D^2}{4} \sum_j \nu_{i,j}r_j
\]</span></p>
<p><span class="math display">\[
- \lambda_{ax} \frac{\pi D^2}{4} \frac{d^2T}{dz^2} + \left( \sum_i \dot{n}_i\hat{C}_{p,i} \right)\frac{dT}{dz} = \pi D U \left( T_{ex} - T \right) - \frac{\pi D^2}{4} \sum_j r_j\Delta H_j
\]</span></p>
<p><span class="math display">\[
\dot{n}_{i,feed} = \dot{n}_{i,0} - D_{ax} \frac{\pi D^2}{4\dot{V}} \frac{d\dot{n}_i}{dz}\Bigg\vert_{z=0}
\]</span></p>
<p><span class="math display">\[
\sum_i\left(\dot{n}_{i,feed} \hat{C}_{p,i} \right) T_{feed} = \sum_i\left(\dot{n}_{i,0} \hat{C}_{p,i} \right) T_0 - \lambda_{ax} \frac{\pi D^2}{4} \frac{dT}{dz}\Bigg\vert_{z=0}
\]</span></p>
<p><span class="math display">\[
\frac{d\dot{n}_i}{dz}\Bigg\vert_{z=L} = 0
\]</span></p>
<p><span class="math display">\[
\frac{dT}{dz}\Bigg\vert_{z=L} = 0
\]</span></p>
<p>Recognizing that the design equations will be solved numerically, it is useful to rewrite them as an equivalent set of first-order ODEs. This can be accomplished by defining new variables, <span class="math inline">\(\omega_i\)</span> and <span class="math inline">\(\omega_T\)</span>.</p>
<p><span class="math display">\[
\frac{d\dot{n}_i}{dz} = \omega_i
\]</span></p>
<p><span class="math display">\[
\frac{dT}{dz} = \omega_T
\]</span></p>
<p>Noting that then <span class="math inline">\(\frac{d^2\dot{n}_i}{dz^2} = \frac{d\omega_i}{dz}\)</span> and <span class="math inline">\(\frac{d^2T}{dz^2} = \frac{d\omega_T}{dz}\)</span>, substitution into the second-order design equations converts them to two additional first-order ODEs.</p>
<p><span class="math display">\[
- D_{ax}\frac{\pi D^2}{4\dot{V}}\frac{d \omega_i}{d z} = - \omega_i + \frac{\pi D^2}{4}\sum_j \nu_{i,j}r_j
\]</span></p>
<p><span class="math display">\[
- \lambda_{ax}\frac{\pi D^2}{4}\frac{d \omega_T}{d z} = -  \left(\sum_i \dot{n}_i \hat{C}_{p,i}\right) \omega_T + \pi DU\left(T_{ex} - T\right) - \frac{\pi D^2}{4}\sum_j r_j \Delta H_j
\]</span></p>
<p>Similarly, the boundary conditions also can be expressed in terms of the new variables.</p>
<p><span class="math display">\[
\dot{n}_{i,0} = \dot{n}_{i,feed} + D_{ax} \frac{\pi D^2}{4\dot{V}} \omega_i\Big\vert_{z=0}
\]</span></p>
<p><span class="math display">\[
T_0 = \frac{\sum_i\dot{n}_{i,feed} \hat{C}_{p,i}}{\sum_i\dot{n}_{i,0} \hat{C}_{p,i}}T_{feed} + \lambda_{ax} \frac{\pi D^2}{4\dot{V} \sum_i\left(\dot{n}_{i,0} \hat{C}_{p,i} \right)} \omega_T\Big\vert_{z=0}
\]</span></p>
<p><span class="math display">\[
\omega_i\Big\vert_{z=L} = 0
\]</span></p>
<p><span class="math display">\[
\omega_T\Big\vert_{z=L} = 0
\]</span></p>
<p>The axial dispersion reactor design equations are boundary value ordinary equations (BVODEs) and must be solved using an appropriate solver (see <a href="apndx_mathematics.html" class="quarto-xref"><span>Appendix F</span></a>).</p>
</section>
</section>
<section id="symbols-used-in-this-appendix" class="level2" data-number="E.7">
<h2 data-number="E.7" class="anchored" data-anchor-id="symbols-used-in-this-appendix"><span class="header-section-number">E.7</span> Symbols Used in This Appendix</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\hat h_i\)</span></td>
<td style="text-align: left;">Enthalpy per mole of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(i\)</span></td>
<td style="text-align: left;">As a subscript, denotes a specific reagent present in the system.<br>
As a summation or continuous product index, indexes all reagents present in the system.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(j\)</span></td>
<td style="text-align: left;">As a subscript, denotes a specific reaction occurring in the system.<br>
As a summation or continuous product index, indexes all reactions occurring in the system..</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot m_{ex}\)</span></td>
<td style="text-align: left;">Mass flow rate of the heat exchange fluid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(n_i\)</span></td>
<td style="text-align: left;">Moles of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot n_i\)</span></td>
<td style="text-align: left;">Molar flow rate of reagent <span class="math inline">\(i\)</span>; an additional subscripted <span class="math inline">\(in\)</span> indicates the inlet molar flow rate of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r_j\)</span></td>
<td style="text-align: left;">Rate of reaction <span class="math inline">\(j\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(t\)</span></td>
<td style="text-align: left;">Time.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\hat u_i\)</span></td>
<td style="text-align: left;">Internal energy per mole of reagent <span class="math inline">\(i\)</span>; an additional subscripted <span class="math inline">\(in\)</span> indicates the internal energy per mole of reagent <span class="math inline">\(i\)</span> at the inlet to the system.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(z\)</span></td>
<td style="text-align: left;">Axial distance from the reactor inlet.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(C_i\)</span></td>
<td style="text-align: left;">Concentration of reagent <span class="math inline">\(i\)</span>, an additional subscript denotes the location.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\hat{C}_{p,i}\)</span></td>
<td style="text-align: left;">Molar heat capacity of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\tilde C_{p,ex}\)</span></td>
<td style="text-align: left;">Heat capacity at constant pressure per unit mass of the heat exchange fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(D\)</span></td>
<td style="text-align: left;">Diameter of the tubular reactor.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(D_{ax}\)</span></td>
<td style="text-align: left;">Axial dispersion coefficient.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(L\)</span></td>
<td style="text-align: left;">Length of the tubular reactor.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(M_{ex}\)</span></td>
<td style="text-align: left;">Molecular weight of the heat exchange fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Pressure.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot Q\)</span></td>
<td style="text-align: left;">Instantaneous net rate of heat input to the system.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot Q_{ex}\)</span></td>
<td style="text-align: left;">Rate of heat transfer <em>into</em> the heat exchange fluid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R\)</span></td>
<td style="text-align: left;">Ideal gas constant.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(T\)</span></td>
<td style="text-align: left;">Temperature, an additional subscript denotes the location.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T_{ex}\)</span></td>
<td style="text-align: left;">Temperature of the heat exchange fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(U\)</span></td>
<td style="text-align: left;">Heat transfer coefficient.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(V\)</span></td>
<td style="text-align: left;">Volume of the (fluid) system.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(V_{ex}\)</span></td>
<td style="text-align: left;">Volume of heat exchange fluid within the reactor shell/jacket.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\hat V_i\)</span></td>
<td style="text-align: left;">Volume per mole of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\dot{V}\)</span></td>
<td style="text-align: left;">Volumetric flow rate, an additional subscript denotes the location.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot W\)</span></td>
<td style="text-align: left;">Instantaneous net rate at which the system does mechanical work on the surroundings.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\gamma\)</span></td>
<td style="text-align: left;">Fraction of the heat exchange fluid that undergoes phase change within the reactor shell/jacket.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\lambda_{ax}\)</span></td>
<td style="text-align: left;">Thermal axial dispersion coefficient.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\nu_{i,j}\)</span></td>
<td style="text-align: left;">Stoichiometric coefficient of reagent <span class="math inline">\(i\)</span> in reaction <span class="math inline">\(j\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\rho_{ex}\)</span></td>
<td style="text-align: left;">Density of the heat exchange fluid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\omega_i\)</span></td>
<td style="text-align: left;">Variable equal to the derivitive of <span class="math inline">\(C_i\)</span> with respect to <span class="math inline">\(z\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\omega_T\)</span></td>
<td style="text-align: left;">Variable equal to the derivitive of <span class="math inline">\(T\)</span> with respect to <span class="math inline">\(z\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\Delta H_j\)</span></td>
<td style="text-align: left;">Heat of reaction <span class="math inline">\(j\)</span>; a superscripted <span class="math inline">\(0\)</span> indicates the standard heat of reaction.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\Delta V\)</span></td>
<td style="text-align: left;">Change in volume; used in this appendix to represent the change in enthalpy when fliuds mix.</td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./apndx_kinetics_theories.html" class="pagination-link" aria-label="Kinetics Theories{#sec-apndx_kin_theories}">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Kinetics Theories{#sec-apndx_kin_theories}</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./apndx_mathematics.html" class="pagination-link" aria-label="Mathematics">
        <span class="nav-page-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Mathematics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>