<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Analysis of Kinetics Data from a CSTR – Reaction Engineering Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./section_6_pfr_data_analysis.html" rel="next">
<link href="./section_6_bstr_data_analysis.html" rel="prev">
<link href="./Graphics/BuffaloBadger_16_16.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="http://buffalobadger.github.io" class="navbar-brand navbar-brand-logo">
    <img src="./Graphics/Banner.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/RE_Basics"> 
<span class="menu-text">Reaction Engineering Basics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/SCoRE"> 
<span class="menu-text">SCoRE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/ToTaL_Engineering"> 
<span class="menu-text">ToTaL Engineering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/The_Sett"> 
<span class="menu-text">The Sett</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://buffalobadger.github.io/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_6_data_generation.html">Kinetics Data Analysis</a></li><li class="breadcrumb-item"><a href="./section_6_cstr_data_analysis.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_intro_safety_ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Reaction Engineering, Ethics and Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_rxns_reactors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reactions and Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_1_reaction_progress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reaction Progress</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Rate Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_rates_and_expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reaction Rates and Rate Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_2_mechanisms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reaction Mechanisms and Mechanistic Rate Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Reaction Engineering Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_react_eng_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reaction Engineering Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_reaction_engineering_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reaction Engineering Tasks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_3_formulating_calcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Completing Reaction Engineering Tasks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_bstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">BSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_sbstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">SBSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_non_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design of Non-Continuous Reactors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_cstr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">CSTR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_pfr_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">PFR Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_4_continuous_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Design of Continuous Reactors</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling Ideal Reactor Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_reactor_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reactor Networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_thermally_backmixed_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thermally Back-Mixed PFRs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_5_recycle_pfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recycle PFRs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Kinetics Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_data_generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generation and Analysis of Kinetics Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_bstr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_cstr_data_analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_6_pfr_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling Non-Ideal Reactors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_age_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Age Distribution Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_segregated_flow_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">A Segregated Flow Reactor Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_axial_dispersion_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Steady-State Axial Dispersion Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./section_7_zoned_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Zoned Reactor Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_prereq_knowledge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prerequisite Knowledge</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_nomenclature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Terminology and Sign Conventions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_reaction_thermo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Reaction Thermodynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_kinetics_theories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Kinetics Theories{#sec-apndx_kin_theories}</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_derivations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Derivation of Model Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_mathematics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Mathematics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apndx_useful_eqns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Frequently Used Equations</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#laboratory-cstrs" id="toc-laboratory-cstrs" class="nav-link active" data-scroll-target="#laboratory-cstrs"><span class="header-section-number">20.1</span> Laboratory CSTRs</a>
  <ul class="collapse">
  <li><a href="#testing-the-ideality-of-a-cstr" id="toc-testing-the-ideality-of-a-cstr" class="nav-link" data-scroll-target="#testing-the-ideality-of-a-cstr"><span class="header-section-number">20.1.1</span> Testing the Ideality of a CSTR</a></li>
  </ul></li>
  <li><a href="#cstr-kinetics-experiments-and-data" id="toc-cstr-kinetics-experiments-and-data" class="nav-link" data-scroll-target="#cstr-kinetics-experiments-and-data"><span class="header-section-number">20.2</span> CSTR Kinetics Experiments and Data</a></li>
  <li><a href="#design-of-cstr-experiments" id="toc-design-of-cstr-experiments" class="nav-link" data-scroll-target="#design-of-cstr-experiments"><span class="header-section-number">20.3</span> Design of CSTR Experiments</a>
  <ul class="collapse">
  <li><a href="#adjusted-experimental-inputs" id="toc-adjusted-experimental-inputs" class="nav-link" data-scroll-target="#adjusted-experimental-inputs"><span class="header-section-number">20.3.1</span> Adjusted Experimental Inputs</a></li>
  <li><a href="#experimental-responses" id="toc-experimental-responses" class="nav-link" data-scroll-target="#experimental-responses"><span class="header-section-number">20.3.2</span> Experimental Responses</a></li>
  </ul></li>
  <li><a href="#cstr-data-analysis" id="toc-cstr-data-analysis" class="nav-link" data-scroll-target="#cstr-data-analysis"><span class="header-section-number">20.4</span> CSTR Data Analysis</a>
  <ul class="collapse">
  <li><a href="#the-steady-state-cstr-model" id="toc-the-steady-state-cstr-model" class="nav-link" data-scroll-target="#the-steady-state-cstr-model"><span class="header-section-number">20.4.1</span> The Steady-State CSTR Model</a></li>
  <li><a href="#the-predicted-response-model" id="toc-the-predicted-response-model" class="nav-link" data-scroll-target="#the-predicted-response-model"><span class="header-section-number">20.4.2</span> The Predicted Response Model</a></li>
  <li><a href="#parameter-estimates-statistics-and-assessment-graphs" id="toc-parameter-estimates-statistics-and-assessment-graphs" class="nav-link" data-scroll-target="#parameter-estimates-statistics-and-assessment-graphs"><span class="header-section-number">20.4.3</span> Parameter Estimates, Statistics, and Assessment Graphs</a></li>
  <li><a href="#accuracy-assessment" id="toc-accuracy-assessment" class="nav-link" data-scroll-target="#accuracy-assessment"><span class="header-section-number">20.4.4</span> Accuracy Assessment</a></li>
  <li><a href="#analysis-using-a-linearized-model" id="toc-analysis-using-a-linearized-model" class="nav-link" data-scroll-target="#analysis-using-a-linearized-model"><span class="header-section-number">20.4.5</span> Analysis Using a Linearized Model</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">20.5</span> Examples</a>
  <ul class="collapse">
  <li><a href="#sec-example_20_5_1" id="toc-sec-example_20_5_1" class="nav-link" data-scroll-target="#sec-example_20_5_1"><span class="header-section-number">20.5.1</span> Analysis of CSTR Kinetics Data for a Liquid-Phase Reaction</a></li>
  <li><a href="#sec-example_20_5_2" id="toc-sec-example_20_5_2" class="nav-link" data-scroll-target="#sec-example_20_5_2"><span class="header-section-number">20.5.2</span> Analysis of Data for a Gas-Phase Reaction with Change of Total Moles</a></li>
  <li><a href="#sec-example_20_5_3" id="toc-sec-example_20_5_3" class="nav-link" data-scroll-target="#sec-example_20_5_3"><span class="header-section-number">20.5.3</span> Analysis of Data for a Reversible Reaction</a></li>
  </ul></li>
  <li><a href="#symbols-used-in-sec-6_cstr_data_analysis" id="toc-symbols-used-in-sec-6_cstr_data_analysis" class="nav-link" data-scroll-target="#symbols-used-in-sec-6_cstr_data_analysis"><span class="header-section-number">20.6</span> Symbols Used in <span>Chapter 20</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section_6_data_generation.html">Kinetics Data Analysis</a></li><li class="breadcrumb-item"><a href="./section_6_cstr_data_analysis.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-6_cstr_data_analysis" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a CSTR</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This section of <em>Reaction Engineering Basics</em> focuses upon the analysis of kinetics data for the purpose of assessing the accuracy of a proposed rate expression. <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> presented a general introduction to kinetics data generation and analysis and <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a> examined the analysis of kinetics data generated using a BSTR. This chapter is like <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a> except it is focused on the analysis of kinetics data generated using a CSTR.</p>
<section id="laboratory-cstrs" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="laboratory-cstrs"><span class="header-section-number">20.1</span> Laboratory CSTRs</h2>
<p>There are many similarities between BSTRs and CSTRs. The primary difference is that fluid continually flows in and out of a CSTR. Basically CSTRs are BSTRs with inlet and outlet flow streams. Other than the stopped flow reactor, the BSTRs described in <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a> could be converted to CSTR simply by adding a flow in and a flow out. In the case of the recirculation loop reactor, <a href="section_6_bstr_data_analysis.html#fig-batch_recirc_reactor" class="quarto-xref">Figure&nbsp;<span>19.2</span></a>, the flow in and out should be small compared to the recirculation flow within the loop. As with the BSTR, one of the most important characteristics of a CSTR is that it is perfectly mixed. As discussed below, when a CSTR is used to generate kinetics data, it is preferable to operate the CSTR at steady state. Consequently, in addition to assessing the mixing before experiments begin, it is also important to verify steady-state operation while conducting the experiments.</p>
<section id="testing-the-ideality-of-a-cstr" class="level3" data-number="20.1.1">
<h3 data-number="20.1.1" class="anchored" data-anchor-id="testing-the-ideality-of-a-cstr"><span class="header-section-number">20.1.1</span> Testing the Ideality of a CSTR</h3>
<p>Given the similarities between BSTRs and CSTRs, most of the discussion in <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a> applies here, as well. Specifically, one of the most important requirements is that the reactor must be perfectly mixed. Smoke tests and the measurement of the reactor response as the agitation rate is increased again can be used to test for perfect mixing. In addition, a property known as the residence time distribution can be used to assess how well a reactor conforms to the assumptions of an ideal CSTR. Essentially, it provides a necessary, but not sufficient, criterion that the laboratory reactor must satisfy. The measurement and use of the residence time distribution will be presented in <a href="section_7_segregated_flow_model.html" class="quarto-xref"><span>Chapter 23</span></a>.</p>
</section>
</section>
<section id="cstr-kinetics-experiments-and-data" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="cstr-kinetics-experiments-and-data"><span class="header-section-number">20.2</span> CSTR Kinetics Experiments and Data</h2>
<p>The nature of kinetics experiments involving a CSTR and the data they generate is different in some respects from a BSTR. To prevent the generally strong temperature dependence of reaction rates from masking weaker composition and pressure effects, steady-state experiments using a temperature controller are preferred. The temperature controller continually monitors the reactor temperature and adjusts the heat input and/or cooling so that the reacting fluid temperature remains constant. To prevent temperature effects from masking composition effects, experiments should be performed in blocks where all of the experiments in a block are performed at the same temperature.</p>
<p>When the experimental CSTR operates at steady state, the reactor design equations are ATEs. Since the reacting fluid temperature is constant and known, the mole balance design equations can be solved independently of the energy balances. The outlet molar flow rates of the reagents can be calculated using only the mole balances, so they are the only design equations needed when analyzing steady-state CSTR kinetics data.</p>
<p>In a typical CSTR kinetics experiment, the rate of fluid flow into the reactor is set along with the composition of the feed fluid, the pressure and the reacting fluid temperature. Once these inputs have been fixed, the flow rate and composition of the fluid leaving the reactor is monitored. Initially the outlet composition and flow rate may change over time. This indicates that the CSTR has not yet reached steady state. When the outlet flow rate and composition become constant, the CSTR has reached steady state, and the response can be measured to conclude the experiment. This is very different from BSTR experiments where the response was measured several times during a single experiment. The reason, of course, is that the composition changes during a BSTR experiment wherease nothing changes during a steady-state CSTR experiment. Consequently, the generation of kinetics data using a CSTR typically involves many more experiments compared to when a BSTR is used. Because reagents are flowing the whole time until steady-state is reached, CSTR experiments typically consume more reagent than batch experiments.</p>
</section>
<section id="design-of-cstr-experiments" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="design-of-cstr-experiments"><span class="header-section-number">20.3</span> Design of CSTR Experiments</h2>
<p>In isothermal BSTR experiments the initial composition and pressure of the reacting fluid and the elapsed time at which the response was measured were the inputs that were adjusted so that the experiments sampled a wide range of compositions. In a sense, the same is true of flow reactor experiments (both CSTR and PFR), but in flow reactors the space time, <a href="section_3_react_eng_models.html#eq-space_time" class="quarto-xref">Equation&nbsp;<span>6.1</span></a>, determines how long the reaction is allowed to proceed instead of the elapsed wall-clock time (see <a href="section_3_react_eng_models.html" class="quarto-xref">Chapter&nbsp;<span>6</span></a>). This means that for flow reactors there are more reactor inputs that can be adjusted from experiment to experiment.</p>
<p>As noted in <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a>, preliminary studies typically define ranges of interest for temperature, pressure, and composition, and the purpose of kinetics experiments is to generate kinetics data that span those ranges. For each factor (e.g.&nbsp;the temperature, pressure, the concentration of reagent A, the concentration of reagent B, etc.) a set of values (also called levels) are chosen that span its range of interest. Increasing the number of levels improves the resolution of the effect of that factor upon the reaction rate. At the same time, increasing the number of levels increases the number of experiments that must be performed. Once the levels have been chosen for each factor, a factorial design like that described in <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> can be used to specify the experiments that will be performed.</p>
<section id="adjusted-experimental-inputs" class="level3" data-number="20.3.1">
<h3 data-number="20.3.1" class="anchored" data-anchor-id="adjusted-experimental-inputs"><span class="header-section-number">20.3.1</span> Adjusted Experimental Inputs</h3>
<p>Temperature is always an important factor in kinetics experiments. The pressure is constant in CSTR experiments, so if pressure is a factor of interest, the reactor pressure becomes one of the adjusted inputs. Typically the pressure does not affect the rate of liquid-phase reactions, but it can be important for gas-phase reactions.</p>
<p>The concentrations (or, for gases, partial pressures) within the reactor are the ones that need to span their range of interest, but unfortunately they cannot be adjusted directly. Instead, the composition and flow rate of the feed entering the reactor are adjusted. Depending upon the configuration of the feed system, the variables that can be adusted include the molar flow rates of the individual reagents or the volumetric flow rate of the feed and the concentrations of the reagents in that feed. Changing these quantities effectively changes the starting composition and the space time. (This assumes that the same reactor will be used in every experiment so the reactor volume cannot be adjusted to vary the space time.)</p>
</section>
<section id="experimental-responses" class="level3" data-number="20.3.2">
<h3 data-number="20.3.2" class="anchored" data-anchor-id="experimental-responses"><span class="header-section-number">20.3.2</span> Experimental Responses</h3>
<p>It was noted in <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a> that there are many different quantities that can be used as the experimental response. That discussion won’t be repeated here. The response should be a quantity that is directly related to the composition of the fluid leaving the reactor or to the extent of reaction relative to the reactor feed. In other words, after measuring the response and knowing the feed, it should be possible to calculate the concentration of every reagent in the product stream leaving the reactor.</p>
</section>
</section>
<section id="cstr-data-analysis" class="level2" data-number="20.4">
<h2 data-number="20.4" class="anchored" data-anchor-id="cstr-data-analysis"><span class="header-section-number">20.4</span> CSTR Data Analysis</h2>
<p>The analysis of kinetics data generated using a CSTR is analogous to the analysis of data from a BSTR, <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a>. First a steady-state CSTR model is generated. The rate expression (and hence the rate expression parameters) appears in the CSTR model. That model is then used to generate a predicted response model. The predicted response model relates the response to the adjusted experimental inputs and the rate expression parameters. It can be fit to the experimental data. That is the best estimates for the values of the rate expression parameters can be taken to be the ones that minimize the difference between the measured responses and the model-predicted responses. Fitting the predicted response model to the experimental data yields estimates for the rate expression parameters, 95% confidence intervals (or standard errors) for the estimated parameters, amd the coefficient of determination. Using the estimated rate expression parameters, the model predicted responses for all of the experiments, and the experiment residuals for all of the experiments can be calculated and used to generate assessment graphs. Finally the accuracy of the resulting model is assessed.</p>
<p>A concise assignment summary can be useful when a kinetics data analysis is undertaken. In this book the summary identifies the reactor used in the experiments and how it was operated, and it includes a simple schematic representation of that reactor. It lists the adjusted experimental inputs and the experimental response. The rate coefficient estimates and uncertainties, coefficient of determination, model-predicted responses and experiment residuals are typically shown in the summary as the quantities of interest because they are used directly or to make assessment graphs that for the assessment of the accuracy of the rate expression. The assignment summary concludes with a listing of given and known constants from the assignment narrative. If it is permissible to choose a basis for the calculations, it is included among the given and known constants.</p>
<section id="the-steady-state-cstr-model" class="level3" data-number="20.4.1">
<h3 data-number="20.4.1" class="anchored" data-anchor-id="the-steady-state-cstr-model"><span class="header-section-number">20.4.1</span> The Steady-State CSTR Model</h3>
<p>The formuation of a steady-state CSTR model involves selecting and simplifying the design equations, guessing a design equations solution, defining the residuals function that is needed to solve the design equations, and defining a CSTR model function that solves the design equations.</p>
<p><strong>Design Equations</strong> During the analysis of kinetics data the CSTR design equations are solved to find the outlet molar flow rates of the reagents. If the reactor operates at steady-state and at a known temperature, the mole balances can be solved for the outlet molar flow rates independently of any energy balances. Therefore only the mole balances are included in the design equations.</p>
<p>The general form of the CSTR mole balances is given in <a href="section_3_react_eng_models.html#eq-cstr_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.24</span></a>. When the reactor operates at steady-state, the time derivatives are all equal to zero. Additionally, if only one reaction is taking place within the reactor, the sum over the reactions reduces to a single term and it isn’t necessary to index the reaction. Accordingly, the steady-state CSTR mole balances for kinetics data analysis take the form shown in <a href="#eq-cstr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>20.1</span></a>, with one mole balance for each reagent present in the system. Anticipating that the design equations will be solved numerically <a href="#eq-cstr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>20.1</span></a> is written in the form of a residual expression.</p>
<p><span id="eq-cstr_mole_bal_one_reaction"><span class="math display">\[
0 = \epsilon = \dot{n}_{i,0} - \dot{n}_{i,1} + \nu_i r V
\tag{20.1}\]</span></span></p>
<p><strong>Initial Guesses for the Design Equations Solution</strong> The steady-state CSTR design equations are ATEs. When they are solved numerically, a guess for their solution must be provided. During the analysis of kinetics data, the design equations will be solved for every experiment in the data set. The likelihood of convergence to a solution can be improved if the measured responses are used to generate guesses. To do so, the inlet molar flow rates and the measured response are used to calculate the extent of reaction. Then the extent of reaction and the inlet molar flow rates are used to calculate guesses for the outlet molar flow rates. (See <a href="section_1_reaction_progress.html" class="quarto-xref"><span>Chapter 3</span></a>.)</p>
<p><strong>Residuals Function</strong> The residuals function is written by the engineer analyzing the kinetics data, but it is used by an ATE solver from a mathematics software package. During kinetics data analysis, its purpose is to calculate the design equation residuals that correspond to a set of outlet molar flow rates provide to it. The definition of the residuals function should indicate that the arguments are the outlet molar flow rates of the reagents, and it returns the design equation residuals.</p>
<p>No other quantities can be passed to the residuals function as arguments. If additional quantities need to be provided to the residuals function in order to evaluate the design equation residuals, the definition of the residuals function should identify them. During kinetics data analysis the rate expression parameters and the adjusted experimental inputs for the experiment being analysec commonly must be made available to the residuals function.</p>
<p>Finally the definition of the residuals function should present the algorithm it uses. That is, the sequence of calculations that need to be performed to evaluate the design equation residuals should be listed. The algorithm should use the given and known constants, additional quantities that have been made available to the residuals function, and the arguments (the outlet molar flow rates).</p>
<p><strong>CSTR Model Function</strong></p>
<p>The purpose of the CSTR model function is to solve the CSTR design equations for the outlet molar flow rates of the reagents. It must be written by the engineer performing the analysis, and since it is not called by functions from a mathematics software package, that engineer can decide what arguments need to be passed to it. Its definition should list those argument, and it should identify the outlet molar flow rates of the reagents as the values it returns. As noted above, one argument to the CSTR model function should be the measured response for the experiment being analyzed because it is needed to generate an initial guess for the design equations unknowns. Similarly, any quantities that need to be made available to the residuals function (e. g. the rate expression parameters and the adjusted experimental inputs for the experiment being analyzed) should be passed to the CSTR model function, and it should make them available just before calling the ATE solver.</p>
<p>The definition of the CSTR model function should conclude with a description of its algorithm. Generally the algorithm is quite simple. First it should make the quantities needed by the residuals function available to it. Next it should calculate the initial guesses for the design equations solution. Finally, it should calculate the outlet molar flow rates of the reagents (the return values) by calling an ATE solver and passing the initial guesses and the residuals function to it.</p>
</section>
<section id="the-predicted-response-model" class="level3" data-number="20.4.2">
<h3 data-number="20.4.2" class="anchored" data-anchor-id="the-predicted-response-model"><span class="header-section-number">20.4.2</span> The Predicted Response Model</h3>
<p>The formulation of the predicted responses model involves generating a model which relates the predicted response for an experiment to the rate expression parameters and the adjusted experimental inputs. It additionally includes defining a predicted responses function that will be used to fit the model to the experimental data.</p>
<p><strong>Predicted Response</strong> The CSTR model cannot be fit directly to the experimental model. It relates the outlet molar flow rates to the rate expression parameters and the adjusted experimental inputs for an experiment. The predicted response model can be generated by simply solving the CSTR model function for the outlet molar flow rates and then adding equations for calculating the predicted response from the outlet molar flow rates.</p>
<p><strong>Predicted Responses Function</strong> A numerical fitting function is used to fit the predicted responses model to the experimental data. In addition to a guess for the rate expression parameters, the full set of adjusted experimental inputs, and the full set of measured responses, a predicted responses function must be provided to the numerical fitting function. The purpose of the predicted responses function is to use the predicted responses model to calculate the model-predicted response for all of the experiments and return them.</p>
<p>The engineer performing the analysis must write the predicted responses function, but it will be called by a numerical fitting function from a mathematics of satistics software package. Typically that package assumes that the only arguments are the full set of adjusted experimental inputs and the rate expression parameters, and it will expect the predicted responses function to return the full set of model-predicted responses and nothing else. If the predicted responses function requires any other input, that input must be made available to it by some means other than as an argument.</p>
<p>The definition of the predicted responses function should indicate that its arguments are the rate expression parameters and the full set of adjusted experimental imputs, and it should indicate that the predicted responses function returns the full set of model-predicted responses. The definition should also indicate that the full set of measured experimental responses must be made available to the predicted responses function. The measured responses are needed because the predicted responses function will call the CSTR model function, and the measure response is one o the arguments to the CSTR model function.</p>
<p>The algorithm for the predicted response function is simple and should be included in its definition. For each experiment it should solve the CSTR design equations (call the CSTR model function) and use the reulting outlet molar flow rates to calculate the model-predicted response. Then it should return the full set of model-predicted responses.</p>
</section>
<section id="parameter-estimates-statistics-and-assessment-graphs" class="level3" data-number="20.4.3">
<h3 data-number="20.4.3" class="anchored" data-anchor-id="parameter-estimates-statistics-and-assessment-graphs"><span class="header-section-number">20.4.3</span> Parameter Estimates, Statistics, and Assessment Graphs</h3>
<p>The estimated rate expression parameters, their uncertainty, the coefficient of determination, the full set of model-predicted responses, and the full set of experiment residuals were previously identified as the quantities of interest in kinetics data analysis. The latter two are used to generate a parity plot and residuals plots. Formulation of the calculations to find these quantities of interest and generate the graphs is uncomplicated.</p>
<p><strong>Parameter Estimation</strong> The parameter estimates, parameter estimate uncertainties, and coefficient of determination are found by fitting the predicted responses model to the experimental data using a numerical fitting function from a mathematics or statistics software package. The numerical fitting function will require four inputs: a guess for the rate expression parameters, the full set of adjusted experimental inputs, the full set of measured responses, and a predicted responsed function.</p>
<p>Assuming the data and the predicted responses function are available, the calculations consist of two steps. First guesses for each rate expression parameter are made. (See <a href="section_6_data_generation.html#sec-example_18_6_2" class="quarto-xref">Example&nbsp;<span>18.6.2</span></a> for an example of using the base-10 log of a parameter when it’s possible value spans many orders of magnitude&gt;) Then the numerical fitting function is called to get the parameter estimates, parameter estimate uncertainties, and coefficient of determination.</p>
<p><strong>Assessment Graphs</strong> Once the parameter estimates are found, the full set of model-predicted responses can be obtained by calling the predicted responses function, passing the estimated parameters and the full set of adjusted inputs as arguments. The full set of experiment residuals can be calculated by taking the difference between the measured response and the model-predicted response for each experiment.</p>
<p>To generate a parity plot the measured responses are plotted against the model-predicted responses as points. The parity line, a line where the measured response equals the model-predicted response, is then added. In a residuals plot, the experiment residuals are plotted against any one of the adjusted experimental inputs. A full set of residuals plots can be generated by making a residuals plot for each of the adjusted experimental inputs.</p>
</section>
<section id="accuracy-assessment" class="level3" data-number="20.4.4">
<h3 data-number="20.4.4" class="anchored" data-anchor-id="accuracy-assessment"><span class="header-section-number">20.4.4</span> Accuracy Assessment</h3>
<p>Once the quantities of interest have been calculated and the assessment graphs have been generated, the accuracy of the model can be assessed. If the rate expression is accurate, the following criteria will be satisfied.</p>
<ul>
<li>The coefficient of determination, <span class="math inline">\(R^2\)</span>, will be close to 1.</li>
<li>The points in the parity plot will all be close to the parity line.</li>
<li>In each residuals plot, the points will scatter randomly about zero (the horizontal axis), and no systematic deviations will be apparent.</li>
<li>The uncertainty in most, if not all, parameter estimates will be small compared to their estimated value. (See <a href="section_6_data_generation.html" class="quarto-xref"><span>Chapter 18</span></a> for a discussion of why a few estimates may have a large uncertaintly.)</li>
</ul>
</section>
<section id="analysis-using-a-linearized-model" class="level3" data-number="20.4.5">
<h3 data-number="20.4.5" class="anchored" data-anchor-id="analysis-using-a-linearized-model"><span class="header-section-number">20.4.5</span> Analysis Using a Linearized Model</h3>
<p>When only one reaction is taking place, as is the case in <em>Reaction Engineering Basics</em> kinetics data analysis problems, the reactor can be modeled using only one mole balance on a reactant or product in the reaction. When this is done, the apparent extent of reaction is used to relate the amounts of all other reagents to the reagent for which the mole balance is written. If that one mole balance can be rearranged into a linear form, it can be fit to the experimental data using linear least squares. Often a spreadsheet can be used to do so. This was described and illustrated in Chapters <a href="section_6_data_generation.html" class="quarto-xref"><span>18</span></a> and <a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>19</span></a> and won’t be repeated or illustrated in this chapter.</p>
<p>One point to note, however, is that with CSTR kinetics data, the mole balance is already an ATE. It isn’t necessary to integrate an IVODE before linearizing it. Indeed, for a simple rate expression with only one rate coefficient of the form shown in <a href="#eq-simple_rate_expr" class="quarto-xref">Equation&nbsp;<span>20.2</span></a>, the mole balance, <a href="#eq-cstr_mole_bal_one_reaction" class="quarto-xref">Equation&nbsp;<span>20.1</span></a>, will already have the linear form shown in <a href="#eq-linear_no_intercept" class="quarto-xref">Equation&nbsp;<span>20.3</span></a> if <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are defined as shown in <a href="#eq-def_y" class="quarto-xref">Equation&nbsp;<span>20.4</span></a> and <a href="#eq-def_x" class="quarto-xref">Equation&nbsp;<span>20.5</span></a>.</p>
<p><span id="eq-simple_rate_expr"><span class="math display">\[
r = kf\left(\dot{n}_i,P\right)
\tag{20.2}\]</span></span></p>
<p><span id="eq-linear_no_intercept"><span class="math display">\[
y=kx
\tag{20.3}\]</span></span></p>
<p><span id="eq-def_y"><span class="math display">\[
y = \dot{n}_{i,1} - \dot{n}_{i,0}
\tag{20.4}\]</span></span></p>
<p><span id="eq-def_x"><span class="math display">\[
x=\nu_i V f\left(\dot{n}_i,P\right)
\tag{20.5}\]</span></span></p>
</section>
</section>
<section id="examples" class="level2" data-number="20.5">
<h2 data-number="20.5" class="anchored" data-anchor-id="examples"><span class="header-section-number">20.5</span> Examples</h2>
<p>As noted above, the analysis of data from a CSTR is quite similar to the analysis of BSTR data (<a href="section_6_bstr_data_analysis.html" class="quarto-xref"><span>Chapter 19</span></a>) or PFR data (<a href="section_6_pfr_data_analysis.html" class="quarto-xref"><span>Chapter 21</span></a>). Perhaps the most significant difference for analysis of CSTR data is that the reactor design equations are ATEs whereas for BSTRs and PFRs they are IVODEs.</p>
<p>The first example here considers a liquid-phase reaction. Assuming liquids to be incompressible, ideal mixtures means that the inlet and outlet volumetric flow rates are equal. In contrast, for a gas-phase reacting fluid the inlet and outlet volumetric flow rates will not be equal if the reaction causes a change in the total number of moles. That situation is illustrated in <a href="#sec-example_20_5_2" class="quarto-xref">Example&nbsp;<span>20.5.2</span></a>. The final example in this chapter illustrates the assessment of a rate expression that contains both forward and reverse rate coefficients.</p>
<section id="sec-example_20_5_1" class="level3" data-number="20.5.1">
<h3 data-number="20.5.1" class="anchored" data-anchor-id="sec-example_20_5_1"><span class="header-section-number">20.5.1</span> Analysis of CSTR Kinetics Data for a Liquid-Phase Reaction</h3>
<p>The liquid-phase reaction between reactants A and B, reaction (1), was studied in a 100 cm<sup>3</sup> laboratory CSTR. The reactor operated at steady state, the volumetric flow rate and the inlet concentrations of each of the reagents were adjusted from one experiment to the next, and the steady-state outlet concentration of reagent Y was measured. Use the experimental data to assess the accuracy with which the rate expression shown in equation (2) describes the rate of reaction (1).</p>
<p><span class="math display">\[
A + B \rightarrow Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = kC_AC_B \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_20_1_data" class="quarto-xref">Table&nbsp;<span>20.1</span></a>. The full data set is available in the file <a href="examples/reb_20_5_1/reb_20_5_1_data.csv">reb_20_5_1_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_20_1_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_20_1_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20.1: First 8 experimental data points.
</figcaption>
<div aria-describedby="tbl-example_20_1_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 28%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">T (K)</th>
<th style="text-align: center;"><span class="math inline">\(\dot{V}\)</span> (cm<sup>3</sup> min<sup>-1</sup>)</th>
<th style="text-align: center;">C<sub>A,0</sub> (M)</th>
<th style="text-align: center;">C<sub>B,0</sub> (M)</th>
<th style="text-align: center;">C<sub>Y,0</sub> (M)</th>
<th style="text-align: center;">C<sub>Z,0</sub> (M)</th>
<th style="text-align: center;">C<sub>Y,1</sub> (M)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">300</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.86</td>
</tr>
<tr class="even">
<td style="text-align: center;">300</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">0.82</td>
</tr>
<tr class="odd">
<td style="text-align: center;">300</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">0.69</td>
</tr>
<tr class="even">
<td style="text-align: center;">300</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">0.61</td>
</tr>
<tr class="odd">
<td style="text-align: center;">300</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.38</td>
</tr>
<tr class="even">
<td style="text-align: center;">300</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">1.33</td>
</tr>
<tr class="odd">
<td style="text-align: center;">300</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">1.19</td>
</tr>
<tr class="even">
<td style="text-align: center;">300</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">1.10</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I see that this assignment describes reactor experiments, presents the data from the experiments and asks me to use the data to assess the accuracy of a proposed rate expressions. So this is a kinetics data analysis assignment for a liquid-phase reaction taking place in a steady-state CSTR. In the experiments the temperature, the volumetric feed rate, and the feed concentrations of the four reagents were adjusted and the outlet concentration of reagent Y was measured as the response.</p>
<p>I’ll begin by summarizing the assignment using appropriate variable symbols for each quantity. I’ll use a subscripted “0” to denote values associated with the reactor feed and a subscripted “1” to denote values associated with the reactor outlet. An underline will be used to indicate sets of values and subscripted “CI,l” and “CI,u” will indicate the lower and upper limits of a 95% confidence interval. Finally, since this is a liquid-phase system, the feed and volumetric flow rates will be equal, so I won’t use a feed or outlet subscript on the volumetric flow rate.</p>
<p>In order to assess the accuracy of the rate expression I will need to fit the data to a model. Assuming Arrhenius temperature dependence, that will yield estimates for the pre-exponential factor and activation energy, estimates for their 95% confidence intervals, and the coefficient of determination. To help assess the accuracy, I will calculate the model-predicted responses and experiment residuals and use them to generate a parity plot and residuals plots because they will be useful for assessing accuracy. Thus, I’ll list all of these as quantities of interest.</p>
</div>
</div>
</div>
<section id="assignment-summary" class="level4" data-number="20.5.1.1">
<h4 data-number="20.5.1.1" class="anchored" data-anchor-id="assignment-summary"><span class="header-section-number">20.5.1.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Steady-state, liquid-phase CSTR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_20_5_1_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_1_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/cstr_isothermal_ss_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_1_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.1: Schematic representation of the steady-state CSTR used in the experiments.
</figcaption>
</figure>
</div>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{C}_{Y,1,model}\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{Y,1}\)</span> (as a parity plot), and <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{B,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{C}_{Z,0}\)</span> (as residuals plots).</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(V=100 \text{ cm}^3\)</span>.</p>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\dot{V}}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, <span class="math inline">\(\underline{C}_{B,0}\)</span>, <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <span class="math inline">\(\underline{C}_{Z,0}\)</span>.</p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{C}_{Y,1}\)</span>.</p>
</section>
<section id="mathematical-formulation-of-the-analysis" class="level4" data-number="20.5.1.2">
<h4 data-number="20.5.1.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-analysis"><span class="header-section-number">20.5.1.2</span> Mathematical Formulation of the Analysis</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I know that I’ll need an isothermal, steady-state CSTR model to analyze the data, so I’ll develop that first. Because the temperature in each experiment is constant and known, I can solve the CSTR mole balances independently of any energy balances. Furthermore, I can calculate everything I need using only the mole balances, so for this analysis the reactor design equations will consist of a mole balance on each reagent present in the system.</p>
<p>The general form of the steady-state CSTR mole balance is given in <a href="section_3_react_eng_models.html#eq-cstr_ss_mole_balance" class="quarto-xref">Equation&nbsp;<span>6.31</span></a>, but here there is only one reaction occurring, so the summation over the reactions reduces to a single term and there isn’t a need to index the reactions. I’ll be solving the design equations numerically, so I’ll write them as residuals expressions.</p>
<p><span class="math display">\[
0 = \epsilon = \dot{n}_{i,0} - \dot{n}_{i,1} + \nu_i r V
\]</span></p>
<p>I’ll be solving the design equations to find the outlet molar flow rates of the reagents. To do so numerically I’ll need to provide guesses for those unknowns and a residuals function.</p>
<p>I will use the experimental response for each experiment to generate a guess for the design equation unknowns (the outlet molar flow rates of the reagents). To do so I’ll calculate the outlet molar flow rate of Y from the measured outlet concentration of Y. From that I can calculate the apparent extent of reaction, and then the outlet molar flow rates of the other reagents.</p>
</div>
</div>
</div>
<center>
<strong>Steady-State CSTR Model</strong>
</center>
<p><strong>Design Equations</strong></p>
<p><span class="math display">\[
0  = \epsilon_1 = \dot{n}_{A,0} - \dot{n}_{A,1} - rV \tag{3}
\]</span></p>
<p><span class="math display">\[
0  = \epsilon_2 = \dot{n}_{B,0} - \dot{n}_{B,1} - rV \tag{4}
\]</span></p>
<p><span class="math display">\[
0  = \epsilon_3 = \dot{n}_{Y,0} - \dot{n}_{Y,1} + rV \tag{5}
\]</span></p>
<p><span class="math display">\[
0  = \epsilon_4 = \dot{n}_{Z,0} - \dot{n}_{Z,1} + rV \tag{6}
\]</span></p>
<p><strong>Initial Guesses for the Design Equations Solution</strong></p>
<p><span class="math display">\[
\dot{n}_{Y,1,guess} = C_{Y,1} \dot{V} \tag{7}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Y,1,guess} = \dot{n}_{Y,0} + \dot{\xi}_{guess} \qquad \Rightarrow \qquad \dot{\xi}_{guess} = \dot{n}_{Y,1,guess} - \dot{n}_{Y,0} \tag{8}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{A,1,guess} = \dot{n}_{A,0} - \dot{\xi}_{guess} \tag{9}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,1,guess} = \dot{n}_{B,0} - \dot{\xi}_{guess} \tag{10}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,1,guess} = \dot{n}_{Z,0} + \dot{\xi}_{guess} \tag{11}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I will need to write the residuals function. Because it will be called by the ATE solver, it must have values for each of the ATE unknowns as its only arguments and it must return the corresponding values of the ATE residuals, <span class="math inline">\(\epsilon_1\)</span> through <span class="math inline">\(\epsilon_4\)</span>. The arguments and the given and known constants from the assignment summary will be available within the residuals function.</p>
<p>Before the ATE residuals can be calculated, any other unknown quantities appearing in the design equations must be calculated. In the present case, the only known quantity in the design equations is <span class="math inline">\(V\)</span>, so the inlet molar flow rates of the four reagents and the rate must be calculated. The inlet molar flow rates can be found from the inlet concentrations and the inlet volumetric flow rate, but those vary from one experiment to the next, so they will need to be made available to the residuals function.</p>
<p>The rate can be calculated using equation (2), but that requires <span class="math inline">\(k\)</span>, <span class="math inline">\(C_A\)</span>, and <span class="math inline">\(C_B\)</span>. The concentrations in the rate expression can be calculated using the defining equation for concentration, but that again requires the volumetric flow rate. The rate coefficient can be calculated using the Arrhenius expression, but that, in turn, requires the pre-exponential factor, activation energy, and temperature. The pre-exponential factor and activation energy will be changing as the response model is being fit to the data, and, like the inlet molar flow rates and the volumetric flow rate, the temperature will change from experiment to experiment. Therefore <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, and <span class="math inline">\(T\)</span> will need to be made available to the residuals function, too.</p>
</div>
</div>
</div>
<p><strong>Residuals Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span>.</p>
<p><u>Returns:</u> <span class="math inline">\(\epsilon_1\)</span>, <span class="math inline">\(\epsilon_2\)</span>, <span class="math inline">\(\epsilon_3\)</span>, and <span class="math inline">\(\epsilon_4\)</span>.</p>
<p><u>Must be Available:</u> <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{B,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>.</p>
<p><u>Algorithm:</u></p>
<p><span class="math display">\[
\dot{n}_{A,0} = C_{A,0}\dot{V} \tag{12}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,0} = C_{B,0}\dot{V} \tag{13}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Y,0} = C_{Y,0}\dot{V} \tag{14}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,0} = C_{Z,0}\dot{V} \tag{15}
\]</span></p>
<p><span class="math display">\[
C_{A,1} = \frac{\dot{n}_{A,1}}{\dot{V}} \tag{16}
\]</span></p>
<p><span class="math display">\[
C_{B,1} = \frac{\dot{n}_{B,1}}{\dot{V}} \tag{17}
\]</span></p>
<p><span class="math display">\[
k = k_0 \exp{\left(\frac{-E}{RT}\right)} \tag{18}
\]</span></p>
<p><span class="math display">\[
r = kC_{A,1}C_{B,1} \tag{2}
\]</span></p>
<p><span class="math display">\[
\epsilon_1 = \dot{n}_{A,0} - \dot{n}_{A,1} - rV  \tag{3}
\]</span></p>
<p><span class="math display">\[
\epsilon_2 = \dot{n}_{B,0} - \dot{n}_{B,1} - rV  \tag{4}
\]</span></p>
<p><span class="math display">\[
\epsilon_3 = \dot{n}_{Y,0} - \dot{n}_{Y,1} + rV  \tag{5}
\]</span></p>
<p><span class="math display">\[
\epsilon_4 = \dot{n}_{Z,0} - \dot{n}_{Z,1} + rV \tag{6}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The last thing I need to complete the steady-state CSTR model is a function that solves the design equations. I’ll use an ATE solver to solve the design equations, so I’ll need to provide it with the guesses for the ATE unknowns and the residuals function above.</p>
<p>The model will be solved for each experiment and for different rate expression parameters. Therefore, I will pass the rate expression parameters, the adjusted experimental inputs for the experiment being analyzed, and the measured response for the experiment being analyzed as arguments. By doing so, the initial guesses for the outlet molar flow rates (the design equation unknowns) can be calculated as described above. The CSTR model function will then need to make the rate expression parameters and the adjusted experimental inputs available to the residuals function. Then all it needs to do is call an ATE solver to solve the design equations.</p>
<p>Being ATEs, he design equations might have multiple solutions. Hopefully by using guesses that were calculated from the measured response, the ATE solver will find the desired solution.</p>
</div>
</div>
</div>
<p><strong>CSTR Model Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{B,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(C_{Y,1}\)</span>, <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span>.</p>
<p><u>Returns:</u> <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span>.</p>
<p><u>Algorithm:</u></p>
<ol type="1">
<li>Make <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{B,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(k_0\)</span>, and <span class="math inline">\(E\)</span> available to the residuals function.</li>
<li>Calculate initial guesses for the ATE unknowns using equations (7) - (11).</li>
<li>Get and return <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span> by calling an ATE solver passing the initial guesses and residuals function as argument.</li>
</ol>
<center>
<strong>Quantities of Interest</strong>
</center>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The quantities of interest are the parameter estimates, the parameter uncertainties, the coefficient of determination, the full set of model-predicted responses, and the full set of experiment residuals. The parameter estimates, parameter uncertainties, and coefficient of determination will be found by fitting a predicted responses model to the experimental data.</p>
<p>The CSTR model cannot be fit to the experimental data directly because it does not yield a predicted value of the response, <span class="math inline">\(C_{A,1,model}\)</span>. Instead, I’ll use it to generate a predicted responses function. The predicted responses function will be called by a numerical fitting function. I will need to write it recognizing that it must receive the rate expression parameters (<span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>) and the full set of adjusted experimental inputs (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\dot{V}}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, <span class="math inline">\(\underline{C}_{B,0}\)</span>, <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <span class="math inline">\(\underline{C}_{Z,0}\)</span>) as its only arguments. It must return the full set of model-predicted responses (<span class="math inline">\(\underline{C}_{Y,1,model}\)</span>) and nothing else. Because the measured response for the experiment being modeled is one of the arguments to the CSTR model function, the measured responses need to be made available to the predicted responses function.</p>
<p>All that the predicted responses function needs to do is go through the experiments one by one. For each one it simply needs to extract the adjusted inputs and measured response for that experiment from the full sets and call the CSTR model function. The CSTR model function will solve the design equations and return the outlet molar flow rates of the reagents. From those and the volumetric flow rate, the outlet concentration of Y, the response, can be calculated. After it goes through all of the experiments it can then return the full set of model-predicted responses.</p>
</div>
</div>
</div>
<p><strong>Predicted Responses Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\dot{V}}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, <span class="math inline">\(\underline{C}_{B,0}\)</span>, <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <span class="math inline">\(\underline{C}_{Z,0}\)</span></p>
<p><u>Returns:</u> <span class="math inline">\(\underline{C}_{Y,1,model}\)</span></p>
<p><u>Must be Available:</u> <span class="math inline">\(\underline{C}_{Y,1}\)</span></p>
<p><u>Algorithm:</u></p>
<ol type="1">
<li><p>For each experiment in the data set</p>
<ol type="a">
<li><p>Extract <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{B,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, and <span class="math inline">\(C_{Y,1}\)</span> for that experiment from the full data sets.</p></li>
<li><p>Get <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span> by calling the CSTR model function, passing the rate expression parameters, adjusted inputs for the experiment and measured response for the experiment as arguments.</p></li>
<li><p>Calculate the model-predicted response.</p></li>
</ol></li>
</ol>
<p><span class="math display">\[
C_{Y,1,model} = \frac{\dot{n}_{Y,1}}{\dot{V}} \tag{19}
\]</span></p>
<ol start="2" type="1">
<li>Return the full set of model-predicted responses, <span class="math inline">\(\underline{C}_{Y,1,model}\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now that I have a model that predicts the responses for the experiments, I need to fit it to the experimental data. I’ll do that using a numerical fitting function. The fitting function will require four things as arguments: (1) guesses for the rate expression parameters, (2) the set of adjusted inputs for all of the experiments, (3) the set of experimental responses for all of the experiments, and (4) the predicted responses function above.</p>
<p>Assuming it is successful, the numerical fitting function will return estimates for the rate expression parameters, <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span>, estimates for the upper and lower limits of their 95% confidence intervals, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, and <span class="math inline">\(E_{CI,u}\)</span>, and the coefficient of determination, <span class="math inline">\(R^2\)</span>.</p>
<p>I can use the estimated rate expression parameters to calculate the model-predicted responses, and I can use them to calculate the experiment residuals. Then I can generate a parity plot and residuals plots.</p>
</div>
</div>
</div>
<p><strong>Parameter Estimation</strong></p>
<ol type="1">
<li>Make an initial guess for the parameters (<span class="math inline">\(k_{0,guess}\)</span> and <span class="math inline">\(E_{guess}\)</span>)</li>
<li>Get <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, and <span class="math inline">\(R^2\)</span> by calling a numerical fitting function, passing the guess for the parameters, the full set of adjusted experimental inputs, the full set of measured responses, and the predicted responses function as arguments.</li>
</ol>
<p><strong>Assessment Graphs</strong>list</p>
<ol type="1">
<li>Get <span class="math inline">\(\underline{C}_{Y,1,model}\)</span> by calling the predicted responses function passing the estimated parameters and the full set of adjusted inputs as arguments.</li>
<li>Calculate the experiment residuals.</li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{C}_{Y,1} - \underline{C}_{Y,1,model} \tag{19}
\]</span></p>
<ol start="3" type="1">
<li>Generate a parity plot showing <span class="math inline">\(\underline{C}_{Y,1}\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{Y,1,model}\)</span>.</li>
<li>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{B,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{C}_{Z,0}\)</span>.</li>
</ol>
<center>
<strong>Calculation Summary</strong>
</center>
<ol type="1">
<li>Read the adjusted experimental inputs and the experimental responses from the file, <a href="examples/reb_20_5_1/reb_20_5_1_data.csv">reb_20_5_1_data.csv</a>.</li>
<li>Make the set of measured responses available to the predicted responses function.</li>
<li>Perform the parameter estimation and assessment graphs calculations described above.</li>
<li>Display the results and/or save them to a file.</li>
</ol>
</section>
<section id="results-and-discussion" class="level4" data-number="20.5.1.3">
<h4 data-number="20.5.1.3" class="anchored" data-anchor-id="results-and-discussion"><span class="header-section-number">20.5.1.3</span> Results and Discussion</h4>
<p>The calculations were performed as described, except that the base-10 log of <span class="math inline">\(k\)</span> was estimated (see <a href="section_6_bstr_data_analysis.html#sec-example_19_5_1" class="quarto-xref">Example&nbsp;<span>19.5.1</span></a>), and the results are shown in <a href="#tbl-example_20_5_1_results" class="quarto-xref">Table&nbsp;<span>20.2</span></a>.</p>
<div class="cell">
<div id="tbl-example_20_5_1_results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_20_5_1_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20.2: Parameter estimation results
</figcaption>
<div aria-describedby="tbl-example_20_5_1_results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 92%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">k<sub>0</sub></td>
<td style="text-align: center;">8.72 x 10<sup>6</sup> L mol<sup>-1</sup> min<sup>-1</sup>, 95% CI [4.61 x 10<sup>6</sup>, 1.65 x 10<sup>7</sup>]</td>
</tr>
<tr class="even">
<td style="text-align: center;">E</td>
<td style="text-align: center;">9.92 kcal mol<sup>-1</sup>, 95% CI [9.52, 10.3]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.993</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The estimated rate coefficient was used to calculate the model-predicted response for each experiment, and that was used to calculate the residual for each experiment. The results were then used to generate the parity plot in <a href="#fig-example_20_5_1_parity" class="quarto-xref">Figure&nbsp;<span>20.2</span></a> and residuals plots shown in <a href="#fig-example_20_5_1_plots" class="quarto-xref">Figure&nbsp;<span>20.3</span></a>.</p>
<div id="fig-example_20_5_1_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_1_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_20_5_1/reb_20_5_1_parity.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_1_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.2: Parity Plot.
</figcaption>
</figure>
</div>
<div id="fig-example_20_5_1_plots" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_1_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_1/reb_20_5_1_T_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_1/reb_20_5_1_Vdot_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_1/reb_20_5_1_CA0_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_1/reb_20_5_1_CB0_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_1/reb_20_5_1_CY0_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_1/reb_20_5_1_CZ0_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_1_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.3: Residuals Plots.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The 95% confidence interval for <span class="math inline">\(k_0\)</span>, 4.61 x 10<sup>6</sup> to 1.65 x 10<sup>7</sup> L mol<sup>-1</sup> min<sup>-1</sup>, is roughly half to double its estimated value, 8.72 x 10<sup>6</sup> L mol<sup>-1</sup> min<sup>-1</sup>. The 95% confidence interval for <span class="math inline">\(E\)</span> is much narrower. There is some scatter apparent in the parity plot, and the coefficient of determination is 0.993. These factors suggest that the rate expression is reasonably accurate. The residuals plots for <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span> and <span class="math inline">\(C_Y\)</span> show random deviations of the residuals about zero, too. However, in the residuals plots for <span class="math inline">\(C_A\)</span> and <span class="math inline">\(C_B\)</span> the residuals at low concentration do not scatter equally about zero. The residuals for <span class="math inline">\(C_Z\)</span> show a definite trend, decreasing steadily as <span class="math inline">\(C_Z\)</span> increases. This suggests that the reaction rate may have some functional dependence on the concentration of Z that is not captured in the rate expression.</p>
</div>
</div>
</div>
<p><strong>Assessment</strong></p>
<p>The rate expression is reasonably accurate, but there are indications that the it may not fully capture the dependence of the rate on the concentration of reagent Z. Rate expressions that include a functional dependence on the concentration of Z should be postulated and assessed to determine whether they can represent the experimental results more accurately.</p>
</section>
</section>
<section id="sec-example_20_5_2" class="level3" data-number="20.5.2">
<h3 data-number="20.5.2" class="anchored" data-anchor-id="sec-example_20_5_2"><span class="header-section-number">20.5.2</span> Analysis of Data for a Gas-Phase Reaction with Change of Total Moles</h3>
<p>Preliminary experiments have indicated that gas-phase reaction (1) is irreversible and that the rate is not affected by the concentration of the product Z. To generate kinetics data, experiments were performed at three temperatures. An ideal CSTR operating at 3 atm was used for all experiments. The feed in every experiment contained only reagents A and B. The temperature, space time, and mole fraction of A in the feed were varied from experiment to experiment, and the outlet concentration of Z was measured. The first few data are presented below. Use the full data set, linked below, to assess the accuracy of the rate expression shown in equation (2) where the power-law reaction orders, <span class="math inline">\(\alpha_A\)</span> and <span class="math inline">\(\alpha_B\)</span>, must be estimated along with the pre-exponential factor and activation energy for the rate coefficient, <span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[
A + B \rightarrow Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = kP_A^{\alpha_A} P_B^{\alpha_B} \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_20_5_2_data" class="quarto-xref">Table&nbsp;<span>20.3</span></a>. The full data set is available in the file <a href="examples/reb_20_5_2/reb_20_5_2_data.csv">reb_20_5_2_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_20_5_2_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_20_5_2_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20.3: First 6 experimental data points.
</figcaption>
<div aria-describedby="tbl-example_20_5_2_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">T (°C)</th>
<th style="text-align: center;"><span class="math inline">\(\tau\)</span> (s)</th>
<th style="text-align: center;">y<sub>A,0</sub></th>
<th style="text-align: center;">C<sub>Z,1</sub> (mmol L<sup>-1</sup>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">440</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.1</td>
<td style="text-align: center;">0.41</td>
</tr>
<tr class="even">
<td style="text-align: center;">440</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.2</td>
<td style="text-align: center;">0.61</td>
</tr>
<tr class="odd">
<td style="text-align: center;">440</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">1.42</td>
</tr>
<tr class="even">
<td style="text-align: center;">440</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">1.64</td>
</tr>
<tr class="odd">
<td style="text-align: center;">440</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">2.21</td>
</tr>
<tr class="even">
<td style="text-align: center;">440</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">2.43</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The assignment narrative describes reactor experiments, provides the data generated in those experiments, and asks me to use them to assess the accuracy of a proposed rate expression. Those are distinguishing characteristics of a kinetics data analysis assignment.</p>
<p>I’ll begin by summarizing the assignment. I’ll assign an appropriate variable symbol to represent each of the quantities provided in the assignment. While doing so I will use a subscripted “0” to denote a quantity value at the inlet to the reactor and a subscripted “1” to denote one at the outlet. I’ll use subscripted “CI,l” and “CI,u” to denote values that are the lower or upper limit of a 95% confidence interval. I’ll underline a variable symbol if it represents a set of values (i. e. a vector).</p>
<p>In the experiments for this assignment, a CSTR that operated at steady-state was used. The adjusted experimental inputs were the temperature, space time, and feed mole fraction of reagent A, and the measured response was the outlet concentration of Z.</p>
<p>In order to assess the accuracy of the rate expression I will need to estimate the parameters in the rate expression and the uncertainty in the estimates. I’ll also calculate the coefficient of determination. A parity plot and residuals plots also will help me assess the accuracy of the proposed rate expression. To make those plots, I’ll need the model-predicted responses and the experiment residuals for the experiments. I’ll list all of these as the quantities of interest.</p>
<p>No extensive quantities were provided in the assignment narrative, so I can select one extensive variable as the basis for the calculations. I’ll use the reactor volume as the basis and include it among the given and known constants.</p>
</div>
</div>
</div>
<section id="assignment-summary-1" class="level4" data-number="20.5.2.1">
<h4 data-number="20.5.2.1" class="anchored" data-anchor-id="assignment-summary-1"><span class="header-section-number">20.5.2.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Steady-state, isothermal, gas-phase CSTR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_20_5_2_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/cstr_isothermal_ss_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_2_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.4: Schematic representation of the steady-state CSTR used in the experiments.
</figcaption>
</figure>
</div>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\tau}\)</span> and <span class="math inline">\(\underline{y}_{A,0}\)</span></p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{C}_{Z,1}\)</span></p>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_{A,CI,l}\)</span>, <span class="math inline">\(\alpha_{A,CI,u}\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_{B,CI,l}\)</span>, <span class="math inline">\(\alpha_{B,CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{C}_{Z,1,model}\)</span>, <span class="math inline">\(\underline{\epsilon}_{expt}\)</span>.</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(P\)</span> = 3 atm, <span class="math inline">\(\dot{n}_{Z,0}\)</span> = 0, <span class="math inline">\(R\)</span> = 0.08206 L atm mol<sup>-1</sup> K<sup>-1</sup>, and <span class="math inline">\(V\)</span> = 1.0 L (basis).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a kinetics data analysis assignment, and I know that to complete it I will need a predicted response model that relates the rate expression parameters and the adjusted experimental inputs for any one experiment to the measured response from that experiment. I can begin to generate the predicted response model by generating a model for the CSTR used in the experiments. The CSTR model relates the rate expression parameters and the adjusted experimental inputs to the outlet molar flow rates.</p>
<p>To generate the predicted responses model I can simply use the CSTR model to relate the rate expression parameters and the adjusted experimental inputs to the outlet molar flow rates, and then add equations to calcuate the response from the outlet molar flow rates.</p>
<p>Once I have a predicted response model, I can fit it to the experimental data to get estimates and uncertainties for the parameters and the coefficient of determination. For the rate expression given here the rate expression parameters are the pre-exponential factor, activation energy, reaction order in A, and reaction order in B. Using the estimated parameters in the predicted responses model will generate the model-predicated responses for the experiments, and those can be used to calculate the experiment residuals. That will allow me to generate a parity plot and residuals plot.</p>
<p>To complete the assignment I can assess the accuracy of the rate expression by noting that for an accurate model the following criteria are satisfied:</p>
<ul>
<li>The coefficient of determination is close to 1.0.</li>
<li>The points in the parity plot are close to the parity line.</li>
<li>The points in the residuals plots scatter randomly about zero with no apparent trends or systematic deviations.</li>
<li>The lower and upper limits of the 95% confidence interval for most, if not all, of the rate expression parameters close to their estimated values.</li>
</ul>
</div>
</div>
</div>
<center>
<strong>Task List</strong>
</center>
<ol type="1">
<li>Develop the CSTR model.</li>
<li>Using the CSTR model develop a predicted response model.</li>
<li>Fit the predicted response model to the experimental data.</li>
<li>Generate a parity plot and residuals plots.</li>
<li>Assess the accuracy of the rate expression.</li>
</ol>
</section>
<section id="mathematical-formulation-of-the-analysis-1" class="level4" data-number="20.5.2.2">
<h4 data-number="20.5.2.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-analysis-1"><span class="header-section-number">20.5.2.2</span> Mathematical Formulation of the Analysis</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To start I’ll formulate the steady-state CSTR model. To do so I need to generate the reactor design equations for the reactor. They will be solved numerically to find the outlet molar flow rates of the reagents. In kinetics experiments the reactor operates at a known temperature, and as a result the mole balance design equations can be solved independently of any energy balances. I can calculate the outlet molar flow rates of the reagents using just the mole balances, to they are the only design equations I need.</p>
<p>The general form of the CSTR mole balances is given in <a href="section_3_react_eng_models.html#eq-cstr_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.24</span></a>. Here the reactor operates at steady-state, so the time derivatives are all equal to zero. There is only one reaction taking place in the reactor so the summation over the reactions reduces to a single term and it isn’t necessary to index the reaction. So for this assignment the mole balance on each reagent in the system will take the following form.</p>
<p><span class="math display">\[
0 = \epsilon = \dot{n}_{i,0} - \dot{n}_{i,1} + \nu_i r V
\]</span></p>
<p>Here, the design equations are a set of ATEs. I will solve numerically for the outlet molar flow rates of the reagents, so the general equation above has been written in the form of a residual expression. To use an ATE solver to solve the design equations numerically for the outlet molar flow rates of the reagents, I will need to provide an initial guess for those outlet molar flow rates. In a kinetics data analysis assignment like this, I can use the measured response from an experiment to make an initial guess for the outlet molar flow rates in that experiment.</p>
<p>In this assignment the measured response was the outlet concentration of Z. Since all I need is a guess, I can ignore the change in the volumetric flow rate and calculate the outlet molar flow of Z as the measured outlet concentration times the inlet volumetric flow rate. The inlet volumetric flow rate can be calculated using the space time and the volume. After guessing the outlet molar flow rate of Z, I can calculate the extent of reaction. Finally, I can calculate the inlet molar flow rates of A and B using the ideal gas law and use them together with the extent of reaction to calculate their outlet molar flow rates.</p>
</div>
</div>
</div>
<center>
<strong>Steady-State CSTR Model</strong>
</center>
<p><strong>Design Equations</strong></p>
<p><span class="math display">\[
0 = \epsilon_1 = \dot{n}_{A,0} - \dot{n}_{A,1} - rV \tag{3}
\]</span></p>
<p><span class="math display">\[
0 = \epsilon_2 = \dot{n}_{B,0} - \dot{n}_{B,1} - rV \tag{4}
\]</span></p>
<p><span class="math display">\[
0 = \epsilon_3 = - \dot{n}_{Z,1} + rV \tag{5}
\]</span></p>
<p><strong>Guesses for the Design Equations Unknowns</strong></p>
<p><span class="math display">\[
\dot{V}_0 = \frac{V}{\tau} \tag{6}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{A,0} = y_{A,0}\frac{P \dot{V}_0}{RT} \tag{7}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,0} = \left(1-y_{A,0}\right) \frac{P \dot{V}_0}{RT} \tag{8}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,1} \approx \dot{V}_0 C_{Z,1} =  \dot{n}_{Z,1,guess} \tag{9}
\]</span></p>
<p><span class="math display">\[
\dot{\xi} = \dot{n}_{Z,1,guess} -\dot{n}_{Z,0} \tag{10}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{A,1,guess} = \dot{n}_{A,0} - \dot{\xi}\tag{11}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,1,guess} = \dot{n}_{B,0} - \dot{\xi} \tag{12}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In addition to the guesses for the design equations unknowns, I will need to write a residuals function and provide it to the ATE solver (see <a href="apndx_mathematics.html#sec-apndx_residuals_fcn" class="quarto-xref"><span>Section F.5.1.1.2</span></a>). The residuals function will be called by an ATE solver from a mathematics software package. The mathematics software package assumes that the only arguments to the residuals function are the ATE unknowns and that the residuals function returns the ATE residuals and nothing else. I can, of course, use the known constants given the assignment narrative within the residuals function, but if it requires any other input, I will need to provide that by some means other than as an argument.</p>
<p>The purpose of the residuals function is to calculate the design equation residuals, equations (3) - (5). Of the quantities appearing in the design equations, <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(V\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span> are either arguments to the residuals function (the outlet molar flow rates) or known constants. <span class="math inline">\(\dot{n}_{A,0}\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\dot{n}_{B,0}\)</span>, and <span class="math inline">\(\dot{n}_{Z,0}\)</span> are not known and must either be calculated or made available within the residuals function. The inlet molar flow rates can be calculated as was done in equations (6) through (8), but the space time, inlet mole fraction of A and temperature will be different depending upon the experiment being analyzed. As such, those quantities cannot be calculated and must be made available to the residuals function before it is called.</p>
<p>The rate can be calculated using the given rate expression, equation (2), but that requires <span class="math inline">\(k\)</span>, <span class="math inline">\(P_A\)</span>, <span class="math inline">\(P_B\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span>. The Arrhenius expression, below, can be used to calculate <span class="math inline">\(k\)</span>, but that requires <span class="math inline">\(k_0\)</span> and <span class="math inline">\(E\)</span> (assuming <span class="math inline">\(T\)</span> has been made available to enable calculation of the inlet molar flow rates as just mentioned). The rate expression parameters, <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span> will be changing during the fitting process, so they cannot be calculated and must be made available to the residuals function before it is called.</p>
<p><span class="math display">\[
k = k_0 \exp{ \left( \frac{-E}{RT} \right)}
\]</span></p>
<p>The partial pressures of A and B can be calculated from the total pressure and their mole fractions, below. Once <span class="math inline">\(T\)</span>, <span class="math inline">\(\tau\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span> have been made available and <span class="math inline">\(\dot{n}_{A,0}\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\dot{n}_{B,0}\)</span>, and <span class="math inline">\(\dot{n}_{Z,0}\)</span> have been calculated, the residuals can be evaluated using the design equations (3) - (5).</p>
<p><span class="math display">\[
P_i = \frac{\dot{n}_{i,1} P}{\dot{n}_{A,1} + \dot{n}_{B,1} + \dot{n}_{Z,1}}
\]</span></p>
</div>
</div>
</div>
<p><strong>Residuals Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span></p>
<p><u>Returns:</u> <span class="math inline">\(\epsilon_1\)</span>, <span class="math inline">\(\epsilon_2\)</span>, and <span class="math inline">\(\epsilon_3\)</span></p>
<p><u>Must be Available:</u> <span class="math inline">\(T\)</span>, <span class="math inline">\(\tau\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span></p>
<p><u>Algorithm:</u></p>
<p><span class="math display">\[
\dot{V}_0 = \frac{V}{\tau} \tag{6}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{A,0} = y_{A,0}\frac{P \dot{V}_0}{RT} \tag{7}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{B,0} = \left(1-y_{A,0}\right) \frac{P \dot{V}_0}{RT} \tag{8}
\]</span></p>
<p><span class="math display">\[
P_A = \frac{\dot{n}_{A,1}P}{\left(\dot{n}_{A,1} + \dot{n}_{B,1} + \dot{n}_{Z,1}\right)} \tag{13}
\]</span></p>
<p><span class="math display">\[
P_B = \frac{\dot{n}_{B,1}P}{\left(\dot{n}_{A,1} + \dot{n}_{B,1} + \dot{n}_{Z,1}\right)} \tag{14}
\]</span></p>
<p><span class="math display">\[
k = k_0 \exp{ \left( \frac{-E}{RT} \right)} \tag{15}
\]</span></p>
<p><span class="math display">\[
r = kP_A^{\alpha_A}P_B^{\alpha_B} \tag{2}
\]</span></p>
<p><span class="math display">\[
\epsilon_1 = \dot{n}_{A,0} - \dot{n}_{A,1} - rV \tag{3}
\]</span></p>
<p><span class="math display">\[
\epsilon_2 = \dot{n}_{B,0} - \dot{n}_{B,1} - rV \tag{4}
\]</span></p>
<p><span class="math display">\[
\epsilon_3 = - \dot{n}_{Z,1} + rV \tag{5}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To complete the CSTR model, I will need to write a CSTR model function that solves the design equations numerically to find the outlet molar flow rates of the reagents. It will use an ATE solver to do so, and it will need to provide two things to the ATE solver: the guess for the ATE unknowns and the residuals function. When it is called, it should be passed the adjusted experimental inputs and the experimental response for the experiment being analyzed and the current rate expression parameters. It needs the adjusted inputs and response to calculate the guesses and it needs to make the adjusted inputs and the rate coefficient parameters available to the residuals function before passing the residuals function to the ATE solver.</p>
<p>After making the adjusted inputs and the rate coefficient parameters available to the residuals function all the CSTR model function needs to do is calculate the guesses and call the ATE solver. Assuming the solver is successful, it will return the outlet molar flow rates of the reagents.</p>
</div>
</div>
</div>
<p><strong>CSTR Model Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(T\)</span>, <span class="math inline">\(\tau\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(C_{Z,1}\)</span>, <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span></p>
<p><u>Returns:</u> <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span>.</p>
<p><u>Algorithm:</u></p>
<ol type="1">
<li>Make <span class="math inline">\(T\)</span>, <span class="math inline">\(\tau\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span> available to the residuals function.</li>
<li>Calculate the guesses for the design equations unknowns, equations (6) - (12).</li>
<li>Get <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span> by calling an ATE solver passing the initial guesses and the CSTR residuals function as arguments.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Having developed a model for the CSTR used in the experiments, my next task is to use it to develop a predicted response model that can be fit to the experimental data. The predicted response model must relate the measured response to the rate expression parameters and the adjusted experimental inputs. The CSTR model relates the outlet molar flow rates to the rate expression parameters and the adjusted experimental inputs, so all I need is equations that relate the outlet molar flow rates to the measured response.</p>
<p>The measured response is the outlet concentration of Z. By definition, it is equal to the outlet molar flow rate of Z divided by the outlet volumetric flow rate. A critical point to remember is that the inlet and outlet volumetric flow rates are not equal because the reaction causes a change in the total molar flow rate. It can be calculated using the ideal gas law and then the outlet concentration of Z can be calculated.</p>
<p>I will use a numerical fitting function from a mathematics or statistics software package to fit the predicted response model to the experimental data (see <a href="apndx_mathematics.html#sec-apndx_parameter_est" class="quarto-xref"><span>Section F.6</span></a>). One of the things I will need to provide to it is a predicted responses function, that I must write. The predicted responses function will be called by the numerical fitting function, and it assumes that the only arguments to the predicted responses function are the adjusted experimental inputs and the rate expression parameters and that the predicted responses function returns the model predicted responses for all of the experiments and nothing else. As was the case for the residuals function, I can use the known constants given the assignment narrative within the predicted function, but if it requires any other input, I will need to provide that by some means other than as an argument.</p>
<p>Writing the predicted responses function is straightforward. It simply needs to go through the experiments one by one calling the CSTR model function and using the outlet molar flow rates it returns to calculate the model-predicted response, <span class="math inline">\(C_{Z,1}\)</span>. After doing this for each experiment, the full set of model-predicated responses can be returned.</p>
<p>In this assighment, the measured response for the experiment must also be provided as an argument when calling the CSTR model function. Since the measured responses are not passed to the predicted responses function as an argument, they must be provided to it by some other means.</p>
</div>
</div>
</div>
<center>
<strong>Predicted Response Model</strong>
</center>
<p><strong>Predicted Response</strong></p>
<p><span class="math display">\[
\dot{V}_1 = \frac{\left(\dot{n}_{A,1} + \dot{n}_{B,1} + \dot{n}_{Z,1}\right)RT}{P} \tag{16}
\]</span></p>
<p><span class="math display">\[
C_{Z,1,model} = \frac{\dot{n}_{Z,1}}{\dot{V}_1} \tag{17}
\]</span></p>
<p><strong>Predicted Responses Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\tau}\)</span>, and <span class="math inline">\(\underline{y}_{A,0}\)</span>.</p>
<p><u>Returns:</u> <span class="math inline">\(\underline{C}_{Z,1,model}\)</span></p>
<p><u>Must be Available:</u> <span class="math inline">\(\underline{C}_{Z,1}\)</span></p>
<p><u>Algorithm:</u></p>
<ol type="1">
<li><p>For each experiment in the data set:</p>
<ol type="a">
<li><p>Get <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{B,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span> by calling the CSTR model function passing <span class="math inline">\(T\)</span>, <span class="math inline">\(\tau\)</span>, <span class="math inline">\(y_{A,0}\)</span>, <span class="math inline">\(C_{Z,1}\)</span>, <span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span> as arguments.</p></li>
<li><p>Calculate the predicted response, equations (16) and (17).</p></li>
</ol></li>
<li><p>Return <span class="math inline">\(\underline{C}_{Z,1,model}\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now that I have generated the CSTR model function and the predicted responses function, most of the remaining tasks can be accomplished simply by making function calls. To estimate the rate expression parameters, parameter uncertainties and get the coefficient of determination, I simply need to make guesses for the rate expression the parameters and call the numerical fitting function. Once I’ve done that, all I need to do to generate the data for the parity and residuals plots is to call the predicted responses function using the final parameter estimates and then calculate the experiment residuals.</p>
</div>
</div>
</div>
<center>
<strong>Parameter Estimates and Statistics</strong>
</center>
<ol type="1">
<li><p>Define guesses, <span class="math inline">\(k_{0,guess}\)</span>, <span class="math inline">\(E_{guess}\)</span>, <span class="math inline">\(\alpha_{A,guess}\)</span>, and <span class="math inline">\(\alpha_{B,guess}\)</span>.</p></li>
<li><p>Get <span class="math inline">\(k_0\)</span>, <span class="math inline">\(k_{0,CI,l}\)</span>, <span class="math inline">\(k_{0,CI,u}\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(E_{CI,l}\)</span>, <span class="math inline">\(E_{CI,u}\)</span>, <span class="math inline">\(\alpha_A\)</span>, <span class="math inline">\(\alpha_{A,CI,l}\)</span>, <span class="math inline">\(\alpha_{A,CI,u}\)</span>, <span class="math inline">\(\alpha_B\)</span>, <span class="math inline">\(\alpha_{B,CI,l}\)</span>, <span class="math inline">\(\alpha_{B,CI,u}\)</span>, and <span class="math inline">\(R^2\)</span> by calling a numerical fitting function, passing the guesses (<span class="math inline">\(k_{0,guess}\)</span>, <span class="math inline">\(E_{guess}\)</span>, <span class="math inline">\(\alpha_{A,guess}\)</span>, and <span class="math inline">\(\alpha_{B,guess}\)</span>), the adjusted experimental inputs (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\tau}\)</span>, and <span class="math inline">\(\underline{y}_{A,0}\)</span>), the experimental responses (<span class="math inline">\(\underline{C}_{Z,1}\)</span>), and the predicted responses function as arguments.</p></li>
</ol>
<center>
<strong>Assessment Graphs</strong>
</center>
<ol type="1">
<li><p>Get <span class="math inline">\(\underline{C}_{Z,1,model}\)</span> by calling the predicted responses function, passing the estimated parameters (<span class="math inline">\(k_0\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span>) and the adjusted experimental inputs (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\tau}\)</span>, and <span class="math inline">\(\underline{y}_{A,0}\)</span>) as arguments.</p></li>
<li><p>Calculate the experiment residuals.</p></li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{C}_{Z,1,model} - \underline{C}_{Z,1} \tag{18}
\]</span></p>
<ol start="3" type="1">
<li><p>Generate a parity plot showing <span class="math inline">\(\underline{C}_{Z,1,model}\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{Z,1}\)</span> as points and <span class="math inline">\(\underline{C}_{Z,1,model}\)</span> = <span class="math inline">\(\underline{C}_{Z,1}\)</span> as the parity line.</p></li>
<li><p>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{\tau}\)</span>, and <em>vs.</em> <span class="math inline">\(\underline{y}_{A,0}\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now I have everything I need to perform the calculations. In this assignment it is necessary to make some quantities available to the residuals function and to make the measured responses available to the predicted responses function. I have taken care of making the necessary quantities available to the residuals function within the CSTR model function. The measured responses from the experiments are constants that will never change during the analysis. Therefore, they can be made available to the predicted responses function as soon as they are read in from the data file.</p>
</div>
</div>
</div>
<center>
<strong>Calculations Summary</strong>
</center>
<ol type="1">
<li><p>Read the adjusted experimental inputs and the experimental responses from the file, <a href="examples/reb_20_5_2/reb_20_5_2_data.csv">reb_20_5_2_data.csv</a>.</p></li>
<li><p>Make the experimental responses (<span class="math inline">\(\underline{C}_{Z,1}\)</span>) available to the predicted responses function.</p></li>
<li><p>Calculate the parameter estimates and statistics and generate the assessment graphs as described above.</p></li>
<li><p>Display the results and/or save them to a file.</p></li>
</ol>
</section>
<section id="results-analysis-and-discussion" class="level4" data-number="20.5.2.3">
<h4 data-number="20.5.2.3" class="anchored" data-anchor-id="results-analysis-and-discussion"><span class="header-section-number">20.5.2.3</span> Results, Analysis, and Discussion</h4>
<p>The calculations were performed as described above except that the base-10 log of <span class="math inline">\(k_0\)</span> was estimated instead of estimating <span class="math inline">\(k_0\)</span> directly (see <a href="section_6_data_generation.html#sec-example_18_6_2" class="quarto-xref"><span>Section 18.6.2</span></a>). The fitting results are shown in <a href="#tbl-example_20_5_2_parameters" class="quarto-xref">Table&nbsp;<span>20.4</span></a>. The parity plot is shown in <a href="#fig-example_20_5_2_parity" class="quarto-xref">Figure&nbsp;<span>20.5</span></a> and the residuals plots are shown in <a href="#fig-example_20_5_2_residuals_plots" class="quarto-xref">Figure&nbsp;<span>20.6</span></a>.</p>
<div class="cell">
<div id="tbl-example_20_5_2_parameters" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_20_5_2_parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20.4: Parameter estimation results
</figcaption>
<div aria-describedby="tbl-example_20_5_2_parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 86%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">k<sub>0</sub></td>
<td style="text-align: center;">6.6 x 10<sup>3</sup> mol L<sup>-1</sup> atm<sup>-2</sup> s<sup>-1</sup>, 95% CI [3.31 x 10<sup>3</sup>, 1.32 x 10<sup>4</sup>]</td>
</tr>
<tr class="even">
<td style="text-align: center;">E</td>
<td style="text-align: center;">113 kJ mol<sup>-1</sup>, 95% CI [109, 117]</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\alpha_A\)</span></td>
<td style="text-align: center;">1.39 , 95% CI [1.35, 1.44]</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\alpha_B\)</span></td>
<td style="text-align: center;">0.595 , 95% CI [0.57, 0.619]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.995</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="fig-example_20_5_2_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_2_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_20_5_2/reb_20_5_2_parity.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_2_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.5: Parity plot.
</figcaption>
</figure>
</div>
<div id="fig-example_20_5_2_residuals_plots" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_2_residuals_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="examples/reb_20_5_2/reb_20_5_2_T_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="examples/reb_20_5_2/reb_20_5_2_tau_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="examples/reb_20_5_2/reb_20_5_2_yA0_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_2_residuals_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.6: Residuals Plots.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The deviations of the data points from the line in the parity plot are small, the deviations of the residuals about zero are random with no apparent trends, the coefficient of determination is close to 1, and the upper and lower limits of the 95% confidence intervals for <span class="math inline">\(E\)</span>, <span class="math inline">\(\alpha_A\)</span>, and <span class="math inline">\(\alpha_B\)</span> are close to the estimated parameter value. The uncertainty in <span class="math inline">\(k_0\)</span> is slightly greater, but still acceptable. This indicates that the rate expression is acceptabley accurate.</p>
</div>
</div>
</div>
<center>
<strong>Assessment</strong>
</center>
<p>When used with the rate expression parameters shown in <a href="#tbl-example_20_5_2_parameters" class="quarto-xref">Table&nbsp;<span>20.4</span></a>, the accuracy of the proposed rate expression in describing the concentration and temperature dependence of the rate, within the range of concentrations and temperatures investigated, is acceptable.</p>
</section>
</section>
<section id="sec-example_20_5_3" class="level3" data-number="20.5.3">
<h3 data-number="20.5.3" class="anchored" data-anchor-id="sec-example_20_5_3"><span class="header-section-number">20.5.3</span> Analysis of Data for a Reversible Reaction</h3>
<p>The liquid-phase disproportionation of reagent A, reaction (1), is reversible. Kinetics data were generated in a 3 gal CSTR by varying the temperature, volumetric flow rate and feed concentrations of reagents A, Y, and Z from experiment to experiment. In each experiment the outlet concentration of reagent A was measured. Use the resulting data, linked below, it to assess the accuracy of the rate expression shown in equation (2). Note that thermodynamic data to calculate the equilibrium constant for reaction (1) are not available, so both the forward and reverse rate coefficients in the rate expression must be estimated from the experimental data.</p>
<p><span class="math display">\[
A \leftrightarrows Y + Z \tag{1}
\]</span></p>
<p><span class="math display">\[
r = k_fC_A^2 - k_rC_YC_Z \tag{2}
\]</span></p>
<p>The first few data points are shown in <a href="#tbl-example_20_5_3_data" class="quarto-xref">Table&nbsp;<span>20.5</span></a>. The full data set is available in the file <a href="examples/reb_20_5_3/reb_20_5_3_data.csv">reb_20_5_3_data.csv</a>.</p>
<div class="cell">
<div id="tbl-example_20_5_3_data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_20_5_3_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20.5: First 6 experimental data points.
</figcaption>
<div aria-describedby="tbl-example_20_5_3_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">T (°F)</th>
<th style="text-align: center;"><span class="math inline">\(\dot{V}\)</span> (gal min<sup>-1</sup>)</th>
<th style="text-align: center;">C<sub>A,0</sub> (lbmol gal<sup>-1</sup>)</th>
<th style="text-align: center;">C<sub>Y,0</sub> (lbmol gal<sup>-1</sup>)</th>
<th style="text-align: center;">C<sub>Z,0</sub> (lbmol gal<sup>-1</sup>)</th>
<th style="text-align: center;">C<sub>A,1</sub> (lbmol gal<sup>-1</sup>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.0070</td>
</tr>
<tr class="even">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.0072</td>
</tr>
<tr class="odd">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.0071</td>
</tr>
<tr class="even">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.0071</td>
</tr>
<tr class="odd">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.0067</td>
</tr>
<tr class="even">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.0082</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The assignment narrative describes reactor experiments, provides the data generated in those experiments, and asks me to use them to assess the accuracy of a proposed rate expression. Those are distinguishing characteristics of a kinetics data analysis assignment.</p>
<p>I’ll begin by summarizing the assignment. I’ll assign an appropriate variable symbol to represent each of the quantities provided in the assignment. While doing so I will use a subscripted “0” to denote a quantity value at the inlet to the reactor and a subscripted “1” to denote one at the outlet. I’ll use subscripted “CI,l” and “CI,u” to denote values that are the lower or upper limit of a 95% confidence interval. I’ll underline a variable symbol if it represents a set of values (i. e. a vector).</p>
<p>In the experiments for this assignment, a CSTR that operated at steady-state was used. The adjusted experimental inputs were the temperature, volumetric flow rate, and feed concentrations of reagents A, Y, and Z, and the measured response was the outlet concentration of A.</p>
<p>In order to assess the accuracy of the rate expression I will need to estimate the parameters in the rate expression and the uncertainty in the estimates. For the rate expression given here, the rate expression parameters are the forward and reverse pre-exponential factors and the forward and reverse activation energies. I’ll also calculate the coefficient of determination. A parity plot and residuals plots also will help me assess the accuracy of the proposed rate expression. To make those plots, I’ll need the model-predicted responses and the experiment residuals for the experiments. I’ll list all of these as the quantities of interest.</p>
<p>The reacting fluid is a liquid, and I’ll assume it to be an ideal, incompressible mixture in which case the inlet and outlet volumetric flow rates will be equal. Therefore I will not use a subscript on the volumetric flow rate.</p>
</div>
</div>
</div>
<section id="assignment-summary-2" class="level4" data-number="20.5.3.1">
<h4 data-number="20.5.3.1" class="anchored" data-anchor-id="assignment-summary-2"><span class="header-section-number">20.5.3.1</span> Assignment Summary</h4>
<p><strong>Reactor System:</strong> Steady-state, isothermal, liquid-phase CSTR</p>
<p><strong>Reactor Schematic:</strong></p>
<div id="fig-example_20_5_3_schematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_3_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Graphics/cstr_isothermal_ss_schematic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_3_schematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.7: Schematic representation of the steady-state CSTR used in the experiments.
</figcaption>
</figure>
</div>
<p><strong>Adjusted Experimental Inputs:</strong> <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\dot{V}}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <span class="math inline">\(\underline{C}_{Z,0}\)</span>.</p>
<p><strong>Experimental Response:</strong> <span class="math inline">\(\underline{C}_{A,1}\)</span></p>
<p><strong>Quantities of Interest:</strong> <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(k_{0,f,CI,l}\)</span>, <span class="math inline">\(k_{0,f,CI,u}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(E_{f,CI,l}\)</span>, <span class="math inline">\(E_{f,CI,u}\)</span>, <span class="math inline">\(k_0,r\)</span>, <span class="math inline">\(k_{0,r,CI,l}\)</span>, <span class="math inline">\(k_{0,r,CI,u}\)</span>, <span class="math inline">\(E_r\)</span>, <span class="math inline">\(E_{r,CI,l}\)</span>, <span class="math inline">\(E_{r,CI,u}\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(\underline{C}_{A,1,model}\)</span>, <span class="math inline">\(\underline{\epsilon}_{expt}\)</span>.</p>
<p><strong>Given and Known Constants:</strong> <span class="math inline">\(V\)</span> = 3 gal and <span class="math inline">\(R\)</span> = 1.987 BTR lbmol<sup>-1</sup>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a kinetics data analysis assignment, and I know that to complete it I will need a predicted response model that relates the rate expression parameters and the adjusted experimental inputs for any one experiment to the measured response from that experiment. I can begin to generate the predicted response model by generating a model for the CSTR used in the experiments. The CSTR model relates the rate expression parameters and the adjusted experimental inputs to the outlet molar flow rates.</p>
<p>To generate the predicted responses model I can simply use the CSTR model to relate the rate expression parameters and the adjusted experimental inputs to the outlet molar flow rates, and then add equations to calcuate the response from the outlet molar flow rates.</p>
<p>Once I have a predicted response model, I can fit it to the experimental data to get estimates and uncertainties for the parameters and the coefficient of determination. Using the estimated parameters in the predicted responses model will generate the model-predicated responses for the experiments, and those can be used to calculate the experiment residuals. That will allow me to generate a parity plot and residuals plot.</p>
<p>To complete the assignment I can assess the accuracy of the rate expression by noting that for an accurate model the following criteria are satisfied:</p>
<ul>
<li>The coefficient of determination is close to 1.0.</li>
<li>The points in the parity plot are close to the parity line.</li>
<li>The points in the residuals plots scatter randomly about zero with no apparent trends or systematic deviations.</li>
<li>The lower and upper limits of the 95% confidence interval for most, if not all, of the rate expression parameters close to their estimated values.</li>
</ul>
</div>
</div>
</div>
<center>
<strong>Task List</strong>
</center>
<ol type="1">
<li>Develop the CSTR model.</li>
<li>Using the CSTR model develop a predicted response model.</li>
<li>Fit the predicted response model to the experimental data.</li>
<li>Generate a parity plot and residuals plots.</li>
<li>Assess the accuracy of the rate expression.</li>
</ol>
</section>
<section id="mathematical-formulation-of-the-analysis-2" class="level4" data-number="20.5.3.2">
<h4 data-number="20.5.3.2" class="anchored" data-anchor-id="mathematical-formulation-of-the-analysis-2"><span class="header-section-number">20.5.3.2</span> Mathematical Formulation of the Analysis</h4>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To start I’ll formulate the steady-state CSTR model. To do so I need to generate the reactor design equations for the reactor. They will be solved numerically to find the outlet molar flow rates of the reagents. In kinetics experiments the reactor operates at a known temperature, and as a result the mole balance design equations can be solved independently of any energy balances. I can calculate the outlet molar flow rates of the reagents using just the mole balances, to they are the only design equations I need.</p>
<p>The general form of the CSTR mole balances is given in <a href="section_3_react_eng_models.html#eq-cstr_mol_balance" class="quarto-xref">Equation&nbsp;<span>6.24</span></a>. Here the reactor operates at steady-state, so the time derivatives are all equal to zero. There is only one reaction taking place in the reactor so the summation over the reactions reduces to a single term and it isn’t necessary to index the reaction. So for this assignment the mole balance on each reagent in the system will take the following form.</p>
<p><span class="math display">\[
0 = \epsilon = \dot{n}_{i,0} - \dot{n}_{i,1} + \nu_i r V
\]</span></p>
<p>Here, the design equations are a set of ATEs. I will solve them numerically for the outlet molar flow rates of the reagents, so the mole balance above has been written in the form of a residual expression. To solve them numerically using using an ATE solver, I will need to provide a guess for those outlet molar flow rates. In a kinetics data analysis assignment like this, I can use the measured response from an experiment to make an initial guess for the outlet molar flow rates in that experiment.</p>
<p>In this assignment the measured response was the outlet concentration of A. To generate guesses for the outlet molar flow rates I can calculate the outlet molar flow of A as the measured outlet concentration times the volumetric flow rate. The inlet volumetric flow rate of A is just the product of the volumetric flow rate and the inlet concentration of A. With that I can calculate the extent of reaction. Finally, I can calculate the inlet molar flow rates of Y and Z, and use them together with the extent of reaction to calculate their outlet molar flow rates.</p>
</div>
</div>
</div>
<center>
<strong>Steady-State CSTR Model</strong>
</center>
<p><strong>Design Equations</strong></p>
<p><span class="math display">\[
0 = \epsilon_1 = \dot{n}_{A,0} - \dot{n}_{A,1} - rV \tag{3}
\]</span></p>
<p><span class="math display">\[
0 = \epsilon_2 = \dot{n}_{Y,0} - \dot{n}_{Y,1} + rV \tag{4}
\]</span></p>
<p><span class="math display">\[
0 = \epsilon_3 = \dot{n}_{Z,0} - \dot{n}_{Z,1} + rV \tag{5}
\]</span></p>
<p><strong>Guesses for the Design Equations Unknowns</strong></p>
<p><span class="math display">\[
\dot{n}_{A,1,guess} = \dot{V}C_{A,1} \tag{6}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{A,0} = \dot{V}C_{A,0} \tag{7}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{A,1,guess} = \dot{n}_{A,0} - \dot{\xi} \qquad \Rightarrow \qquad \dot{\xi} = \dot{n}_{A,0} - \dot{n}_{A,1,guess} \tag{8}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Y,0} = \dot{V}C_{Y,0} \tag{9}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,0} = \dot{V}C_{Z,0} \tag{10}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Y,1,guess} = \dot{n}_{Y,0} + \dot{\xi} \tag{11}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,1,guess} = \dot{n}_{Z,0} + \dot{\xi} \tag{12}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In addition to the guesses for the design equation unknowns, I will need to write a residuals function and provide it to the ATE solver (see <a href="apndx_mathematics.html#sec-apndx_residuals_fcn" class="quarto-xref"><span>Section F.5.1.1.2</span></a>). The residuals function will be called by an ATE solver from a mathematics software package. The mathematics software package assumes that the only arguments to the residuals function are the ATE unknowns and that the residuals function returns the ATE residuals and nothing else. I can, of course, use the known constants given in the assignment narrative within the residuals function, but if it requires any other input, I will need to provide that by some means other than as an argument.</p>
<p>The purpose of the residuals function is to calculate the design equation residuals, equations (3) - (5). Of the quantities appearing in the design equations, <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(V\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span> are either arguments to the residuals function (the outlet molar flow rates) or known constants. <span class="math inline">\(\dot{n}_{A,0}\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\dot{n}_{Y,0}\)</span>, and <span class="math inline">\(\dot{n}_{Z,0}\)</span> are not known and must either be calculated or made available within the residuals function. The inlet molar flow rates can be calculated as was done in equations (7), (9), and (10), but the volumetric flow rate, and inlet concentrations of A, Y, and Z will be different depending upon the experiment being analyzed. As such, those quantities cannot be calculated and must be made available to the residuals function before it is called.</p>
<p>The rate can be calculated using the given rate expression, equation (2), but that requires <span class="math inline">\(k_f\)</span>, <span class="math inline">\(k_r\)</span>, <span class="math inline">\(C_{A,1}\)</span>, <span class="math inline">\(C_{Y,1}\)</span>, and <span class="math inline">\(C_{Z1}\)</span>. The Arrhenius expression, below, can be used to calculate <span class="math inline">\(k_f\)</span> and <span class="math inline">\(k_r\)</span>, but that requires <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, <span class="math inline">\(E_r\)</span>, and <span class="math inline">\(T\)</span>. The rate expression parameters, <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, and <span class="math inline">\(E_r\)</span> will be changing during the fitting process, so they cannot be calculated and must be made available to the residuals function before it is called. Similarly, the temperature will change depending upon which experiment is being analzyed, so it, too, must be made available to the residuals function.</p>
<p><span class="math display">\[
k = k_0 \exp{ \left( \frac{-E}{RT} \right)}
\]</span></p>
<p>The concentrations of the reagents appearing in the rate expression can be calculated from outlet molar flow rates (which are the arguments to the residuals function) and volumetric flow rate. Once <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, and <span class="math inline">\(E_r\)</span> have been made available and <span class="math inline">\(\dot{n}_{A,0}\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(\dot{n}_{Y,0}\)</span>, and <span class="math inline">\(\dot{n}_{Z,0}\)</span> have been calculated, the residuals can be evaluated using the design equations (3) - (5).</p>
<p><span class="math display">\[
C_i = \frac{\dot{n}_{i,1}}{\dot{V}}
\]</span></p>
</div>
</div>
</div>
<p><strong>Residuals Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span></p>
<p><u>Returns:</u> <span class="math inline">\(\epsilon_1\)</span>, <span class="math inline">\(\epsilon_2\)</span>, and <span class="math inline">\(\epsilon_3\)</span></p>
<p><u>Must be Available:</u> <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, and <span class="math inline">\(E_r\)</span></p>
<p><u>Algorithm:</u></p>
<p><span class="math display">\[
\dot{n}_{A,0} = \dot{V}C_{A,0} \tag{7}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Y,0} = \dot{V}C_{Y,0} \tag{9}
\]</span></p>
<p><span class="math display">\[
\dot{n}_{Z,0} = \dot{V}C_{Z,0} \tag{10}
\]</span></p>
<p><span class="math display">\[
k_f = k_{0,f} \exp{ \left( \frac{-E_f}{RT} \right)} \tag{13}
\]</span></p>
<p><span class="math display">\[
k_r = k_{0,r} \exp{ \left( \frac{-E_r}{RT} \right)} \tag{14}
\]</span></p>
<p><span class="math display">\[
C_A = \frac{\dot{n}_{A,1}}{\dot{V}} \tag{15}
\]</span></p>
<p><span class="math display">\[
C_Y = \frac{\dot{n}_{Y,1}}{\dot{V}} \tag{16}
\]</span></p>
<p><span class="math display">\[
C_Z = \frac{\dot{n}_{Z,1}}{\dot{V}} \tag{17}
\]</span></p>
<p><span class="math display">\[
r = k_fC_A^2 - k_rC_YC_Z \tag{2}
\]</span></p>
<p><span class="math display">\[
\epsilon_1 = \dot{n}_{A,0} - \dot{n}_{A,1} - rV \tag{3}
\]</span></p>
<p><span class="math display">\[
\epsilon_2 = \dot{n}_{Y,0} - \dot{n}_{Y,1} + rV \tag{4}
\]</span></p>
<p><span class="math display">\[
\epsilon_3 = \dot{n}_{Z,0} - \dot{n}_{Z,1} + rV \tag{5}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To complete the CSTR model, I will need to write a CSTR model function that solves the design equations numerically to find the outlet molar flow rates of the reagents. It will use an ATE solver to do so, and it will need to provide two things to the ATE solver: the guess for the ATE unknowns and the residuals function. When it is called, it should be passed the adjusted experimental inputs and the experimental response for the experiment being analyzed and the current rate expression parameters. It needs the adjusted inputs and response to calculate the guesses and it needs to make the adjusted inputs and the rate coefficient parameters available to the residuals function before passing the residuals function to the ATE solver.</p>
<p>After making the adjusted inputs and the rate coefficient parameters available to the residuals function all the CSTR model function needs to do is calculate the guesses and call the ATE solver. Assuming the solver is successful, it will return the outlet molar flow rates of the reagents.</p>
</div>
</div>
</div>
<p><strong>CSTR Model Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(C_{A,1}\)</span>, <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, and <span class="math inline">\(E_r\)</span>.</p>
<p><u>Returns:</u> <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span>.</p>
<p><u>Algorithm:</u></p>
<ol type="1">
<li>Make <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, and <span class="math inline">\(E_r\)</span> available to the residuals function.</li>
<li>Calculate the guesses for the design equations unknowns, equations (6) - (12).</li>
<li>Get <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span> by calling an ATE solver passing the initial guesses and the CSTR residuals function as arguments.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Having developed a model for the CSTR used in the experiments, my next task is to use it to develop a predicted response model that can be fit to the experimental data. The predicted response model must relate the measured response to the rate expression parameters and the adjusted experimental inputs. The CSTR model relates the outlet molar flow rates to the rate expression parameters and the adjusted experimental inputs, so all I need is equations that relate the outlet molar flow rates to the measured response. The measured response is the outlet concentration of A. By definition, it is equal to the outlet molar flow rate of A divided by the volumetric flow rate.</p>
<p>I will use a numerical fitting function from a mathematics or statistics software package to fit the predicted response model to the experimental data (see <a href="apndx_mathematics.html#sec-apndx_parameter_est" class="quarto-xref"><span>Section F.6</span></a>). One of the things I will need to provide to it is a predicted responses function, that I must write. The predicted responses function will be called by the numerical fitting function, and it assumes that the only arguments to the predicted responses function are the adjusted experimental inputs and the rate expression parameters and that the predicted responses function returns the model predicted responses for all of the experiments and nothing else. As was the case for the residuals function, I can use the known constants given the assignment narrative within the predicted function, but if it requires any other input, I will need to provide that by some means other than as an argument.</p>
<p>Writing the predicted responses function is straightforward. It simply needs to go through the experiments one by one calling the CSTR model function and using the outlet molar flow rates it returns to calculate the model-predicted response, <span class="math inline">\(C_{A,1}\)</span>. After doing this for each experiment, the full set of model-predicated responses can be returned.</p>
<p>In this assighment, the measured response for the experiment must also be provided as an argument when calling the CSTR model function. Since the measured responses are not passed to the predicted responses function as an argument, they must be provided to it by some other means.</p>
</div>
</div>
</div>
<center>
<strong>Predicted Response Model</strong>
</center>
<p><strong>Predicted Response</strong></p>
<p><span class="math display">\[
C_{A,1,model} = \frac{\dot{n}_{A,1}}{\dot{V}} \tag{18}
\]</span></p>
<p><strong>Predicted Responses Function</strong></p>
<p><u>Arguments:</u> <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, <span class="math inline">\(E_r\)</span>, <span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\dot{V}}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <span class="math inline">\(\underline{C}_{Z,0}\)</span>.</p>
<p><u>Returns:</u> <span class="math inline">\(\underline{C}_{A,1,model}\)</span></p>
<p><u>Must be Available:</u> <span class="math inline">\(\underline{C}_{A,1}\)</span></p>
<p><u>Algorithm:</u></p>
<ol type="1">
<li><p>For each experiment in the data set:</p>
<ol type="a">
<li><p>Get <span class="math inline">\(\dot{n}_{A,1}\)</span>, <span class="math inline">\(\dot{n}_{Y,1}\)</span>, and <span class="math inline">\(\dot{n}_{Z,1}\)</span> by calling the CSTR model function passing <span class="math inline">\(T\)</span>, <span class="math inline">\(\dot{V}\)</span>, <span class="math inline">\(C_{A,0}\)</span>, <span class="math inline">\(C_{Y,0}\)</span>, <span class="math inline">\(C_{Z,0}\)</span>, <span class="math inline">\(C_{A,1}\)</span>, <span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, and <span class="math inline">\(E_r\)</span> as arguments.</p></li>
<li><p>Calculate the predicted response, equation (18).</p></li>
</ol></li>
<li><p>Return <span class="math inline">\(\underline{C}_{A,1,model}\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now that I have generated the CSTR model function and the predicted responses function, most of the remaining tasks can be accomplished simply by making function calls. To estimate the rate expression parameters, parameter uncertainties and get the coefficient of determination, I simply need to make guesses for the rate expression the parameters and call the numerical fitting function. Once I’ve done that, all I need to do to generate the data for the parity and residuals plots is to call the predicted responses function using the final parameter estimates and then calculate the experiment residuals.</p>
</div>
</div>
</div>
<center>
<strong>Parameter Estimates and Statistics</strong>
</center>
<ol type="1">
<li><p>Define guesses, <span class="math inline">\(k_{0,f,guess}\)</span>, <span class="math inline">\(E_{f,guess}\)</span>, <span class="math inline">\(k_{0,r,guess}\)</span>, and <span class="math inline">\(E_{r,guess}\)</span>.</p></li>
<li><p>Get <span class="math inline">\(k_0,f\)</span>, <span class="math inline">\(k_{0,f,CI,l}\)</span>, <span class="math inline">\(k_{0,f,CI,u}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(E_{f,CI,l}\)</span>, <span class="math inline">\(E_{f,CI,u}\)</span>, <span class="math inline">\(k_0,r\)</span>, <span class="math inline">\(k_{0,r,CI,l}\)</span>, <span class="math inline">\(k_{0,r,CI,u}\)</span>, <span class="math inline">\(E_r\)</span>, <span class="math inline">\(E_{r,CI,l}\)</span>, <span class="math inline">\(E_{r,CI,u}\)</span>, and <span class="math inline">\(R^2\)</span> by calling a numerical fitting function, passing the guesses (<span class="math inline">\(k_{0,f,guess}\)</span>, <span class="math inline">\(E_{f,guess}\)</span>, <span class="math inline">\(k_{0,r,guess}\)</span>, and <span class="math inline">\(E_{r,guess}\)</span>), the adjusted experimental inputs (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\dot{V}}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <span class="math inline">\(\underline{C}_{Z,0}\)</span>), the experimental responses (<span class="math inline">\(\underline{C}_{A,1}\)</span>), and the predicted responses function as arguments.</p></li>
</ol>
<center>
<strong>Assessment Graphs</strong>
</center>
<ol type="1">
<li><p>Get <span class="math inline">\(\underline{C}_{A,1,model}\)</span> by calling the predicted responses function, passing the estimated parameters (<span class="math inline">\(k_{0,f}\)</span>, <span class="math inline">\(E_f\)</span>, <span class="math inline">\(k_{0,r}\)</span>, and <span class="math inline">\(E_r\)</span>) and the adjusted experimental inputs (<span class="math inline">\(\underline{T}\)</span>, <span class="math inline">\(\underline{\dot{V}}\)</span>, <span class="math inline">\(\underline{C}_{A,0}\)</span>, <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and <span class="math inline">\(\underline{C}_{Z,0}\)</span>) as arguments.</p></li>
<li><p>Calculate the experiment residuals.</p></li>
</ol>
<p><span class="math display">\[
\underline{\epsilon}_{expt} = \underline{C}_{Z,1,model} - \underline{C}_{Z,1} \tag{18}
\]</span></p>
<ol start="3" type="1">
<li><p>Generate a parity plot showing <span class="math inline">\(\underline{C}_{A,1,model}\)</span> <em>vs.</em> <span class="math inline">\(\underline{C}_{A,1}\)</span> as points and <span class="math inline">\(\underline{C}_{A,1,model}\)</span> = <span class="math inline">\(\underline{C}_{A,1}\)</span> as the parity line.</p></li>
<li><p>Generate residuals plots showing <span class="math inline">\(\underline{\epsilon}_{expt}\)</span> <em>vs.</em> <span class="math inline">\(\underline{T}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{\dot{V}}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{A,0}\)</span>, <em>vs.</em> <span class="math inline">\(\underline{C}_{Y,0}\)</span>, and , <em>vs.</em> <span class="math inline">\(\underline{C}_{Z,0}\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Now I have everything I need to perform the calculations. In this assignment it is necessary to make some quantities available to the residuals function and to make the measured responses available to the predicted responses function. I have taken care of making the necessary quantities available to the residuals function within the CSTR model function. The measured responses from the experiments are constants that will never change during the analysis. Therefore, they can be made available to the predicted responses function as soon as they are read in from the data file.</p>
</div>
</div>
</div>
<center>
<strong>Calculations Summary</strong>
</center>
<ol type="1">
<li><p>Read the adjusted experimental inputs and the experimental responses from the file, <a href="examples/reb_20_5_3/reb_20_5_3_data.csv">reb_20_5_3_data.csv</a>.</p></li>
<li><p>Make the experimental responses (<span class="math inline">\(\underline{C}_{A,1}\)</span>) available to the predicted responses function.</p></li>
<li><p>Calculate the parameter estimates and statistics and generate the assessment graphs as described above.</p></li>
<li><p>Display the results and/or save them to a file.</p></li>
</ol>
</section>
<section id="results-analysis-and-discussion-1" class="level4" data-number="20.5.3.3">
<h4 data-number="20.5.3.3" class="anchored" data-anchor-id="results-analysis-and-discussion-1"><span class="header-section-number">20.5.3.3</span> Results, Analysis, and Discussion</h4>
<p>The calculations were performed as described above except that the base-10 logs of <span class="math inline">\(k_{0,f}\)</span> and <span class="math inline">\(k_{0,r}\)</span> were estimated instead of estimating <span class="math inline">\(k_{0,f}\)</span> and <span class="math inline">\(k_{0,r}\)</span> directly (see <a href="section_6_data_generation.html#sec-example_18_6_2" class="quarto-xref">Example&nbsp;<span>18.6.2</span></a>). The fitting results are shown in <a href="#tbl-example_20_5_3_parameters" class="quarto-xref">Table&nbsp;<span>20.6</span></a>. The parity plot is shown in <a href="#fig-example_20_5_3_parity" class="quarto-xref">Figure&nbsp;<span>20.8</span></a> and the residuals plots are shown in <a href="#fig-example_20_5_2_residuals_plots" class="quarto-xref">Figure&nbsp;<span>20.6</span></a>.</p>
<div class="cell">
<div id="tbl-example_20_5_3_parameters" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-example_20_5_3_parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20.6: Parameter estimation results
</figcaption>
<div aria-describedby="tbl-example_20_5_3_parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 90%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">k<sub>0,f</sub></td>
<td style="text-align: center;">6.12 x 10<sup>5</sup> gal lbmol<sup>-1</sup> min<sup>-1</sup>, 95% CI [2.5 x 10<sup>5</sup>, 1.5 x 10<sup>6</sup>]</td>
</tr>
<tr class="even">
<td style="text-align: center;">E<sub>f</sub></td>
<td style="text-align: center;">1.19 x 10<sup>4</sup> BTU/lbmol, 95% CI [1.09 x 10<sup>4</sup>, 1.29 x 10<sup>4</sup>]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">k<sub>0r</sub></td>
<td style="text-align: center;">9.46 x 10<sup>7</sup> gal lbmol<sup>-1</sup> min<sup>-1</sup>, 95% CI [1.9 x 10<sup>7</sup>, 4.71 x 10<sup>8</sup>]</td>
</tr>
<tr class="even">
<td style="text-align: center;">E<sub>r</sub></td>
<td style="text-align: center;">1.89 x 10<sup>4</sup> BTU/lbmol, 95% CI [1.71 x 10<sup>4</sup>, 2.07 x 10<sup>4</sup>]</td>
</tr>
<tr class="odd">
<td style="text-align: center;">R<sup>2</sup></td>
<td style="text-align: center;">0.986</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="fig-example_20_5_3_parity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_3_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="examples/reb_20_5_3/reb_20_5_3_parity.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_3_parity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.8: Parity plot.
</figcaption>
</figure>
</div>
<div id="fig-example_20_5_3_residuals_plots" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example_20_5_3_residuals_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_3/reb_20_5_3_T_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_3/reb_20_5_3_Vdot_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_3/reb_20_5_3_CA0_residual.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_3/reb_20_5_3_CY0_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="examples/reb_20_5_3/reb_20_5_3_CZ0_residual.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example_20_5_3_residuals_plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.9: Residuals Plots.
</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click Here to See What an Expert Might be Thinking at this Point
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The deviations of the data points from the line in the parity plot are not large, the deviations of the residuals about zero are random with no apparent trends, the coefficient of determination is close to 1, and the upper and lower limits of the 95% confidence intervals for <span class="math inline">\(E_f\)</span> and <span class="math inline">\(E_r\)</span> are close to the estimated parameter value. The uncertainties in <span class="math inline">\(k_{0,f}\)</span> and <span class="math inline">\(k_{0,f}\)</span> are slightly greater, but still acceptable. This indicates that the rate expression is acceptabley accurate.</p>
</div>
</div>
</div>
<center>
<strong>Assessment</strong>
</center>
<p>When used with the rate expression parameters shown in <a href="#tbl-example_20_5_3_parameters" class="quarto-xref">Table&nbsp;<span>20.6</span></a>, the accuracy of the proposed rate expression in describing the concentration and temperature dependence of the rate, within the range of concentrations and temperatures investigated, is acceptable.</p>
</section>
</section>
</section>
<section id="symbols-used-in-sec-6_cstr_data_analysis" class="level2" data-number="20.6">
<h2 data-number="20.6" class="anchored" data-anchor-id="symbols-used-in-sec-6_cstr_data_analysis"><span class="header-section-number">20.6</span> Symbols Used in <a href="#sec-6_cstr_data_analysis" class="quarto-xref"><span>Chapter 20</span></a></h2>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(i\)</span></td>
<td style="text-align: left;">index denoting a reagent.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(k\)</span></td>
<td style="text-align: left;">Rate coefficient, an additional subscript denotes the reaction or direction of the reaction.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(k_0\)</span></td>
<td style="text-align: left;">Arrhenius pre-exponential factor, an additional subscript denotes the reaction or direction of the reaction.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(f\left(\right)\)</span></td>
<td style="text-align: left;">A mathematical function of the variables within the parentheses.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{n}_i\)</span></td>
<td style="text-align: left;">Molar flow rate of reagent <span class="math inline">\(i\)</span>, an additional subscripted “0” denotes the flow into the reactor and “1” denotes flow from the reactor.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(r\)</span></td>
<td style="text-align: left;">Net rate of reaction per unit fluid volume.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(x\)</span></td>
<td style="text-align: left;">Independent variable in a linear model.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(y\)</span></td>
<td style="text-align: left;">Dependent variable in a linear model.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(y_i\)</span></td>
<td style="text-align: left;">Mole fraction of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(C_i\)</span></td>
<td style="text-align: left;">Concentration of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(CI\)</span></td>
<td style="text-align: left;">Subscript denoting a 95% confidence interval, an additional “u” or “l” denotes the upper or lower limit of the interval.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(E\)</span></td>
<td style="text-align: left;">Activation energy, an additional subscript denotes the reaction or direction of the reaction.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(P\)</span></td>
<td style="text-align: left;">Pressure.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(P_i\)</span></td>
<td style="text-align: left;">Partial pressure of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(R\)</span></td>
<td style="text-align: left;">Ideal gas constant.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(R^2\)</span></td>
<td style="text-align: left;">Coefficient of determination.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(T\)</span></td>
<td style="text-align: left;">Temperature.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(V\)</span></td>
<td style="text-align: left;">Volume of fluid within the reactor.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{V}\)</span></td>
<td style="text-align: left;">Volumetric flow rate.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\alpha_i\)</span></td>
<td style="text-align: left;">Reaction order for reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\epsilon\)</span></td>
<td style="text-align: left;">Residual, a subscripted “expt” denotes an experiment residual and a subscripted index denotes an ATE residual.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\nu_i\)</span></td>
<td style="text-align: left;">Stoichiometric coefficient of reagent <span class="math inline">\(i\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\dot{\xi}\)</span></td>
<td style="text-align: left;">Apparent extent of reaction.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\tau\)</span></td>
<td style="text-align: left;">Space time.</td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./section_6_bstr_data_analysis.html" class="pagination-link" aria-label="Analysis of Kinetics Data from a BSTR">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a BSTR</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./section_6_pfr_data_analysis.html" class="pagination-link" aria-label="Analysis of Kinetics Data from a PFR">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Analysis of Kinetics Data from a PFR</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>